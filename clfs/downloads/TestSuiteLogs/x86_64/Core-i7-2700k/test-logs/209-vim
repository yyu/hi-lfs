Sat Jun 28 19:04:45 CDT 2014
make[1]: Entering directory '/sources/vim74'
Starting make in the src directory.
If there are problems, cd to the src directory and run make there
cd src && make test
make[2]: Entering directory '/sources/vim74/src'
make -f Makefile vim
make[3]: Entering directory '/sources/vim74/src'
make[3]: 'vim' is up to date.
make[3]: Leaving directory '/sources/vim74/src'
if test -n "yes" -a -f po/Makefile; then \
	cd po; make -f Makefile check VIM=../vim; \
fi
make[3]: Entering directory '/sources/vim74/src/po'
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq af.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"af.po" "af.po" 5393 lines, 133397 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch af.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq ca.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"ca.po" "ca.po" 6201 lines, 161830 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch ca.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq cs.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"cs.po" "cs.po" 4664 lines, 111014 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch cs.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq de.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"de.po" "de.po" 6117 lines, 156572 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch de.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq en_GB.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"en_GB.po" "en_GB.po" 290 lines, 8951 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch en_GB.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq eo.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"eo.po" "eo.po" 6873 lines, 175718 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch eo.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq es.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"es.po" "es.po" 8279 lines, 203808 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch es.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq fi.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"fi.po" "fi.po" 6526 lines, 161906 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch fi.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq fr.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"fr.po" "fr.po" 7091 lines, 192056 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch fr.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq ga.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"ga.po" "ga.po" 6503 lines, 164354 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch ga.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq it.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"it.po" "it.po" 6803 lines, 174858 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch it.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq ja.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"ja.po" "ja.po" 6808 lines, 195581 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch ja.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq ko.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"ko.po" "ko.po" 6447 lines, 155536 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch ko.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq ko.UTF-8.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"ko.UTF-8.po" "ko.UTF-8.po" 6447 lines, 171433 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch ko.UTF-8.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq nb.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"nb.po" "nb.po" 6166 lines, 150557 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch nb.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq nl.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"nl.po" "nl.po" 5852 lines, 135176 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch nl.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq no.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"no.po" "no.po" 6166 lines, 150557 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch no.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq pl.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"pl.po" "pl.po" 6904 lines, 175254 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch pl.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq pt_BR.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"pt_BR.po" "pt_BR.po" 6236 lines, 160821 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch pt_BR.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq ru.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"ru.po" "ru.po" 6890 lines, 226143 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch ru.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq sk.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"sk.po" "sk.po" 5821 lines, 147387 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch sk.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq sv.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"sv.po" "sv.po" 6148 lines, 149141 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch sv.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq uk.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"uk.po" "uk.po" 7027 lines, 215754 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch uk.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq vi.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"vi.po" "vi.po" 5196 lines, 143932 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch vi.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq zh_CN.UTF-8.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"zh_CN.UTF-8.po" "zh_CN.UTF-8.po" 6139 lines, 147454 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch zh_CN.UTF-8.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq zh_CN.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"zh_CN.po" "zh_CN.po" 6140 lines, 136476 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch zh_CN.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq zh_TW.UTF-8.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"zh_TW.UTF-8.po" "zh_TW.UTF-8.po" 5282 lines, 127286 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch zh_TW.UTF-8.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq zh_TW.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"zh_TW.po" "zh_TW.po" 5275 lines, 117353 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch zh_TW.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq cs.cp1250.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"cs.cp1250.po" "cs.cp1250.po" 4664 lines, 111022 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch cs.cp1250.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq ja.sjis.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"ja.sjis.po" "ja.sjis.po" 6808 lines, 172634 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch ja.sjis.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq ja.euc-jp.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"ja.euc-jp.po" "ja.euc-jp.po" 6808 lines, 172525 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch ja.euc-jp.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq pl.cp1250.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"pl.cp1250.po" "pl.cp1250.po" 6904 lines, 175250 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch pl.cp1250.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq pl.UTF-8.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"pl.UTF-8.po" "pl.UTF-8.po" 6904 lines, 178040 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch pl.UTF-8.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq ru.cp1251.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"ru.cp1251.po" "ru.cp1251.po" 6890 lines, 178240 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch ru.cp1251.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq sk.cp1250.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"sk.cp1250.po" "sk.cp1250.po" 5821 lines, 147383 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch sk.cp1250.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq uk.cp1251.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"uk.cp1251.po" "uk.cp1251.po" 7027 lines, 174515 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch uk.cp1251.ck
../vim -u NONE -e -X -S check.vim -c "if error == 0 | q | endif" -c cq zh_CN.cp936.po
[1;25r[?25h[?8c[?25h[?0c[?25l[?1c[25;1H"zh_CN.cp936.po" "zh_CN.cp936.po" 6140 lines, 136487 characters
search hit BOTTOM, continuing at TOPOK[25;3H[K[25;1H[?25h[?0c
touch zh_CN.cp936.ck
make[3]: Leaving directory '/sources/vim74/src/po'
if test vim != vim -a ! -r vim; then \
	ln -s vim vim; \
fi
cd testdir; make -f Makefile  VIMPROG=../vim  SCRIPTSOURCE=../../runtime
make[3]: Entering directory '/sources/vim74/src/testdir'
rm -f test.log
rm -rf test1.failed test.out X* viminfo tiny.vim small.vim mbyte.vim mzscheme.vim lua.vim test.ok wrongtermsize
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test1.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test1.in" 57 lines, 2069 characters[2;1HFirst a simple test to check if the test script works.

If Vim was not compiled with the +eval feature, the small.vim script will be
set to copy the test.ok file to test.out, so that it looks like the test
succeeded.  Otherwise an empty small.vim is written.  small.vim is sourced by
tests that require the +eval feature or other features that are missing in the
small version.

If Vim was not compiled with the +windows feature, the tiny.vim script will be
set like small.vim above.  tiny.vim is sourced by tests that require the
+windows feature or other features that are missing in the tiny version.

If Vim was not compiled with the +multi_byte feature, the mbyte.vim script will
be set like small.vim above.  mbyte.vim is sourced by tests that require the
+multi_byte feature.
Similar logic is applied to the +mzscheme feature, using mzscheme.vim.
Similar logic is applied to the +lua feature, using lua.vim.

STARTTEST
:" If columns or lines are too small, create wrongtermsize.
:" (Some tests will fail. When columns and/or lines are small)
:if &lines < 24 || &columns < 80 | sp another | w! wrongtermsize | qa! | endif
:"[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[20;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[21;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 35 lines, 1133 characters written[21;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[21;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H[1m[34m^[[0m:w! mbyte.vim
:w! mzscheme.vim
:w! lua.vim
:"
:" If +multi_byte feature supported, make mbyte.vim empty.
:if has("multi_byte") | sp another | w! mbyte.vim | q | endif
:"
:" If +mzscheme feature supported, make mzscheme.vim empty.
:if has("mzscheme") | sp another | w! mzscheme.vim | q | endif
:"
:" If +lua feature supported, make lua.vim empty.
:if has("lua") | sp another | w! lua.vim | q | endif
:"
:" If +eval feature supported quit here, leaving tiny.vim and small.vim empty.
:" Otherwise write small.vim to skip the test.
:if 1 | q! | endif
:w! small.vim
:" If +windows feature not supported :sp will fail and tiny.vim will be
:" written to skip the test.
:sp another
:wq! tiny.vim
:qa!
ENDTEST[?25h[?0c
[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" If columns or lines are too small, create wrongtermsize.[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" (Some tests will fail. When columns and/or lines are small)[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif &lines < 24 || &columns < 80 | sp another | w! wrongtermsize | qa! | endif[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Write a single line to test.out to check if testing works at all.[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c%d[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [0m[25;1H--No lines in buffer--[1;1H[?25h[?0c[?25l[?1cthis is a test[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 1 line, 15 characters written[1;14H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Create small.vim and tiny.vim empty, create mbyte.vim to skip the test.[?25l[?1c[1;14H[?25h[?0c[?25l[?1c[1;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! small.vim[?25l[?1c"small.vim" [25;13H[K[25;13H[New File] 1 line, 1 character written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! tiny.vim[?25l[?1c"tiny.vim" [25;12H[K[25;12H[New File] 1 line, 1 character written[1;1H[?25h[?0c[?25l[?1ce! test.ok
w! test.out[2;12H[K[3;1Hqa![3;4H[K[4;1H[K[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! mbyte.vim[?25l[?1c"mbyte.vim" [25;13H[K[25;13H[New File] 4 lines, 28 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! mzscheme.vim[?25l[?1c"mzscheme.vim" [25;16H[K[25;16H[New File] 4 lines, 28 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! lua.vim[?25l[?1c"lua.vim" [25;11H[K[25;11H[New File] 4 lines, 28 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" If +multi_byte feature supported, make mbyte.vim empty.[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif has("multi_byte") | sp another | w! mbyte.vim | q | endif[?25l[?1c"another" [New File][25;21H[K[25;1H
"mbyte.vim" 0 lines, 0 characters written[1;1H[L[1;1He! test.ok[25;1H[K[4;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c"[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" If +mzscheme feature supported, make mzscheme.vim empty.[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif has("mzscheme") | sp another | w! mzscheme.vim | q | endif[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" If +lua feature supported, make lua.vim empty.[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif has("lua") | sp another | w! lua.vim | q | endif[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" If +eval feature supported quit here, leaving tiny.vim and small.vim empty.[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Otherwise write small.vim to skip the test.[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif 1 | q! | endif[?25l[?1c[?25h[?0c[25;1H[K[25;1Hrm -rf X* viminfo
rm -rf test2.failed test.ok test.out X* viminfo
cp test2.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test2.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test2.in" 29 lines, 717 characters[2;1HThis is a test if a URL is recognized by "gf", with the cursor before and
after the "://".  Also test ":\\".

STARTTEST
:so small.vim
/^first
/tmp
:call append(0, expand("<cfile>"))
/^second
/URL
:call append(1, expand("<cfile>"))
:if has("ebcdic")
: set isf=@,240-249,/,.,-,_,+,,,$,:,~,\
:else
: set isf=@,48-57,/,.,-,_,+,,,$,:,~,\
:endif
/^third
/name
:call append(2, expand("<cfile>"))
/^fourth
/URL
:call append(3, expand("<cfile>"))
5GdG:wq! test.out[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[5;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 19 lines, 336 characters written[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[6;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[24;1H
[1;25r[24;1HENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hfirst test for URL://machine.name/tmp/vimtest2a and other text[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^first[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[24;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H/[?25h[?0ctmp[?25l[?1c[24;35H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append(0, expand("<cfile>"))[?25l[?1c[24;35H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^second[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hsecond test for URL://machine.name/tmp/vimtest2b. And other text[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0cURL[?25l[?1c[24;17H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append(1, expand("<cfile>"))[?25l[?1c[24;17H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif has("ebcdic")[?25l[?1c
:  [?25h[?0c: set isf=@,240-249,/,.,-,_,+,,,$,:,~,\
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c: set isf=@,48-57,/,.,-,_,+,,,$,:,~,\
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[2;1HSTARTTEST
:so small.vim
/^first[25;1H[K[24;17H[?25h[?0c[?25l[?1c
/[?25h[?0c^third[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hthird test for URL:\\machine.name\vimtest2c and other text[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0cname[?25l[?1c[24;30H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append(2, expand("<cfile>"))[?25l[?1c[24;30H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^fourth[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hfourth test for URL:\\machine.name\tmp\vimtest2d, and other text[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0cURL[?25l[?1c[24;17H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append(3, expand("<cfile>"))[?25l[?1c[24;17H[?25h[?0c[?25l[?1c[1;24r[1;1H[5L[1;25r[2;1HThis is a test if a URL is recognized by "gf", with the cursor before and
after the "://".  Also test ":\\".

STARTTEST[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H29 fewer lines[27m[24m[0m[H[J[1;1HURL:\\machine.name\tmp\vimtest2d
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [0m[25;1H29 fewer lines[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwq! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 4 lines, 128 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test3.failed test.ok test.out X* viminfo
cp test3.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test3.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test3.in" 2056 lines, 21564 characters[1;1H/* vim: set cin ts=4 sw=4 : */

Test for 'cindent'

STARTTEST
:so small.vim
:set nocompatible viminfo+=nviminfo modeline
:edit[16C" read modeline
/start of AUTO
=/end of AUTO
ENDTEST

/* start of AUTO matically checked vim: set ts=4 : */
{[15;9Hif (test)[16;17Hcmd1;[17;9Hcmd2;
}

{[21;9Hif (test)[22;17Hcmd1;[23;9Helse[24;17Hcmd2;[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1H/* vim: set cin ts=4 sw=4 : */[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[5;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 5 lines, 125 characters written[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[6;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[11;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nocompatible viminfo+=nviminfo modeline[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cedit                " read modeline[?25l[?1c"test3.in"[25;22H[K[25;12H2056L, 21564C[15;5Hif (test)[15;14H[K[16;9Hcmd1;[16;17H[K[17;5Hcmd2;[17;10H[K[21;5Hif (test)[21;14H[K[22;9Hcmd1;[22;17H[K[23;5Helse[23;9H[K[24;9Hcmd2;[24;17H[K[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cstart of AUTO[?25l[?1c[13;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cend of AUTO[?25l[?1c873 lines to indent...850075065055045035025015050 lines to indent... 874 lines indented [25;20H[K[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[27m[24m[0m[H[J[1;1Hnamespace test test2
{
    1111111111111111111;
}
namespace111111111
{
    111111111111111111;
}

/* end of AUTO */

STARTTEST
:set tw=0 wm=60 columns=80 noai fo=croq
/serious/e
a about life, the universe, and the rest[1m[34m^[[0m
ENDTEST

{

/* this is
 * a real serious important big
 * comment
 */
    /* insert " about life, the universe, and the rest" after "serious" */[12;1H[?25h[?0c
[?25l[?1c[25;1H:set ff=unix cpo-=A[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 93C written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST/+-1[25;13H[K[25;1H[15;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[16;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset tw=0 wm=60 columns=80 noai fo=croq[?25l[?1c[27m[24m[0m[H[J[1;1Hnamespace test test2
{
    1111111111111111111;
}
namespace111111111
{
    111111111111111111;
}

/* end of AUTO */

STARTTEST
:set tw=0 wm=60 columns=80 noai fo=croq
/serious/e
a about life, the universe, and the rest[1m[34m^[[0m
ENDTEST

{

/* this is
 * a real serious important big
 * comment
 */
    /* insert " about life, the universe, and the rest" after "serious" */[16;1H[?25h[?0c[?25l[?1c[25;1H/[?25h[?0cserious/e[?25l[?1c[21;17H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT --[0m[25;1H[K[21;19H[K[22;4Habout life, the
 * universe, and the
 * rest important big[24;23H[K[24;7H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;2H* comment[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[5M[1;25r[20;2H*/
    /* insert " about life, the universe, and the rest" after "serious" */
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set nocin[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H6L, 78C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[5M[1;25r[20;1H/comments
joabout life[1m[34m^[[0m/happens
jothere[1m[34m^[[0m/below
oline[1m[34m^[[0m/this
Ohello[1m[34m^[[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nocin[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0ccomments[?25l[?1c[1;24r[1;1H[4M[1;25r[22;1H{
    /*[24;6H* Testing for comments, without 'cin' set[25;1H[K[24;20H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;6H*/[?25h[?0c[?25l[?1c
[1m-- INSERT --[0m[25;1H[K[1;24r[24;1H
[1;25r[24;1Habout life[?25h[?0c[?25l[?1c
/[?25h[?0chappens[?25l[?1c[1;24r[1;1H[3M[1;25r[23;1H/*
* what happens here?[25;1H[K[24;8H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H*/[?25h[?0c[?25l[?1c
[1m-- INSERT --[0m[25;1H[K[1;24r[24;1H
[1;25r[24;1Hthere[?25h[?0c[?25l[?1c
/[?25h[?0cbelow[?25l[?1c[1;24r[1;1H[3M[1;25r[23;5H/*[24;8Hthe end of the comment, try inserting a line below */[25;1H[K[24;53H[?25h[?0c[?25l[?1c
[1m-- INSERT --[0m[25;1H[K[1;24r[24;1H
[1;25r[24;1Hline[?25h[?0c[?25l[?1c
/[?25h[?0cthis[?25l[?1c[1;24r[1;1H[3M[1;25r[23;9H/* how about[24;25Hthis one */[25;1H[K[24;25H[?25h[?0c[?25l[?1c
[1m-- INSERT --[0m[25;1H[K[24;1Hhello[24;25H[K[24;5H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;25Hthis one */[24;8H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[3M[1;25r[22;1H}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cin[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 18C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[2M[1;25r[23;1H/vec2
==[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cin[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cvec2[?25l[?1c[1;24r[1;1H[5M[1;25r[21;1H{
    var = this + that + vec[0] * vec[0][23;23H+ vec[1] * vec[1][24;23H+ vec2[2] * vec[2];[25;1H[K[24;25H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H}[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cin[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H5L, 51C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[4M[1;25r[21;1H:set cino=}4
/testing1
k2==/testing2
k2==[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cin[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=}4[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0ctesting1[?25l[?1c[1;24r[1;1H[8M[1;25r[18;1H{[19;9Hasdf asdflkajds f;
    if (tes & ting) {[21;9Hasdf asdf asdf ;[22;9Hasdfa sdf asdf;[23;9H}
    testing1;[25;1H[K[24;5H[?25h[?0c[23;8H [?25l[?1c

/[?25h[?0ctesting2[?25l[?1c[1;24r[1;1H[6M[1;25r[19;5Hif (tes & ting)
    {[21;9Hasdf asdf asdf ;[22;9Hasdfa sdf asdf;[23;9H}
    testing2;[25;1H[K[24;5H[?25h[?0c[23;8H [24;9H[?25l[?1c
/^STARTTEST[1;24r[1;1H[3M[1;25r[22;1H}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cin[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H4L, 36C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[3M[1;25r[22;1H:set cino=(0,)20
/main
=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cin[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=(0,)20[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cmain[?25l[?1c[1;24r[1;1H[2M[1;25r[24;1Hmain ( int first_par, /*[25;1H[K[24;1H[?25h[?0c[?25l[?1c
19 lines to indent...20[7Cindented [25;19H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;24H* Comment for[25;1H[K[24;4H[?25h[?0c[?25l[?1c
/^STARTTEST[27m[24m[0m[H[J[1;23H* Comment for[2;23H* first par[3;23H*/[4;11Hsecond_par /*[5;23H* Comment for[6;23H* second par[7;23H*/[8;9H);

}

STARTTEST
:set cin
:set cino=es,n0s
/main
=][
ENDTEST

main(void)
{
    /* Make sure that cino=X0s is not parsed like cino=Xs. */
    if (cond)[23;9Hfoo();
    else[12;1H[?25h[?0c
[?25l[?1c[25;1H:set ff=unix cpo-=A[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H4L, 36C written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST/+-1[25;13H[K[25;1H[16;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cin[?25l[?1c[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=es,n0s[?25l[?1c[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cmain[?25l[?1c[19;1H[?25h[?0c[?25l[?1c[25;1H8 lines to indent...9[7Cindented [25;18H[K[19;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H/^STARTTEST[1;24r[1;1H[6M[1;25r[19;5H{[20;9Hbar();
    }
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cin[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 26C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[2M[1;25r[23;1H:set cino=
]]=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cin[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[24;1H{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
11 lines to indent...12[7Cindented [25;19H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Hdo[25;1H[K[24;4H[?25h[?0c[?25l[?1c
/^STARTTEST[27m[24m[0m[H[J[1;9Hif ()[2;9H{[3;13Hif ()[4;17Hasdf;[5;13Helse[6;17Hasdf;[7;9H}
    } while ();
    cmd;[8C/* this should go under the } */
}

STARTTEST
]]=][
ENDTEST

void f()
{
    if ( k() ) {[19;9Hl();[21;5H} else { /* Start (two words) end */[22;9Hm();
    }[12;1H[?25h[?0c
[?25l[?1c[25;1H:set ff=unix cpo-=A[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H1L, 6C written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST/+-1[25;13H[K[25;1H[13;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[14;1H[?25h[?0c


[?25l[?1c[25;1H8 lines to indent...9[7Cindented [25;18H[K[17;1H[?25h[?0c
   [?25l[?1c[25;1H[K[25;1H/^STARTTEST[1;24r[1;1H[4M[1;25r[21;5Hn();
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino={s,e-s[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 23C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H]]=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino={s,e-s[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[3M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
7 lines to indent...8[7Cindented [25;18H[K[24;1H    {[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Hif ( k() )[25;1H[K[24;5H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[9M[1;25r[16;9H{[17;9Hl();[18;9H} else { /* Start (two words) end */[19;9Hm();[20;9H}
    n();    /* should be under the if () */
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino={s,fs[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 25C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H]]=/ foo[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino={s,fs[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[3M[1;25r[23;1Hvoid bar(void)
{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0c foo[?25l[?1c30 lines to indent...31[7Cindented [25;19H[K[24;1H    {[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[27m[24m[0m[H[J[1;1Hvoid func(void)
    {
    a = 1;[4;9H{[5;9Hb = 2;[6;9H}
    c = 3;
    d = 4;
    }
/* foo */

STARTTEST
:set cino=
/while
ohere[1m[34m^[[0m
ENDTEST

a()
{
  do {
    a = a +[22;7Ha;
  } while ( a );[8C/* add text under this line */
    if ( a )[12;1H[?25h[?0c
[?25l[?1c[25;1H:set ff=unix cpo-=A[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 25C written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST/+-1[25;13H[K[25;1H[15;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[16;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=[?25l[?1c[16;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cwhile[?25l[?1c[23;5H[?25h[?0c[?25l[?1c

[1m-- INSERT --[0m[25;1H[K[24;3Hhere[24;8H[K[24;6H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Hif ( a )    i[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[4M[1;25r[21;7Ha;
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino= com=[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 109C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[3M[1;25r[22;1H/comment
olabel2: b();[1m[34m^M[0mlabel3 /* post */:[1m[34m^M[0m/* pre */ label4:[1m[34m^M[0mf(/*com*/);[1m[34m^M[0mif (/*com*/)[1m[34m^[24;1HM[0mcmd();[1m[34m^[[0m[25;1H[K[23;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino= com=[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0ccomment[?25l[?1c[1;24r[1;1H[6M[1;25r[20;1Ha()
{
label1:[23;13H/* hmm */[24;13H// comment[25;1H[K[24;16H[?25h[?0c[?25l[?1c
[1m-- INSERT --[0m[25;1H[K[1;24r[1;1H[6M[1;25r[19;1Hlabel2: b();
label3 /* post */:
/* pre */ label4:[22;9Hf(/*com*/);[23;9Hif (/*com*/)[24;13Hcmd();[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H}[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set comments& comments^=s:/*,m:**,ex:*/[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 53C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[2M[1;25r[23;1H/simple
=5j[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset comments& comments^=s:/*,m:**,ex:*/[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0csimple[?25l[?1c[1;24r[1;1H[4M[1;25r[22;1H/*
  * A simple comment
   */[25;1H[K[23;7H[?25h[?0c[?25l[?1c

5 lines to indent...6[7Cindented [25;18H[K[23;2H* A simple comment[23;20H[K[24;2H*/[24;4H[K[23;2H[?25h[?0c
 [?25l[?1c[25;1H[K[25;1H/^STARTTEST[1;24r[1;1H[6M[1;25r[20;1H/*
** A different comment
*/

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=c0[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 70C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[2M[1;25r[23;1H:set comments& comments-=s1:/* comments^=s0:/*
2kdd]]=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=c0[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset comments& comments-=s1:/* comments^=s0:/*[?25l[?1c[24;1H[?25h[?0c[22;1H[?25l[?1c2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
4 lines to indent...5[7Cindented [25;18H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[6M[1;25r[19;5H/*********[20;7HA comment.
    *********/
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=c0,C1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 73C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[2M[1;25r[23;1H:set comments& comments-=s1:/* comments^=s0:/*
2kdd]]=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=c0,C1[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset comments& comments-=s1:/* comments^=s0:/*[?25l[?1c[24;1H[?25h[?0c[22;1H[?25l[?1c2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
4 lines to indent...5[7Cindented [25;18H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[6M[1;25r[19;5H/*********
    A comment.
    *********/
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 17C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H]]=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[3M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
5 lines to indent...6[7Cindented [25;18H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Hc = c1 &&[25;1H[K[24;4H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[7M[1;25r[18;9H([19;10Hc2 ||[20;10Hc3[21;9H) && c4;
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=(s[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 23C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=(s[?25l[?1c[24;1H[?25h[?0c[22;1H[?25l[?1c2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
5 lines to indent...6[7Cindented [25;18H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Hc = c1 &&[25;1H[K[24;4H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[7M[1;25r[18;9H([19;10Hc2 ||[20;10Hc3[21;9H) && c4;
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=(s,U1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 28C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=(s,U1  [?25l[?1c[24;1H[?25h[?0c[22;1H[?25l[?1c2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
5 lines to indent...6[7Cindented [25;18H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Hc = c1 &&[25;1H[K[24;4H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[7M[1;25r[18;9H([19;13Hc2 ||[20;13Hc3[21;9H) && c4;
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=(0[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 23C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=(0[?25l[?1c[24;1H[?25h[?0c[22;1H[?25l[?1c2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
4 lines to indent...5[7Cindented [25;18H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Hif (   c1[25;1H[K[24;4H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[6M[1;25r[19;12H&& (   c2[20;19H|| c3))[21;9Hfoo;
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=(0,w1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 28C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=(0,w1  [?25l[?1c[24;1H[?25h[?0c[22;1H[?25l[?1c2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
4 lines to indent...5[7Cindented [25;18H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Hif (   c1[25;1H[K[24;4H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[6M[1;25r[19;9H&& (   c2[20;13H|| c3))[21;9Hfoo;
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=(s[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 23C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=(s[?25l[?1c[24;1H[?25h[?0c[22;1H[?25l[?1c2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
8 lines to indent...9[7Cindented [25;18H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Hc = c1 && ([25;1H[K[24;4H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[10M[1;25r[15;9Hc2 ||[16;9Hc3[17;9H) && c4;
    if ([19;9Hc1 && c2[20;8H)[21;9Hfoo;
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=(s,m1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 28C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=(s,m1  [?25l[?1c[24;1H[?25h[?0c[22;1H[?25l[?1c2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
8 lines to indent...9[7Cindented [25;18H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Hc = c1 && ([25;1H[K[24;4H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[10M[1;25r[15;9Hc2 ||[16;9Hc3
    ) && c4;
    if ([19;9Hc1 && c2
    )[21;9Hfoo;
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=b1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 23C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=b1[?25l[?1c[24;1H[?25h[?0c[22;1H[?25l[?1c2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
9 lines to indent...10 lines indented [25;19H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Hswitch (x)[25;1H[K[24;4H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[11M[1;25r[14;5H{[15;9Hcase 1:[16;13Ha = b;[17;9Hbreak;[18;9Hdefault:[19;13Ha = 0;[20;9Hbreak;
    }
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=(0,W5[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 26C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=(0,W5[?25l[?1c[24;1H[?25h[?0c[22;1H[?25l[?1c2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
10 lines to indent...11[7Cindented [25;19H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Hinvokeme([25;1H[K[24;4H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[12M[1;25r[13;10Hargu,[14;10Hment);
    invokeme([16;10Hargu,[17;10Hment[18;10H);
    invokeme(argu,[20;14Hment[21;13H);
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=/6[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 23C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=/6[?25l[?1c[24;1H[?25h[?0c[22;1H[?25l[?1c2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
3 lines to indent...4[7Cindented [25;18H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Hstatement;[25;1H[K[24;4H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[5M[1;25r[20;11H// comment 1[21;11H// comment 2
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 34C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[2M[1;25r[23;1H2kdd]]/comment 1/+1
==[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=[?25l[?1c[24;1H[?25h[?0c[22;1H[?25l[?1c==[22;3H[K[23;1HENDTEST[24;1H[K[22;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hvoid f()
{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0ccomment 1/+1[?25l[?1c[1;24r[1;1H[3M[1;25r[22;5Hstatement;[23;8H// comment 1
    // comment 2[25;1H[K[24;4H[?25h[?0c[?25l[?1c    // comment 2[24;8H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H}[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=g0[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 23C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=g0[?25l[?1c[24;1H[?25h[?0c[22;1H[?25l[?1c2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hclass CAbc
{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
6 lines to indent...7[7Cindented [25;18H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Hint Test() { return FALSE; }[25;1H[K[24;4H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[8M[1;25r[18;1Hpublic: // comment
    void testfall();
protected:
    void testfall();
};

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=(0,gs,hs[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 29C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=(0,gs,hs[?25l[?1c[24;1H[?25h[?0c[22;1H[?25l[?1c2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hclass Foo : public Bar
{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
5 lines to indent...6[7Cindented [25;18H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Hpublic:[25;1H[K[24;4H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[7M[1;25r[18;9Hvirtual void method1(void) = 0;[19;9Hvirtual void method2(int arg1,[20;30Hint arg2,[21;30Hint arg3) = 0;
};

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=+20[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 24C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=+20[?25l[?1c[24;1H[?25h[?0c[22;1H[?25l[?1c2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[3M[1;25r[22;5Hvoid
foo()
{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
4 lines to indent...5[7Cindented [25;18H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Hif (a)[25;1H[K[24;4H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[6M[1;25r[19;5H{
    } else[21;9Hasdf;
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=(0,W2s[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 27C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd]]=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=(0,W2s[?25l[?1c[24;1H[?25h[?0c[22;1H[?25l[?1c2kdd]]=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
34 lines to indent...35[7Cindented [25;19H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Haverylongfunctionnamelongfunctionnameaverylongfunctionname()->asd([25;1H[K[24;4H[?25h[?0c[?25l[?1c
/^STARTTEST[27m[24m[0m[H[J[1;21Hdec)->asdfasdfasdf([2;29Hasdfadsf,[3;29Hasdfasdf,[4;29Hasdfasdf,[5;29H),[6;13Hfunc(asdfadf,[7;18Hasdfasdf),[8;13Hasdasdf[9;13H);
}

STARTTEST
:set cino=M1
2kdd]]=][
ENDTEST

int main ()
{
    if (cond1 &&[20;13Hcond2[21;13H)[22;9Hfoo;
}[12;1H[?25h[?0c
[?25l[?1c[25;1H:set ff=unix cpo-=A[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 23C written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST/+-1[25;13H[K[25;1H[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=M1[?25l[?1c[15;1H[?25h[?0c[13;1H[?25l[?1c[13;24r[24;1H
[1;25r[24;1HSTARTTEST[25;1H[K[13;1H[?25h[?0c[17;1H[?25l[?1c[25;1H4 lines to indent...5[7Cindented [25;18H[K[17;1H[?25h[?0c
   [?25l[?1c[25;1H[K[25;1H/^STARTTEST[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=(0,ts[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 24C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=(0,ts[?25l[?1c[24;1H[?25h[?0c[22;1H[?25l[?1c2kdd=][[22;8H[K[23;1HENDTEST[24;1H[K[22;1H[?25h[?0c[?25l[?1c


9 lines to indent...10 lines indented [25;19H[K[22;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H/^STARTTEST[1;24r[1;1H[10M[1;25r[15;1Hvoid func(int a
#if defined(FOO)[17;11H, int b[18;11H, int c
#endif[20;10H)
{
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=(0[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 21C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=(0[?25l[?1c[24;1H[?25h[?0c[22;1H[?25l[?1c2kdd=][[22;8H[K[23;1HENDTEST[24;1H[K[22;1H[?25h[?0c[?25l[?1c


10 lines to indent...11[7Cindented [25;19H[K[22;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H/^STARTTEST[1;24r[1;1H[11M[1;25r[14;5Hvoid
func(int a
#if defined(FOO)[17;6H, int b[18;6H, int c
#endif
    )
{
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino&[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 20C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd=7][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino&[?25l[?1c[24;1H[?25h[?0c[22;1H[?25l[?1c2kdd=7][[22;9H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?25h[?0c[?25l[?1c


71 lines to indent...5072[7Cindented [25;19H[K[22;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H/^STARTTEST[27m[24m[0m[H[J[1;9Hint a,[2;9Hint b)
{
}[6;5Hvoid
func6([8;9Hint a)
{
}

STARTTEST
:set cino&
:set cino+=l1
2kdd=][
ENDTEST

void func(void)
{
    int tab[] =
    {[22;9H1, 2, 3,[23;9H4, 5, 6};[12;1H[?25h[?0c
[?25l[?1c[25;1H:set ff=unix cpo-=A[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 33C written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST/+-1[25;13H[K[25;1H[15;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[16;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino&[?25l[?1c[16;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino+=l1[?25l[?1c[16;1H[?25h[?0c[14;1H[?25l[?1c[14;24r[24;1H
[1;25r[24;5Hprintf("Indent this line correctly!\n");[25;1H[K[14;1H[?25h[?0c[?25l[?1c[25;1H24 lines to indent...25[7Cindented [25;19H[K[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H/^STARTTEST[27m[24m[0m[H[J[1;13Hbreak;[2;9Hcase baz: {[3;13Hprintf("baz");[4;13Hbreak;[5;9H}[6;9Hcase quux:[7;13Hprintf("But don't break the indentation of this instruction\n");[8;13Hbreak;
    }
}

STARTTEST
:set cino&
2kdd=][
ENDTEST

void func(void)
{
    cout << "a"
    << "b"
    << ") :"
    << "c";
}[12;1H[?25h[?0c
[?25l[?1c[25;1H:set ff=unix cpo-=A[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 19C written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST/+-1[25;13H[K[25;1H[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino&[?25l[?1c[15;1H[?25h[?0c[13;1H[?25l[?1c[13;24r[24;1H
[1;25r[24;1HSTARTTEST[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H8 lines to indent...9[7Cindented [25;18H[K[19;5H    << "b"
        << ") :"
        << "c";[13;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H/^STARTTEST[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set com=s1:/*,m:*,ex:*/[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 38C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H]]3jofoo();[1m[34m^[[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset com=s1:/*,m:*,ex:*/[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[3M[1;25r[23;1Hvoid func(void)
{[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[3M[1;25r[22;5H/*[23;6H* This is a comment.[24;6H*/[?25h[?0c[?25l[?1c
[1m-- INSERT --[0m[25;1H[K[1;24r[24;1H
[1;25r[24;5Hfoo();[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H}[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino&[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 19C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino&[?25l[?1c[24;1H[?25h[?0c[22;1H[?25l[?1c2kdd=][[22;8H[K[23;1HENDTEST[24;1H[K[22;1H[?25h[?0c[?25l[?1c


10 lines to indent...11[7Cindented [25;19H[K[22;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H/^STARTTEST[1;24r[1;1H[11M[1;25r[14;1Hvoid func(void)
{
    for (int i = 0; i < 10; ++i)[17;9Hif (i & 1) {[18;13Hfoo(1);[19;9H} else[20;13Hfoo(0);
    baz();
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=k2s,(0[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 27C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;1H2kdd3j=][[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=k2s,(0[?25l[?1c[24;1H[?25h[?0c[22;1H[?25l[?1c2kdd3j=][[22;10H[K[23;1HENDTEST[23;8H[K[24;1H[K[22;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hvoid func(void)[25;1H[K[24;1H[?25h[?0c[?25l[?1c
23 lines to indent...24[7Cindented [25;19H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/^STARTTEST[27m[24m[0m[H[J[2;5Hif (   c1[3;13H&& (      c2[4;23H|| c3))[5;9Hfoo;
    func( c1[7;11H&& (     c2[8;20H|| c3))[9;9Hfoo;
}

STARTTEST
:set cino=k2s,(s
2kdd3j=][
ENDTEST

void func(void)
{
    if (condition1
    && condition2)
    action();
    function(argument1
    && argument2);[12;1H[?25h[?0c
[?25l[?1c[25;1H:set ff=unix cpo-=A[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 27C written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST/+-1[25;13H[K[25;1H[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=k2s,(s[?25l[?1c[15;1H[?25h[?0c[13;1H[?25l[?1c[13;24r[24;1H
[1;25r[24;5Hif (c1 && (c2 ||[25;1H[K[13;1H[?25h[?0c


[?25l[?1c[25;1H23 lines to indent...24[7Cindented [25;19H[K[19;5H        && condition2)
        action();[22;5H    && argument2);[16;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H/^STARTTEST[27m[24m[0m[H[J[2;5Hif (   c1[3;13H&& (      c2[4;17H|| c3))[5;9Hfoo;
    func(   c1[7;9H&& (      c2[8;13H|| c3))[9;9Hfoo;
}

STARTTEST
:set cino=k2s,(s,U1
2kdd3j=][
ENDTEST

void func(void)
{
    if (condition1
    && condition2)
    action();
    function(argument1
    && argument2);[12;1H[?25h[?0c
[?25l[?1c[25;1H:set ff=unix cpo-=A[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 30C written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST/+-1[25;13H[K[25;1H[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=k2s,(s,U1[?25l[?1c[15;1H[?25h[?0c[13;1H[?25l[?1c[13;24r[24;1H
[1;25r[24;5Hif (c1 && (c2 ||[25;1H[K[13;1H[?25h[?0c


[?25l[?1c[25;1H24 lines to indent...25[7Cindented [25;19H[K[19;5H        && condition2)
        action();[22;5H    && argument2);[16;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H/^STARTTEST[27m[24m[0m[H[J[1;13H&& (c22345[2;17H|| c3))[3;9Hprintf("foo\n");[5;5Hc = c1 &&[6;9H([7;13Hc2 ||[8;13Hc3[9;9H) && c4;
}

STARTTEST
:set cino=k2s,(0,W4
2kdd3j=][
ENDTEST

void func(void)
{
    if (condition1
    && condition2)
    action();
    function(argument1
    && argument2);[12;1H[?25h[?0c
[?25l[?1c[25;1H:set ff=unix cpo-=A[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 30C written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST/+-1[25;13H[K[25;1H[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=k2s,(0,W4[?25l[?1c[15;1H[?25h[?0c[13;1H[?25l[?1c[13;24r[24;1H
[1;25r[24;5Hif (c1 && (c2 ||[25;1H[K[13;1H[?25h[?0c


[?25l[?1c[25;1H29 lines to indent...30[7Cindented [25;19H[K[19;5H        && condition2)
        action();[22;5H         && argument2);[16;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H/^STARTTEST[27m[24m[0m[H[J[1;13H&& (   c2[2;20H|| c3))[3;9Hfoo;[5;5Ha_long_line([6;9Hargument,[7;9Hargument);
    a_short_line(argument,[9;18Hargument);
}

STARTTEST
:set cino=k2s,u2
2kdd3j=][
ENDTEST

void func(void)
{
    if (condition1
    && condition2)
    action();
    function(argument1
    && argument2);[12;1H[?25h[?0c
[?25l[?1c[25;1H:set ff=unix cpo-=A[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 27C written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST/+-1[25;13H[K[25;1H[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=k2s,u2[?25l[?1c[15;1H[?25h[?0c[13;1H[?25l[?1c[13;24r[24;1H
[1;25r[24;5Hif (c1 && (c2 ||[25;1H[K[13;1H[?25h[?0c


[?25l[?1c[25;1H18 lines to indent...19[7Cindented [25;19H[K[19;5H        && condition2)
        action();[22;5H        && argument2);[16;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H/^STARTTEST[27m[24m[0m[H[J[1;9Hfoo;
    if (c1 &&[3;13H(c2 || c3))
    {
    }
    if (c123456789[7;13H&& (c22345[8;15H|| c3))[9;9Hprintf("foo\n");
}

STARTTEST
:set cino=k2s,(0,w1
2kdd3j=][
ENDTEST

void func(void)
{
    if (condition1
    && condition2)
    action();
    function(argument1
    && argument2);[12;1H[?25h[?0c
[?25l[?1c[25;1H:set ff=unix cpo-=A[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 30C written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST/+-1[25;13H[K[25;1H[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=k2s,(0,w1[?25l[?1c[15;1H[?25h[?0c[13;1H[?25l[?1c[13;24r[24;1H
[1;25r[24;5Hif (c1 && (c2 ||[25;1H[K[13;1H[?25h[?0c


[?25l[?1c[25;1H27 lines to indent...28[7Cindented [25;19H[K[19;5H        && condition2)
        action();[22;5H         && argument2);[16;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H/^STARTTEST[27m[24m[0m[H[J[2;5Hif (   c1[3;13H&& (      c2[4;17H|| c3))[5;9Hfoo;
    func(   c1[7;10H&& (      c2[8;14H|| c3))[9;9Hfoo;
}

STARTTEST
:set cino=k2,(s
2kdd3j=][
ENDTEST

void func(void)
{
    if (condition1[20;7H&& condition2)[21;9Haction();
    function(argument1[23;9H&& argument2);[12;1H[?25h[?0c
[?25l[?1c[25;1H:set ff=unix cpo-=A[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 26C written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST/+-1[25;13H[K[25;1H[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=k2,(s[?25l[?1c[15;1H[?25h[?0c[13;1H[?25l[?1c[13;24r[24;1H
[1;25r[24;5Hif (c1 && (c2 ||[25;1H[K[13;1H[?25h[?0c


[?25l[?1c[25;1H14 lines to indent...15[7Cindented [25;19H[K[16;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H/^STARTTEST[1;24r[1;1H[9M[1;25r[16;11Hc3))[17;9Hfoo;
    if (c1 &&[19;7H(c2 || c3))
    {
    }
}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=N-s[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 47C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[2M[1;25r[23;1H/^NAMESPACESTART
=/^NAMESPACEEND[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=N-s[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^NAMESPACESTART[?25l[?1c[1;24r[1;1H[2M[1;25r[24;1HNAMESPACESTART[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0c^NAMESPACEEND[?25l[?1c61 lines to indent...5062[7Cindented [25;19H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[27m[24m[0m[H[J[1;1Hnamespace test test2
{
    1111111111111111111;
}
namespace111111111
{
    111111111111111111;
}
NAMESPACEEND


STARTTEST
:set cino=j1,J1
/^JSSTART
=/^JSEND
ENDTEST

JSSTART
var bar = {
foo: {
that: this,
some: ok,
},
"bar":{[12;1H[?25h[?0c
[?25l[?1c[25;1H:set ff=unix cpo-=A[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 35C written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST/+-1[25;13H[K[25;1H[15;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[16;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=j1,J1[?25l[?1c[16;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^JSSTART[?25l[?1c[18;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^JSEND[?25l[?1c12 lines to indent...13[7Cindented [25;19H[K[20;1H    foo: {
        that: this,
        some: ok,
    },
    "bar":{[18;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[1;24r[1;1H[9M[1;25r[16;9Ha : 2,[17;9Hb: "123abc",[18;9Hx: 4,[19;9H"y": 5
    }
}
JSEND

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=j1,J1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 35C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[2M[1;25r[23;1H/^JSSTART
=/^JSEND[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=j1,J1[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^JSSTART[?25l[?1c[1;24r[1;1H[2M[1;25r[24;1HJSSTART[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0c^JSEND[?25l[?1c5 lines to indent...6[7Cindented [25;18H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[1;24r[1;1H[8M[1;25r[17;1Hvar foo = [
1,  // indent 8 more
    2,
    3
    ];  // indent 8 less
JSEND

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=j1,J1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 35C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[2M[1;25r[23;1H/^JSSTART
=/^JSEND[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=j1,J1[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^JSSTART[?25l[?1c[1;24r[1;1H[2M[1;25r[24;1HJSSTART[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0c^JSEND[?25l[?1c7 lines to indent...8[7Cindented [25;18H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[1;24r[1;1H[10M[1;25r[15;1Hfunction bar() {
    var foo = [[17;9H1,[18;9H2,[19;9H3[20;13H];  // indent 16 less
}
JSEND

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=j1,J1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 35C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[2M[1;25r[23;1H/^JSSTART
=/^JSEND[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=j1,J1[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^JSSTART[?25l[?1c[1;24r[1;1H[2M[1;25r[24;1HJSSTART[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0c^JSEND[?25l[?1c52 lines to indent...503[7Cindented [25;19H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[27m[24m[0m[H[J[1;21Hreturn false;[2;17H}[3;17H_arguments[0]=options;[4;17Hmethod.apply(this,_arguments);[5;13H}[6;9H});
    }

})(jQuery);
JSEND

STARTTEST
:set cino=j1,J1
/^JSSTART
=/^JSEND
ENDTEST

JSSTART
function init(options) {
$(this).data(class_name+'_public',$.extend({},{
foo: 'bar',
bar: 2,
foobar: [
1,  // indent 8 more[12;1H[?25h[?0c
[?25l[?1c[25;1H:set ff=unix cpo-=A[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 35C written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST/+-1[25;13H[K[25;1H[15;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[16;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=j1,J1[?25l[?1c[16;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^JSSTART[?25l[?1c[18;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^JSEND[?25l[?1c14 lines to indent...15[7Cindented [25;19H[K[20;1H    $(this).data(class_name+'_public',$.extend({},{
        foo: 'bar',
        bar: 2,
        foobar: [
        1,  // indent 8 more[18;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[1;24r[1;1H[11M[1;25r[14;9H2,  // indent 8 more[15;9H3   // indent 8 more[16;9H],[17;9Hcallback: function(){[18;13Hreturn true;[19;9H}
    }, options||{}));
}
JSEND

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set cino=j1,J1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3L, 35C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[1;24r[1;1H[2M[1;25r[23;1H/^JSSTART
=/^JSEND[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HENDTEST[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cino=j1,J1[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^JSSTART[?25l[?1c[1;24r[1;1H[2M[1;25r[24;1HJSSTART[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0c^JSEND[?25l[?1c16 lines to indent...17[7Cindented [25;19H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[1;24r[1;1H[19M[1;25r[6;1H(function($){
    function init(options) {[8;9H$(this).data(class_name+'_public',$.extend({},{[9;13Hfoo: 'bar',[10;9Hbar: 2,  // indent 8 more[11;9Hfoobar: [  // indent 8 more[12;13H1,  // indent 8 more[13;9H2,  // indent 16 more[14;9H3  // indent 16 more[15;13H],[16;9Hcallback: function(){  // indent 8 more[17;13Hreturn true;  // indent 8 more[18;9H}  // indent 8 more[19;9H}, options||{}));
    }
})(jQuery);
JSEND

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:g/^STARTTEST/.,/^ENDTEST/d[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2L, 61C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST/+-1[25;13H[K[25;1H[23;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cg/^STARTTEST/.,/^ENDTEST/d[?25l[?1c216 fewer lines[25;16H[K[1;1H    }, options||{}));
}[2;2H[K[3;1HJSEND[4;1H[K[5;1H[K[6;1HJSSTART[6;8H[K[7;1H(function($){[7;14H[K[8;5Hfunction init(options) {[9;9H$(this).data(class_name+'_public',$.extend({},{[10;9H    foo: 'bar',[10;24H[K[11;9Hbar: 2,  // indent 8 more[12;9Hfoobar: [  // indent 8 more[13;9H    1,  // indent 8 more[14;9H2,  // indent 16 more[15;9H3  // indent 16 more[15;29H[K[16;13H],[16;15H[K[17;9Hcallback: function(){  // indent 8 more[18;9H    return true;  // indent 8 more
        }  // indent 8 more
        }, options||{}));
    }
})(jQuery);
JSEND[23;6H[K[24;1H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c1;/start of AUTO/,$wq! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New] 1820L, 18429C written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test4.failed test.ok test.out X* viminfo
cp test4.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test4.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test4.in" 31 lines, 839 characters[1;1HTest for autocommand that changes current buffer on BufEnter event.
Check if modelines are interpreted for the correct buffer.

STARTTEST
:so small.vim
:set nocompatible viminfo+=nviminfo
:au BufEnter Xxx brew
/start of
:.,/end of/w! Xxx   " write test file Xxx
:set ai modeline modelines=3
:sp Xxx[13C" split to Xxx, autocmd will do :brew
G?this is a
othis should be auto-indented[1m[34m^[[0m
:[19C" Append text with autoindent to this file
:au! BufEnter Xxx
:buf Xxx[12C" go to Xxx, no autocmd anymore
G?this is a
othis should be in column 1[1m[34m^[[0m:wq " append text without autoindent to Xxx
G:r Xxx[13C" include Xxx in the current file
:?startstart?,$w! test.out
:qa!
ENDTEST

startstart[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for autocommand that changes current buffer on BufEnter event.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[4;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 17 lines, 557 characters written[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[22;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nocompatible viminfo+=nviminfo[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau BufEnter Xxx brew[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cstart of[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hstart of test file Xxx[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c.,/end of/w! Xxx   " write test file Xxx[?25l[?1c"Xxx" [25;7H[K[25;7H[New] 7L, 124C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ai modeline modelines=3[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csp Xxx             " split to Xxx, autocmd will do :brew[?25l[?1c"Xxx" [25;7H[K[25;7H7L, 124C[1;1HTest for autocommand that changes current buffer on BufEnter event.
Check if modelines are interpreted for the correct buffer.[3;1H[K[4;1HSTARTTEST[4;10H[K[5;3Ho small.vim[5;14H[K[6;2Hset nocompatible viminfo+=nviminfo
:au BufEnter Xxx brew
/start of[8;10H[K[9;2H.,/end of/w! Xxx   " write test file Xxx
:set ai modeline modelines=3[10;29H[K[11;1H:sp Xxx    [9C" split to Xxx, autocmd will do :brew
[1m[7mtest4.in                                                                        [0m[13;2Hau! BufEnter Xxx[13;21H[K[14;2Hbuf Xxx            " go to Xxx, no autocmd anymore
G?this is a[15;21H[K[16;1Hothis should be in column 1[1m[34m^[[0m:wq " append text without autoindent to Xxx
G:r Xxx             " include Xxx in the current file[17;54H[K[18;1H:?startstart?,$w! test.out[18;27H[K[19;2Hqa![19;5H[K[20;1HENDTEST[21;1H[K[22;1Hstartstart[23;6H of test file Xxx
[7mtest4.in                                                                        [0m[25;2Htest4.in" line 1 of 31 --3%-- col 1[1;1H[?25h[?0c[?25l[?1c:qa![1;6H[K[2;1HENDTEST[2;8H[K[4;1Hstartstart
start of test file Xxx
vim: set noai :[6;16H[K[7;1H        this is a test
        this is a test
        this is a test[9;23H[K[10;1H        this is a test[10;23H[K[11;1Hend of test file Xxx[11;21H[K[11;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H?[?25h[?0cthis is a[?25l[?1c[10;9H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT --[0m[25;1H[K[11;1H        this should be auto-indented[12;10H[1m[7m[+][0m[24;10H[7m[+][11;36H[?25h[?0c[?25l[?1c[1;11r[0m[11;1H
[1;25r[11;1Hend of test file Xxx[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c                   " Append text with autoindent to this file[?25l[?1c[11;20H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau! BufEnter Xxx[?25l[?1c[11;20H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbuf Xxx            " go to Xxx, no autocmd anymore[?25l[?1c"Xxx" [25;7H[K[25;7H7L, 124C[1;1Hstart of test file Xxx
vim: set noai :
        this is a test
        this is a test
        this is a test

end of test file Xxx[7;21H[K[8;1H[1m[34m~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7mXxx         [1;1H[?25h[?0c[7;1H[?25l[?1c[0m[25;1H[K[25;1H?[?25h[?0cthis is a[?25l[?1c[6;9H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT --[0m[25;1H[K[7;11r[7;1H[L[1;25r[7;1Hthis should be in column 1[12;5H[1m[7m[+][7;26H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0cwq " append text without autoindent to Xxx[?25l[?1c"Xxx[25;7H[K[25;7H8L, 151C written[1;1HCheck if modelines are interpreted for the correct buffer.[2;1H[K[3;1HSTARTTEST[3;10H[K[4;1H:so small.vim[4;14H[K[5;1H:set nocompatible viminfo+=nviminfo
:au BufEnter Xxx brew[6;22H[K[7;1H/start of[7;10H[K[8;1H:.,/end of/w! Xxx   " write test file Xxx
:set ai modeline modelines=3[9;29H[K[10;1H:sp Xxx             " split to Xxx, autocmd will do :brew[10;58H[K[11;1HG?this is a[11;12H[K[12;1Hothis should be auto-indented[1m[34m^[[0m[12;32H[K[13;2H                   " Append text with autoindent to this file
:au! BufEnter Xxx[14;21H[K[15;1H:buf Xxx   [9C" go to Xxx, no autocmd anymore
G?this is a[16;12H[K[17;1Hothis should be in column 1[1m[34m^[[0m:wq " append text without autoindent to Xxx
G:r Xxx             " include Xxx in the current file
:?startstart?,$w! test.out
:qa![20;5H[K[21;1HENDTEST[22;1H[K[23;6Hstar[23;11H[K[24;1Hstart of test file Xxx[24;23H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[7M[1;25r[18;1Hvim: set noai :[19;9Hthis is a test[20;9Hthis is a test[21;9Hthis is a test[22;9Hthis is a test[23;9Hthis should be auto-indented
end of test file Xxx[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cr Xxx             " include Xxx in the current file[?25l[?1c"Xxx" [25;20H[K[25;7H8L, 151C[1;24r[24;1H
[1;25r[24;1Hstart of test file Xxx[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c?startstart?,$w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New] 17L, 316C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test5.failed test.ok test.out X* viminfo
cp test5.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test5.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test5.in" 29 lines, 949 characters[1;1HTest for autocommand that deletes the current buffer on BufLeave event.
Also test deleting the last buffer, should give a new, empty buffer.

STARTTEST
:so small.vim
:au BufLeave Xxx bwipe
/start of
:.,/end of/w! Xxx[15C" write test file Xxx
:sp Xxx[25C" split to Xxx
:bwipe[26C" delete buffer Xxx, now we're back here
G?this is a
othis is some more text[1m[34m^[[0m
:[31C" Append some text to this file
:?start?,$w! test.out[11C" Write current file contents
:bwipe test.out[17C" delete alternate buffer
:au bufleave test5.in bwipe
:bwipe![25C" delete current buffer, get an empty one
ithis is another test line[1m[34m^[[0m:w >>test.out
:[31C" append an extra line to the output file
:qa!
ENDTEST

start of test file Xxx
vim: set noai :[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for autocommand that deletes the current buffer on BufLeave event.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[4;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 16 lines, 664 characters written[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[21;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau BufLeave Xxx bwipe[?25l[?1c[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cstart of[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.,/end of/w! Xxx               " write test file Xxx[?25l[?1c"Xxx" [25;7H[K[25;7H[New File] 7 lines, 124 characters written[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csp Xxx                         " split to Xxx[?25l[?1c"Xxx" [25;7H[K[25;7H7 lines, 124 characters[1;1Hstart of test file Xxx[1;23H[K[2;1Hvim: set noai :[2;16H[K[3;9Hthis is a test
        this is a test
        this is a test
        this is a test
end of test file Xxx
[1m[34m~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7mXxx                                                                             [0m[24;1H[7mtest5.in                                                                        [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cbwipe                          " delete buffer Xxx, now we're back here[?25l[?1c[1;1HTest for autocommand that deletes the current buffer on BufLeave event.
Also test deleting the last buffer, should give a new, empty buffer.[3;9H[K[4;1HSTARTTEST[4;10H[K[5;1H:so small.vim[5;14H[K[6;1H:au BufLeave Xxx bwipe
/start of[7;10H[K[8;1H:.,/end of/w! Xxx               " write test file Xxx[8;54H[K[9;1H:sp Xxx                         " split to Xxx[9;47H[K[10;1H:bwipe                          " delete buffer Xxx, now we're back here[10;73H[K[11;1HG?this is a[11;12H[K[12;1Hothis is some more text[1m[34m^[[0m[12;26H[K[24;1Hvim: set noai :[24;16H[K[25;1H"test5.in" line 23 of 29 --79%-- col 1[25;39H[K[23;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[5M[1;25r[20;9Hthis is a test[21;9Hthis is a test[22;9Hthis is a test[23;9Hthis is a test
end of test file Xxx[25;1H[K[24;1H[?25h[?0c[?25l[?1c
?[?25h[?0cthis is a[?25l[?1c[23;9H[?25h[?0c[?25l[?1c
this is some more text[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hend of test file Xxx[25;1H[K[24;20H[?25h[?0c[?25l[?1c
:[?25h[?0c                               " Append some text to this file[?25l[?1c[24;20H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c?start?,$w! test.out           " Write current file contents[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 8 lines, 147 characters written[24;20H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe test.out                 " delete alternate buffer[?25l[?1c[24;20H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau bufleave test5.in bwipe[?25l[?1c[24;20H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe!                         " delete current buffer, get an empty one[?25l[?1c[1m[37m[41mError detected while processing BufLeave Auto commands for "test5.in":[0m[25;71H[K[25;1H
[1m[37m[41mE89: No write since last change for buffer 1 (add ! to override)[0m
[1m[32mPress ENTER or type command to continue[?25h[?0c[0m[1;1H[2L[?25l[?1c[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [0m[25;1H[K[1;1H[?25h[?0c[?25l[?1cthis is another test line[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 26 characters appended[1;25H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c                               " append an extra line to the output file[?25l[?1c[1;25H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test6.failed test.ok test.out X* viminfo
cp test6.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test6.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test6.in" 24 lines, 739 characters[1;1HTest for autocommand that redefines the argument list, when doing ":all".

STARTTEST
:so small.vim
:au BufReadPost Xxx2 next Xxx2 Xxx1
/^start of
A1[1m[34m^[[0m:.,/end of/w! Xxx1    " write test file Xxx1
$r2:.,/end of/w! Xxx2     " write test file Xxx2
$r3:.,/end of/w! Xxx3     " write test file Xxx3
:next! Xxx1 Xxx2 Xxx3     " redefine arglist; go to Xxx1
:all[22C" open window for all args
:w! test.out[14C" Write contents of Xxx1
[1m[34m^W^W^W^W[0m:w >>test.out     " Append contents of last window (Xxx1)
:rew[22C" should now be in Xxx2
:w >>test.out[13C" Append contents of Xxx2
:qa!
ENDTEST

start of test file Xxx[20;9Hthis is a test[21;9Hthis is a test[22;9Hthis is a test[23;9Hthis is a test
end of test file Xxx[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for autocommand that redefines the argument list, when doing ":all".[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 13 lines, 537 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[17;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[18;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[18;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau BufReadPost Xxx2 next Xxx2 Xxx1[?25l[?1c[18;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^start of[?25l[?1c[19;1H[?25h[?0c[?25l[?1c[22C1[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.,/end of/w! Xxx1    " write test file Xxx1[?25l[?1c"Xxx1" [25;9H[K[25;8H[New File] 6 lines, 109 characters written[19;23H[?25h[?0c[?25l[?1c2[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.,/end of/w! Xxx2     " write test file Xxx2[?25l[?1c"Xxx2" [25;9H[K[25;8H[New File] 6 lines, 109 characters written[19;23H[?25h[?0c[?25l[?1c3[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.,/end of/w! Xxx3     " write test file Xxx3[?25l[?1c"Xxx3" [25;9H[K[25;8H[New File] 6 lines, 109 characters written[19;23H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnext! Xxx1 Xxx2 Xxx3     " redefine arglist; go to Xxx1[?25l[?1c"Xxx1"[25;8H[K[25;8H6 lines, 109 characters[1;1Hstart of test file Xxx1[1;24H[K[2;9Hthis is a test
        this is a test
        this is a test
        this is a test[5;23H[K[6;1Hend of test file Xxx
[1m[34m~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0call                      " open window for all args[?25l[?1c"Xxx2"[25;27H[K[25;8H6 lines, 109 characters
"Xxx2" 6 lines, 109 characters
"Xxx1" line 1 of 6 --16%-- col 1 (file (3) of 2)
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! test.out              " Write contents of Xxx1[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 6 lines, 109 characters written
[1m[32mPress ENTER or type command to continue[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[1;1Hstart of test file Xxx1[2;9Hthis is a test[3;9Hthis is a test[4;9Hthis is a test[5;9Hthis is a test
end of test file Xxx
[1m[34m~                                                                               [0m[8;1H[1m[7mXxx1                                                                            [0m[9;1Hstart of test file Xxx2[10;9Hthis is a test[11;9Hthis is a test[12;9Hthis is a test[13;9Hthis is a test
end of test file Xxx
[1m[34m~                                                                               [0m[16;1H[7mXxx2                                                                            [0m[17;1Hstart of test file Xxx1[18;9Hthis is a test[19;9Hthis is a test[20;9Hthis is a test[21;9Hthis is a test
end of test file Xxx
[1m[34m~                                                                               [0m[24;1H[7mXxx1                                                                            [1;1H[?25h[?0c[8;1HXxx1                                                                            [0m[16;1H[1m[7mXxx2                                                                            [9;1H[0m[16;1H[7mXxx2                                                                            [0m[24;1H[1m[7mXxx1                                                                            [17;1H[?25l[?1c[25;1H[0m:[?25h[?0cw >>test.out     " Append contents of last window (Xxx1)[?25l[?1c"test.out" [25;12H[K[25;12H6 lines, 109 characters appended[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0crew                      " should now be in Xxx2[?25l[?1c"Xxx2" line 1 of 6 --16%-- col 1 (file 1 of 2)[25;47H[K[17;23H2[24;4H[1m[7m2[17;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw >>test.out             " Append contents of Xxx2[?25l[?1c"test.out" [25;12H[K[25;12H6 lines, 109 characters appended[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test7.failed test.ok test.out X* viminfo
cp test7.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test7.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test7.in" 26 lines, 675 characters[1;1HTest for autocommand that changes the buffer list, when doing ":ball".

STARTTEST
:so small.vim
/^start of
A1[1m[34m^[[0m:.,/end of/w! Xxx1   " write test file Xxx1
:sp Xxx1
:close
$r2:.,/end of/w! Xxx2    " write test file Xxx2
:sp Xxx2
:close
$r3:.,/end of/w! Xxx3    " write test file Xxx3
:sp Xxx3
:close
:au BufReadPost Xxx2 bwipe
$r4:ball[17C" open window for all args, close Xxx2
:.,$w! test.out[10C" Write contents of this file
[1m[34m^W^W[0m:w >>test.out[8C" Append contents of second window (Xxx1)
[1m[34m^W^W[0m:/^start of/,$w >>test.out   " Append contents of last window (this file)
:qa!
ENDTEST

start of test file Xxx[24;9Hthis is a test[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for autocommand that changes the buffer list, when doing ":ball".[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 17 lines, 508 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[21;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^start of[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[22C1[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.,/end of/w! Xxx1   " write test file Xxx1[?25l[?1c"Xxx1" [25;9H[K[25;8H[New File] 4 lines, 77 characters written[23;23H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csp Xxx1[?25l[?1c"Xxx1" [25;8H[K[25;8H4 lines, 77 characters[1;1Hstart of test file Xxx1[1;24H[K[2;9Hthis is a test
        this is a test
end of test file Xxx
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7mXxx1                                                                            [0m[24;1H[7mtest7.in [+]                                                                    [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cclose[?25l[?1c[1;1HTest for autocommand that changes the buffer list, when doing ":ball".[2;9H[K[3;1HSTARTTEST[3;10H[K[4;1H:so small.vim[4;14H[K[5;1H/^start of[5;11H[K[6;1HA1[1m[34m^[[0m:.,/end of/w! Xxx1   " write test file Xxx1[6;48H[K[7;1H:sp Xxx1[7;9H[K[8;1H:close[8;7H[K[9;1H$r2:.,/end of/w! Xxx2    " write test file Xxx2[9;48H[K[10;1H:sp Xxx2[10;9H[K[11;1H:close[11;7H[K[12;1H$r3:.,/end of/w! Xxx3    " write test file Xxx3[12;48H[K[24;1H        this is a test[24;23H[K[23;23H[?25h[?0c[?25l[?1c2[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.,/end of/w! Xxx2    " write test file Xxx2[?25l[?1c"Xxx2" [25;9H[K[25;8H[New File] 4 lines, 77 characters written[23;23H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csp Xxx2[?25l[?1c"Xxx2" [25;8H[K[25;8H4 lines, 77 characters[1;1Hstart of test file Xxx2[1;24H[K[2;9Hthis is a test
        this is a test
end of test file Xxx
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7mXxx2                                                                            [0m[24;1H[7mtest7.in [+]                                                                    [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cclose[?25l[?1c[1;1HTest for autocommand that changes the buffer list, when doing ":ball".[2;9H[K[3;1HSTARTTEST[3;10H[K[4;1H:so small.vim[4;14H[K[5;1H/^start of[5;11H[K[6;1HA1[1m[34m^[[0m:.,/end of/w! Xxx1   " write test file Xxx1[6;48H[K[7;1H:sp Xxx1[7;9H[K[8;1H:close[8;7H[K[9;1H$r2:.,/end of/w! Xxx2    " write test file Xxx2[9;48H[K[10;1H:sp Xxx2[10;9H[K[11;1H:close[11;7H[K[12;1H$r3:.,/end of/w! Xxx3    " write test file Xxx3[12;48H[K[24;1H        this is a test[24;23H[K[23;23H[?25h[?0c[?25l[?1c3[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.,/end of/w! Xxx3    " write test file Xxx3[?25l[?1c"Xxx3" [25;9H[K[25;8H[New File] 4 lines, 77 characters written[23;23H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csp Xxx3[?25l[?1c"Xxx3" [25;8H[K[25;8H4 lines, 77 characters[1;1Hstart of test file Xxx3[1;24H[K[2;9Hthis is a test
        this is a test
end of test file Xxx
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7mXxx3                                                                            [0m[24;1H[7mtest7.in [+]                                                                    [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cclose[?25l[?1c[1;1HTest for autocommand that changes the buffer list, when doing ":ball".[2;9H[K[3;1HSTARTTEST[3;10H[K[4;1H:so small.vim[4;14H[K[5;1H/^start of[5;11H[K[6;1HA1[1m[34m^[[0m:.,/end of/w! Xxx1   " write test file Xxx1[6;48H[K[7;1H:sp Xxx1[7;9H[K[8;1H:close[8;7H[K[9;1H$r2:.,/end of/w! Xxx2    " write test file Xxx2[9;48H[K[10;1H:sp Xxx2[10;9H[K[11;1H:close[11;7H[K[12;1H$r3:.,/end of/w! Xxx3    " write test file Xxx3[12;48H[K[24;1H        this is a test[24;23H[K[23;23H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau BufReadPost Xxx2 bwipe[?25l[?1c[23;23H[?25h[?0c[?25l[?1c4[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cball                 " open window for all args, close Xxx2[?25l[?1c"Xxx1"[25;23H[K[25;8H4 lines, 77 characters
"Xxx2" 4 lines, 77 characters
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c.,$w! test.out          " Write contents of this file[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 4 lines, 77 characters written
[1m[32mPress ENTER or type command to continue[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[1;1H:sp Xxx3
:close
:au BufReadPost Xxx2 bwipe
$r4:ball[17C" open window for all args, close Xxx2
:.,$w! test.out[10C" Write contents of this file
[1m[34m^W^W[0m:w >>test.out[8C" Append contents of second window (Xxx1)
[1m[34m^W^W[0m:/^start of/,$w >>test.out   " Append contents of last window (this file)
:qa!
ENDTEST

start of test file Xxx4
[1m[7mtest7.in [+]                                                                    [0m[13;1Hstart of test file Xxx1[14;9Hthis is a test[15;9Hthis is a test
end of test file Xxx
[1m[34m~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [0m[24;1H[7mXxx1                                                                            [11;23H[?25h[?0c
test7.in [+]                                                                    [0m[24;1H[1m[7mXxx1                                                                            [13;1H[?25l[?1c[25;1H[0m:[?25h[?0cw >>test.out        " Append contents of second window (Xxx1)[?25l[?1c"test.out" [25;12H[K[25;12H4 lines, 77 characters appended[13;1H[?25h[?0c[12;1H[1m[7mtest7.in [+]                                                                    [0m[24;1H[7mXxx1                                                                            [11;23H[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c/^start of/,$w >>test.out   " Append contents of last window (this file)[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m[25;37H[K[25;1H"test.out" [25;12H[K[25;12H4 lines, 77 characters appended[11;23H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test8.failed test.ok test.out X* viminfo
cp test8.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test8.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test8.in" 46 lines, 1236 characters[1;1HTest for BufWritePre autocommand that deletes or unloads the buffer.
Test for BufUnload autocommand that unloads all other buffers.

STARTTEST
:so small.vim
:au BufWritePre Xxx1 bunload
:au BufWritePre Xxx2 bwipe
/^start of
A1[1m[34m^[[0m:.,/end of/w! Xxx1  " write test file Xxx1
$r2:.,/end of/w! Xxx2   " write test file Xxx2
:e! Xxx2[16C" edit Xxx2
:bdel test8.in[10C" delete this file from the buffer list
:e Xxx1[17C" edit Xxx1
:w[22C" write it, will unload it and give an error msg
:w! test.out[12C" Write contents of this file
:e! Xxx2[16C" start editing Xxx2
:bwipe test.out[9C" remove test.out from the buffer list
:w[22C" write it, will delete the buffer and give an error msg[19;1H:w >>test.out[11C" Append contents of this file
:au! BufWritePre
:func CloseAll()
  let i = 0
  while i <= bufnr('$')
    if i != bufnr('%') && bufloaded(i)[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for BufWritePre autocommand that deletes or unloads the buffer.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[4;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 37 lines, 1054 characters written[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[18M[1;25r[7;7Hexe  i . "bunload"
    endif
    let i += 1
  endwhile
endfunc
:func WriteToOut()
  edit! test.out
  $put ='VimLeave done'
  write
endfunc
:set viminfo='100,nviminfo
:au BufUnload * call CloseAll()
:au VimLeave * call WriteToOut()
:e small.vim
:sp mbyte.vim
:q
:qa!
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau BufWritePre Xxx1 bunload[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau BufWritePre Xxx2 bwipe[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^start of[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hstart of Xxx[25;1H[K[24;1H[?25h[?0c[?25l[?1c[12C1[?25h[?0c[?25l[?1c
:[?25h[?0c.,/end of/w! Xxx1  " write test file Xxx1[?25l[?1c"Xxx1" [25;9H[K[25;8H[New File] 3 lines, 31 characters written[24;13H[?25h[?0c[?25l[?1c2[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.,/end of/w! Xxx2   " write test file Xxx2[?25l[?1c"Xxx2" [25;9H[K[25;8H[New File] 3 lines, 31 characters written[24;13H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! Xxx2                " edit Xxx2[?25l[?1c"Xxx2" [25;8H[K[25;8H3 lines, 31 characters[1;1Hstart of Xxx2[1;14H[K[2;3H      test
end of Xxx[3;11H[K[4;1H[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cbdel test8.in[1m[34m^I^I[0m" delete this file from the buffer list[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xxx1                 " edit Xxx1[?25l[?1c"Xxx1" [25;25H[K[25;8H3 lines, 31 characters[1;13H1[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw                      " write it, will unload it and give an error msg[?25l[?1c"Xxx2"[25;25H[K[25;8H3 lines, 31 characters
[1m[37m[41mE203: Autocommands deleted or unloaded buffer to be written[0m
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! test.out            " Write contents of this file[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 3 lines, 31 characters written
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ce! Xxx2                " start editing Xxx2[?25l[?1c"Xxx2" [25;8H[K[25;8H3 lines, 31 characters[1;1H[3L[1;1Hstart of Xxx2[2;9Htest
end of Xxx[25;1H[K[25;1H"Xxx2" 3 lines, 31 characters[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe test.out         " remove test.out from the buffer list[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw                      " write it, will delete the buffer and give an error ms
[24;80Hg[25;1H[?25l[?1c[24;1H"Xxx1"[24;25H[K[24;8H3 lines, 31 characters
[1m[37m[41mE203: Autocommands deleted or unloaded buffer to be written[0m
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw >>test.out           " Append contents of this file[?25l[?1c"test.out" [25;12H[K[25;12H3 lines, 31 characters appended
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cau! BufWritePre[?25l[?1c[1;1H[3L[1;1Hstart of Xxx1[2;9Htest
end of Xxx[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cfunc CloseAll()[?25l[?1c
:  [?25h[?0c  let i = 0
[?25l[?1c:  [?25h[?0c  while i <= bufnr('$')
[?25l[?1c:    [?25h[?0c    if i != bufnr('%') && bufloaded(i)
[?25l[?1c:      [?25h[?0c      exe  i . "bunload"
[?25l[?1c:      [?25h[?0c    endif
[?25l[?1c:    [?25h[?0c    let i += 1
[?25l[?1c:    [?25h[?0c  endwhile
[?25l[?1c:  [?25h[?0cendfunc[1;1H[8L[?25l[?1c[1;1Hstart of Xxx1[2;9Htest
end of Xxx
[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cfunc WriteToOut()[?25l[?1c
:  [?25h[?0c  edit! test.out
[?25l[?1c:  [?25h[?0c  $put ='VimLeave done'
[?25l[?1c:  [?25h[?0c  write
[?25l[?1c:  [?25h[?0cendfunc[1;1H[4L[?25l[?1c[1;1Hstart of Xxx1[2;9Htest
end of Xxx
[1m[34m~                                                                               [0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset viminfo='100,nviminfo[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau BufUnload * call CloseAll()[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau VimLeave * call WriteToOut()[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce small.vim[?25l[?1c[1m[37m[41mError detected while processing function CloseAll:[0m
[1m[33mline    4:[0m
[1m[37m[41mE515: No buffers were unloaded: 0bunload[0m
"small.vim" 1 line, 1 character
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0csp mbyte.vim[?25l[?1c"mbyte.vim" [25;13H[K[25;13H0 lines, 0 characters[1;1H[4L[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [0m[12;1H[1m[7mmbyte.vim                                                                       [0m[13;1H[K[24;1H[7msmall.vim                                                                       [0m[25;1H[K[25;1H"mbyte.vim" 0 lines, 0 characters[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cq[?25l[?1c[1m[37m[41mError detected while processing function CloseAll:[0m
[1m[33mline    4:[0m
[1m[37m[41mE515: No buffers were unloaded: 0bunload[0m
"test.out" 6 lines, 62 characters
"test.out" 7 lines, 76 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test9.failed test.ok test.out X* viminfo
cp test9.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test9.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test9.in" 12 lines, 255 characters[1;1HTest for Bufleave autocommand that deletes the buffer we are about to edit.

STARTTEST
:so small.vim
:au BufLeave test9.in bwipe yy
:e yy
:/^start of/,$w! test.out      " Write contents of this file
:qa!
ENDTEST

start of test file xx
end of test file xx
[1m[34m~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for Bufleave autocommand that deletes the buffer we are about to edit.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 5 lines, 117 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[9;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[10;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[10;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau BufLeave test9.in bwipe yy[?25l[?1c[10;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce yy[?25l[?1c[1m[37m[41mE143: Autocommands unexpectedly deleted new buffer yy[10;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c/^start of/,$w! test.out      " Write contents of this file[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 2 lines, 42 characters written[10;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test10.failed test.ok test.out X* viminfo
cp test10.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test10.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test10.in" 114 lines, 3080 characters[1;1HTest for 'errorformat'.  This will fail if the quickfix feature was disabled.

STARTTEST
:so small.vim
:" Also test a BOM is ignored.
:so mbyte.vim
:set encoding=utf-8
:7/start of errorfile/,/end of errorfile/w! Xerrorfile1
:7/start of errorfile/,/end of errorfile/-1w! Xerrorfile2
:/start of testfile/,/end of testfile/w! Xtestfile
:set efm+==%f=\\,\ line\ %l%*\\D%v%*[^\ ]\ %m
:set efm^=%AError\ in\ \"%f\"\ at\ line\ %l:,%Z%p^,%C%m
:cf Xerrorfile2
:clast
:copen
:let a=w:quickfix_title
:wincmd p
lgR[1m[34m^R[0m=a[1m[34m^M^[[0m
:cf Xerrorfile1
grA
:cn
gRLINE 6, COL 19[1m[34m^[[0m
:cn
gRNO COLUMN SPECIFIED[1m[34m^[[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for 'errorformat'.  This will fail if the quickfix feature was disabled.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 50 lines, 801 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:cn
gR. TAB-SPACE POINTER[1m[34m^[[0m
:clast
:cprev
:cprev
:wincmd w
:let a=w:quickfix_title
:wincmd p
lgR[1m[34m^R[0m=a[1m[34m^M^[[0m
:w! test.out[13C" Write contents of this file
:qa!
ENDTEST

start of errorfile
"Xtestfile", line 4.12: 1506-045 (S) Undeclared identifier fd_set.
﻿"Xtestfile", line 6 col 19; this is an error
gcc -c -DHAVE_CONFIsing-prototypes -I/usr/X11R6/include  version.c
Xtestfile:9: parse error before `asd'
make: *** [vim] Error 1
in file "Xtestfile" linenr 10: there is an error

2 returned
"Xtestfile", line 11 col 1; this is an error
"Xtestfile", line 12 col 2; this is another error[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Also test a BOM is ignored.[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso mbyte.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset encoding=utf-8[?25l[?1c[27m[24m[0m[H[J[1;1H:cn
gR. TAB-SPACE POINTER[1m[34m^[[0m
:clast
:cprev
:cprev
:wincmd w
:let a=w:quickfix_title
:wincmd p
lgR[1m[34m^R[0m=a[1m[34m^M^[[0m
:w! test.out[13C" Write contents of this file
:qa!
ENDTEST

start of errorfile
"Xtestfile", line 4.12: 1506-045 (S) Undeclared identifier fd_set.
[1m[34m<feff>[0m"Xtestfile", line 6 col 19; this is an error
gcc -c -DHAVE_CONFIsing-prototypes -I/usr/X11R6/include  version.c
Xtestfile:9: parse error before `asd'
make: *** [vim] Error 1
in file "Xtestfile" linenr 10: there is an error

2 returned
"Xtestfile", line 11 col 1; this is an error
"Xtestfile", line 12 col 2; this is another error[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c7/start of errorfile/,/end of errorfile/w! Xerrorfile1[?25l[?1c"Xerrorfile1" [25;15H[K[25;15H[New File] 83 lines, 1974 characters written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c7/start of errorfile/,/end of errorfile/-1w! Xerrorfile2[?25l[?1c"Xerrorfile2" [25;15H[K[25;15H[New File] 82 lines, 1957 characters written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/start of testfile/,/end of testfile/w! Xtestfile[?25l[?1c"Xtestfile" [25;13H[K[25;13H[New File] 23 lines, 937 characters written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset efm+==%f=\\,\ line\ %l%*\\D%v%*[^\ ]\ %m[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset efm^=%AError\ in\ \"%f\"\ at\ line\ %l:,%Z%p^,%C%m[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccf Xerrorfile2[?25l[?1c"Xtestfile" [25;13H[K[25;13H23 lines, 937 characters
(50 of 70): 1506-045 (S) Undeclared identifier fd_set.
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cclast[?25l[?1c(70 of 70): What is the title of the quickfix window?
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccopen[?25l[?1c[1;1H[3L[1;9Hxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 12[2;9Hxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 13[3;9Hxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 14
        xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 15
        xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 16
        xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 17
        xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 18
        xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 19
        xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 20
        xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 21[10;51H[K[11;1H        xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 22
end of testfile
[7mXtestfile                                                                       [0m[14;1HXtestfile|18 col 14|  x should be a dot xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 1[15;1H8[15;2H[K[16;1HXtestfile|19 col 15|  x should be a dot xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 1[17;1H9[17;2H[K[18;10H|20 col 16|  x should be a dot xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 2[19;1H0[19;2H[K[20;1H||[20;4H[K[21;1H|| Does anyone know what is the problem and how to correction it?
Xtestfile|21 col 9| What is the title of the quickfix window?
[30m[43mXtestfile|22 col 9| What is the title of the quickfix window?                   [0m[24;1H[1m[7m[Quickfix List]                                                                 [0m[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0clet a=w:quickfix_title[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwincmd p[?25l[?1c[13;1H[1m[7mXtestfile                                                                       [0m[24;1H[7m[Quickfix List]                                                                 [11;16H[?25h[?0c[0mx[?25l[?1c[25;1H[K[25;1H=[?25h[?0ca[?25l[?1c[11;17H:cf Xerrorfile2[13;11H[1m[7m[+][11;31H[?25h[?0c[12;15H[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccf Xerrorfile1[?25l[?1c[1;1Hstart of testfile[1;18H[K[2;48H 2[3;48H 3[4;48H 4[5;48H 5[6;48H 6[7;48H 7[8;48H 8[9;48H 9[10;48H10[11;17Hxxxxxxxxxxxxxxx[16C11
        xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 12

|| :qa![14;8H[K[15;1H|| ENDTEST
|| [16;4H[K[17;1H|| start of errorfile
[30m[43mXtestfile|4 col 12| 1506-045 (S) Undeclared identifier fd_set.                  [0m[19;1HXtestfile|6 col 19| this is an error
|| gcc -c -DHAVE_CONFIsing-prototypes -I/usr/X11R6/include  version.c
Xtestfile|9| parse error before `asd'[21;38H[K[22;1H|| make: *** [vim] Error 1[22;27H[K[23;1HXtestfile|10| there is an error[23;32H[K[4;19H[?25h[?0c[?25l[?1cA[?25h[?0c[5;19H[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccn[?25l[?1c[18;1HXtestfile|4 col 12| 1506-045 (S) Undeclared identifier fd_set.[18;63H[K[19;1H[30m[43mXtestfile|6 col 19| this is an error                                            [6;26H[?25h[?0c[?25l[?1c[0mLINE 6, COL 19[?25h[?0c[7;39H[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccn[?25l[?1c[19;1HXtestfile|6 col 19| this is an error[19;37H[K[21;1H[30m[43mXtestfile|9| parse error before `asd'                                           [9;9H[?25h[?0c[?25l[?1c[0mNO COLUMN SPECIFIED[?25h[?0c[10;27H[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccn[?25l[?1c[21;1HXtestfile|9| parse error before `asd'[21;38H[K[23;1H[30m[43mXtestfile|10| there is an error                                                 [10;9H[?25h[?0c[?25l[?1c[0mAGAIN NO COLUMN[?25h[?0c[11;23H[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccn[?25l[?1c[14;23r[14;1H[3M[1;25r[20;1HXtestfile|10| there is an error[20;32H[K[21;1H||
|| 2 returned
[30m[43mXtestfile|11 col 1| this is an error                                            [0m[25;1H[K[11;8H[?25h[?0c[?25l[?1cCOL 1[?25h[?0c[12;8H[?25l[?1c[25;1H:[?25h[?0ccn[?25l[?1c[14;23r[23;1H
[1;25r[22;1HXtestfile|11 col 1| this is an error[22;37H[K[23;1H[30m[43mXtestfile|12 col 2| this is another error                                       [0m[25;1H[K[12;9H[?25h[?0c[?25l[?1cCOL 2[?25h[?0c[?25l[?1c[1;12r[12;1H
[1;25r[12;9Hxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 13[12;13H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccn[?25l[?1c[1;12r[12;1H
[1;25r[12;9Hxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 14[14;23r[23;1H
[1;25r[22;1HXtestfile|12 col 2| this is another error[22;42H[K[23;1H[30m[43mXtestfile|14 col 10| this is an error in column 10                              [0m[25;1H[K[12;17H[?25h[?0c[?25l[?1cCOL 10[?25h[?0c[?25l[?1c[1;12r[12;1H
[1;25r[12;9Hxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 15[12;22H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccn[?25l[?1c[14;23r[23;1H
[1;25r[22;1HXtestfile|14 col 10| this is an error in column 10[22;51H[K[23;1H[30m[43mXtestfile|15 col 10| this is another error, but in vcol 10 this time            [0m[25;1H[K[12;10H[?25h[?0c[?25l[?1cVCOL 10[?25h[?0c[?25l[?1c[1;12r[12;1H
[1;25r[12;9Hxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 16[12;16H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccn[?25l[?1c[14;23r[23;1H
[1;25r[22;1HXtestfile|15 col 10| this is another error, but in vcol 10 this time[22;69H[K[23;1H[30m[43mXtestfile|16| yet another problem                                               [0m[25;1H[K[12;9H[?25h[?0c[?25l[?1cI[?25h[?0c[?25l[?1c[1;12r[12;1H
[1;25r[12;9Hxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 17[12;9H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccn[?25l[?1c[14;23r[14;1H[2M[1;25r[21;1HXtestfile|16| yet another problem[21;34H[K[22;1H[30m[43mXtestfile|17 col 13|  x should be a dot xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 1[23;1H7                                                                               [0m[25;1H[K[12;13H[?25h[?0c[?25l[?1c. SPACE POINTER[?25h[?0c[?25l[?1c[1;12r[12;1H
[1;25r[12;9Hxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 18[12;27H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccn[?25l[?1c[14;23r[14;1H[2M[1;25r[20;1HXtestfile|17 col 13|  x should be a dot xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 1[21;1H7[21;2H[K[22;1H[30m[43mXtestfile|18 col 14|  x should be a dot xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 1[23;1H8                                                                               [0m[25;1H[K[12;14H[?25h[?0c[?25l[?1c. DOT POINTER[?25h[?0c[?25l[?1c[1;12r[12;1H
[1;25r[12;9Hxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 19[12;26H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccn[?25l[?1c[14;23r[14;1H[2M[1;25r[20;1HXtestfile|18 col 14|  x should be a dot xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 1[21;1H8[21;2H[K[22;1H[30m[43mXtestfile|19 col 15|  x should be a dot xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 1[23;1H9                                                                               [0m[25;1H[K[12;15H[?25h[?0c[?25l[?1c. DASH POINTER[?25h[?0c[?25l[?1c[1;12r[12;1H
[1;25r[12;9Hxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 20[12;28H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccn[?25l[?1c[14;23r[14;1H[2M[1;25r[20;1HXtestfile|19 col 15|  x should be a dot xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 1[21;1H9[21;2H[K[22;1H[30m[43mXtestfile|20 col 16|  x should be a dot xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 2[23;1H0                                                                               [0m[25;1H[K[12;16H[?25h[?0c[?25l[?1c. TAB-SPACE POINTER[?25h[?0c[?25l[?1c[1;12r[12;1H
[1;25r[12;9Hxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 21[12;34H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cclast[?25l[?1c[14;23r[14;1H[6M[1;25r[16;1HXtestfile|20 col 16|  x should be a dot xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    line 2[17;1H0[17;2H[K[18;1H||
|| Does anyone know what is the problem and how to correction it?
Xtestfile|21 col 9| What is the title of the quickfix window?
Xtestfile|22 col 9| What is the title of the quickfix window?
[30m[43m|| end of errorfile                                                             [0m[23;1H[1m[34m~                                                                               [0m[25;1H[K[12;9H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccprev[?25l[?1c[1;12r[12;1H
[1;25r[12;9Hxxxxxxxx:cf Xerrorfile2xxxxxxx    line 22[21;1H[30m[43mXtestfile|22 col 9| What is the title of the quickfix window?                   [0m[22;1H|| end of errorfile[22;20H[K[25;1H[K[12;16H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccprev[?25l[?1c[20;1H[30m[43mXtestfile|21 col 9| What is the title of the quickfix window?                   [0m[21;1HXtestfile|22 col 9| What is the title of the quickfix window?[21;62H[K[11;16H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwincmd w[?25l[?1c[13;1H[7mXtestfile [+]                                                                   [0m[24;1H[1m[7m[Quickfix List]                                                                 [20;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet a=w:quickfix_title[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwincmd p[?25l[?1c[13;1H[1m[7mXtestfile [+]                                                                   [0m[24;1H[7m[Quickfix List]                                                                 [11;16H[?25h[?0c[0mx[?25l[?1c[25;1H[K[25;1H=[?25h[?0ca[?25l[?1c[11;17H:cf Xerrorfile1[?25h[?0c[12;31H[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! test.out             " Write contents of this file[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 23 lines, 942 characters written[13;11H[1m[7m   [12;31H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test11.failed test.ok test.out X* viminfo
cp test11.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test11.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test11.in" 84 lines, 3345 characters[1;1HTests for autocommands:
- FileWritePre[10Cwriting a compressed file
- FileReadPost[10Creading a compressed file
- BufNewFile[12Creading a file template
- BufReadPre[12Cdecompressing the file to be read
- FilterReadPre[9Csubstituting characters in the temp file
- FilterReadPost[8Csubstituting characters after filtering
- FileReadPre[11Cset options for decompression
- FileReadPost[10Cdecompress the file

Note: This test is skipped if "gzip" is not available.
$GZIP is made empty, "-v" would cause trouble.
Use a FileChangedShell autocommand to avoid a prompt for "Xtestfile.gz" being
modified outside of Vim (noticed on Solaris).

STARTTEST
:so small.vim
:" drop out when there is no gzip program
:if !executable("gzip")
: e! test.ok
: w! test.out
: qa!
:endif
:let $GZIP = ""[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for autocommands:[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[16;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 48 lines, 2277 characters written[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[17;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:23,$s/\r$//[17C" remove CR for when sed adds them
:au! FileReadPre    *.gz   exe '!gzip -d ' . shellescape(expand("<afile>"))
:au  FileReadPre    *.gz   call rename(expand("<afile>:r"), expand("<afile>"))
:au! FileReadPost   *.gz   '[,']s/l/L/
:$r Xtestfile.gz[13C" Read compressed file
:w[27C" write it, after filtering
:au![13C" remove all autocommands
:e[15C" Edit test.out again
:set nobin ff&   " use the default fileformat for writing
:w
:qa!
ENDTEST

startstart
start of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
line 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 6  Abcdefghijklmnopqrstuvwxyz
line 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 8  Abcdefghijklmnopqrstuvwxyz
line 9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 Abcdefghijklmnopqrstuvwxyz[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" drop out when there is no gzip program[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif !executable("gzip")[?25l[?1c
:  [?25h[?0c: e! test.ok
[?25l[?1c:  [?25h[?0c: w! test.out
[?25l[?1c:  [?25h[?0c: qa!
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[1;1H:23,$s/\r$//[17C" remove CR for when sed adds them
:au! FileReadPre    *.gz   exe '!gzip -d ' . shellescape(expand("<afile>"))
:au  FileReadPre    *.gz   call rename(expand("<afile>:r"), expand("<afile>"))
:au! FileReadPost   *.gz   '[,']s/l/L/[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0clet $GZIP = ""[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau FileChangedShell * echo "caught FileChangedShell"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset bin[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau FileWritePre    *.gz   '[,']!gzip[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau FileWritePost   *.gz   undo[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^start of testfile/,/^end of testfile/w! Xtestfile.gz[?25l[?1c[?25h[?0c[?25l[?1c11 lines filtered[25;18H[K[25;1H
"Xtestfile.gz" [New File][Incomplete last line] 1 line, 111 characters written
10 more lines; before #1  0 seconds ago
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cau FileReadPost    *.gz   '[,']!gzip -d[?25l[?1c[1;1H[3L[1;1H:au! FileReadPre    *.gz   exe '!gzip -d ' . shellescape(expand("<afile>"))
:au  FileReadPre    *.gz   call rename(expand("<afile>:r"), expand("<afile>"))
:au! FileReadPost   *.gz   '[,']s/l/L/
:$r Xtestfile.gz             " Read compressed file
:w              [15Cwrite it, after filtering
:au![13C" remove all autocommands[6;43H[K[7;2He  [15CEdit test.out again[7;39H[K[8;2Hset nobin ff&   " use the default fileformat for writing
:w[9;3H[K[10;2Hqa!
ENDTEST[12;1H[K[13;1Hstartstart[14;6H of testfile
line 2  Abcdefghijklmnopqrstuvwxyz[16;6H3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[17;6H4  Abcdefghijklmnopqrstuvwxyz[17;35H[K[18;6H5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[19;6H6  Abcdefghijklmnopqrstuvwxyz[19;35H[K[20;6H7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[21;6H8  Abcdefghijklmnopqrstuvwxyz[21;35H[K[22;6H9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[23;6H10 Abcdefghijklmnopqrstuvwxyz[23;35H[K[24;1Hend of testfile[24;16H[K[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$r Xtestfile.gz                " Read and decompress the testfile[?25l[?1c"Xtestfile.gz" [25;16H[K[25;16H[Incomplete last line] 1 line, 111 characters[?25h[?0c[60C[?25l[?1c[1;24r[1;1H[7M[1;25r[19;1Hstart of test.c
/*
 * Here is a new .c file
 */
end of test.c
start of testfile[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c?startstart?,$w! test.out      " Write contents of this file[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 29 lines, 788 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau BufNewFile      *.c    read Xtest.c[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^start of test.c/+1,/^end of test.c/-1w! Xtest.c[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m[25;37H[K[25;1H"Xtest.c" [25;11H[K[25;11H[New File] 3 lines, 32 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! foo.c                       " Will load Xtest.c[?25l[?1c"foo.c" [New File][25;33H[K[25;1H
"Xtest.c" 3 lines, 32 characters
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cau FileAppendPre   *.out  '[,']s/new/NEW/[?25l[?1c[1;1H[2L[2;1H/*
 * Here is a new .c file
 */[4;4H[K[5;1H[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [0m[25;1H[K[2;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cau FileAppendPost  *.out  !cat Xtest.c >>test.out[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw>>test.out                    " Append it to the output file[?25l[?1c"test.out" [25;12H[K[25;12H4 lines, 33 characters appended
:!cat Xtest.c >>test.out
[?25h[?0c[24m[0m
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cau! FileAppendPre[?25l[?1c[27m[24m[0m[H[J[2;1H/*
 * Here is a NEW .c file
 */
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [3;2H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0c" setup autocommands to decompress before reading and re-compress afterwards[?25l[?1c[3;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau BufReadPre      *.gz   exe '!gzip -d ' . shellescape(expand("<afile>"))[?25l[?1c[3;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau BufReadPre      *.gz   call rename(expand("<afile>:r"), expand("<afile>"))[?25l[?1c[3;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau BufReadPost     *.gz   call rename(expand("<afile>"), expand("<afile>:r"))[?25l[?1c[3;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau BufReadPost     *.gz   exe '!gzip ' . shellescape(expand("<afile>:r"))[?25l[?1c[3;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! Xtestfile.gz                " Edit compressed file[?25l[?1c:!gzip -d 'Xtestfile.gz'[25;33H[K[25;25H
[?25h[?0c[?25l[?1c[24m[0m"Xtestfile.gz"[24;1H"Xtestfile.gz" 11 lines, 357 characters[25;1H[K[25;1H:!gzip 'Xtestfile'
[?25h[?0c[?25l[?1c[24m[0m[24;1Hcaught FileChangedShell
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw>>test.out                    " Append it to the output file[?25l[?1c"test.out" [25;12H[K[25;12H11 lines, 357 characters appended
:!cat Xtest.c >>test.out
[?25h[?0c[24m[0m
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset shelltemp                  " need temp files here[?25l[?1c[27m[24m[0m[H[J[1;1Hstart of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
line 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 6  Abcdefghijklmnopqrstuvwxyz
line 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 8  Abcdefghijklmnopqrstuvwxyz
line 9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 Abcdefghijklmnopqrstuvwxyz
end of testfile
[1m[34m~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0cau FilterReadPre   *.out  call rename(expand("<afile>"), expand("<afile>") . "
[24;80H.[25;1Ht")[?25l[?1c[1;1H[L[1;1Hstart of testfile[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cau FilterReadPre   *.out  exe '!sed s/e/E/ ' . shellescape(expand("<afile>")) 
[24;80H.[25;1H ".t >" . shellescape(expand("<afile>"))[?25l[?1c[1;1H[L[1;1Hstart of testfile[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cau FilterReadPre   *.out  exe '!rm ' . shellescape(expand("<afile>")) . '.t'[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau FilterReadPost  *.out  '[,']s/x/X/g[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! test.out                    " Edit the output file[?25l[?1c"test.out" [25;12H[K[25;12H50 lines, 1242 characters[1;6Hstar[1;11H[K[2;1Hstart of testfile[2;18H[K[3;6H2  Abcdefghijklmnopqrstuvwxyz[3;35H[K[4;6H3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[5;6H4  Abcdefghijklmnopqrstuvwxyz[5;35H[K[6;6H5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[7;6H6  Abcdefghijklmnopqrstuvwxyz[7;35H[K[8;6H7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[9;6H8  Abcdefghijklmnopqrstuvwxyz[9;35H[K[10;6H9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 Abcdefghijklmnopqrstuvwxyz
end of testfile[12;16H[K[13;1H[K[14;1Hstart of test.c[14;16H[K[15;1H/*[15;3H[K[16;1H * Here is a new .c file[16;25H[K[17;1H */[17;4H[K[18;1Hend of test.c[18;14H[K[19;1Hstart of testfile[19;18H[K[20;1Hline 2  Abcdefghijklmnopqrstuvwxyz[20;35H[K[21;1Hline 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[21;39H[K[22;1Hline 4  Abcdefghijklmnopqrstuvwxyz[22;35H[K[23;1Hline 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[23;39H[K[24;1Hline 6  Abcdefghijklmnopqrstuvwxyz[24;35H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c23,$!cat[?25l[?1c[?25h[?0c[?25l[?1c:!sed s/e/E/ '/tmp/vtAjwzl/1'.t >'/tmp/vtAjwzl/1'
[?25h[?0c[?25l[?1c[24m[0m:!rm '/tmp/vtAjwzl/1'.t
[?25h[?0c[?25l[?1c[24m[0m218 substitutions on 15 lines
28 lines filtered
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c23,$s/\r$//                 " remove CR for when sed adds them[?25l[?1c[1m[37m[41mE486: Pattern not found: \r$[0m[25;30H[K[25;1H
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cau! FileReadPre    *.gz   exe '!gzip -d ' . shellescape(expand("<afile>"))[?25l[?1c[27m[24m[0m[H[J[1;1Hstartstart
start of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
line 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 6  Abcdefghijklmnopqrstuvwxyz
line 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 8  Abcdefghijklmnopqrstuvwxyz
line 9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 Abcdefghijklmnopqrstuvwxyz
end of testfile

start of test.c
/*
 * Here is a new .c file
 */
end of test.c
start of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
linE 5  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
linE 6  AbcdefghijklmnopqrstuvwXyz[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0cau  FileReadPre    *.gz   call rename(expand("<afile>:r"), expand("<afile>"))[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau! FileReadPost   *.gz   '[,']s/l/L/[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$r Xtestfile.gz             " Read compressed file[?25l[?1c:!gzip -d 'Xtestfile.gz'[25;30H[K[25;25H
[?25h[?0c[?25l[?1c[24m[0m"Xtestfile.gz"[24;1H"Xtestfile.gz" 11 lines, 357 characters[25;1H[K[25;1H11 substitutions on 11 lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw                           " write it, after filtering[?25l[?1c"test.out"[25;30H[K[25;12H61 lines, 1599 characters written
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cau!             " remove all autocommands[?25l[?1c[1m[37m[41mE216: No such group or event: " remove all autocommands[0m
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ce               " Edit test.out again[?25l[?1c"test.out"[25;18H[K[25;12H61 lines, 1599 characters[27m[24m[0m[H[J[1;1Hstartstart
start of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
line 5  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 6  Abcdefghijklmnopqrstuvwxyz
line 7  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 8  Abcdefghijklmnopqrstuvwxyz
line 9  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 10 Abcdefghijklmnopqrstuvwxyz
end of testfile

start of test.c
/*
 * Here is a new .c file
 */
end of test.c
start of testfile
line 2  Abcdefghijklmnopqrstuvwxyz
line 3  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
line 4  Abcdefghijklmnopqrstuvwxyz
linE 5  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
linE 6  AbcdefghijklmnopqrstuvwXyz
"test.out" 61 lines, 1599 characters[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nobin ff&   " use the default fileformat for writing[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"test.out" 61 lines, 1599 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test12.failed test.ok test.out X* viminfo
cp test12.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test12.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test12.in" 52 lines, 1199 characters[1;1HTests for 'directory' option.
- ".", in same dir as file
- "./dir", in directory relative to file
- "dir", in directory relative to current dir

STARTTEST
:so small.vim
:set nocompatible viminfo+=nviminfo
:set dir=.,~
:/start of testfile/,/end of testfile/w! Xtest1
:" do an ls of the current dir to find the swap file (should not be there)
:if has("unix")
:  !ls .X*.swp >test.out
:else
:  r !ls X*.swp >test.out
:endif
:!echo first line >>test.out
:e Xtest1
:if has("unix")
:" Do an ls of the current dir to find the swap file, remove the leading dot
:" to make the result the same for all systems.
:  r!ls .X*.swp
:  s/\.*X/X/
:  .w >>test.out[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for 'directory' option.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[6;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 40 lines, 965 characters written[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[7;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:!echo under Xtest1.swp >>test.out
:!mkdir Xtest2
:set dir=./Xtest2,.,~
:e Xtest1
:!ls X*.swp >>test.out
:!echo under under >>test.out
:!ls Xtest2 >>test.out
:!echo under Xtest1.swp >>test.out
:!mkdir Xtest.je
:/start of testfile/,/end of testfile/w! Xtest2/Xtest3
:set dir=Xtest.je,~
:e Xtest2/Xtest3
:swap
:!ls Xtest2 >>test.out
:!echo under Xtest3 >>test.out
:!ls Xtest.je >>test.out
:!echo under Xtest3.swp >>test.out
:qa!
ENDTEST

start of testfile
line 2 Abcdefghij
line 3 Abcdefghij
end of testfile[19;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nocompatible viminfo+=nviminfo[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset dir=.,~[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/start of testfile/,/end of testfile/w! Xtest1[?25l[?1c"Xtest1" [25;10H[K[25;10H[New] 4L, 70C written[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" do an ls of the current dir to find the swap file (should not be there)[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif has("unix")[?25l[?1c
:  [?25h[?0c:  !ls .X*.swp >test.out
[?25l[?1c:!ls .X*.swp >test.out[?25h[?0c[25;1H
ls: cannot access .X*.swp: No such file or directory

shell returned 2
[?25l[?1c[25;1H:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c:  r !ls X*.swp >test.out
[?25l[?1c:  [?25h[?0c:endif[27m[24m[0m[H[J[?25l[?1c[1;1H:!echo under Xtest1.swp >>test.out
:!mkdir Xtest2
:set dir=./Xtest2,.,~
:e Xtest1
:!ls X*.swp >>test.out
:!echo under under >>test.out
:!ls Xtest2 >>test.out
:!echo under Xtest1.swp >>test.out
:!mkdir Xtest.je
:/start of testfile/,/end of testfile/w! Xtest2/Xtest3
:set dir=Xtest.je,~
:e Xtest2/Xtest3
:swap
:!ls Xtest2 >>test.out
:!echo under Xtest3 >>test.out
:!ls Xtest.je >>test.out
:!echo under Xtest3.swp >>test.out
:qa!
ENDTEST

start of testfile
line 2 Abcdefghij
line 3 Abcdefghij
end of testfile[20;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c!echo first line >>test.out[?25l[?1c[28C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ce Xtest1[?25l[?1c"Xtest1" 4L, 70C[27m[24m[0m[H[J[1;1Hstart of testfile
line 2 Abcdefghij
line 3 Abcdefghij
end of testfile
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [0m[25;1H"Xtest1" 4L, 70C[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif has("unix")[?25l[?1c
:  [?25h[?0c:" Do an ls of the current dir to find the swap file, remove the leading dot
[?25l[?1c:  [?25h[?0c:" to make the result the same for all systems.
[?25l[?1c:  [?25h[?0c:  r!ls .X*.swp[24m[0m
[?25l[?1c:  [?25h[?0c:  s/\.*X/X/
[?25l[?1c:  [?25h[?0c:  .w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1L, 11C appended
:  [?25h[?0c:  undo
[?25l[?1c1 line less; before #1  0 seconds ago
:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c:  !ls X*.swp >>test.out
[?25l[?1c:  [?25h[?0c:endif[27m[24m[0m[H[J[?25l[?1c[1;1Hstart of testfile
line 2 Abcdefghij
line 3 Abcdefghij
end of testfile
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0c!echo under Xtest1.swp >>test.out[?25l[?1c[34C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c!mkdir Xtest2[?25l[?1c[14C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset dir=./Xtest2,.,~[?25l[?1c[27m[24m[0m[H[J[1;1Hstart of testfile
line 2 Abcdefghij
line 3 Abcdefghij
end of testfile
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0ce Xtest1[?25l[?1c"Xtest1" 4L, 70C[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c!ls X*.swp >>test.out[?25l[?1c[22C[?25h[?0c[25;1H
ls: cannot access X*.swp: No such file or directory

shell returned 2
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c!echo under under >>test.out[?25l[?1c[29C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c!ls Xtest2 >>test.out[?25l[?1c[22C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c!echo under Xtest1.swp >>test.out[?25l[?1c[34C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c!mkdir Xtest.je[?25l[?1c[16C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c/start of testfile/,/end of testfile/w! Xtest2/Xtest3[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m[25;37H[K[25;1H"Xtest2/Xtest3" [25;17H[K[25;17H[New] 4L, 70C written
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset dir=Xtest.je,~[?25l[?1c[27m[24m[0m[H[J[1;1Hstart of testfile
line 2 Abcdefghij
line 3 Abcdefghij
end of testfile
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0ce Xtest2/Xtest3[?25l[?1c"Xtest2/Xtest3" 4L, 70C[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cswap[?25l[?1cXtest.je/Xtest3.swp[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c!ls Xtest2 >>test.out[?25l[?1c[22C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c!echo under Xtest3 >>test.out[?25l[?1c[30C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c!ls Xtest.je >>test.out[?25l[?1c[24C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c!echo under Xtest3.swp >>test.out[?25l[?1c[34C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test13.failed test.ok test.out X* viminfo
cp test13.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test13.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test13.in" 58 lines, 1133 characters[1;1HTests for autocommands on :close command

Write three files and open them, each in a window.
Then go to next window, with autocommand that deletes the previous one.
Do this twice, writing the file.

Also test deleting the buffer on a Unload event.  If this goes wrong there
will be the ATTENTION prompt.

Also test changing buffers in a BufDel autocommand.  If this goes wrong there
are ml_line errors and/or a Crash.

STARTTEST
:so small.vim
:/^start of testfile/,/^end of testfile/w! Xtestje1
:/^start of testfile/,/^end of testfile/w! Xtestje2
:/^start of testfile/,/^end of testfile/w! Xtestje3
:e Xtestje1
otestje1[1m[34m^[[0m
:w
:sp Xtestje2
otestje2[1m[34m^[[0m
:w
:sp Xtestje3[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for autocommands on :close command[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[13;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 38 lines, 631 characters written[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[14;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:bwipe Xtestje2 Xtestje3 test.out
:au!
:au! BufUnload Xtestje1 bwipe
:e Xtestje3
:w >>test.out
:e Xtestje2
:sp Xtestje1
:e
:w >>test.out
:au!
:only
:e Xtestje1
:bwipe Xtestje2 Xtestje3 test.out test13.in
:au BufWipeout Xtestje1 buf Xtestje1
:bwipe
:w >>test.out
:qa!
ENDTEST

start of testfile[21;9Hcontents[22;9Hcontents[23;9Hcontents
end of testfile[18;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[19;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[19;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^start of testfile/,/^end of testfile/w! Xtestje1[?25l[?1c"Xtestje1" [25;13H[K[25;12H[New File] 5 lines, 64 characters written[19;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^start of testfile/,/^end of testfile/w! Xtestje2[?25l[?1c"Xtestje2" [25;13H[K[25;12H[New File] 5 lines, 64 characters written[19;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^start of testfile/,/^end of testfile/w! Xtestje3[?25l[?1c"Xtestje3" [25;13H[K[25;12H[New File] 5 lines, 64 characters written[19;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xtestje1[?25l[?1c"Xtestje1" 5 lines, 64 characters[1;1Hstart of testfile[1;18H[K[2;1H        contents
        contents[3;17H[K[4;1H        contents
end of testfile
[1m[34m~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[2;24r[0m[2;1H[L[1;25r[2;1Htestje1[25;1H[K[2;7H[?25h[?0c[3;8H[?25l[?1c[25;1H:[?25h[?0cw[?25l[?1c"Xtestje1" 6 lines, 72 characters written[3;8H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csp Xtestje2[?25l[?1c"Xtestje2" [25;12H[K[25;12H5 lines, 64 characters[2;1H        contents


end of testfile[5;16H[K[6;1H[1m[34m~                                                                               [0m[12;1H[1m[7mXtestje2                                                                        [0m[13;1Htestje1[13;8H[K[14;1H        contents[14;17H[K[15;1H        contents[15;17H[K[16;1H        contents[16;17H[K[17;1Hend of testfile[17;16H[K[24;1H[7mXtestje1                                                                        [1;1H[?25h[?0c[?25l[?1c[2;11r[0m[2;1H[L[1;25r[2;1Htestje2[12;10H[1m[7m[+][0m[25;1H[K[2;7H[?25h[?0c[3;8H[?25l[?1c[25;1H:[?25h[?0cw[?25l[?1c"Xtestje2" 6 lines, 72 characters written[12;10H[1m[7m   [3;8H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0csp Xtestje3[?25l[?1c"Xtestje3" [25;12H[K[25;12H5 lines, 64 characters[27m[24m[0m[H[J[1;1Hstart of testfile[2;9Hcontents[3;9Hcontents[4;9Hcontents
end of testfile
[1m[34m~                                                                               [7;1H~                                                                               [0m[8;1H[1m[7mXtestje3                                                                        [0m[9;1Htestje2[10;9Hcontents[11;9Hcontents[12;9Hcontents
end of testfile
[1m[34m~                                                                               [15;1H~                                                                               [0m[16;1H[7mXtestje2                                                                        [0m[17;1Htestje1[18;9Hcontents[19;9Hcontents[20;9Hcontents
end of testfile
[1m[34m~                                                                               [23;1H~                                                                               [0m[24;1H[7mXtestje1                                                                        [1;1H[?25h[?0c[?25l[?1c[2;7r[0m[2;1H[L[1;25r[2;1Htestje3[8;10H[1m[7m[+][2;7H[?25h[?0c[3;8H[?25l[?1c[25;1H[0m:[?25h[?0cw[?25l[?1c"Xtestje3" 6 lines, 72 characters written[8;10H[1m[7m   [3;8H[?25h[?0c[0m[8;1H[7mXtestje3                                                                        [0m[16;1H[1m[7mXtestje2                                                                        [10;8H[11;8H[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cau WinLeave Xtestje2 bwipe[?25l[?1c[11;8H[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[1;1Hstart of testfile
testje3[3;9Hcontents[4;9Hcontents[5;9Hcontents
end of testfile
[1m[34m~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[7mXtestje3                                                                        [0m[13;1Htestje1[14;9Hcontents[15;9Hcontents[16;9Hcontents
end of testfile
[1m[34m~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [0m[24;1H[1m[7mXtestje1                                                                        [14;8H[?25h[?0c[15;8H[?25l[?1c[25;1H[0m:[?25h[?0cw! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 6 lines, 72 characters written[15;8H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau WinLeave Xtestje1 bwipe Xtestje3[?25l[?1c[15;8H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cclose[?25l[?1c[2;7H1[12;1H[1m[34m~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [24;1H~                                                                               [4;8H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H6 lines, 72 characters appended[4;8H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xtestje1[?25l[?1c"Xtestje1" 6 lines, 72 characters[4;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe Xtestje2 Xtestje3 test.out[?25l[?1c[1m[37m[41mE94: No matching buffer for Xtestje2 Xtestje3 test.out[4;9H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cau![?25l[?1c[4;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau! BufUnload Xtestje1 bwipe[?25l[?1c[4;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xtestje3[?25l[?1c"Xtestje3" 6 lines, 72 characters[2;7H3[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H6 lines, 72 characters appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xtestje2[?25l[?1c"Xtestje2" 6 lines, 72 characters[2;7H2[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csp Xtestje1[?25l[?1c"Xtestje1" [25;12H[K[25;12H6 lines, 72 characters[2;7H1[12;1H[1m[7mXtestje1                                                                        [0m[13;1Hstart of testfile[13;18H[K[14;1Htestje2[14;8H[K[15;1H        contents[15;17H[K[16;1H        contents[16;17H[K[17;1H        contents[17;17H[K[18;1Hend of testfile[18;16H[K[24;1H[7mXtestje2                                                                        [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ce[?25l[?1c[1m[37m[41mE143: Autocommands unexpectedly deleted new buffer Xtestje1[0m[2;7H2[12;8H[1m[7m2[0m[25;1H"Xtestje2" line 1 of 6 --16%-- col 1[25;37H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H6 lines, 72 characters appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau![?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0conly[?25l[?1c[12;1H[1m[34m~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ce Xtestje1[?25l[?1c"Xtestje1" 6 lines, 72 characters[2;7H1[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe Xtestje2 Xtestje3 test.out test13.in[?25l[?1c4 buffers wiped out[25;20H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau BufWipeout Xtestje1 buf Xtestje1[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe[?25l[?1c"Xtestje1" 6 lines, 72 characters[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H6 lines, 72 characters appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test14.failed test.ok test.out X* viminfo
cp test14.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test14.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test14.in" 99 lines, 1606 characters[1;1HTests for "vaBiB", end could be wrong.
Also test ":s/pat/sub/" with different ~s in sub.
Also test for ^Vxff and ^Vo123 in Insert mode.
Also test "[m", "]m", "[M" and "]M"
Also test search()

STARTTEST
:so small.vim
/Start cursor here
vaBiBD:?Bug?,/Piece/-2w! test.out
/^- Bug
:s/u/~u~/
:s/i/~u~/
:s/o/~~~/
:.w >>test.out
:if has("ebcdic")
: let tt = "o\<C-V>193\<C-V>xc2\<C-V>o303 \<C-V>90a\<C-V>xfg\<C-V>o578\<Esc>"
:else
: let tt = "o\<C-V>65\<C-V>x42\<C-V>o103 \<C-V>33a\<C-V>xfg\<C-V>o78\<Esc>"
:endif
:exe "normal " . tt
:unlet tt
:.w >>test.out
:set vb[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for "vaBiB", end could be wrong.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[7;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[8;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 56 lines, 1141 characters written[8;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[8;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:$put =@/
/^substitute
:keeppatterns s/asdf/xyz/
:$put =@/
/^substitute
Y:$put =@0
/bar /e
:$put =@0
-:keeppatterns /xyz
0dn:/^search()/,$w >>test.out
:qa!
ENDTEST

- Bug in "vPPPP" on this text (Webb):[15;9H{[16;17Hcmd;[17;17H{[18;25Hcmd;    /* <-- Start cursor here */[19;25H{[20;25H}[21;17H}[22;9H}

Piece of Java[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cStart cursor here[?25l[?1c[18;40H[?25h[?0c[?25l[?1c[?25h[?0c[?25l[?1c[17;17H[7m{ 
                        cmd;    /* <-- Start cursor here */ 
                        { 
                        } 
                [?25h[?0c[?25l[?1c[16;1H                cmd; 
                [21;17H}[?25h[?0c[?25l[?1c[0m[25;1H6 fewer lines[25;15H[K[16;24r[16;1H[6M[1;25r[19;1H{[20;9Htt m1 {[21;17Ht1;[22;9H} e1[24;9Htt m2 {[25;1H[K[25;1H6 fewer lines[16;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c?Bug?,/Piece/-2w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 3 lines, 44 characters written[16;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^- Bug[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[14;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cs/u/~u~/[?25l[?1c[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/i/~u~/[?25l[?1c[14;7Huuun "vPPPP" on this text (Webb):[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/o/~~~/[?25l[?1c[14;20Huuuuuuuuun this text (Webb):[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 48 characters appended[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif has("ebcdic")[?25l[?1c
:  [?25h[?0c: let tt = "o\<C-V>193\<C-V>xc2\<C-V>o303 \<C-V>90a\<C-V>xfg\<C-V>o578\<Esc>
[24;80H"[25;1H
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c: let tt = "o\<C-V>65\<C-V>x42\<C-V>o103 \<C-V>33a\<C-V>xfg\<C-V>o78\<Esc>"
[?25l[?1c:  [?25h[?0c:endif[1;1H[5L[?25l[?1c[1;1H:$put =@/
/^substitute
:keeppatterns s/asdf/xyz/
:$put =@/
/^substitute[25;1H[K[14;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cexe "normal " . tt[?25l[?1c[15;24r[15;1H[L[1;25r[15;1HABC !a[1m[34m^O[0mg[1m[34m^G[0m8[25;1H[K[15;12H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cunlet tt[?25l[?1c[15;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 11 characters appended[15;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset vb[?25l[?1c[15;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^Piece[?25l[?1c[19;1H[?25h[?0c[21;15H[?25l[?1c{A[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 10 characters appended[21;16H[?25h[?0c[22;16H[?25l[?1c[1;24r[24;1H
[1;25r[24;9Htt m2 {[25;1H[K[24;15H[?25h[?0c[?25l[?1c{B[?25h[?0c[?25l[?1c
:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 10 characters appended[24;16H[?25h[?0c[?25l[?1c[1;24r[1;1H[4M[1;25r[21;17Ht2;[22;9H} e2[24;9Htt m3 {[25;1H[K[24;15H[?25h[?0c[?25l[?1c{C[?25h[?0c[?25l[?1c
:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 10 characters appended[24;16H[?25h[?0c[?25l[?1c{DC[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 11 characters appended[24;16H[?25h[?0c[23;1H[16;15H[?25l[?1c{EA[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 11 characters appended[16;16H[?25h[?0c[15;1H[?25l[?1c{F[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 3 characters appended[15;2H[?25h[?0c[18;9H[?25l[?1c}G e1[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 7 characters appended[18;10H[?25h[?0c
[?25l[?1c[1;24r[1;1H[5M[1;25r[20;17Hif (x)[21;17H{[22;25Ht3;[23;17H}[24;9H} e3[25;1H[K[24;9H[?25h[?0c[?25l[?1c}H e3[?25h[?0c[?25l[?1c
:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 7 characters appended[24;10H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H}[25;1H[K[24;1H[?25h[?0c[?5h[?5l[?25l[?1c}I[?25h[?0c[?25l[?1c
:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 3 characters appended[24;2H[?25h[?0c[23;9H[?25l[?1c}JH e3[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 8 characters appended[23;10H[?25h[?0c[22;16H[16;9H[?25l[?1c}K e2[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 7 characters appended[16;10H[?25h[?0c[9;1H[?25l[?1c{LF[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 4 characters appended[9;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[9;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^foobar[?25l[?1c[1;24r[1;1H[2M[1;25r[24;1Hfoobar[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet startline = line('.')[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall search('foobar', 'c')[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append(line('$'), line('.') - startline)[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0ccall search('^$', 'c')[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append(line('$'), line('.') - startline)[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall search('^$', 'bc')[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append(line('$'), line('.') - startline)[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0ctwo[?25l[?1c[1;24r[1;1H[3M[1;25r[22;1Hsubstitute foo asdf

one two[25;1H[K[24;5H[?25h[?0c[?25l[?1c
:[?25h[?0ccall search('.', 'c')[?25l[?1c[24;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append(line('$'), getline('.')[col('.') - 1:])[?25l[?1c[24;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^substitute[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[22;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cs/foo/bar/[?25l[?1c[22;12Hbar[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =@/[?25l[?1c[1;24r[1;1H[6M[1;25r[19;1Hsearch()
0
1
1
two
foo[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0c^substitute[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[16;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ckeeppatterns s/asdf/xyz/[?25l[?1c[16;16Hxyz[16;19H[K[16;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =@/[?25l[?1c[1;24r[24;1H
[1;25r[24;1H^substitute[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0c^substitute[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[15;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c$put =@0[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hsubstitute bar xyz[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0cbar /e[?25l[?1c[24;15H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =@0[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hsubstitute bar xyz[25;1H[K[24;1H[?25h[?0c[23;1H[?25l[?1c

:[?25h[?0ckeeppatterns /xyz[?25l[?1c[24;1H[?25h[?0c[?25l[?1c
/bar /e[25;8H[K[25;1H[24;1Hxyz[24;4H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^search()/,$w >>test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H9 lines, 58 characters appended[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test15.failed test.ok test.out X* viminfo
cp test15.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test15.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test15.in" 136 lines, 2246 characters[1;1HTests for :right on text with embedded TAB.
Also test formatting a paragraph.
Also test undo after ":%s" and formatting.

STARTTEST
:so small.vim
:set tw=65

:/^\s*test for :left/,/^\s*test for :center/ left
:/^\s*test for :center/,/^\s*test for :right/ center
:/^\s*test for :right/,/^xxx/-1 right
:set fo+=tcroql tw=72
/xxxxxxxx$
0gq6kk
:set nocp viminfo+=nviminfo
:" undo/redo here to make the next undo only work on the following changes
u[1m[34m^R[0m
:map gg :.,.+2s/^/x/<CR>kk:set tw=3<CR>gqq
/^aa
ggu
:?test for :left?,$w! test.out
:qa!
ENDTEST[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for :right on text with embedded TAB.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[5;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 17 lines, 401 characters written[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[6;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[23;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset tw=65[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;9Htest for :left[25;1H[K[24;8H[?25h[?0c[?25l[?1c
:[?25h[?0c/^\s*test for :left/,/^\s*test for :center/ left[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m[25;37H[K[24;1Htest for :left[24;15H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^\s*test for :center/,/^\s*test for :right/ center[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^\s*test for :right/,/^xxx/-1 right[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fo+=tcroql tw=72[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cxxxxxxxx$[?25l[?1c[27m[24m[0m[H[J[1;41Hasxxdfa[9Caxxxoike[2;40Hasxa;ofa[9Caxxxoike[3;39Hasdfaqwer[9Caxxxoike[4;47Ha[9Caxxxoikey[5;46Hfa[9Caxxxoikey[6;45Hdfa[9Caxxxoikey[7;44Hsdfa[9Caxxxoikey[8;43Hasdfa[9Caxxxoikey[9;42Hxasdfa[9Caxxxoikey[10;41Hasxxdfa[9Caxxxoikey[11;40Hasxa;ofa[9Caxxxoikey[12;39Hasdfaqwer[9Caxxxoikey

xxxxx xx xxxxxx
xxxxxxx xxxxxxxxx xxx xxxx xxxxx xxxxx xxx xx
xxxxxxxxxxxxxxxxxx xxxxx xxxx, xxxx xxxx xxxx xxxx xxx xx xx
xx xxxxxxx. xxxx xxxx.

> xx xx, xxxx xxxx xxx xxxx xxx xxxxx xxx xxx xxxxxxx xxx xxxxx
> xxxxxx xxxxxxx: xxxx xxxxxxx, xx xxxxxx xxxx xxxxxxxxxx

aa aa aa aa
bb bb bb bb
cc cc cc cc[20;50H[?25h[?0c[?25l[?1c[14;24r[24;1H
[1;25r[14;6H xx xxxxxx xxxxxxx xxxxxxxxx xxx xxxx xxxxx xxxxx xxx xx[15;62Hxx xxxxxxx.
xxxx xxxx.[16;11H[K[18;65Hxxxxxx[19;9Hx: xxxx xxxxxxx, xx xxxx[7C xxxxxxx[19;51H[K[24;1H[1m[34m~                                                                               [19;1H[?25h[?0c[18;1H
[?25l[?1c[25;1H[0m:[?25h[?0cset nocp viminfo+=nviminfo[?25l[?1c[19;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" undo/redo here to make the next undo only work on the following changes[?25l[?1c[19;1H[?25h[?0c[?25l[?1c[25;1H1 more line; before #1  0 seconds ago[25;38H[K[27m[24m[0m[H[J[1;1H0gq6kk
:set nocp viminfo+=nviminfo
:" undo/redo here to make the next undo only work on the following changes
u[1m[34m^R[0m
:map gg :.,.+2s/^/x/<CR>kk:set tw=3<CR>gqq
/^aa
ggu
:?test for :left?,$w! test.out
:qa!
ENDTEST[12;9Htest for :left[13;11Ha[13Ca[14;13Hfa[10Ca[15;11Hdfa[11Ca[16;17Hsdfa[12Ca[17;11Hasdfa[9Ca[18;17Hxasdfa[10Ca
asxxdfa[9Ca[21;9Htest for :center[22;11Ha[13Ca[23;13Hfa[10Cafd asdf[24;11Hdfa[11Ca[12;8H[?25h[?0c[?25l[?1c[25;1H1 line less; after #1  0 seconds ago[12;1Htest for :left[12;15H[K[13;1Ha[9C      a[13;25H[K[14;1Hfa[10C    a[14;25H[K[15;1Hdfa[7C      a[15;25H[K[16;1Hsdfa[12Ca[16;18H[K[17;1Hasdfa           a[17;25H[K[18;1Hxasdfa[10Ca[18;18H[K[21;9H                test for :center[22;11H [13C a[14Ca[23;13H  [8Cfa        [8Cafd asdf[24;11H   [11C dfa[12Ca[12;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap gg :.,.+2s/^/x/<CR>kk:set tw=3<CR>gqq[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^aa[?25l[?1c[27m[24m[0m[H[J[1;42Hxasdfa[9Caxxxoike[2;41Hasxxdfa[9Caxxxoike[3;40Hasxa;ofa[9Caxxxoike[4;39Hasdfaqwer[9Caxxxoike[5;47Ha[9Caxxxoikey[6;46Hfa[9Caxxxoikey[7;45Hdfa[9Caxxxoikey[8;44Hsdfa[9Caxxxoikey[9;43Hasdfa[9Caxxxoikey[10;42Hxasdfa[9Caxxxoikey[11;41Hasxxdfa[9Caxxxoikey[12;40Hasxa;ofa[9Caxxxoikey[13;39Hasdfaqwer[9Caxxxoikey

xxxxx xx xxxxxx xxxxxxx xxxxxxxxx xxx xxxx xxxxx xxxxx xxx xx
xxxxxxxxxxxxxxxxxx xxxxx xxxx, xxxx xxxx xxxx xxxx xxx xx xx xx xxxxxxx.
xxxx xxxx.

> xx xx, xxxx xxxx xxx xxxx xxx xxxxx xxx xxx xxxxxxx xxx xxxxx xxxxxx
> xxxxxxx: xxxx xxxxxxx, xx xxxxxx xxxx xxxxxxxxxx

aa aa aa aa
bb bb bb bb
cc cc cc cc[22;1H[?25h[?0c[?25l[?1c


:.,.+2s/^/x/3 substitutions on 3 lines[22;1Hxaa aa aa aa
xbb bb bb bb
xcc cc cc cc[?25h[?0c[23;1H[22;1H[?25l[?1c[25;1H[K[25;1H:set tw=3[22;1H[?25h[?0c[?25l[?1c


3 more lines[1;24r[24;1H
[1;25r[21;5H[K[22;1Haa[22;3H[K[23;1Haa[23;3H[K[24;1Haa[25;1H[K[25;1H3 more lines[24;1H[?25h[?0c[?25l[?1c
3 fewer lines; before #2  0 seconds ago[21;1Haa aa aa aa
bb bb bb bb
cc cc cc cc
[1m[34m~                                                                               [21;1H[?25h[?0c
[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c?test for :left?,$w! test.out[?25l[?1c"test.out"[25;12H[K[25;12H[New] 111L, 2304C written[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test17.failed test.ok test.out X* viminfo
cp test17.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test17.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test17.in" 141 lines, 2634 characters[1;1HTests for:
- "gf" on ${VAR},
- ":checkpath!" with various 'include' settings.

STARTTEST
:so small.vim
:if has("ebcdic")
: set isfname=@,240-249,/,.,-,_,+,,,$,:,~,{,}
:else
: set isfname=@,48-57,/,.,-,_,+,,,$,:,~,{,}
:endif
:function! DeleteDirectory(dir)
: if has("win16") || has("win32") || has("win64") || has("dos16") || has("dos32"[14;1H)
:  exec "silent !rmdir /Q /S " . a:dir
: else
:  exec "silent !rm -rf " . a:dir
: endif
:endfun
:if has("unix")
:let $CDIR = "."
/CDIR
:else
:if has("amiga")[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for:[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[5;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 33 lines, 771 characters written[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[6;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H/TDIR
:endif
:" Dummy writing for making that sure gf doesn't fail even if the current
:" file is modified. It can be occurred when executing the following command
:" directly on Windows without fixing the 'fileformat':
:"  > nmake -f Make_dos.mak test17.out
:w! test.out
gf
:set ff=unix
:w! test.out
:brewind
ENDTEST[14;9H${CDIR}/test17a.in[15;9H$TDIR/test17a.in

STARTTEST
:" check for 'include' without \zs or \ze
:lang C
:call delete("./Xbase.a")
:call DeleteDirectory("Xdir1")
:!mkdir Xdir1
:!mkdir "Xdir1/dir2"
:e! Xdir1/dir2/foo.a[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif has("ebcdic")[?25l[?1c
:  [?25h[?0c: set isfname=@,240-249,/,.,-,_,+,,,$,:,~,{,}
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c: set isfname=@,48-57,/,.,-,_,+,,,$,:,~,{,}
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[1;1H/TDIR
:endif
:" Dummy writing for making that sure gf doesn't fail even if the current
:" file is modified. It can be occurred when executing the following command[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cfunction! DeleteDirectory(dir)[?25l[?1c
:  [?25h[?0c: if has("win16") || has("win32") || has("win64") || has("dos16") || has("do
[24;80Hs[25;1H32")
[?25l[?1c:    [?25h[?0c:  exec "silent !rmdir /Q /S " . a:dir
[?25l[?1c:    [?25h[?0c: else
[?25l[?1c:    [?25h[?0c:  exec "silent !rm -rf " . a:dir
[?25l[?1c:    [?25h[?0c: endif
[?25l[?1c:  [?25h[?0c:endfun[1;1H[7L[?25l[?1c[1;1H/TDIR
:endif
:" Dummy writing for making that sure gf doesn't fail even if the current
:" file is modified. It can be occurred when executing the following command
:" directly on Windows without fixing the 'fileformat':
:"  > nmake -f Make_dos.mak test17.out
:w! test.out[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cif has("unix")[?25l[?1c
:  [?25h[?0c:let $CDIR = "."
[?25l[?1c:  [?25h[?0c/CDIR
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c:if has("amiga")
[?25l[?1c:    [?25h[?0c:let $TDIR = "/testdir"
[?25l[?1c:    [?25h[?0c:else
[?25l[?1c:    [?25h[?0c:let $TDIR = "."
[?25l[?1c:    [?25h[?0c:endif
[?25l[?1c:  [?25h[?0c/TDIR
[?25l[?1c:  [?25h[?0c:endif[1;1H[10L[?25l[?1c[1;1H/TDIR
:endif
:" Dummy writing for making that sure gf doesn't fail even if the current
:" file is modified. It can be occurred when executing the following command
:" directly on Windows without fixing the 'fileformat':
:"  > nmake -f Make_dos.mak test17.out
:w! test.out
gf
:set ff=unix
:w! test.out[25;1H[K[14;9H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c" Dummy writing for making that sure gf doesn't fail even if the current[?25l[?1c[14;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" file is modified. It can be occurred when executing the following command[?25l[?1c[14;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" directly on Windows without fixing the 'fileformat':[?25l[?1c[14;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"  > nmake -f Make_dos.mak test17.out[?25l[?1c[14;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 141 lines, 2634 characters written[14;9H[?25h[?0c[?25l[?1c[25;2H/sources/vim74/src/testdir/./test17a.in" [25;43H[K[25;43H3 lines, 88 characters[1;1HThis file is just to test "gf" in test 17.
The contents is not important.
Just testing![3;14H[K[4;1H[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c
[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset ff=unix[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! test.out[?25l[?1c"test.out" [25;12H[K[25;12H3 lines, 88 characters written[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbrewind[?25l[?1c"test17.in" 141 lines, 2634 characters[1;1H:" Dummy writing for making that sure gf doesn't fail even if the current
:" file is modified. It can be occurred when executing the following command
:" directly on Windows without fixing the 'fileformat':
:"  > nmake -f Make_dos.mak test17.out[4;39H[K[5;1H:w! test.out[5;13H[K[6;1Hgf[6;3H[K[7;1H:set ff=unix[7;13H[K[8;1H:w! test.out[8;13H[K[9;1H:brewind[9;9H[K[10;1HENDTEST[10;8H[K[11;1H[K[12;1H        ${CDIR}/test17a.in[12;27H[K[13;1H        $TDIR/test17a.in[13;25H[K[14;1H[K[15;1HSTARTTEST[15;10H[K[16;1H:" check for 'include' without \zs or \ze[16;42H[K[17;1H:lang C[17;8H[K[18;1H:call delete("./Xbase.a")[18;26H[K[19;1H:call DeleteDirectory("Xdir1")[19;31H[K[20;1H:!mkdir Xdir1[20;14H[K[21;1H:!mkdir "Xdir1/dir2"[21;21H[K[22;1H:e! Xdir1/dir2/foo.a[22;21H[K[23;1Hi#include   "bar.a"[1m[34m^[[0m[23;22H[K[24;1H:w[24;3H[K[12;8H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[15;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[16;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H23 lines, 395 characters written[16;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[16;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:e Xdir1/dir2/baz.a
i#include[12C"foo.a"[1m[34m^[[0m
:w
:e Xbase.a
:set path=Xdir1/dir2
i#include    <foo.a>[1m[34m^[[0m
:w
:redir! >>test.out
:checkpath!
:redir END
:brewind
ENDTEST

STARTTEST
:" check for 'include' with \zs and \ze
:call delete("./Xbase.b")
:call DeleteDirectory("Xdir1")
:!mkdir Xdir1
:!mkdir "Xdir1/dir2"
:let &include='^\s*%inc\s*/\zs[^/]\+\ze'
:function! DotsToSlashes()
:  return substitute(v:fname, '\.', '/', 'g') . '.b'
:endfunction
:let &includeexpr='DotsToSlashes()'[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" check for 'include' without \zs or \ze[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clang C[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall delete("./Xbase.a")[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall DeleteDirectory("Xdir1")[?25l[?1c[?25h[?0c[25;1H[13;1H[?25l[?1c[25;1H[K[25;1H:[?25h[?0c!mkdir Xdir1[?25l[?1c[13C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c!mkdir "Xdir1/dir2"[?25l[?1c[20C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ce! Xdir1/dir2/foo.a[?25l[?1c"Xdir1/dir2/foo.a" [New File][27m[24m[0m[H[J[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m#include   "bar.a"[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cw[?25l[?1c"Xdir1/dir2/foo.a" [New File] 1 line, 19 characters written[1;18H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xdir1/dir2/bar.a[?25l[?1c"Xdir1/dir2/bar.a" [New File][1;1H[K[1;1H[?25h[?0c[?25l[?1c#include      "baz.a"[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"Xdir1/dir2/bar.a" [New File] 1 line, 22 characters written[1;21H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xdir1/dir2/baz.a[?25l[?1c"Xdir1/dir2/baz.a" [New File][1;1H[K[1;1H[?25h[?0c[?25l[?1c#include[12C"foo.a"[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"Xdir1/dir2/baz.a" [New File] 1 line, 28 characters written[1;27H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xbase.a[?25l[?1c"Xbase.a" [New File][1;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset path=Xdir1/dir2[?25l[?1c[1;1H[?25h[?0c[?25l[?1c#include    <foo.a>[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"Xbase.a" [New File] 1 line, 20 characters written[1;19H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir! >>test.out[?25l[?1c[1;19H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccheckpath![?25l[?1c[25;1H[K[25;1H[1m[35m--- Included files in path ---[0m
[1m[36mXdir1/dir2/foo.a[0m
Xdir1/dir2/foo.a -->
  [1m[36mXdir1/dir2/bar.a[0m
  Xdir1/dir2/bar.a -->
    [1m[36mXdir1/dir2/baz.a[0m
    Xdir1/dir2/baz.a -->
      [1m[36m"foo.a"[0m  (Already listed)
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0credir END[?25l[?1c[1;1H[8L[1;1H#include    <foo.a>
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [0m[25;1H[K[1;19H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cbrewind[?25l[?1c"test17.in" 141 lines, 2634 characters[1;1Hi#include            "foo.a"[1m[34m^[[0m
:w[2;3H[K[3;1H:e Xbase.a[3;11H[K[4;1H:set path=Xdir1/dir2[4;21H[K[5;1Hi#include    <foo.a>[1m[34m^[[0m[5;23H[K[6;1H:w[6;3H[K[7;1H:redir! >>test.out[7;19H[K[8;1H:checkpath![8;12H[K[9;1H:redir END[9;11H[K[10;1H:brewind[10;9H[K[11;1HENDTEST[11;8H[K[12;1H[K[13;1HSTARTTEST[13;10H[K[14;1H:" check for 'include' with \zs and \ze[14;40H[K[15;1H:call delete("./Xbase.b")[15;26H[K[16;1H:call DeleteDirectory("Xdir1")[16;31H[K[17;1H:!mkdir Xdir1[17;14H[K[18;1H:!mkdir "Xdir1/dir2"[18;21H[K[19;1H:let &include='^\s*%inc\s*/\zs[^/]\+\ze'[19;41H[K[20;1H:function! DotsToSlashes()[20;27H[K[21;1H:  return substitute(v:fname, '\.', '/', 'g') . '.b'[21;53H[K[22;1H:endfunction[22;13H[K[23;1H:let &includeexpr='DotsToSlashes()'[23;36H[K[24;1H:e! Xdir1/dir2/foo.b[24;21H[K[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[13;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H27 lines, 531 characters written[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[14;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:e Xdir1/dir2/baz.b
i%inc[12C/foo/[1m[34m^[[0m
:w
:e Xbase.b
:set path=Xdir1/dir2
i%inc    /foo/[1m[34m^[[0m
:w
:redir! >>test.out
:checkpath!
:redir END
:brewind
ENDTEST

STARTTEST
:" check for 'include' with \zs and no \ze
:call delete("./Xbase.c")
:call DeleteDirectory("Xdir1")
:!mkdir Xdir1
:!mkdir "Xdir1/dir2"
:let &include='^\s*%inc\s*\%([[:upper:]][^[:space:]]*\s\+\)\?\zs\S\+\ze'
:function! StripNewlineChar()
:  if v:fname =~ '\n$'
:    return v:fname[:-2]
:  endif[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" check for 'include' with \zs and \ze[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall delete("./Xbase.b")[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall DeleteDirectory("Xdir1")[?25l[?1c[?25h[?0c[25;1H[13;1H[?25l[?1c[25;1H[K[25;1H:[?25h[?0c!mkdir Xdir1[?25l[?1c[13C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c!mkdir "Xdir1/dir2"[?25l[?1c[20C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet &include='^\s*%inc\s*/\zs[^/]\+\ze'[?25l[?1c[27m[24m[0m[H[J[1;1H:e Xdir1/dir2/baz.b
i%inc[12C/foo/[1m[34m^[[0m
:w
:e Xbase.b
:set path=Xdir1/dir2
i%inc    /foo/[1m[34m^[[0m
:w
:redir! >>test.out
:checkpath!
:redir END
:brewind
ENDTEST

STARTTEST
:" check for 'include' with \zs and no \ze
:call delete("./Xbase.c")
:call DeleteDirectory("Xdir1")
:!mkdir Xdir1
:!mkdir "Xdir1/dir2"
:let &include='^\s*%inc\s*\%([[:upper:]][^[:space:]]*\s\+\)\?\zs\S\+\ze'
:function! StripNewlineChar()
:  if v:fname =~ '\n$'
:    return v:fname[:-2]
:  endif[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cfunction! DotsToSlashes()[?25l[?1c
:  [?25h[?0c:  return substitute(v:fname, '\.', '/', 'g') . '.b'
[?25l[?1c:  [?25h[?0c:endfunction[1;1H[2L[?25l[?1c[1;1H:e Xdir1/dir2/baz.b
i%inc[12C/foo/[1m[34m^[[0m[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0clet &includeexpr='DotsToSlashes()'[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! Xdir1/dir2/foo.b[?25l[?1c"Xdir1/dir2/foo.b" [New File][1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m%inc   /bar/[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"Xdir1/dir2/foo.b" [New File] 1 line, 13 characters written[1;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xdir1/dir2/bar.b[?25l[?1c"Xdir1/dir2/bar.b" [New File][1;1H[K[1;1H[?25h[?0c[?25l[?1c%inc      /baz/[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"Xdir1/dir2/bar.b" [New File] 1 line, 16 characters written[1;15H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xdir1/dir2/baz.b[?25l[?1c"Xdir1/dir2/baz.b" [New File][1;1H[K[1;1H[?25h[?0c[?25l[?1c%inc[12C/foo/[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"Xdir1/dir2/baz.b" [New File] 1 line, 22 characters written[1;21H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xbase.b[?25l[?1c"Xbase.b" [New File][1;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset path=Xdir1/dir2[?25l[?1c[1;1H[?25h[?0c[?25l[?1c%inc    /foo/[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"Xbase.b" [New File] 1 line, 14 characters written[1;13H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir! >>test.out[?25l[?1c[1;13H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccheckpath![?25l[?1c[25;1H[K[25;1H[1m[35m--- Included files in path ---[0m
[1m[36mXdir1/dir2/foo.b[0m
Xdir1/dir2/foo.b -->
  [1m[36mXdir1/dir2/bar.b[0m
  Xdir1/dir2/bar.b -->
    [1m[36mXdir1/dir2/baz.b[0m
    Xdir1/dir2/baz.b -->
      [1m[36mfoo[0m  (Already listed)
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0credir END[?25l[?1c[1;1H[8L[1;1H%inc    /foo/
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [0m[25;1H[K[1;13H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cbrewind[?25l[?1c"test17.in" 141 lines, 2634 characters[1;1Hi%inc            /foo/[1m[34m^[[0m
:w[2;3H[K[3;1H:e Xbase.b[3;11H[K[4;1H:set path=Xdir1/dir2[4;21H[K[5;1Hi%inc    /foo/[1m[34m^[[0m[5;17H[K[6;1H:w[6;3H[K[7;1H:redir! >>test.out[7;19H[K[8;1H:checkpath![8;12H[K[9;1H:redir END[9;11H[K[10;1H:brewind[10;9H[K[11;1HENDTEST[11;8H[K[12;1H[K[13;1HSTARTTEST[13;10H[K[14;1H:" check for 'include' with \zs and no \ze[14;43H[K[15;1H:call delete("./Xbase.c")[15;26H[K[16;1H:call DeleteDirectory("Xdir1")[16;31H[K[17;1H:!mkdir Xdir1[17;14H[K[18;1H:!mkdir "Xdir1/dir2"[18;21H[K[19;1H:let &include='^\s*%inc\s*\%([[:upper:]][^[:space:]]*\s\+\)\?\zs\S\+\ze'[19;73H[K[20;1H:function! StripNewlineChar()[20;30H[K[21;1H:  if v:fname =~ '\n$'[21;23H[K[22;1H:    return v:fname[:-2][22;25H[K[23;1H:  endif[23;9H[K[24;1H:  return v:fname[24;18H[K[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[13;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H39 lines, 743 characters written[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[14;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1Hi%inc      baz.c[1m[34m^[[0m
:w
:e Xdir1/dir2/baz.c
i%inc[12Cfoo.c[1m[34m^[[0m
:w
:e Xdir1/dir2/FALSE.c
i%inc[12Cfoo.c[1m[34m^[[0m
:w
:e Xbase.c
:set path=Xdir1/dir2
i%inc    FALSE.c foo.c[1m[34m^[[0m
:w
:redir! >>test.out
:checkpath!
:redir END
:brewind
:" change "\" to "/" for Windows and fix 'fileformat'
:e test.out
:%s#\\#/#g
:set ff&
:w
:q
ENDTEST[?25h[?0c
[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" check for 'include' with \zs and no \ze[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall delete("./Xbase.c")[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall DeleteDirectory("Xdir1")[?25l[?1c[?25h[?0c[25;1H[24;1H[?25l[?1c[25;1H[K[25;1H:[?25h[?0c!mkdir Xdir1[?25l[?1c[13C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c!mkdir "Xdir1/dir2"[?25l[?1c[20C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet &include='^\s*%inc\s*\%([[:upper:]][^[:space:]]*\s\+\)\?\zs\S\+\ze'[?25l[?1c[27m[24m[0m[H[J[1;1Hi%inc      baz.c[1m[34m^[[0m
:w
:e Xdir1/dir2/baz.c
i%inc[12Cfoo.c[1m[34m^[[0m
:w
:e Xdir1/dir2/FALSE.c
i%inc[12Cfoo.c[1m[34m^[[0m
:w
:e Xbase.c
:set path=Xdir1/dir2
i%inc    FALSE.c foo.c[1m[34m^[[0m
:w
:redir! >>test.out
:checkpath!
:redir END
:brewind
:" change "\" to "/" for Windows and fix 'fileformat'
:e test.out
:%s#\\#/#g
:set ff&
:w
:q
ENDTEST
[?25h[?0c[?25l[?1c
:[?25h[?0cfunction! StripNewlineChar()[?25l[?1c
:  [?25h[?0c:  if v:fname =~ '\n$'
[?25l[?1c:    [?25h[?0c:    return v:fname[:-2]
[?25l[?1c:    [?25h[?0c:  endif
[?25l[?1c:  [?25h[?0c:  return v:fname
[?25l[?1c:  [?25h[?0c:endfunction[1;1H[5L[?25l[?1c[1;1Hi%inc      baz.c[1m[34m^[[0m
:w
:e Xdir1/dir2/baz.c
i%inc[12Cfoo.c[1m[34m^[[0m
:w[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet &includeexpr='StripNewlineChar()'[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! Xdir1/dir2/foo.c[?25l[?1c"Xdir1/dir2/foo.c" [New File][1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m%inc   bar.c[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"Xdir1/dir2/foo.c" [New File] 1 line, 13 characters written[1;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xdir1/dir2/bar.c[?25l[?1c"Xdir1/dir2/bar.c" [New File][1;1H[K[1;1H[?25h[?0c[?25l[?1c%inc      baz.c[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"Xdir1/dir2/bar.c" [New File] 1 line, 16 characters written[1;15H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xdir1/dir2/baz.c[?25l[?1c"Xdir1/dir2/baz.c" [New File][1;1H[K[1;1H[?25h[?0c[?25l[?1c%inc[12Cfoo.c[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"Xdir1/dir2/baz.c" [New File] 1 line, 22 characters written[1;21H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xdir1/dir2/FALSE.c[?25l[?1c"Xdir1/dir2/FALSE.c" [New File][1;1H[K[1;1H[?25h[?0c[?25l[?1c%inc[12Cfoo.c[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"Xdir1/dir2/FALSE.c" [New File] 1 line, 22 characters written[1;21H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xbase.c[?25l[?1c"Xbase.c" [New File][1;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset path=Xdir1/dir2[?25l[?1c[1;1H[?25h[?0c[?25l[?1c%inc    FALSE.c foo.c[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"Xbase.c" [New File] 1 line, 22 characters written[1;21H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir! >>test.out[?25l[?1c[1;21H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccheckpath![?25l[?1c[25;1H[K[25;1H[1m[35m--- Included files in path ---[0m
[1m[36mXdir1/dir2/foo.c[0m
Xdir1/dir2/foo.c -->
  [1m[36mXdir1/dir2/bar.c[0m
  Xdir1/dir2/bar.c -->
    [1m[36mXdir1/dir2/baz.c[0m
    Xdir1/dir2/baz.c -->
      [1m[36mfoo.c[0m  (Already listed)
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0credir END[?25l[?1c[1;1H[8L[1;1H%inc    FALSE.c foo.c
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [0m[25;1H[K[1;21H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cbrewind[?25l[?1c"test17.in" 141 lines, 2634 characters[1;1Hi%inc      baz.c[1m[34m^[[0m[1;19H[K[2;1H:w[2;3H[K[3;1H:e Xdir1/dir2/baz.c[3;20H[K[4;1Hi%inc            foo.c[1m[34m^[[0m[4;25H[K[5;1H:w[5;3H[K[6;1H:e Xdir1/dir2/FALSE.c[6;22H[K[7;1Hi%inc            foo.c[1m[34m^[[0m[7;25H[K[8;1H:w[8;3H[K[9;1H:e Xbase.c[9;11H[K[10;1H:set path=Xdir1/dir2[10;21H[K[11;1Hi%inc    FALSE.c foo.c[1m[34m^[[0m[11;25H[K[12;1H:w[12;3H[K[13;1H:redir! >>test.out[13;19H[K[14;1H:checkpath![14;12H[K[15;1H:redir END[15;11H[K[16;1H:brewind[16;9H[K[17;1H:" change "\" to "/" for Windows and fix 'fileformat'[17;54H[K[18;1H:e test.out[18;12H[K[19;1H:%s#\\#/#g[19;11H[K[20;1H:set ff&[20;9H[K[21;1H:w[21;3H[K[22;1H:q[22;3H[K[23;1HENDTEST[23;8H[K[24;1H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" change "\" to "/" for Windows and fix 'fileformat'[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce test.out[?25l[?1c"test.out" 33 lines, 655 characters[1;1HThis file is just to test "gf" in test 17.
The contents is not important.
Just testing![3;14H[K[4;1H[K[5;1H[K[6;1H--- Included files in path ---
Xdir1/dir2/foo.a[7;18H[K[8;1HXdir1/dir2/foo.a -->
  Xdir1/dir2/bar.a
  Xdir1/dir2/bar.a -->
    Xdir1/dir2/baz.a[11;21H[K[12;1H    Xdir1/dir2/baz.a -->
      "foo.a"  (Already listed)[14;1H[K[15;1H[K[16;1H--- Included files in path ---
Xdir1/dir2/foo.b[17;18H[K[18;1HXdir1/dir2/foo.b -->
  Xdir1/dir2/bar.b
  Xdir1/dir2/bar.b -->
    Xdir1/dir2/baz.b
    Xdir1/dir2/baz.b -->
      foo  (Already listed)[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c%s#\\#/#g[?25l[?1c[1m[37m[41mE486: Pattern not found: \\[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset ff&[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"test.out" 33 lines, 655 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cq[?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test18.failed test.ok test.out X* viminfo
cp test18.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test18.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test18.in" 16 lines, 213 characters[1;1HTests for not doing smart indenting when it isn't set.

STARTTEST
:so small.vim
:set nocin nosi ai
/some
2cc#test[1m[34m^[[0m
:?start?,$w! test.out
:qa!
ENDTEST

start text[13;17Hsome test text[14;17Htest text
test text[16;17Htest text
[1m[34m~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for not doing smart indenting when it isn't set.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 6 lines, 76 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[10;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[11;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[11;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nocin nosi ai[?25l[?1c[11;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0csome[?25l[?1c[13;17H[?25h[?0c[?25l[?1c[13;24r[24;1H
[1;25r[13;17H#test[13;22H[K[24;1H[1m[34m~                                                                               [0m[25;1H[K[13;21H[?25h[?0c[14;9H[?25l[?1c[25;1H:[?25h[?0c?start?,$w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 4 lines, 41 characters written[14;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test19.failed test.ok test.out X* viminfo
cp test19.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test19.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test19.in" 33 lines, 692 characters[1;1HTests for "r<Tab>" with 'smarttab' and 'expandtab' set/not set.
Also test that dv_ works correctly

STARTTEST
:so small.vim
:set smarttab expandtab ts=8 sw=4
:" make sure that backspace works, no matter what termcap is used
:set t_kD=[1m[34m^V[0mx7f t_kb=[1m[34m^V[0mx08
/some
r[7C:set noexpandtab
/other
r
:" Test replacing with Tabs and then backspacing to undo it
0wR[21C[1m[34m^H^H^H^[[0m
:" Test replacing with Tabs
0wR[21C[1m[34m^[[0m
:" Test that copyindent works with expandtab set
:set expandtab smartindent copyindent ts=8 sw=8 sts=8
o{
x[1m[34m^[[0m:set nosol
/Second line/
fwdv_:?^start?,$w! test.out
:qa!
ENDTEST[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for "r<Tab>" with 'smarttab' and 'expandtab' set/not set.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[4;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 19 lines, 447 characters written[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset smarttab expandtab ts=8 sw=4[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" make sure that backspace works, no matter what termcap is used[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset t_kD=^[1m[34m^?[0m t_kb=^[1m[34m^H[?25l[?1c[27m[24m[0m[H[J[1;1HAlso test that dv_ works correctly

STARTTEST
:so small.vim
:set smarttab expandtab ts=8 sw=4
:" make sure that backspace works, no matter what termcap is used
:set t_kD=[1m[34m^V[0mx7f t_kb=[1m[34m^V[0mx08
/some
r[7C:set noexpandtab
/other
r
:" Test replacing with Tabs and then backspacing to undo it
0wR[21C[1m[34m^H^H^H^[[0m
:" Test replacing with Tabs
0wR[21C[1m[34m^[[0m
:" Test that copyindent works with expandtab set
:set expandtab smartindent copyindent ts=8 sw=8 sts=8
o{
x[1m[34m^[[0m:set nosol
/Second line/
fwdv_:?^start?,$w! test.out
:qa!
ENDTEST
[?25h[?0c[?25l[?1c
/[?25h[?0csome[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hstart text[24;17Hsome test text[25;1H[K[24;17H[?25h[?0c[?25l[?1c    ome test text[24;20H[?25h[?0c[?25l[?1c
:[?25h[?0cset noexpandtab[?25l[?1c[24;20H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cother[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Htest text[24;17Hother test text[25;1H[K[24;17H[?25h[?0c[?25l[?1c    ther test text[24;20H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Ha cde[?25h[?0c[?25l[?1c
:[?25h[?0c" Test replacing with Tabs and then backspacing to undo it[?25l[?1c[24;9H[?25h[?0c    [?25l[?1c[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Hf ghi[25;1H[K[24;4H[?25h[?0c[?25l[?1c
:[?25h[?0c" Test replacing with Tabs[?25l[?1c[24;4H[?25h[?0c    [?25l[?1c     [7Chi[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Htest text[25;1H[K[24;9H[?25h[?0c[?25l[?1c
:[?25h[?0c" Test that copyindent works with expandtab set[?25l[?1c[24;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset expandtab smartindent copyindent ts=8 sw=8 sts=8[?25l[?1c[24;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1H{[24;9Hx[25;1H[K[24;9H[?25h[?0c[?25l[?1c
:[?25h[?0cset nosol[?25l[?1c[24;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cSecond line/[?25l[?1c[25;13H[K[25;1H[1;24r[24;1H
[1;25r[24;3HSecond line beginning with whitespace[25;1H[K[24;3H[?25h[?0c[22C[?25l[?1c  with whitespace[24;18H[K[24;3H[?25h[?0c[?25l[?1c
:[?25h[?0c?^start?,$w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 10 lines, 121 characters written[24;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test20.failed test.ok test.out X* viminfo
cp test20.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test20.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test20.in" 28 lines, 398 characters[1;1HTests Blockwise Visual when there are TABs before the text.
First test for undo working properly when executing commands from a register.
Also test this in an empty buffer.

STARTTEST
:so tiny.vim
G0"ay$k@au
:new
@auY:quit!
GP
/start here$
"by$[1m[34m^V[0mjjlld
/456$
[1m[34m^V[0mjj"bP
:/56$/,$-1w! test.out
:qa!
ENDTEST

123456
234567
345678

test text test tex start here[24;17Hsome text[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests Blockwise Visual when there are TABs before the text.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[5;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 11 lines, 107 characters written[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[6;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[17;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[18;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso tiny.vim[?25l[?1c[18;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[4M[1;25r[21;17Htest text
test text

Ox[1m[34m^[[0mjAy[1m[34m^[[0mkdd[25;1H[K[24;1H[?25h[?0c[23;1H[?25l[?1cx[24;1H[K[23;1H[?25h[?0c
[?25l[?1cy[?25h[?0c[23;1H[?25l[?1cy
Ox[1m[34m^[[0mjAy[1m[34m^[[0mkdd[23;1H[?25h[?0c[?25l[?1c

2 changes; before #1  0 seconds ago[23;1H[K[23;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnew[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7m[No Name]                                                                       [0m[13;1H[K[14;1H123456
234567
345678[17;1H[K[18;1Htest text test tex start here
                some text[19;26H[K[20;17Htest
test text[21;17H[K[22;1H[K[23;1HOx[1m[34m^[[0mjAy[1m[34m^[[0mkdd
[7mtest20.in                                                                       [1;1H[?25h[?0c[?25l[?1c[1;11r[0m[1;1H[L[1;25r[1;1Hx[12;11H[1m[7m[+][0m[25;1H[K[1;1H[?25h[?0c
[?25l[?1cy[?25h[?0c[1;1H[?25l[?1c[1;11r[11;1H
[1;25r[11;1H[1m[34m~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H1 line less; before #1  0 seconds ago[1;1H[K[12;11H[1m[7m   [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cquit![?25l[?1c[1;1HSTARTTEST
:so tiny.vim[2;13H[K[3;1HG0"ay$k@au[3;11H[K[4;1H:new[4;5H[K[5;1H@auY:quit![5;11H[K[6;1HGP[6;3H[K[7;1H/start here$[7;13H[K[8;1H"by$[1m[34m^V[0mjjlld[8;12H[K[9;1H/456$[9;6H[K[10;1H[1m[34m^V[0mjj"bP[10;8H[K[11;1H:/56$/,$-1w! test.out[11;22H[K[12;1H:qa![12;5H[K[13;1HENDTEST[14;1H[K[15;1H123456
234567
345678[18;1H[K[19;1Htest text test tex start here[20;17Hsome
         [7Ctest text
test text[23;1H[K[24;1HOx[1m[34m^[[0mjAy[1m[34m^[[0mkdd[24;13H[K[24;1H[?25h[?0c[?25l[?1c[24;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HOx[1m[34m^[[0mjAy[1m[34m^[[0mkdd[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0cstart here$[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[18;20H[?25h[?0c[?25l[?1c[?25h[?0c[?25l[?1c[0m[7ms[19;20H[?25h[?0c[?25l[?1ce[20;20H[?25h[?0c[?25l[?1c[18;21Ht[19;21H [20;20Ht[?25h[?0c[?25l[?1c[18;22Ha[19;22Ht[20;21H [?25h[?0c[?25l[?1c[0m[18;20Hrt here[18;27H[K[19;20Hext[19;23H[K[20;20Hex[20;23H[K[18;20H[?25h[?0c[19;20H[?25l[?1c[25;1H[K[25;1H/[?25h[?0c456$[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[14;4H[?25h[?0c[?25l[?1c[?25h[?0c[?25l[?1c[0m[7m4
[0m234[?25h[?0c[?25l[?1c[7m5
[0m345[?25h[?0c[?25l[?1c[?25h[?0c[?25l[?1c[14;4Hstart here56
234start here67
345start here78[14;13H[?25h[?0c[15;13H[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/56$/,$-1w! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 10 lines, 106 characters written[15;13H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test21.failed test.ok test.out X* viminfo
cp test21.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test21.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test21.in" 19 lines, 297 characters[1;1HTests for [ CTRL-I with a count and CTRL-W CTRL-I with a count

STARTTEST
:so small.vim
/start
6[      :.w! test.out
?start here
6[1m[34m^W[0m     :.w >>test.out
:qa!
ENDTEST

#include test21.in

/* test text test tex start here[15;17Hsome text[16;17Htest text[17;17Hstart OK if found this line[18;9Hstart found wrong line
test text
[1m[34m~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for [ CTRL-I with a count and CTRL-W CTRL-I with a count[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 6 lines, 73 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[10;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[11;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[11;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cstart[?25l[?1c[14;23H[?25h[?0c[17;17H[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 1 line, 30 characters written[17;17H[?25h[?0c[?25l[?1c[25;1H[K[25;1H?[?25h[?0cstart here[?25l[?1c[14;23H[?25h[?0c[?25l[?1c[1;1H6[1m[34m^W[0m     :.w >>test.ou[1;23H[K[2;1H:qa!
ENDTEST[3;8H[K[4;1H[K[5;1H#include test21.in[6;1H[K[7;1H/* test text test tex start here
                some text
    [12Ctest text
       [9Cstart OK if found this line[11;9Hstart found wrong line
[1m[7mtest21.in                                                                       [0m[13;1H6[1m[34m^W[0m     :.w >>test.out
:qa![14;5H[K[15;1HENDTEST[15;17H[K[16;17H[K[17;1H#include test21.in[17;19H[K[18;9H[K[19;1H/* test text test tex start here
                some text[20;26H[K[21;1H                test text[21;26H[K[22;1H                start OK if found this line[22;44H[K[23;1H        start found wrong line[23;31H[K[24;1H[7mtest21.in                                                                       [10;17H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 30 characters appended[10;17H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test22.failed test.ok test.out X* viminfo
cp test22.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test22.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test22.in" 13 lines, 197 characters[1;1HTests for file with some lines ending in CTRL-M, some not[1m[34m^M
^M[0m
STARTTEST
:set ta tx
:e!
:$-3,$w! test.out
:qa!
ENDTEST

this lines ends in a[1m[34m^M[0m
this one doesn't
this one does[1m[34m^M[0m
and the last one doesn't
[1m[34m~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for file with some lines ending in CTRL-M, some not[1m[34m^M[0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 4 lines, 38 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[8;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ta tx[?25l[?1c[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce![?25l[?1c"test22.in" 13 lines, 197 characters[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$-3,$w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 4 lines, 79 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test23.failed test.ok test.out X* viminfo
cp test23.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test23.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test23.in" 15 lines, 282 characters[1;1HTests for complicated + argument to :edit command

STARTTEST
:$-1w! Xfile1
:$w! Xfile2
:edit +1|s/|/PIPE/|w Xfile1| e Xfile2|1 | s/\//SLASH/|w
:w! test.out
:e Xfile1
:w >> test.out
:qa!
ENDTEST

The result should be in Xfile1: "fooPIPEbar", in Xfile2: "fooSLASHbar"
foo|bar
foo/bar
[1m[34m~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for complicated + argument to :edit command[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 7 lines, 125 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[11;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$-1w! Xfile1[?25l[?1c"Xfile1" [25;10H[K[25;10H[New File] 1 line, 8 characters written[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$w! Xfile2[?25l[?1c"Xfile2" [25;10H[K[25;10H[New File] 1 line, 8 characters written[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cedit +1|s/|/PIPE/|w Xfile1| e Xfile2|1 | s/\//SLASH/|w[?25l[?1c"Xfile1" [25;10H[K[25;10H1 line, 8 characters
foo|bar
"Xfile1" 1 line, 11 characters written
"Xfile2" 1 line, 8 characters
foo/bar
"Xfile2" 1 line, 12 characters written
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 1 line, 12 characters written
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ce Xfile1[?25l[?1c"Xfile1" 1 line, 11 characters[1;1H[7L[1;1HfooPIPEbar
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [0m[25;1H[K[25;1H"Xfile1" 1 line, 11 characters[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >> test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 11 characters appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test24.failed test.ok test.out X* viminfo
cp test24.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test24.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test24.in" 89 lines, 1301 characters[1;1HTests for regexp with backslash and other special characters inside []
Also test backslash for hex/octal numbered character.

STARTTEST
:set nocompatible viminfo+=nviminfo
/[\x]
x/[\t\]]
x/[]y]
x/[\]]
x/[y^]
x/[$y]
x/[\x61]
x/[\x60-\x64]
xj0/[\x785]
x/[\o143]
x/[\o140-\o144]
x/[\o417]
x/\%x42
x/\%o103
x/[\x00]
x
:s/[\x00-\x10]//g

:s/[\x-z]\+//[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for regexp with backslash and other special characters inside [][25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[4;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 51 lines, 519 characters written[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[2;1H:s/^\(\h\w*\%(->\|\.\)\=\)\+=/YY/

:s/aaa/xyz/

:s/~/bcd/

:s/~\+/BB/
:"
:?start?,$w! test.out
:qa!
ENDTEST

start
test \text test text
test    text test text
test text ]test text
test ]text test text
test text te^st text
test te$xt test text
test taext test text  x61
test tbext test text  x60-x64
test 5text test text  x78 5
testc text test text  o143[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nocompatible viminfo+=nviminfo[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c[\x][?25l[?1c[15;6H[?25h[?0c[?25l[?1ctext test text[15;20H[K[15;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c[\t\]][?25l[?1c[16;8H[?25h[?0c[?25l[?1ctext test tex[16;20H[K[16;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c[]y][?25l[?1c[17;11H[?25h[?0c[?25l[?1ctest text[17;20H[K[17;11H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c[\]][?25l[?1c[18;6H[?25h[?0c[?25l[?1ctext test text[18;20H[K[18;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c[y^][?25l[?1c[19;13H[?25h[?0c[?25l[?1cst text[19;20H[K[19;13H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c[$y][?25l[?1c[20;8H[?25h[?0c[?25l[?1cxt test text[20;20H[K[20;8H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c[\x61][?25l[?1c[21;7H[?25h[?0c[?25l[?1cext test text  x61[21;25H[K[21;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c[\x60-\x64][?25l[?1c[22;7H[?25h[?0c[?25l[?1cext test text  x60-x64[22;29H[K[22;7H[?25h[?0c[23;7H[?25l[?1c[25;1H[K[25;1H/[?25h[?0c[\x785][?25l[?1c[23;6H[?25h[?0c[?25l[?1ctext test text  x78 5[23;27H[K[23;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c[\o143][?25l[?1c[24;5H[?25h[?0c[?25l[?1c text test text  o143[24;26H[K[24;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c[\o140-\o144][?25l[?1c[1;24r[24;1H
[1;25r[24;1Htesdt text test text  o140-o144[25;1H[K[24;4H[?25h[?0c[?25l[?1ct text test text  o140-o14[24;31H[K[24;4H[?25h[?0c[?25l[?1c
/[?25h[?0c[\o417][?25l[?1c[1;24r[24;1H
[1;25r[24;1Htest7 text test text  o41 7[25;1H[K[24;5H[?25h[?0c[?25l[?1c text test text  o41 7[24;27H[K[24;5H[?25h[?0c[?25l[?1c
/[?25h[?0c\%x42[?25l[?1c[1;24r[24;1H
[1;25r[24;1Htest text tBest text  \%x42[25;1H[K[24;12H[?25h[?0c[?25l[?1cest text  \%x42[24;27H[K[24;12H[?25h[?0c[?25l[?1c
/[?25h[?0c\%o103[?25l[?1c[1;24r[24;1H
[1;25r[24;1Htest text teCst text  \%o103[25;1H[K[24;13H[?25h[?0c[?25l[?1cst text  \%o103[24;28H[K[24;13H[?25h[?0c[?25l[?1c
/[?25h[?0c[\x00][?25l[?1c[1;24r[24;1H
[1;25r[24;1Htest text [1m[34m^@[0mtest text  [\x00][25;1H[K[24;11H[?25h[?0c[?25l[?1ctest text  [\x00][24;28H[K[24;11H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Htest te[1m[34m^@[0mxt t[1m[34m^D[0mest t[1m[34m^P[0mext  [\x00-\x10][24;11H[?25h[?0c[?25l[?1c
:[?25h[?0cs/[\x00-\x10]//g[?25l[?1c3 substitutions on 1 line[24;8Hxt test text  [\x00-\x10][24;33H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Htest \xyztext test text  [\x-z][25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/[\x-z]\+//[?25l[?1c[24;6Htext test text  [\x-z][24;28H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Htest text tev\uyst text  [\u-z][25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/[\u-z]\{2,}//[?25l[?1c[24;13Hst text  [\u-z][24;28H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hxx aaaaa xx a[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/\(a\)\+//[?25l[?1c[24;4H xx [24;10H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hxx aaaaa xx a[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/\(a*\)\+//[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hxx aaaaa xx a[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/\(a*\)*//[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hxx aaaaa xx[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/\(a\)\{2,3}/A/[?25l[?1c[24;4HAaa xx[24;10H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hxx aaaaa xx[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/\(a\)\{-2,3}/A/[?25l[?1c[24;4HAaaa x[24;11H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hxx aaa12aa xx[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/\(a\)*\(12\)\@>/A/[?25l[?1c[24;4HAaa xx[24;10H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hxx foobar xbar xx[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/\(foo\)\@<!bar/A/[?25l[?1c[24;12HA xx[24;16H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hxx an file xx[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/\(an\_s\+\)\@<=file/A/[?25l[?1c[24;7HA xx[24;12H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hx= 9;[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/^\(\h\w*\%(->\|\.\)\=\)\+=/XX/[?25l[?1c[24;1HXX[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hhh= 77;[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/^\(\h\w*\%(->\|\.\)\=\)\+=/YY/[?25l[?1c[24;1HYY 77;[24;7H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;2Haaa[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/aaa/xyz/[?25l[?1c[24;2Hxyz [?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;2Hxyz[25;1H[K[24;2H[?25h[?0c[?25l[?1c
:[?25h[?0cs/~/bcd/[?25l[?1c[24;2Hbcd [?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;2Hbcdbcdbcd[25;1H[K[24;2H[?25h[?0c[?25l[?1c
:[?25h[?0cs/~\+/BB/[?25l[?1c[24;2HBB[24;4H[K[24;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c?start?,$w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New] 32L, 586C written[24;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test25.failed test.ok test.out X* viminfo
cp test25.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test25.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test25.in" 31 lines, 840 characters[1;1HTest for jumping to a tag with 'hidden' set, with symbolic link in path of tag.
This only works for Unix, because of the symbolic link.

STARTTEST
:so small.vim
:set hidden
:" Create a link from test25.dir to the current directory.
:!rm -f test25.dir
:!ln -s . test25.dir
:" Create tags.text, with the current directory name inserted.
/tags line
:r !pwd
d$/test
hP:.w! tags.test
:" Try jumping to a tag in the current file, but with a path that contains a
:" symbolic link.  When wrong, this will give the ATTENTION message.  The next
:" space will then be eaten by hit-return, instead of moving the cursor to 'd'.
:set tags=tags.test
G[1m[34m^][0m x:.w! test.out
:!rm -f test25.dir tags.test
:qa!
ENDTEST

tags line:[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for jumping to a tag with 'hidden' set, with symbolic link in path of tag.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[4;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 17 lines, 540 characters written[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[22;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset hidden[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Create a link from test25.dir to the current directory.[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c!rm -f test25.dir[?25l[?1c[18C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c!ln -s . test25.dir[?25l[?1c[20C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c" Create tags.text, with the current directory name inserted.[?25l[?1c[27m[24m[0m[H[J[1;1HTest for jumping to a tag with 'hidden' set, with symbolic link in path of tag.
This only works for Unix, because of the symbolic link.

STARTTEST
:so small.vim
:set hidden
:" Create a link from test25.dir to the current directory.
:!rm -f test25.dir
:!ln -s . test25.dir
:" Create tags.text, with the current directory name inserted.
/tags line
:r !pwd
d$/test
hP:.w! tags.test
:" Try jumping to a tag in the current file, but with a path that contains a
:" symbolic link.  When wrong, this will give the ATTENTION message.  The next
:" space will then be eaten by hit-return, instead of moving the cursor to 'd'.
:set tags=tags.test
G[1m[34m^][0m x:.w! test.out
:!rm -f test25.dir tags.test
:qa!
ENDTEST

tags line:[23;1H[?25h[?0c[?25l[?1c

/[?25h[?0ctags line[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cr !pwd[?25l[?1c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[1;1HThis only works for Unix, because of the symbolic link.

STARTTEST
:so small.vim
:set hidden
:" Create a link from test25.dir to the current directory.
:!rm -f test25.dir
:!ln -s . test25.dir
:" Create tags.text, with the current directory name inserted.
/tags line
:r !pwd
d$/test
hP:.w! tags.test
:" Try jumping to a tag in the current file, but with a path that contains a
:" symbolic link.  When wrong, this will give the ATTENTION message.  The next
:" space will then be eaten by hit-return, instead of moving the cursor to 'd'.
:set tags=tags.test
G[1m[34m^][0m x:.w! test.out
:!rm -f test25.dir tags.test
:qa!
ENDTEST

tags line:
/sources/vim74/src/testdir[?25h[?0c[?25l[?1c[24;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0ctest[?25l[?1c[1;24r[24;1H
[1;25r[24;1HSECTION_OFF     /test25.dir/test25.in   /^#define  SECTION_OFF  3$/[25;1H[K[24;18H[?25h[?0c[?25l[?1c/sources/vim74/src/testdir/test25.dir/test25.in /^#define  SECTI[24;1H[1m[34m@                                                                               [1;24r[0m[24;1H
[1;25r[23;1HSECTION_OFF     /sources/vim74/src/testdir/test25.dir/test25.in /^#define  SECTI[24;1HON_OFF  3$/[23;42H[?25h[?0c[?25l[?1c

:[?25h[?0c.w! tags.test[?25l[?1c"tags.test" [25;13H[K[25;13H[New File] 1 line, 88 characters written[23;42H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Try jumping to a tag in the current file, but with a path that contains a[?25l[?1c[23;42H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" symbolic link.  When wrong, this will give the ATTENTION message.  The next[?25l[?1c[23;42H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" space will then be eaten by hit-return, instead of moving the cursor to 'd'.[?25l[?1c[23;42H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset tags=tags.test[?25l[?1c[23;42H[?25h[?0c[?25l[?1c[1;24r[1;1H[6M[1;25r[20;1H/*tx.c*/
#define  SECTION_OFF  3
#define  NUM_SECTIONS 3

SECTION_OFF[25;1H[K[24;1H[?25h[?0c[21;1H#[?25l[?1cefine  SECTION_OFF  3[21;23H[K[21;2H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c.w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 1 line, 23 characters written[21;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c!rm -f test25.dir tags.test[?25l[?1c[28C[?25h[?0c[25;1H
[No write since last change]
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test26.failed test.ok test.out X* viminfo
cp test26.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test26.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test26.in" 44 lines, 750 characters[1;1HTest for :execute, :while and :if

STARTTEST
:so small.vim
mt:let i = 0
:while i < 12
:  let i = i + 1
:  if has("ebcdic")
:    execute "normal o" . i . "\047"
:  else
:    execute "normal o" . i . "\033"
:  endif
:  if i % 2
:    normal Ax[1m[34m^V^[[0m
:    if i == 9
:      break
:    endif
:    if i == 5
:      continue
:    else
:      let j = 9
:      while j > 0
:[8Cif has("ebcdic")
:[10Cexecute "normal" j . "a" . j . "\x27"[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for :execute, :while and :if[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 39 lines, 696 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[19M[1;25r[6;1H:[8Celse
:[10Cexecute "normal" j . "a" . j . "\x1b"
:[8Cendif
:[8Clet j = j - 1
:      endwhile
:    endif
:  endif
:  if i == 9
:    if has("ebcdic")
:      execute "normal Az\047"
:    else
:      execute "normal Az\033"
:    endif
:  endif
:endwhile
:unlet i j
:'t,$w! test.out
:qa!
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet i = 0[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwhile i < 12[?25l[?1c
:  [?25h[?0c:  let i = i + 1
[?25l[?1c:  [?25h[?0c:  if has("ebcdic")
[?25l[?1c:    [?25h[?0c:    execute "normal o" . i . "\047"
[?25l[?1c:    [?25h[?0c:  else
[?25l[?1c:    [?25h[?0c:    execute "normal o" . i . "\033"
[?25l[?1c:    [?25h[?0c:  endif
[?25l[?1c:  [?25h[?0c:  if i % 2
[?25l[?1c:    [?25h[?0c:    normal Ax^[1m[34m^[[0m
[?25l[?1c:    [?25h[?0c:    if i == 9
[?25l[?1c:      [?25h[?0c:      break
[?25l[?1c:      [?25h[?0c:    endif
[?25l[?1c:    [?25h[?0c:    if i == 5
[?25l[?1c:      [?25h[?0c:      continue
[?25l[?1c:      [?25h[?0c:    else
[?25l[?1c:      [?25h[?0c:      let j = 9
[?25l[?1c:      [?25h[?0c:      while j > 0
[?25l[?1c:[8C[?25h[?0c:        if has("ebcdic")
[?25l[?1c:[10C[?25h[?0c:          execute "normal" j . "a" . j . "\x27"
[?25l[?1c:[10C[?25h[?0c:        else
[?25l[?1c:[10C[?25h[?0c:          execute "normal" j . "a" . j . "\x1b"
[?25l[?1c:[10C[?25h[?0c:        endif
[?25l[?1c:[8C[?25h[?0c:        let j = j - 1
[?25l[?1c:[8C[?25h[?0c:      endwhile
[?25l[?1c:      [?25h[?0c:    endif
[?25l[?1c:    [?25h[?0c:  endif
[?25l[?1c:  [?25h[?0c:  if i == 9
[?25l[?1c:    [?25h[?0c:    if has("ebcdic")
[?25l[?1c:      [?25h[?0c:      execute "normal Az\047"
[?25l[?1c:      [?25h[?0c:    else
[?25l[?1c:      [?25h[?0c:      execute "normal Az\033"
[?25l[?1c:      [?25h[?0c:    endif
[?25l[?1c:    [?25h[?0c:  endif
[?25l[?1c:  [?25h[?0c:endwhile[27m[24m[0m[H[J[?25l[?1c[1;1H:    endif
:  endif
:  if i == 9
:    if has("ebcdic")
:      execute "normal Az\047"
:    else
:      execute "normal Az\033"
:    endif
:  endif
:endwhile
:unlet i j
:'t,$w! test.out
:qa!
ENDTEST

1x999999999888888887777777666666555554444333221
2
3x999999999888888887777777666666555554444333221
4
5x
6
7x999999999888888887777777666666555554444333221
8
9x[?25h[?0c[?25l[?1c
:[?25h[?0cunlet i j[?25l[?1c[24;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c't,$w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 10 lines, 159 characters written[24;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test27.failed test.ok test.out X* viminfo
cp test27.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test27.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test27.in" 20 lines, 270 characters[1;1HTest for expanding file names

STARTTEST
:!mkdir Xdir1
:!mkdir Xdir2
:!mkdir Xdir3
:cd Xdir3
:!mkdir Xdir4
:cd ..
:w Xdir1/file
:w Xdir3/Xdir4/file
:n Xdir?/*/file
Go[1m[34m^R[0m%[1m[34m^[[0m:.w! test.out
:n! Xdir?/*/nofile
Go[1m[34m^R[0m%[1m[34m^[[0m:.w >>test.out
:e! xx
:!rm -rf Xdir1 Xdir2 Xdir3
:qa!
ENDTEST

[1m[34m~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for expanding file names[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 15 lines, 220 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[19;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c!mkdir Xdir1[?25l[?1c[13C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c!mkdir Xdir2[?25l[?1c[13C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c!mkdir Xdir3[?25l[?1c[13C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccd Xdir3[?25l[?1c/sources/vim74/src/testdir/Xdir3
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c!mkdir Xdir4[?25l[?1c[13C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccd ..[?25l[?1c/sources/vim74/src/testdir
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw Xdir1/file[?25l[?1c"Xdir1/file" [New File] 20 lines, 270 characters written
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw Xdir3/Xdir4/file[?25l[?1c"Xdir3/Xdir4/file" [New File] 20 lines, 270 characters written
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cn Xdir?/*/file[?25l[?1c"Xdir3/Xdir4/file" 20 lines, 270 characters[27m[24m[0m[H[J[1;1HTest for expanding file names

STARTTEST
:!mkdir Xdir1
:!mkdir Xdir2
:!mkdir Xdir3
:cd Xdir3
:!mkdir Xdir4
:cd ..
:w Xdir1/file
:w Xdir3/Xdir4/file
:n Xdir?/*/file
Go[1m[34m^R[0m%[1m[34m^[[0m:.w! test.out
:n! Xdir?/*/nofile
Go[1m[34m^R[0m%[1m[34m^[[0m:.w >>test.out
:e! xx
:!rm -rf Xdir1 Xdir2 Xdir3
:qa!
ENDTEST

[1m[34m~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [0m[25;1H"Xdir3/Xdir4/file" 20 lines, 270 characters[1;1H[?25h[?0c[20;1H[?25l[?1c
Xdir3/Xdir4/file[21;17H[K[21;16H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 1 line, 17 characters written[21;16H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cn! Xdir?/*/nofile[?25l[?1c"Xdir?/*/nofile" [New DIRECTORY][1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m
Xdir?/*/nofile[2;15H[K[2;14H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 15 characters appended[2;14H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! xx[?25l[?1c"xx" [New File][2;1H[1m[34m~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c!rm -rf Xdir1 Xdir2 Xdir3[?25l[?1c[26C[?25h[?0c[25;1H
[25;1H
[1m[32mPress ENTER or type command to continue[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test28.failed test.ok test.out X* viminfo
cp test28.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test28.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test28.in" 23 lines, 364 characters[1;1HTest for sourcing a file with CTRL-V's at the end of the line

STARTTEST
:/firstline/+1,/lastline/-1w! Xtestfile
:so Xtestfile
Gmm__1[1m[34m^[^[[0m__2[1m[34m^[[0m__3[1m[34m^[^[[0m__4[1m[34m^[[0m__5[1m[34m^[[0m:'m,$s/[1m[34m^@[0m/0/g
:'m,$w! test.out
:qa!
ENDTEST

firstline
map __1 afirst
map __2 asecond
map __3 athird
map __4 afourth
map __5 afifth
map __1 asd[1m[34m^V[0m
map __2 asd[1m[34m^V^V[0m
map __3 asd[1m[34m^V^V[0m
map __4 asd[1m[34m^V^V^V[0m
map __5 asd[1m[34m^V^V^V[0m
lastline

[1m[34m~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for sourcing a file with CTRL-V's at the end of the line[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 5 lines, 114 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[9;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[10;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/firstline/+1,/lastline/-1w! Xtestfile[?25l[?1c"Xtestfile" [25;13H[K[25;13H[New File] 10 lines, 148 characters written[10;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso Xtestfile[?25l[?1c[10;1H[?25h[?0c[23;1H[24;12H[?25l[?1c[23;1Hsd
map __2 asd[1m[34m^[[0m[24;14H[K[24;12H[?25h[?0c[?25l[?1c[2Csecond[?25h[?0cd  [?25l[?1csd[1m[34m^[[?25h[?0c^[[0m  [13C[?25l[?1c[24;24Hsd[1m[34m^@[0mmap __5 asd[1m[34m^@[?25h[?0c[?25l[?1c[0m[2Cfifth[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c'm,$s/[1m[34m^@[0m/0/g[?25l[?1c[24;26H0map __5 asd0fifth[24;44H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c'm,$w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 2 lines, 45 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test29.failed test.ok test.out X* viminfo
cp test29.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test29.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test29.in" 230 lines, 4222 characters[1;1HTest for joining lines and marks in them
 in compatible and nocompatible modes
 and with 'joinspaces' set or not
 and with 'cpoptions' flag 'j' set or not

STARTTEST
:so small.vim
:set nocompatible viminfo+=nviminfo
:set nojoinspaces
:set cpoptions-=j
/firstline/
j"td/^STARTTEST/-1
PJjJjJjJjJjJjJjJjJjJjJjJjJjJj05lmx2j06lmy2k4Jy3l$p`xyl$p`yy2l$p:set cpoptions+=j[14;1Hj05lmx2j06lmy2k4Jy3l$p`xyl$p`yy2l$p:set cpoptions-=j joinspaces
j"tpJjJjJjJjJjJjJjJjJjJjJjJjJjJj05lmx2j06lmy2k4Jy3l$p`xyl$p`yy2l$p:set cpoptions[16;1H+=j
j05lmx2j06lmy2k4Jy3l$p`xyl$p`yy2l$p:set cpoptions-=j nojoinspaces compatible
j"tpJjJjJjJjJjJjJjJjJjJjJjJjJjJj4Jy3l$pjd/STARTTEST/-2
ENDTEST

firstline
asdfasdf.
asdf
asdfasdf.[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for joining lines and marks in them[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[6;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 11 lines, 478 characters written[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[7;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[19;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nocompatible viminfo+=nviminfo[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nojoinspaces[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpoptions-=j[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cfirstline/[?25l[?1c[25;11H[K[25;1H[21;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^STARTTEST/-1[?25l[?1c[12C+-137 fewer lines[25;15H[K[22;1HSTARTTEST
/^{/+1
:set comments=s1:/*,mb:*,ex:*/,://[22;1H[?25h[?0c[?25l[?1c[25;4Hmore lines[25;14H[K[22;1Hasdfasdf.
asdf[23;5H[K[24;1Hasdfasdf. [24;11H[K[22;1H[?25h[?0c[?25l[?1c[10Casdf
asdfasdf.[24;5H[K[22;10H[?25h[?0c[23;10H[?25l[?1c asdf
asdfasdf.[23;11H[?25h[?0c[24;11H[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf.[25;1H[K[24;16H[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf.      [?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf.[7C[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf.[14C[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf[?25h[?0c[?25l[?1cf asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf [?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf[7C[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf[8C[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf[7C[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf[15C[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hzx cvn.[?25h[?0czx cv[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Has dfg?
hjkl iop![?25h[?0chjkl i[22;7H[?25l[?1c. as dfg? hjkl iop! ert
zx cvn.
as dfg?[24;8H[K[22;26H[?25h[?0c er[?25l[?1ct er[?25h[?0czx cv[26C[?25l[?1crn[?25h[?0c[22;23H[10C[?25l[?1cnop[?25h[?0c[?25l[?1c


:[?25h[?0cset cpoptions+=j[?25l[?1c[22;35H[?25h[?0c[23;7Hzx cv[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hhjkl iop!
ert[25;1H[K[23;6H[?25h[?0chjkl i[21;7H[?25l[?1c. as dfg? hjkl iop! ert[22;1H[K[23;1HSTARTTEST
/^{/+1[21;26H[?25h[?0c er[?25l[?1ct er[?25h[?0czx cv[26C[?25l[?1crn[?25h[?0c[21;23H[10C[?25l[?1cnop[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset cpoptions-=j joinspaces[?25l[?1c[21;35H[?25h[?0c
[?25l[?1c


37 more lines[25;14H[K[23;1Hasdfasdf.
asdf[24;5H[K[23;1H[?25h[?0c[?25l[?1c[11Casdf
asdfasdf.[23;10H[?25h[?0c[24;10H[?25l[?1c  asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf.[25;1H[K[24;11H[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf.      [?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf.      [?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf.[7C[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf.[14C[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf[?25h[?0c[?25l[?1cf asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf [?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf[7C[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf[8C[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf[7C[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf[15C[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hzx cvn.[?25h[?0czx cv[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Has dfg?
hjkl iop![?25h[?0chjkl i[22;7H[?25l[?1c.  as dfg?  hjkl iop!  ert
zx cvn.
as dfg?[24;8H[K[22;28H[?25h[?0c  er[?25l[?1ct  e[?25h[?0czx cv[29C[?25l[?1cen[?25h[?0c[22;25H[11C[?25l[?1cnop[?25h[?0c[?25l[?1c


:[?25h[?0cset cpoptions+=j[?25l[?1c[22;38H[?25h[?0c[23;7Hzx cv[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hhjkl iop![25;1H[K[24;6H[?25h[?0chjkl i[22;7H[?25l[?1c.  as dfg? hjkl iop! ert[23;1H[K[24;1HSTARTTEST[22;27H[?25h[?0c er[?25l[?1ct er[?25h[?0czx cv[27C[?25l[?1crn[?25h[?0c[22;24H[10C[?25l[?1cnop[?25h[?0c[?25l[?1c


:[?25h[?0cset cpoptions-=j nojoinspaces compatible[?25l[?1c[22;36H[?25h[?0c
[?25l[?1c

37 more lines[25;14H[K[24;1Hasdfasdf.[?25h[?0c[?25l[?1c[11Casdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf.[25;1H[K[24;10H[?25h[?0c[?25l[?1c  asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf. [?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf.      [?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf.      [?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf.[7C[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf.[14C[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf[?25h[?0c[?25l[?1cf asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf [?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf[7C[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf[8C[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf[7C[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hasdfasdf[15C[?25h[?0c[?25l[?1c asdf[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hzx cvn.[?25h[?0c[?25l[?1c.  as dfg? hjkl iop! ert[24;8H[?25h[?0c[22C[?25l[?1ct  a[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hzx cvn.[?25h[?0c[?25l[?1c
/[?25h[?0cSTARTTEST/-2[?25l[?1c[11C+-24 fewer lines[25;14H[K[24;1H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[1;24r[24;1H
[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H/^{/+1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H12 lines, 147 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[12M[1;25r[13;1H:set comments=s1:/*,mb:*,ex:*/,://
:set nojoinspaces fo=j
:set backspace=eol,start
:.,+3join
j4J
:.,+2join
j3J
:.,+2join
j3J
:.,+2join
jj3J
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^{/+1[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1H{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset comments=s1:/*,mb:*,ex:*/,://[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nojoinspaces fo=j[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset backspace=eol,start[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.,+3join[?25l[?1c[24;1H/* Make sure the previous comment leader is not removed. */[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[25;1H[K[24;1H[?25h[?0c[?25l[?1c/* Make sure the previous comment leader is not removed. */[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c.,+2join[?25l[?1c[24;1H// Should the next comment leader be left alone? Yes.[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[25;1H[K[24;1H[?25h[?0c[?25l[?1c// Should the next comment leader be left alone? Yes.[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c.,+2join[?25l[?1c[24;1H/* Here the comment leader should be left intact. */ // And so should this one.[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[25;1H[K[24;1H[?25h[?0c[?25l[?1c/* Here the comment leader should be left intact. */ // And so should this one.[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c.,+2join[?25l[?1c[24;1Hif (condition) // Remove the next comment leader! OK, I will.[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Haction();[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1cif (condition) // Remove the next comment leader! OK, I will.[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Haction();[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[3M[1;25r[22;1H}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:" Test with backspace set to the non-compatible setting[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H17 lines, 308 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:inoremap <c-u> <left><c-u>
Avim3[1m[34m^U^[[0m
:iunmap <c-u>
Avim4[1m[34m^U^U^[[0m
:" Test with backspace set to the compatible setting
:set bs=
A vim5[1m[34m^[[0mA[1m[34m^U^U^[[0m
A vim6[1m[34m^[[0mAzwei[1m[34m^G[0mu[1m[34m^U^[[0m
:inoremap <c-u> <left><c-u>
A vim7[1m[34m^U^U^[[0m
:set cp
ENDTEST
1 this shouldn't be deleted
2 this shouldn't be deleted
3 this shouldn't be deleted
4 this should be deleted
5 this shouldn't be deleted
6 this shouldn't be deleted
7 this shouldn't be deleted
8 this shouldn't be deleted (not touched yet)

STARTTEST
/^{/+1
:set comments=sO:*\ -,mO:*\ \ ,exO:*/[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test with backspace set to the non-compatible setting[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^\d\+ this[?25l[?1c[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp bs=2[?25l[?1c[14;1H[?25h[?0c[?25l[?1c[26C[?25h[?0c[15;27Hd    [?25l[?1cvim2[?25h[?0c[?25l[?1c[15;28H[K[15;27H[?25h[?0c[16;24H[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpo-=<[?25l[?1c[16;24H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cinoremap <c-u> <left><c-u>[?25l[?1c[16;24H[?25h[?0c[?25l[?1cd3[?25h[?0c[17;24H[?25l[?1c[25;1H[K[25;1H:[?25h[?0ciunmap <c-u>[?25l[?1c[17;24H[?25h[?0c[?25l[?1c[17;1H[K[17;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test with backspace set to the compatible setting[?25l[?1c[18;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset bs=[?25l[?1c[18;1H[?25h[?0c[?25l[?1c[28Cvim5[?25h[?0c[19;27H[?25l[?1cd vim6[?25h[?0c6    [?25l[?1czwei[?25h[?0c[?25l[?1c[19;33H[K[19;32H[?25h[?0c[20;32H[?25l[?1c[25;1H[K[25;1H:[?25h[?0cinoremap <c-u> <left><c-u>[?25l[?1c[20;32H[?25h[?0c[?25l[?1c[15Cvim7[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[21;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[22;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H21 lines, 356 characters written[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[23;1H[?25h[?0c[?25l[?1c

/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1Hj3J
:.,+2join
j3J
:.,+2join
jj3J
j:.,+2join
jj3J
j:.,+5join
j6J
oSome code![1m[34m^M[0m// Make sure backspacing does not remove this comment leader.[1m[34m^[[0m0i[1m[34m^H[11;1H^[[0m
ENDTEST

{

/*
 * Make sure the previous comment leader is not removed.
 */

/*
 * Make sure the previous comment leader is not removed.
 */

/* List:[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^{/+1[?25l[?1c[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset comments=sO:*\ -,mO:*\ \ ,exO:*/[?25l[?1c[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset comments+=s1:/*,mb:*,ex:*/,://[?25l[?1c[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset comments+=s1:>#,mb:#,ex:#<,:<[?25l[?1c[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpoptions-=j joinspaces fo=j[?25l[?1c[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset backspace=eol,start[?25l[?1c[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.,+3join[?25l[?1c[15;24r[15;1H[3M[1;25r[15;1H/* Make sure the previous comment leader is not removed.  */[22;2H* - item1
 *   foo bar baz
 *   foo bar baz[25;1H[K[15;1H[?25h[?0c
[?25l[?1c[16;24r[16;1H[3M[1;25r[16;1H/* Make sure the previous comment leader is not removed.  */[22;2H* - item2
 *   foo bar baz
 *   foo bar baz[16;1H[?25h[?0c
[?25l[?1c[25;1H:[?25h[?0c.,+8join[?25l[?1c[17;1H/* List: item1 foo bar baz foo bar baz item2 foo bar baz foo bar baz */[18;1H[K[19;1H/* List:[19;9H[K[20;4H- item1[20;11H[K[22;4H  foo bar baz
 * - item2[23;11H[K[17;1H[?25h[?0c
[?25l[?1c/* List: item1 foo bar baz foo bar baz item2 foo bar baz foo bar baz */[19;1H[K[20;1H// Should the next comment leader be left alone?
// Yes.[21;8H[K[22;2H[K[23;1H// Should the next comment leader be left alone?
// Yes.[24;8H[K[18;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.,+2join[?25l[?1c[19;24r[19;1H[2M[1;25r[19;4HShould the next comment leader be left alone?  Yes.[24;1H/* Here the comment leader should be left intact. */[25;1H[K[19;1H[?25h[?0c
[?25l[?1c[20;24r[20;1H[2M[1;25r[20;4HShould the next comment leader be left alone?  Yes.


// And so should this one.[20;1H[?25h[?0c
[?25l[?1c[25;1H:[?25h[?0c.,+2join[?25l[?1c[21;1H/* Here the comment leader should be left intact. */ // And so should this one.[22;1H[K[23;2H* Here the comment leader should be left intact. */
// And so should this one.[21;1H[?25h[?0c
[?25l[?1c/* Here the comment leader should be left intact. */ // And so should this one.[23;1H[K[24;1Hif (condition) // Remove the next comment leader![22;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.,+2join[?25l[?1c[23;1Hif (condition) // Remove the next comment leader!  OK, I will.
    action();[24;14H[K[23;1H[?25h[?0c
[?25l[?1c[1;24r[24;1H
[1;25r[25;1H[K[24;1H[?25h[?0c[?25l[?1cif (condition) // Remove the next comment leader!  OK, I will.[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Haction();[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c.,+2join[?25l[?1c[24;1Hint i = 7 /* foo *// 3 // comment[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;2H;[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1cint i = 7 /* foo *// 3 // comment[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;2H;[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c.,+5join[?25l[?1c[24;1H># Note that the last character of the ending comment leader (left angle bracket[24;1H[1m[34m@                                                                               [1;24r[0m[1;1H[4M[1;25r[20;1H># Note that the last character of the ending comment leader (left angle bracket[21;1H) is a comment leader itself. Make sure that this comment leader is not removed
from the next line #< < On this line a new comment is opened which spans 2 lines[23;1H. This comment should retain its comment leader.[25;1H[K[20;1H[?25h[?0c[24;1H[?25l[?1c># Note that the last character of the ending comment leader (left angle bracket[24;1H[1m[34m@                                                                               [1;24r[0m[1;1H[3M[1;25r[21;1H># Note that the last character of the ending comment leader (left angle bracket[22;1H) is a comment leader itself. Make sure that this comment leader is not removed
from the next line #< < On this line a new comment is opened which spans 2 lines[24;1H. This comment should retain its comment leader.[21;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1HSome code!
// Make sure backspacing does not remove this comment leader.[?25h[?0c[?25l[?1c[23;11H// Make sure backspacing does not remove this comment leader.
}[24;2H[K[23;10H[?25h[?0c
[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:g/^STARTTEST/.,/^ENDTEST/d[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3 lines, 61 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[24;19H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:?firstline?+1,$w! test.out[25;1H[K[24;19H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cg/^STARTTEST/.,/^ENDTEST/d[?25l[?1c74 fewer lines[25;15H[K[1;2H/ Should the next comment leader[9Calone?  Yes.[1;55H[K[2;1H// Should the next comment leader be left alone?  Yes.[2;56H[K[3;1H/* Here the comment leader should be left intact. */ // And so should this one.
/* Here the comment leader should be left intact. */ // And so should this one.
if (condition) // Remove the next comment leader!  OK, I will.
    action();[6;14H[K[7;1Hif (condition) // Remove the next comment leader!  OK, I will.
    action();[8;14H[K[9;1Hint i = 7 /* foo *// 3 // comment
 ;[10;4H[K[11;1Hint i = 7 /* foo *// 3 // comment[11;34H[K[12;1H ;[12;3H[K[13;1H># Note that the last character of the ending comment leader (left angle bracket[14;1H) is a comment leader itself. Make sure that this comment leader is not removed [15;1Hfrom the next line #< < On this line a new comment is opened which spans 2 lines[16;1H. This comment should retain its comment leader.[16;49H[K[17;1H># Note that the last character of the ending comment leader (left angle bracket[18;1H) is a comment leader itself. Make sure that this comment leader is not removed
from the next line #< < On this line a new comment is opened which spans 2 lines[20;1H. This comment should retain its comment leader.

Some code!// Make sure backspacing does not remove this comment leader.
}[23;2H[K[24;1H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c?firstline?+1,$w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 97 lines, 3018 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test30.failed test.ok test.out X* viminfo
cp test30.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test30.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test30.in" 222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option

Note: This test will fail if "cat" is not available.

STARTTEST
:so small.vim
:" first write three test files, one in each format
:set fileformat=unix
:set fileformats=
:/^1/w! XX1
:/^2/w! XX2
:/^3/w! XX3
:/^4/w! XX4
:/^5/w! XX5
:/^6/w! XX6
:/^7/w! XX7
:/^8/w! XX8
:/^9/w! XX9
:/^10/w! XX10
:/^unix/;/eof/-1w! XXUnix
:/^dos/;/eof/-1w! XXDos
:set bin noeol
:$w! XXMac
:set nobin eol[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for a lot of variations of the 'fileformats' option[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[5;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 195 lines, 3271 characters written[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[6;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:$r XXtt62
:$r XXtt63
Go7[1m[34m^[[0m:$r XXtt71
Go8[1m[34m^[[0m:$r XXtt81
Go9[1m[34m^[[0m:$r XXtt91
:$r XXtt92
:$r XXtt93
Go10[1m[34m^[[0m:$r XXUnix
:set nobinary ff&
:w
:qa!
ENDTEST

1
2
3
4
5
6
7
8
9
10[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" first write three test files, one in each format[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileformat=unix[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileformats=[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^1/w! XX1[?25l[?1c"XX1" [25;7H[K[25;7H[New File] 1 line, 2 characters written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^2/w! XX2[?25l[?1c"XX2" [25;7H[K[25;7H[New File] 1 line, 2 characters written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^3/w! XX3[?25l[?1c"XX3" [25;7H[K[25;7H[New File] 1 line, 2 characters written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^4/w! XX4[?25l[?1c"XX4" [25;7H[K[25;7H[New File] 1 line, 2 characters written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^5/w! XX5[?25l[?1c"XX5" [25;7H[K[25;7H[New File] 1 line, 2 characters written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^6/w! XX6[?25l[?1c"XX6" [25;7H[K[25;7H[New File] 1 line, 2 characters written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^7/w! XX7[?25l[?1c"XX7" [25;7H[K[25;7H[New File] 1 line, 2 characters written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^8/w! XX8[?25l[?1c"XX8" [25;7H[K[25;7H[New File] 1 line, 2 characters written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^9/w! XX9[?25l[?1c"XX9" [25;7H[K[25;7H[New File] 1 line, 2 characters written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^10/w! XX10[?25l[?1c"XX10" [25;8H[K[25;8H[New File] 1 line, 3 characters written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^unix/;/eof/-1w! XXUnix[?25l[?1c"XXUnix" [25;10H[K[25;10H[New File] 2 lines, 10 characters written[1;24r[24;1H
[1;25r[24;1Hunix[25;1H[K[25;1H"XXUnix" [New File] 2 lines, 10 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^dos/;/eof/-1w! XXDos[?25l[?1c"XXDos" [25;9H[K[25;9H[New File] 2 lines, 10 characters written[1;24r[1;1H[4M[1;25r[21;1Hunix
eof

dos[1m[34m^M[0m[25;1H[K[25;1H"XXDos" [New File] 2 lines, 10 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset bin noeol[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$w! XXMac[?25l[?1c"XXMac" [25;9H[K[25;9H[New File][Incomplete last line] 1 line, 8 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nobin eol[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe XXUnix XXDos XXMac[?25l[?1c3 buffers wiped out[25;21H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" create mixed format files[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif has("vms")[?25l[?1c
:  [?25h[?0c: !copy XXUnix,XXDos XXUxDs.
[?25l[?1c:  [?25h[?0c: !copy XXUnix,XXMac XXUxMac.
[?25l[?1c:  [?25h[?0c: !copy XXDos,XXMac  XXDosMac.
[?25l[?1c:  [?25h[?0c: !copy XXUnix,XXDos,XXMac XXUxDsMc.
[?25l[?1c:  [?25h[?0c:elseif has("win32")
[?25l[?1c:  [?25h[?0c: !copy /b XXUnix+XXDos XXUxDs
[?25l[?1c:  [?25h[?0c: !copy /b XXUnix+XXMac XXUxMac
[?25l[?1c:  [?25h[?0c: !copy /b XXDos+XXMac XXDosMac
[?25l[?1c:  [?25h[?0c: !copy /b XXUnix+XXDos+XXMac XXUxDsMc
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c: !cat XXUnix XXDos >XXUxDs
[?25l[?1c:!cat XXUnix XXDos >XXUxDs[?25h[?0c[25;1H
[?25l[?1c[25;1H:  [?25h[?0c: !cat XXUnix XXMac >XXUxMac
[?25l[?1c:!cat XXUnix XXMac >XXUxMac[?25h[?0c[25;1H
[?25l[?1c[25;1H:  [?25h[?0c: !cat XXDos XXMac >XXDosMac
[?25l[?1c:!cat XXDos XXMac >XXDosMac[?25h[?0c[25;1H
[?25l[?1c[25;1H:  [?25h[?0c: !cat XXUnix XXDos XXMac >XXUxDsMc
[?25l[?1c:!cat XXUnix XXDos XXMac >XXUxDsMc[?25h[?0c[25;1H
[?25l[?1c[25;1H:  [?25h[?0c:endif[27m[24m[0m[H[J[?25l[?1c[1;1H:$r XXtt92
:$r XXtt93
Go10[1m[34m^[[0m:$r XXUnix
:set nobinary ff&
:w
:qa!
ENDTEST

1
2
3
4
5
6
7
8
9
10

unix
unix
eof

dos[1m[34m^M[?25h[?0c[?25l[?1c
[0m:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" try reading and writing with 'fileformats' empty[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileformat=unix[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXUnix[?25l[?1c"XXUnix" [25;10H[K[25;10H2 lines, 10 characters[1;1Hunix[1;5H[K[2;1Hunix[2;5H[K[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 2 lines, 10 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXDos[?25l[?1c"XXDos" [25;9H[K[25;9H2 lines, 10 characters[1;1Hdos[1m[34m^M[0m
dos[1m[34m^M[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! XXtt01[?25l[?1c"XXtt01" [25;10H[K[25;10H[New File] 2 lines, 10 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXMac[?25l[?1c"XXMac" [25;9H[K[25;9H[Incomplete last line] 1 line, 8 characters[1;1Hmac[2Cmac[1m[34m^M
~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! XXtt02[?25l[?1c"XXtt02" [25;10H[K[25;10H[New File] 1 line, 9 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe XXUnix XXDos XXMac[?25l[?1c"test30.in" [25;13H[K[25;13H222 lines, 3463 characters
3 buffers wiped out
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset fileformat=dos[?25l[?1c[1;1H[2L[1;1H:w
:qa!
ENDTEST[3;8H[K[4;1H[K[5;1H1[5;2H[K[6;1H2[6;2H[K[7;1H3[7;2H[K[8;1H4[8;2H[K[9;1H5[9;2H[K[10;1H6[10;2H[K[11;1H7[11;2H[K[12;1H8[12;2H[K[13;1H9[13;2H[K[14;1H10[14;3H[K[15;1H[K[16;1Hunix[16;5H[K[17;1Hunix[17;5H[K[18;1Heof[18;4H[K[19;1H[K[20;1Hdos[1m[34m^M[0m[20;6H[K[21;1Hdos[1m[34m^M[0m[21;6H[K[22;1Heof[22;4H[K[23;1H[K[24;1Hmac[1m[34m^M[0mmac[1m[34m^M[0m[24;11H[K[25;1H[K[20;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ce! XXUnix[?25l[?1c"XXUnix" [25;10H[K[25;10H[CR missing][dos format] 2 lines, 10 characters[1;1Hunix
unix
[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! XXtt11[?25l[?1c"XXtt11" [25;10H[K[25;10H[New File][dos format] 2 lines, 12 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXDos[?25l[?1c"XXDos" [25;9H[K[25;9H[dos format] 2 lines, 10 characters[1;1Hdos[1;4H[K[2;1Hdos[2;4H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! XXtt12[?25l[?1c"XXtt12" [25;10H[K[25;10H[New File][dos format] 2 lines, 10 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXMac[?25l[?1c"XXMac" [25;9H[K[25;9H[Incomplete last line][dos format] 1 line, 8 characters[1;1Hmac[1m[34m^M[0mmac[1m[34m^M
~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! XXtt13[?25l[?1c"XXtt13" [25;10H[K[25;10H[New File][dos format] 1 line, 10 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe XXUnix XXDos XXMac[?25l[?1c"test30.in" [25;13H[K[25;13H[CR missing][dos format] 222 lines, 3463 characters
3 buffers wiped out
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset fileformat=mac[?25l[?1c[1;1H[2L[1;1H:w
:qa!
ENDTEST[3;8H[K[4;1H[K[5;1H1[5;2H[K[6;1H2[6;2H[K[7;1H3[7;2H[K[8;1H4[8;2H[K[9;1H5[9;2H[K[10;1H6[10;2H[K[11;1H7[11;2H[K[12;1H8[12;2H[K[13;1H9[13;2H[K[14;1H10[14;3H[K[15;1H[K[16;1Hunix[16;5H[K[17;1Hunix[17;5H[K[18;1Heof[18;4H[K[19;1H[K[20;1Hdos[20;4H[K[21;1Hdos[21;4H[K[22;1Heof[22;4H[K[23;1H[K[24;1Hmac[1m[34m^J[0mmac[24;9H[K[25;1H[K[20;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ce! XXUnix[?25l[?1c"XXUnix" [25;10H[K[25;10H[Incomplete last line][mac format] 1 line, 10 characters[1;1Hunix[1m[34m^J[0munix[1m[34m^J
~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! XXtt21[?25l[?1c"XXtt21" [25;10H[K[25;10H[New File][mac format] 1 line, 11 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXDos[?25l[?1c"XXDos" [25;9H[K[25;9H[Incomplete last line][mac format] 3 lines, 10 characters[1;1Hdos[1;4H[K[2;1H[1m[34m^J[0mdos[2;6H[K[3;1H[1m[34m^J[0m[3;3H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! XXtt22[?25l[?1c"XXtt22" [25;10H[K[25;10H[New File][mac format] 3 lines, 11 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXMac[?25l[?1c"XXMac" [25;9H[K[25;9H[mac format] 2 lines, 8 characters[1;1Hmac
mac[2;4H[K[3;1H[1m[34m~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! XXtt23[?25l[?1c"XXtt23" [25;10H[K[25;10H[New File][mac format] 2 lines, 8 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe XXUnix XXDos XXMac[?25l[?1c"test30.in" [25;13H[K[25;13H[Incomplete last line][mac format] 5 lines, 3463 characters
3 buffers wiped out
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[2L[1;1H[1m[34m^J[0mdos
[1m[34m^J[0meof[1m[34m^J^J[0mmac
mac[3;4H[K[4;1H[1m[34m^J[0m[4;3H[K[25;1H[K[4;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c" try reading and writing with 'fileformats' set to one format[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileformats=unix[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXUxDsMc[?25l[?1c"XXUxDsMc" [25;12H[K[25;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;5H[K[2;1Hunix[2;5H[K[3;1Hdos[1m[34m^M[0m
dos[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M[0m[5;11H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! XXtt31[?25l[?1c"XXtt31" [25;10H[K[25;10H[New File] 5 lines, 29 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe XXUxDsMc[?25l[?1c"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileformats=dos[?25l[?1c[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXUxDsMc[?25l[?1c"XXUxDsMc" [25;12H[K[25;12H[Incomplete last line][CR missing][dos format] 5 lines, 28 character
[24;80Hs[25;1H
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! XXtt32[?25l[?1c"XXtt32" [25;10H[K[25;10H[New File][dos format] 5 lines, 32 characters written
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cbwipe XXUxDsMc[?25l[?1c"test30.in" [25;13H[K[25;13H[CR missing][dos format] 222 lines, 3463 characters[1;1H[3L[1;1HTest for a lot of variations of the 'fileformats' option

Note: This test will fail if "cat" is not available.[25;1H[K[25;1H"test30.in" [CR missing][dos format] 222 lines, 3463 characters[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileformats=mac[?25l[?1c[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXUxDsMc[?25l[?1c"XXUxDsMc" [25;12H[K[25;12H[mac format] 4 lines, 28 characters[1;1Hunix[1m[34m^J[0munix[1m[34m^J[0mdos[1;16H[K[2;1H[1m[34m^J[0mdos
[1m[34m^J[0mmac[3;7H[K[4;1Hmac
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! XXtt33[?25l[?1c"XXtt33" [25;10H[K[25;10H[New File][mac format] 4 lines, 28 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe XXUxDsMc[?25l[?1c"test30.in" [25;13H[K[25;13H[Incomplete last line][mac format] 5 lines, 3463 characters[1;1H[1m[34m^J[0mdos[1;6H[K[2;3Heof[1m[34m^J^J[0mmac
mac[3;4H[K[4;1H[1m[34m^J[0m[4;3H[K[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" try reading and writing with 'fileformats' set to two formats[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileformats=unix,dos[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXUxDsMc[?25l[?1c"XXUxDsMc" [25;12H[K[25;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;5H[K[2;1Hunix[2;5H[K[3;1Hdos[1m[34m^M[0m
dos[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M[0m[5;11H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! XXtt41[?25l[?1c"XXtt41" [25;10H[K[25;10H[New File] 5 lines, 29 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe XXUxDsMc[?25l[?1c"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXUxMac[?25l[?1c"XXUxMac" [25;11H[K[25;11H[Incomplete last line] 3 lines, 18 characters[1;1Hunix[1;6H[K[2;1Hunix
mac[1m[34m^M[0mmac[1m[34m^M[0m[3;12H[K[4;1H[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! XXtt42[?25l[?1c"XXtt42" [25;10H[K[25;10H[New File] 3 lines, 19 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe XXUxMac[?25l[?1c"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXDosMac[?25l[?1c"XXDosMac" [25;12H[K[25;12H[Incomplete last line][dos format] 3 lines, 18 characters[1;1Hdo[1;4H[K[2;1Hdos
mac[1m[34m^M[0mmac[1m[34m^M[0m[3;12H[K[4;1H[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! XXtt43[?25l[?1c"XXtt43" [25;10H[K[25;10H[New File][dos format] 3 lines, 20 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe XXDosMac[?25l[?1c"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileformats=unix,mac[?25l[?1c[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXUxDs[?25l[?1c"XXUxDs" [25;10H[K[25;10H4 lines, 20 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[1m[34m^M[0m[3;7H[K[4;1Hdos[1m[34m^M
~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! XXtt51[?25l[?1c"XXtt51" [25;10H[K[25;10H[New File] 4 lines, 20 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe XXUxDs[?25l[?1c"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXUxDsMc[?25l[?1c"XXUxDsMc" [25;12H[K[25;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[1m[34m^M[0m[3;7H[K[4;1Hdos[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M
~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! XXtt52[?25l[?1c"XXtt52" [25;10H[K[25;10H[New File] 5 lines, 29 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe XXUxDsMc[?25l[?1c"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXDosMac[?25l[?1c"XXDosMac" [25;12H[K[25;12H[mac format] 4 lines, 18 characters[1;1Hdo[1;4H[K[2;1H[1m[34m^J[0mdos
[1m[34m^J[0mmac[3;7H[K[4;1Hmac
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! XXtt53[?25l[?1c"XXtt53" [25;10H[K[25;10H[New File][mac format] 4 lines, 18 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe XXDosMac[?25l[?1c"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileformats=dos,mac[?25l[?1c[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXUxDs[?25l[?1c"XXUxDs" [25;10H[K[25;10H[CR missing][dos format] 4 lines, 20 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[3;4H[K[4;1Hdos
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! XXtt61[?25l[?1c"XXtt61" [25;10H[K[25;10H[New File][dos format] 4 lines, 22 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe XXUxDs[?25l[?1c"test30.in" [25;13H[K[25;13H[CR missing][dos format] 222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXUxMac[?25l[?1c"XXUxMac" [25;11H[K[25;11H[Incomplete last line][CR missing][dos format] 3 lines, 18 characters[1;1Hunix[1;6H[K[2;1Hunix
mac[1m[34m^M[0mmac[1m[34m^M[0m[3;12H[K[4;1H[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! XXtt62[?25l[?1c"XXtt62" [25;10H[K[25;10H[New File][dos format] 3 lines, 22 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe XXUxMac[?25l[?1c"test30.in" [25;13H[K[25;13H[CR missing][dos format] 222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXUxDsMc[?25l[?1c"XXUxDsMc" [25;12H[K[25;12H[Incomplete last line][CR missing][dos format] 5 lines, 28 character
[24;80Hs[25;1H
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! XXtt63[?25l[?1c"XXtt63" [25;10H[K[25;10H[New File][dos format] 5 lines, 32 characters written
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cbwipe XXUxDsMc[?25l[?1c"test30.in" [25;13H[K[25;13H[CR missing][dos format] 222 lines, 3463 characters[1;1H[3L[1;1HTest for a lot of variations of the 'fileformats' option

Note: This test will fail if "cat" is not available.[25;1H[K[25;1H"test30.in" [CR missing][dos format] 222 lines, 3463 characters[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" try reading and writing with 'fileformats' set to three formats[?25l[?1c[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileformats=unix,dos,mac[?25l[?1c[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXUxDsMc[?25l[?1c"XXUxDsMc" [25;12H[K[25;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[1m[34m^M[0m[3;7H[K[4;1Hdos[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M
~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! XXtt71[?25l[?1c"XXtt71" [25;10H[K[25;10H[New File] 5 lines, 29 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe XXUxDsMc[?25l[?1c"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileformats=mac,dos,unix[?25l[?1c[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXUxDsMc[?25l[?1c"XXUxDsMc" [25;12H[K[25;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[1m[34m^M[0m[3;7H[K[4;1Hdos[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M
~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! XXtt81[?25l[?1c"XXtt81" [25;10H[K[25;10H[New File] 5 lines, 29 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe XXUxDsMc[?25l[?1c"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" try with 'binary' set[?25l[?1c[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileformats=mac,unix,dos[?25l[?1c[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset binary[?25l[?1c[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXUxDsMc[?25l[?1c"XXUxDsMc" [25;12H[K[25;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[1m[34m^M[0m[3;7H[K[4;1Hdos[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M
~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! XXtt91[?25l[?1c"XXtt91" [25;10H[K[25;10H[New File][Incomplete last line] 5 lines, 28 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe XXUxDsMc[?25l[?1c"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileformats=mac[?25l[?1c[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXUxDsMc[?25l[?1c"XXUxDsMc" [25;12H[K[25;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[1m[34m^M[0m[3;7H[K[4;1Hdos[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M
~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! XXtt92[?25l[?1c"XXtt92" [25;10H[K[25;10H[New File][Incomplete last line] 5 lines, 28 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe XXUxDsMc[?25l[?1c"test30.in" [25;13H[K[25;13H222 lines, 3463 characters[1;1HTest for a lot of variations of the 'fileformats' option[2;1H[K[3;1HNote: This test will fail if "cat" is not available.[4;1H[K[5;1HSTARTTEST[5;10H[K[6;1H:so small.vim[6;14H[K[7;1H:" first write three test files, one in each format[7;52H[K[8;1H:set fileformat=unix[8;21H[K[9;1H:set fileformats=[9;18H[K[10;1H:/^1/w! XX1[10;12H[K[11;1H:/^2/w! XX2[11;12H[K[12;1H:/^3/w! XX3[12;12H[K[13;1H:/^4/w! XX4[13;12H[K[14;1H:/^5/w! XX5[14;12H[K[15;1H:/^6/w! XX6[15;12H[K[16;1H:/^7/w! XX7[16;12H[K[17;1H:/^8/w! XX8[17;12H[K[18;1H:/^9/w! XX9[18;12H[K[19;1H:/^10/w! XX10[19;14H[K[20;1H:/^unix/;/eof/-1w! XXUnix[20;26H[K[21;1H:/^dos/;/eof/-1w! XXDos[21;24H[K[22;1H:set bin noeol[22;15H[K[23;1H:$w! XXMac[23;11H[K[24;1H:set nobin eol[24;15H[K[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileformats=dos[?25l[?1c[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! XXUxDsMc[?25l[?1c"XXUxDsMc" [25;12H[K[25;12H[Incomplete last line] 5 lines, 28 characters[1;1Hunix[1;6H[K[2;1Hunix
dos[1m[34m^M[0m[3;7H[K[4;1Hdos[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M
~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! XXtt93[?25l[?1c"XXtt93" [25;10H[K[25;10H[New File][Incomplete last line] 5 lines, 28 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Append "END" to each file so that we can see what the last written char was.[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileformat=unix nobin[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [0m[25;1H--No lines in buffer--[25;23H[K[1;1H[?25h[?0c[?25l[?1cEND[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt01[?25l[?1c"XXtt01" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt02[?25l[?1c"XXtt02" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt11[?25l[?1c"XXtt11" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt12[?25l[?1c"XXtt12" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt13[?25l[?1c"XXtt13" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt21[?25l[?1c"XXtt21" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt22[?25l[?1c"XXtt22" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt23[?25l[?1c"XXtt23" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt31[?25l[?1c"XXtt31" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt32[?25l[?1c"XXtt32" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt33[?25l[?1c"XXtt33" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt41[?25l[?1c"XXtt41" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt42[?25l[?1c"XXtt42" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt43[?25l[?1c"XXtt43" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt51[?25l[?1c"XXtt51" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt52[?25l[?1c"XXtt52" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt53[?25l[?1c"XXtt53" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt61[?25l[?1c"XXtt61" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt62[?25l[?1c"XXtt62" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt63[?25l[?1c"XXtt63" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt71[?25l[?1c"XXtt71" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt81[?25l[?1c"XXtt81" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt91[?25l[?1c"XXtt91" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt92[?25l[?1c"XXtt92" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XXtt93[?25l[?1c"XXtt93" [25;10H[K[25;10H1 line, 4 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Concatenate the results.[?25l[?1c[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Make fileformat of test.out the native fileformat.[?25l[?1c[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Add a newline at the end.[?25l[?1c[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset binary[?25l[?1c[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! test.out[?25l[?1c"test.out" [25;12H[K[25;12H2 lines, 10 characters[1;1Hunix
unix[2;5H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$r XXtt01[?25l[?1c"XXtt01" [25;10H[K[25;10H3 lines, 14 characters[3;1Hdos[1m[34m^M[0m[3;6H[K[4;1Hdos[1m[34m^M[0m[4;6H[K[5;1HEND[5;4H[K[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$r XXtt02[?25l[?1c"XXtt02" [25;10H[K[25;10H2 lines, 13 characters[6;1Hmac[1m[34m^M[0mmac[1m[34m^M[0m[6;11H[K[7;1HEND[7;4H[K[6;1H[?25h[?0c
[?25l[?1c
1[8;2H[K[8;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$r XXtt11[?25l[?1c"XXtt11" [25;10H[K[25;10H3 lines, 16 characters[9;1Hunix[1m[34m^M[0m[9;7H[K[10;1Hunix[1m[34m^M[0m[10;7H[K[11;1HEND[11;4H[K[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$r XXtt12[?25l[?1c"XXtt12" [25;10H[K[25;10H3 lines, 14 characters[12;1Hdos[1m[34m^M[0m[12;6H[K[13;1Hdos[1m[34m^M[0m[13;6H[K[14;1HEND[14;4H[K[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$r XXtt13[?25l[?1c"XXtt13" [25;10H[K[25;10H2 lines, 14 characters[15;1Hmac[1m[34m^M[0mmac[1m[34m^M^M[0m[15;13H[K[16;1HEND[16;4H[K[15;1H[?25h[?0c
[?25l[?1c
2[17;2H[K[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$r XXtt21[?25l[?1c"XXtt21" [25;10H[K[25;10H3 lines, 15 characters[18;1Hunix[18;5H[K[19;1Hunix[19;5H[K[20;1H[1m[34m^M[0mEND[20;6H[K[18;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$r XXtt22[?25l[?1c"XXtt22" [25;10H[K[25;10H3 lines, 15 characters[21;1Hdos[1m[34m^M[0m[21;6H[K[22;1Hdos[1m[34m^M[0m[22;6H[K[23;1H[1m[34m^M[0mEND[23;6H[K[21;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$r XXtt23[?25l[?1c"XXtt23" [25;10H[K[25;10H1 line, 12 characters[24;1Hmac[1m[34m^M[0mmac[1m[34m^M[0mEND[24;14H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H3[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$r XXtt31[?25l[?1c"XXtt31" [25;10H[K[25;10H6 lines, 33 characters[1;24r[24;1H
[1;25r[24;1Hunix[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$r XXtt32[?25l[?1c"XXtt32" [25;10H[K[25;10H6 lines, 36 characters[1;24r[1;1H[6M[1;25r[19;1Hunix
dos[1m[34m^M[0m
dos[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M[0m
END
unix[1m[34m^M[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$r XXtt33[?25l[?1c"XXtt33" [25;10H[K[25;10H5 lines, 32 characters[1;24r[1;1H[6M[1;25r[19;1Hunix[1m[34m^M[0m
dos[1m[34m^M[0m
dos[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M^M[0m
END
unix[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[4M[1;25r[21;1Hunix
dos[1m[34m^M[0m
dos[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M[0mEND[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H4[?25h[?0c[?25l[?1c
:[?25h[?0c$r XXtt41[?25l[?1c"XXtt41" [25;10H[K[25;10H6 lines, 33 characters[1;24r[24;1H
[1;25r[24;1Hunix[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$r XXtt42[?25l[?1c"XXtt42" [25;10H[K[25;10H4 lines, 23 characters[1;24r[1;1H[6M[1;25r[19;1Hunix
dos[1m[34m^M[0m
dos[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M[0m
END
unix[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$r XXtt43[?25l[?1c"XXtt43" [25;10H[K[25;10H4 lines, 24 characters[1;24r[1;1H[4M[1;25r[21;1Hunix
mac[1m[34m^M[0mmac[1m[34m^M[0m
END
dos[1m[34m^M[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[3M[1;25r[22;1Hdos[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M^M[0m
END[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H5[?25h[?0c[?25l[?1c
:[?25h[?0c$r XXtt51[?25l[?1c"XXtt51" [25;10H[K[25;10H5 lines, 24 characters[1;24r[24;1H
[1;25r[24;1Hunix[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$r XXtt52[?25l[?1c"XXtt52" [25;10H[K[25;10H6 lines, 33 characters[1;24r[1;1H[5M[1;25r[20;1Hunix
dos[1m[34m^M[0m
dos[1m[34m^M[0m
END
unix[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$r XXtt53[?25l[?1c"XXtt53" [25;10H[K[25;10H3 lines, 22 characters[1;24r[1;1H[6M[1;25r[19;1Hunix
dos[1m[34m^M[0m
dos[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M[0m
END
dos[1m[34m^M[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hdos[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M[0mEND[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H6[?25h[?0c[?25l[?1c
:[?25h[?0c$r XXtt61[?25l[?1c"XXtt61" [25;10H[K[25;10H5 lines, 26 characters[1;24r[24;1H
[1;25r[24;1Hunix[1m[34m^M[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$r XXtt62[?25l[?1c"XXtt62" [25;10H[K[25;10H4 lines, 26 characters[1;24r[1;1H[5M[1;25r[20;1Hunix[1m[34m^M[0m
dos[1m[34m^M[0m
dos[1m[34m^M[0m
END
unix[1m[34m^M[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$r XXtt63[?25l[?1c"XXtt63" [25;10H[K[25;10H6 lines, 36 characters[1;24r[1;1H[4M[1;25r[21;1Hunix[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M^M[0m
END
unix[1m[34m^M[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[5M[1;25r[20;1Hunix[1m[34m^M[0m
dos[1m[34m^M[0m
dos[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M^M[0m
END[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H7[?25h[?0c[?25l[?1c
:[?25h[?0c$r XXtt71[?25l[?1c"XXtt71" [25;10H[K[25;10H6 lines, 33 characters[1;24r[24;1H
[1;25r[24;1Hunix[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[5M[1;25r[20;1Hunix
dos[1m[34m^M[0m
dos[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M[0m
END[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H8[?25h[?0c[?25l[?1c
:[?25h[?0c$r XXtt81[?25l[?1c"XXtt81" [25;10H[K[25;10H6 lines, 33 characters[1;24r[24;1H
[1;25r[24;1Hunix[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[5M[1;25r[20;1Hunix
dos[1m[34m^M[0m
dos[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M[0m
END[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H9[?25h[?0c[?25l[?1c
:[?25h[?0c$r XXtt91[?25l[?1c"XXtt91" [25;10H[K[25;10H5 lines, 32 characters[1;24r[24;1H
[1;25r[24;1Hunix[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$r XXtt92[?25l[?1c"XXtt92" [25;10H[K[25;10H5 lines, 32 characters[1;24r[1;1H[5M[1;25r[20;1Hunix
dos[1m[34m^M[0m
dos[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M[0mEND
unix[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$r XXtt93[?25l[?1c"XXtt93" [25;10H[K[25;10H5 lines, 32 characters[1;24r[1;1H[5M[1;25r[20;1Hunix
dos[1m[34m^M[0m
dos[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M[0mEND
unix[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[4M[1;25r[21;1Hunix
dos[1m[34m^M[0m
dos[1m[34m^M[0m
mac[1m[34m^M[0mmac[1m[34m^M[0mEND[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H10[?25h[?0c[?25l[?1c
:[?25h[?0c$r XXUnix[?25l[?1c"XXUnix" [25;10H[K[25;10H2 lines, 10 characters[1;24r[24;1H
[1;25r[24;1Hunix[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset nobinary ff&[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"test.out" 121 lines, 664 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test31.failed test.ok test.out X* viminfo
cp test31.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test31.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test31.in" 75 lines, 1545 characters[1;1HTest for commands that close windows and/or buffers:
:quit
:close
:hide
:only
:sall
:all
:ball
:buf
:edit

STARTTEST
:so tiny.vim
GA 1[1m[34m^[[0m:$w! Xtest1
$r2:$w! Xtest2
$r3:$w! Xtest3
:n! Xtest1 Xtest2
A 1[1m[34m^[[0m:set hidden
:" test for working :n when hidden set; write "testtext 2"
:n
:w! test.out
:" test for failing :rew when hidden not set; write "testtext 2 2"
:set nohidden
A 2[1m[34m^[[0m:rew[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for commands that close windows and/or buffers:[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[12;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 60 lines, 1410 characters written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:" test ":edit" working in modified buffer when 'hidden' set; write "testtext 1"[2;1H:set hidden
:e Xtest1
:w >>test.out
:" test ":close" not hiding when 'hidden' not set in modified buffer;
:" write "testtext 3 3 3"
:sp Xtest3
:set nohidden
A 3[1m[34m^[[0m:close
:w >>test.out
:" test ":close!" does hide when 'hidden' not set in modified buffer;
:" write "testtext 1"
A 3[1m[34m^[[0m:close!
:w >>test.out
:set nohidden
:" test ":all!" hides changed buffer; write "testtext 2 2 2"
:sp Xtest4
GA 4[1m[34m^[[0m:all!
:1wincmd w
:w >>test.out
:qa!
ENDTEST

testtext[22;1H[?25h[?0c
[?25l[?1c

:so! Xdotest[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso tiny.vim[?25l[?1c[23;1H[?25h[?0c
[?25l[?1c[9C1[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$w! Xtest1[?25l[?1c"Xtest1" [25;10H[K[25;10H[New File] 1 line, 11 characters written[24;10H[?25h[?0c[?25l[?1c2[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$w! Xtest2[?25l[?1c"Xtest2" [25;10H[K[25;10H[New File] 1 line, 11 characters written[24;10H[?25h[?0c[?25l[?1c3[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$w! Xtest3[?25l[?1c"Xtest3" [25;10H[K[25;10H[New File] 1 line, 11 characters written[24;10H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cn! Xtest1 Xtest2[?25l[?1c"Xtest1" [25;10H[K[25;10H1 line, 11 characters[1;1Htesttext 1[1;11H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[11C1[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset hidden[?25l[?1c[1;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test for working :n when hidden set; write "testtext 2"[?25l[?1c[1;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cn[?25l[?1c"Xtest2" 1 line, 11 characters[1;10H2[1;12H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 1 line, 11 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test for failing :rew when hidden not set; write "testtext 2 2"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nohidden[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[11C2[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0crew[?25l[?1c[1m[37m[41mE37: No write since last change (add ! to override)[1;12H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 13 characters appended[1;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test for working :rew when hidden set; write "testtext 1 1"[?25l[?1c[1;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset hidden[?25l[?1c[1;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0crew[?25l[?1c"Xtest1" [Modified] line 1 of 1 --100%-- col 1 (file 1 of 2)[1;10H1 1[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 13 characters appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test for :all keeping a buffer when it's modified; write "testtext 1 1 1"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nohidden[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[13C1[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csp[?25l[?1c[12;1H[1m[7mXtest1 [+]                                                                      [0m[13;1Htesttext 1 1 1[13;15H[K[24;1H[7mXtest1 [+]                                                                      [1;14H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cn Xtest2 Xtest3[?25l[?1c"Xtest2" [Modified] line 1 of 1 --100%-- col 1 (file 1 of 2)[1;10H2 2[1;14H[K[12;6H[1m[7m2[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0call[?25l[?1c"Xtest3" 1 line, 11 characters[27m[24m[0m[H[J[1;1Htesttext 1 1 1
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [0m[8;1H[7mXtest1 [+]                                                                      [0m[9;1Htesttext 2 2
[1m[34m~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [0m[16;1H[1m[7mXtest2 [+]                                                                      [0m[17;1Htesttext 3
[1m[34m~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [0m[24;1H[7mXtest3                                                                          [9;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0c1wincmd w[?25l[?1c[8;1H[1m[7mXtest1 [+]                                                                      [0m[16;1H[7mXtest2 [+]                                                                      [1;14H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 15 characters appended[1;14H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test abandoning changed buffer, should be unloaded even when 'hidden' set[?25l[?1c[1;14H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" write "testtext 2 2" twice[?25l[?1c[1;14H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset hidden[?25l[?1c[1;14H[?25h[?0c[?25l[?1c1 1[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cq![?25l[?1c[27m[24m[0m[H[J[1;1Htesttext 2 2
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7mXtest2 [+]                                                                      [0m[13;1Htesttext 3
[1m[34m~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [0m[24;1H[7mXtest3                                                                          [1;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 13 characters appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunhide[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 13 characters appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test ":hide" hides anyway when 'hidden' not set; write "testtext 3"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nohidden[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[13C2[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0chide[?25l[?1c[1;10H3[1;12H[K[12;1H[1m[34m~                                                                               [13;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 11 characters appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test ":edit" failing in modified buffer when 'hidden' not set[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" write "testtext 3 3"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[11C3[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xtest1[?25l[?1c[1m[37m[41mE37: No write since last change (add ! to override)[1;12H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 13 characters appended[1;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test ":edit" working in modified buffer when 'hidden' set; write "testtext 1
[24;80H"[25;1H[?25l[?1c[1;1H[L[1;1Htesttext 3 3[25;1H[K[1;12H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset hidden[?25l[?1c[1;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xtest1[?25l[?1c"Xtest1" 1 line, 11 characters[1;10H1[1;12H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 11 characters appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test ":close" not hiding when 'hidden' not set in modified buffer;[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" write "testtext 3 3 3"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csp Xtest3[?25l[?1c"Xtest3" [Modified] line 1 of 1 --100%-- col 1 (file 2 of 2)[1;10H3 3[12;1H[1m[7mXtest3 [+]                                                                      [0m[13;1Htesttext 1[13;11H[K[24;1H[7mXtest1                                                                          [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset nohidden[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[13C3[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cclose[?25l[?1c[1m[37m[41mE37: No write since last change (add ! to override)[1;14H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 15 characters appended[1;14H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test ":close!" does hide when 'hidden' not set in modified buffer;[?25l[?1c[1;14H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" write "testtext 1"[?25l[?1c[1;14H[?25h[?0c[?25l[?1c3 3[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cclose![?25l[?1c[1;10H1[1;12H[K[12;1H[1m[34m~                                                                               [13;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 11 characters appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nohidden[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test ":all!" hides changed buffer; write "testtext 2 2 2"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csp Xtest4[?25l[?1c"Xtest4" [New File][1;1H[K[12;1H[1m[7mXtest4                                                                          [0m[13;1Htesttext 1[13;11H[K[24;1H[7mXtest1                                                                          [1;1H[?25h[?0c[?25l[?1c[0m 4[12;8H[1m[7m[+][1;2H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0call![?25l[?1c"Xtest2" [Modified] line 1 of 1 --100%-- col 1 (file 1 of 2)
"Xtest3" [Modified] line 1 of 1 --100%-- col 1 (file 2 of 2)
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c1wincmd w[?25l[?1c[1;1H[2L[1;1Htesttext 2 2 2
[1m[34m~                                                                               [0m[12;6H[1m[7m2[0m[13;10H3 3 3 3[24;6H[7m3 [+][0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 15 characters appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test32.failed test.ok test.out X* viminfo
cp test32.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test32.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test32.in" 60 lines, 1391 characters[1;1HTest for insert expansion

:se cpt=.,w
* add-expands (word from next line) from other window
* add-expands (current buffer first)
* Local expansion, ends in an empty line (unless it becomes a global expansion)
* starts Local and switches to global add-expansion
:se cpt=.,w,i
* i-add-expands and switches to local
* add-expands lines (it would end in an empty line if it didn't ignored it self)[11;1H:se cpt=kXtestfile
* checks k-expansion, and file expansion (use Xtest11 instead of test11,
* because TEST11.OUT may match first on DOS)
:se cpt=w
* checks make_cyclic in other window
:se cpt=u nohid
* checks unloaded buffer expansion
* checks adding mode abortion
:se cpt=t,d
* tag expansion, define add-expansion interrupted
* t-expansion

STARTTEST
:so small.vim[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for insert expansion[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[23;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 27 lines, 533 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:w Xtest11.two
O[1m[34m^N^[[0mIX[1m[34m^[[0mA[1m[34m^X^F^N^[[0m
:" use CTRL-X CTRL-F to complete Xtest11.one, remove it and then use
:" CTRL-X CTRL-F again to verify this doesn't cause trouble.
OX[1m[34m^X^F^H^H^H^H^H^H^H^H^X^F^[[0mddk
:se cpt=w
OST[1m[34m^N^P^P^P^P^[[0m
:se cpt=u nohid
[1m[34m^W[0moOEN[1m[34m^N[0m
unl[1m[34m^N^X^X^P^[[0m
:se cpt=t,d def=^\\k* tags=Xtestfile notagbsearch
O[1m[34m^X^]^X^D^X^D^X^X^D^X^D^X^D^X^D[0m
a[1m[34m^N^[[0m
:wq! test.out
ENDTEST

start of testfile
run1
run2
end of testfile

test11  36Gepeto[8C/Tag/
asd     test11file      36G
Makefile[8Cto      run[15;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[16;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[16;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cse nocp viminfo+=nviminfo cpt=.,w ff=unix | $-2,$w!Xtestfile | set ff&[?25l[?1c"Xtestfile" [25;13H[K[25;13H[New] 3L, 57C written[16;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cse cot=[?25l[?1c[16;1H[?25h[?0c[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7m[No Name]                                                                       [0m[13;1H[1m[34m^W[0moOEN[1m[34m^N[0m
unl[1m[34m^N^X^X^P^[[0m
:se cpt=t,d def=^\\k* tags=Xtestfile notagbsearch
O[1m[34m^X^]^X^D^X^D^X^X^D^X^D^X^D^X^D[0m
a[1m[34m^N^[[0m[17;7H[K[18;1H:wq! test.out
ENDTEST[20;1H[K[21;1Hstart of testfile
run1[22;5H[K[23;1Hrun2[23;9H[K[24;1H[7mtest32.in                                                                       [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[1m-- INSERT ---- Keyword completion (^N^P) -- Searching...[0m[1m[32mScanning: test32.in[0m[25;20H[K[25;1Hmatch in file test32.in[1m-- Keyword completion (^N^P) [0m[1m[32mmatch 1 of 4[2;3H[0m[25;29H[K[25;1Hmatch in file test32.in[25;24H[K[25;1H[1m-- Keyword completion (^N^P) [0m[1m[32mmatch 2 of 4[2;5H[0m[25;29H[K[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[0m[25;13H[K[25;4H[1mAdding Keyword completion (^N^P) -- Searching...[0m[1m[32mScanning: test32.in[0m[25;20H[K[25;1Hmatch in file test32.in[1m-- Adding Keyword completion (^N^P) Word from other line[2;10H[1;11r[0m[1;1H[2L[1;25r[1;1H#include "Xtestfile"
run1 run2[12;11H[1m[7m[+][2;10H[?25h[?0c[0m[25;1H[K[?25l[?1c[25;1H[1m-- Adding Keyword completion (^N^P) Word from other line[0m[25;1H[K[25;1H[1m-- INSERT --[0m[25;1H[K[2;9H[?25h[?0c[?25l[?1c3[?25h[?0c
[?25l[?1c[25;1H[1m-- INSERT ---- Keyword completion (^N^P) -- Searching...[0m[1m[32mScanning: test32.in[0m[25;20H[K[25;1H[1m-- Keyword completion (^N^P) [0m[1m[32mmatch 1 of 115[3;5H[0m[25;29H[K[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[0m[25;13H[K[25;4H[1mAdding Keyword completion (^N^P) -- Searching...[0m[1m[32mScanning: test32.in[0m[25;20H[K[25;1H[1m-- Adding Keyword completion (^N^P) Word from other line[3;10H[0m[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[0m[25;13H[K[25;4H[1mKeyword Local completion (^N^P) -- Searching...[0m[25;36H[1m[32mmatch 1 of 4[0m[25;48H[K[4;5H[25;35H[K[25;35H[1m [0m[1m[32mmatch 2 of 4[4;5H[0m[25;35H[K[25;35H[1m [0m[1m[32mmatch 3 of 4[4;10H[0m[25;35H[K[25;35H[1m [0m[1m[32mmatch 4 of 4[4;8H[0m[25;35H[K[25;35H[1m [0m[1m[31mBack at original[4;1H[0m[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[0m[25;13H[K[25;4H[1mKeyword Local completion (^N^P) -- Searching...[0m[25;36H[1m[32mmatch 1 of 4[0m[25;48H[K[5;5H[25;35H[K[25;35H[1m [0m[1m[32mmatch 2 of 4[5;5H[0m[25;35H[K[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[0m[25;13H[K[25;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[0m[25;13H[K[25;4H[1mKeyword completion (^N^P) -- Searching...[0m[1m[32mScanning: test32.in[0m[25;20H[K[25;1H[1m-- Keyword completion (^N^P) The only match[5;5H[0m[25;29H[K[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[0m[25;13H[K[25;4H[1mAdding Keyword completion (^N^P) -- Searching...[0m[1m[32mScanning: test32.in[0m[25;20H[K[25;1H[1m-- Adding Keyword completion (^N^P) [0m[1m[32mmatch 1 of 2[5;10H[0m[25;36H[K[25;1Hmatch in file test32.in[25;24H[K[25;1H[1m-- Adding Keyword completion (^N^P) Word from other line[5;10H[3;11r[0m[3;1H[3L[1;25r[3;1Hrun3 run3

run1 run2[?25h[?0c[25;1H[K[?25l[?1c[25;1H[1m-- Adding Keyword completion (^N^P) Word from other line[0m[25;1H[K[25;1H[1m-- INSERT --[0m[25;1H[K[5;9H[?25h[?0c
[?25l[?1c[25;1H:[?25h[?0cse cpt=.,w,i[?25l[?1c[6;1H[?25h[?0c[5;9H[?25l[?1c[25;1H[1m-- INSERT --[0m[25;13H[K[25;4H[1mKeyword completion (^N^P) -- Searching...[0m[1m[32mScanning: test32.in[0m[25;20H[K[25;9H[1m[32m included file: Xtestfile[0mmatch in file test32.in[25;24H[K[25;1H[1m-- Keyword completion (^N^P) The only match[5;9H[0m[25;29H[K[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[0m[25;13H[K[25;4H[1mAdding Keyword completion (^N^P) -- Searching...[0m[1m[32mScanning: test32.in[0m[25;20H[K[25;9H[1m[32m included file: Xtestfile[0mmatch in file test32.in[25;24H[K[25;1H[1m-- Adding Keyword completion (^N^P) The only match[5;19H[0m[25;36H[K[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[0m[25;13H[K[25;4H[1mAdding Keyword completion (^N^P) -- Searching...[0m[1m[32mScanning: test32.in[0m[25;20H[K[25;9H[1m[32m included file: Xtestfile[0mmatch in file test32.in[25;24H[K[25;1H[1m-- Adding Keyword completion (^N^P) The only match[5;28H[0m[25;36H[K[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[0m[25;13H[K[25;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[0m[25;13H[K[25;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[0m[25;13H[K[25;4H[1mKeyword Local completion (^N^P) -- Searching...[0m[25;36H[1m[32mmatch 1 of 3[0m[25;48H[K[5;29H[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- Whole line completion (^L^N^P) -- Searching...[0m[1m[32mScanning: test32.in[0m[25;20H[K[25;1H[1m-- Whole line completion (^L^N^P) [0m[1m[32mmatch 1 of 57[6;29H[0m[25;4H[1mINSERT --[0m[25;13H[K[25;1H[K[25;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) [0m[1m[32mmatch 1 of 57[0m[25;4H[1mAdding Whole line completion (^L^N^P) -- Searching...[0m[1m[32mScanning: test32.in[0m[25;20H[K[25;1H[1m-- Adding Whole line completion (^L^N^P) The only match[7;29H[0m[25;41H[K[25;41H[1m [0m[1m[31mBack at original[7;1H[0m[25;41H[K[25;41H[1m The only match[7;29H[5;11r[0m[5;1H[3L[1;25r[5;1HMakefile[8Cto      run3
Makefile[8Cto      run3
Makefile[8Cto      run3[?25h[?0c[25;1H[K[?25l[?1c[25;1H[1m-- INSERT --[0m[25;1H[K[7;28H[?25h[?0c[8;9H[?25l[?1c[25;1H:[?25h[?0cse cpt=kXtestfile[?25l[?1c[8;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw Xtest11.one[?25l[?1c"Xtest11.one" [New] 9L, 104C written[12;1H[1m[7mXtest11.one  [8;9H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw Xtest11.two[?25l[?1c"Xtest11.two" [New] 9L, 104C written[8;9H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT --[0m[25;13H[K[25;4H[1mKeyword completion (^N^P) -- Searching...[0m[1m[32mScanning dictionary: Xtestfile[0m[25;31H[K[25;1Hmatch in file Xtestfile[25;24H[K[25;1H[1m-- Keyword completion (^N^P) [0m[1m[32mmatch 1 of 9[8;7H[8;11r[0m[8;1H[L[1;25r[8;1Htest11[12;13H[1m[7m[+][8;7H[0mI[?25h[?0c [25;1H[K[?25l[?1c[25;1H[1m-- Keyword completion (^N^P) [0m[1m[32mmatch 1 of 9[0m[25;1H[K[25;1H[1m-- INSERT --[0m[25;1H[K[8;6H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT --[0m[25;1H[K[8;1HXtest11[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- File name completion (^F^N^P) -- Searching...[0m[25;34H[1m[32mmatch 1 of 2[0m[25;46H[K[8;12H[25;33H[K[25;33H[1m [0m[1m[32mmatch 2 of 2[8;12H[0m.two[?25h[?0c[25;1H[K[?25l[?1c[25;1H[1m-- INSERT --[0m[25;1H[K[8;11H[?25h[?0c[9;9H[?25l[?1c[25;1H:[?25h[?0c" use CTRL-X CTRL-F to complete Xtest11.one, remove it and then use[?25l[?1c[9;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" CTRL-X CTRL-F again to verify this doesn't cause trouble.[?25l[?1c[9;9H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT --[0m[25;13H[K[25;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- File name completion (^F^N^P) -- Searching...[0m[25;34H[1m[32mmatch 1 of 4[0m[25;46H[K[9;8H[25;4H[1mINSERT --[0m[25;13H[K[25;1H[K[25;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- File name completion (^F^N^P) -- Searching...[0m[25;34H[1m[32mmatch 1 of 292[0m[25;48H[K[9;15HMake_amiga.mak
run1 run2[11;1H[K[9;15Hd[?25h[?0c [25;1H[K[?25l[?1c[25;1H[1m-- INSERT --[0m[25;1H[K[9;14H[?25h[?0c[?25l[?1crun1 run2[9;10H[K[10;1H[K[11;1H[1m[34m~                                                                               [9;1H[?25h[?0c[8;1H
[?25l[?1c[25;1H[0m:[?25h[?0cse cpt=w[?25l[?1c[9;1H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT ---- Keyword completion (^N^P) -- Searching...[0m[1m[32mScanning: test32.in[0m[25;20H[K[25;1Hmatch in file test32.in[1m-- Keyword completion (^N^P) The only match[9;10H[0m[25;29H[K[25;29H[1m [0m[1m[31mBack at original[9;3H[0m[25;29H[K[25;1Hmatch in file test32.in[25;24H[K[25;1H[1m-- Keyword completion (^N^P) The only match[9;10H[0m[25;29H[K[25;29H[1m [0m[1m[31mBack at original[9;3H[0m[25;29H[K[25;1Hmatch in file test32.in[25;24H[K[25;1H[1m-- Keyword completion (^N^P) The only match[9;10H[0mSTARTTEST
run1 run2[11;1H[K[9;10H[?25h[?0c[25;1H[K[?25l[?1c[25;1H[1m-- Keyword completion (^N^P) The only match[0m[25;1H[K[25;1H[1m-- INSERT --[0m[25;1H[K[9;9H[?25h[?0c[10;9H[?25l[?1c[25;1H:[?25h[?0cse cpt=u nohid[?25l[?1c[10;9H[?25h[?0c[?25l[?1c

[1m[34m~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [10;9H[?25h[?0c[?25l[?1c[0m[25;1H[1m-- INSERT --[0m[25;13H[K[25;4H[1mKeyword completion (^N^P) -- Searching...[0m[1m[32mScanning: test32.in[0m[25;20H[K[25;1Hmatch in file test32.in[1m-- Keyword completion (^N^P) The only match[10;8H[0m[25;1H[K[25;1H[1m-- INSERT ---- Keyword completion (^N^P) -- Searching...[0m[1m[32mScanning: test32.in[0m[25;20H[K[25;1Hmatch in file test32.in[1m-- Keyword completion (^N^P) [0m[1m[32mmatch 1 of 3[11;7H[0m[25;29H[K[25;1H[K[25;1H[1m-- INSERT ---- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[0m[25;13H[K[25;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- INSERT --[0m[25;13H[K[25;4H[1mKeyword completion (^N^P) -- Searching...[0m[1m[32mScanning: test32.in[0m[25;20H[K[25;1Hmatch in file test32.in[1m-- Keyword completion (^N^P) The only match[11;7H[10;24r[0m[10;1H[2L[1;25r[10;1HENDTEST
unless[?25h[?0c[25;1H[K[?25l[?1c[25;1H[1m-- Keyword completion (^N^P) The only match[0m[25;1H[K[25;1H[1m-- INSERT --[0m[25;1H[K[11;6H[?25h[?0c[12;6H[?25l[?1c[25;1H:[?25h[?0cse cpt=t,d def=^\\k* tags=Xtestfile notagbsearch[?25l[?1c[12;6H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT --[0m[25;13H[K[25;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- Tag completion (^]^N^P) -- Searching...[0m[25;28H[1m[32mmatch 1 of 3[0m[25;40H[K[12;7H[25;4H[1mINSERT --[0m[25;13H[K[25;1H[K[25;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) [0m[1m[32mmatch 1 of 3[0m[25;4H[1mDefinition completion (^D^N^P) -- Searching...[0m[25;50H[K[25;1H[1m[32mScanning included file: Xtestfile[0m[25;34H[K[25;1Hmatch in file Xtestfile[25;24H[K[25;1H[1m-- Definition completion (^D^N^P) The only match[12;11H[25;4HINSERT --[0m[25;13H[K[25;1H[K[25;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) The only match-- Adding Definition completion (^D^N^P) -- Searching...[0m[1m[32mScanning included file: Xtestfile[0m[25;34H[K[25;1Hmatch in file Xtestfile[25;24H[K[25;1H[1m-- Adding Definition completion (^D^N^P) The only match[12;20H[25;4HINSERT --[0m[25;13H[K[25;1H[K[25;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) The only match-- INSERT --[0m[25;13H[K[25;4H[1m^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)-- Definition completion (^D^N^P) -- Searching...[0m[1m[32mScanning included file: Xtestfile[0m[25;34H[K[25;1Hmatch in file Xtestfile[25;24H[K[25;1H[1m-- Definition completion (^D^N^P) The only match[12;25H[25;4HINSERT --[0m[25;13H[K[25;1H[K[25;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) The only match-- Adding Definition completion (^D^N^P) -- Searching...[0m[1m[32mScanning included file: Xtestfile[0m[25;34H[K[25;1Hmatch in file Xtestfile[25;24H[K[25;1H[1m-- Adding Definition completion (^D^N^P) The only match[12;37H[25;4HINSERT --[0m[25;13H[K[25;1H[K[25;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) The only match-- Adding Definition completion (^D^N^P) -- Searching...[0m[1m[32mScanning included file: Xtestfile[0m[25;34H[K[25;1Hmatch in file Xtestfile[25;24H[K[25;1H[1m-- Adding Definition completion (^D^N^P) The only match[12;38H[25;4HINSERT --[0m[25;13H[K[25;1H[K[25;1H[1m-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y) The only match-- Adding Definition completion (^D^N^P) -- Searching...[0m[1m[32mScanning included file: Xtestfile[0m[25;34H[K[25;1Hmatch in file Xtestfile[25;24H[K[25;1H[1m-- Adding Definition completion (^D^N^P) Word from other line[12;42H[25;4HINSERT --[0m[25;13H[K[25;1H[K[25;1H[1m-- Keyword completion (^N^P) -- Searching...[0m[1m[32mScanning tags.[0m[25;15H[K[25;10H[1m[32mincluded file: Xtestfile[0m[1m-- Keyword completion (^N^P) The only match[13;4H[12;24r[0m[12;1H[2L[1;25r[12;1Htest11file      36Gepeto[8C/Tag/ asd
asd[?25h[?0c[25;1H[K[?25l[?1c[25;1H[1m-- Keyword completion (^N^P) The only match[0m[25;1H[K[25;1H[1m-- INSERT --[0m[25;1H[K[13;3H[?25h[?0c
ru[?25l[?1c[25;1H:[?25h[?0cwq! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New] 15L, 175C written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test33.failed test.ok test.out X* viminfo
cp test33.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test33.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test33.in" 34 lines, 616 characters[1;1HTest for 'lisp'
If the lisp feature is not enabled, this will fail!

STARTTEST
:so small.vim
:set lisp
/^(defun
=G:/^(defun/,$w! test.out
:q!
ENDTEST

(defun html-file (base)
(format nil "~(~A~).html" base))

(defmacro page (name title &rest body)
(let ((ti (gensym)))
`(with-open-file (*standard-output*
(html-file ,name)
:direction :output
:if-exists :supersede)
(let ((,ti ,title))
(as title ,ti)
(with center
(as h2 (string-upcase ,ti)))[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for 'lisp'[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[4;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 5 lines, 63 characters written[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[10;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[11;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[11;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset lisp[?25l[?1c[11;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^(defun[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H22 lines to indent...23[7Cindented [25;19H[K[13;1H  (format nil "~(~A~).html" base))


  (let ((ti (gensym)))
       `(with-open-file (*standard-output*
                 [8C(html-file ,name)
                  [7C:direction :output
                         :if-exists :supersede)
                        (let ((,ti ,title))
              [15C(as title ,ti)
            [17C(with center
                            [7C(as h2 (string-upcase ,ti)))[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^(defun/,$w! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 23 lines, 544 characters written[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cq![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test34.failed test.ok test.out X* viminfo
cp test34.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test34.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test34.in" 87 lines, 1833 characters[1;1HTest for user functions.
Also test an <expr> mapping calling a function.
Also test that a builtin function cannot be replaced.
Also test for regression when calling arbitrary expression.

STARTTEST
:so small.vim
:function Table(title, ...)
:  let ret = a:title
:  let idx = 1
:  while idx <= a:0
:    exe "let ret = ret . a:" . idx
:    let idx = idx + 1
:  endwhile
:  return ret
:endfunction
:function Compute(n1, n2, divname)
:  if a:n2 == 0
:    return "fail"
:  endif
:  exe "let g:" . a:divname . " = ". a:n1 / a:n2
:  return "ok"
:endfunction
:func Expr1()[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for user functions.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[6;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 78 lines, 1621 characters written[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[7;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:call extend(g:, {'max': function('min')})
:call append(line('$'), max([1, 2, 3]))
:try
:    " Regression: the first line below used to throw ?E110: Missing ')'?
:    " Second is here just to prove that this line is correct when not skipping
:    " rhs of &&.
:    $put =(0&&(function('tr'))(1, 2, 3))
:    $put =(1&&(function('tr'))(1, 2, 3))
:catch
:    $put ='!!! Unexpected exception:'
:    $put =v:exception
:endtry
:$-9,$w! test.out
:delfunc Table
:delfunc Compute
:delfunc Expr1
:delfunc Expr2
:delfunc ListItem
:delfunc ListReset
:unlet retval counter
:q!
ENDTEST

here[22;1H[?25h[?0c
[?25l[?1c

:so! Xdotest[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunction Table(title, ...)[?25l[?1c
:  [?25h[?0c:  let ret = a:title
[?25l[?1c:  [?25h[?0c:  let idx = 1
[?25l[?1c:  [?25h[?0c:  while idx <= a:0
[?25l[?1c:    [?25h[?0c:    exe "let ret = ret . a:" . idx
[?25l[?1c:    [?25h[?0c:    let idx = idx + 1
[?25l[?1c:    [?25h[?0c:  endwhile
[?25l[?1c:  [?25h[?0c:  return ret
[?25l[?1c:  [?25h[?0c:endfunction[1;1H[8L[?25l[?1c[1;1H:call extend(g:, {'max': function('min')})
:call append(line('$'), max([1, 2, 3]))
:try
:    " Regression: the first line below used to throw ?E110: Missing ')'?
:    " Second is here just to prove that this line is correct when not skipping
:    " rhs of &&.
:    $put =(0&&(function('tr'))(1, 2, 3))
:    $put =(1&&(function('tr'))(1, 2, 3))[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0cfunction Compute(n1, n2, divname)[?25l[?1c
:  [?25h[?0c:  if a:n2 == 0
[?25l[?1c:    [?25h[?0c:    return "fail"
[?25l[?1c:    [?25h[?0c:  endif
[?25l[?1c:  [?25h[?0c:  exe "let g:" . a:divname . " = ". a:n1 / a:n2
[?25l[?1c:  [?25h[?0c:  return "ok"
[?25l[?1c:  [?25h[?0c:endfunction[1;1H[6L[?25l[?1c[1;1H:call extend(g:, {'max': function('min')})
:call append(line('$'), max([1, 2, 3]))
:try
:    " Regression: the first line below used to throw ?E110: Missing ')'?
:    " Second is here just to prove that this line is correct when not skipping
:    " rhs of &&.[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0cfunc Expr1()[?25l[?1c
:  [?25h[?0c:  normal! v
[?25l[?1c:  [?25h[?0c:  return "111"
[?25l[?1c:  [?25h[?0c:endfunc[1;1H[3L[?25l[?1c[1;1H:call extend(g:, {'max': function('min')})
:call append(line('$'), max([1, 2, 3]))
:try[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0cfunc Expr2()[?25l[?1c
:  [?25h[?0c:  call search('XX', 'b')
[?25l[?1c:  [?25h[?0c:  return "222"
[?25l[?1c:  [?25h[?0c:endfunc[1;1H[3L[?25l[?1c[1;1H:call extend(g:, {'max': function('min')})
:call append(line('$'), max([1, 2, 3]))
:try[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0cfunc ListItem()[?25l[?1c
:  [?25h[?0c:  let g:counter += 1
[?25l[?1c:  [?25h[?0c:  return g:counter . '. '
[?25l[?1c:  [?25h[?0c:endfunc[1;1H[3L[?25l[?1c[1;1H:call extend(g:, {'max': function('min')})
:call append(line('$'), max([1, 2, 3]))
:try[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0cfunc ListReset()[?25l[?1c
:  [?25h[?0c:  let g:counter = 0
[?25l[?1c:  [?25h[?0c:  return ''
[?25l[?1c:  [?25h[?0c:endfunc[1;1H[3L[?25l[?1c[1;1H:call extend(g:, {'max': function('min')})
:call append(line('$'), max([1, 2, 3]))
:try[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0cfunc FuncWithRef(a)[?25l[?1c
:  [?25h[?0c:  unlet g:FuncRef
[?25l[?1c:  [?25h[?0c:  return a:a
[?25l[?1c:  [?25h[?0c:endfunc[1;1H[3L[?25l[?1c[1;1H:call extend(g:, {'max': function('min')})
:call append(line('$'), max([1, 2, 3]))
:try[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0clet g:FuncRef=function("FuncWithRef")[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet counter = 0[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cinoremap <expr> ( ListItem()[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cinoremap <expr> [ ListReset()[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cimap <expr> + Expr1()[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cimap <expr> * Expr2()[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet retval = "nop"[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^here[?25l[?1c[24;1H[?25h[?0c[?25l[?1cher$[25;1H[K[25;1H=[?25h[?0cTable("xxx", 4, "asdf")[?25l[?1c[25;1H[K[25;1H=[?25h[?0cCompute(45, 0, "retval")[?25l[?1c[25;1H[K[25;1H=[?25h[?0cretval[?25l[?1c[25;1H[K[25;1H=[?25h[?0cCompute(45, 5, "retval")[?25l[?1c[25;1H[K[25;1H=[?25h[?0cretval[?25l[?1c[25;1H[K[25;1H=[?25h[?0cg:FuncRef(333)
[?25l[?1c[1m[37m[41mError detected while processing function Expr1:[0m
[1m[33mline    1:[0m
[1m[37m[41mE523: Not allowed here[0m
[1m[32mPress ENTER or type command to continue[?25h[?0c[0m[1;1H[4L[?25l[?1c[1;1H:    " rhs of &&.
:    $put =(0&&(function('tr'))(1, 2, 3))
:    $put =(1&&(function('tr'))(1, 2, 3))
:catch[5;6H$put ='!!! Unexpected exception:'[5;39H[K[6;6H$put =v:exception
:endtry[7;8H[K[8;2H$-9,$w! test.out[8;18H[K[9;2Hdelfunc Table
:delfunc Compute[10;17H[K[11;2Hdelfunc Expr1[11;15H[K[12;2Hdelfunc Expr2
:delfunc ListItem[14;10HListReset
:unlet retval counter
:q![16;4H[K[17;1HENDTEST[17;8H[K[18;1H[K[19;1Hxxx4asdf fail nop ok 9 333
XX111-XX[20;9H[K[21;1H---222---
1. one[22;7H[K[23;1H2. two[24;1H[K[25;1H[K[24;1H[?25h[?0c[?25l[?1c1. one again[?25h[?0c[?25l[?1c
:[?25h[?0ccall append(line('$'), max([1, 2, 3]))[?25l[?1c[24;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall extend(g:, {'max': function('min')})[?25l[?1c[1m[37m[41mE704: Funcref variable name must start with a capital: max[24;12H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall append(line('$'), max([1, 2, 3]))[?25l[?1c[24;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctry[?25l[?1c
:  [?25h[?0c:    " Regression: the first line below used to throw ?E110: Missing ')'?
[?25l[?1c:  [?25h[?0c:    " Second is here just to prove that this line is correct when not skipp
[24;80Hi[25;1Hng
[?25l[?1c:  [?25h[?0c:    " rhs of &&.
[?25l[?1c:  [?25h[?0c:    $put =(0&&(function('tr'))(1, 2, 3))
[?25l[?1c:  [?25h[?0c:    $put =(1&&(function('tr'))(1, 2, 3))
[?25l[?1c:  [?25h[?0c:catch
[?25l[?1c:  [?25h[?0c:    $put ='!!! Unexpected exception:'
[?25l[?1c:  [?25h[?0c:    $put =v:exception
[?25l[?1c:  [?25h[?0c:endtry[1;1H[10L[?25l[?1c[1;1H:    $put ='!!! Unexpected exception:'
:    $put =v:exception
:endtry
:$-9,$w! test.out
:delfunc Table
:delfunc Compute
:delfunc Expr1
:delfunc Expr2
:delfunc ListItem
:delfunc ListReset
:unlet retval counter
:q![12;4H[K[13;1HENDTEST[13;8H[K[14;1H[K[15;1Hxxx4asdf fail nop ok 9 333
XX111-XX
---222---
1. one
2. two[19;7H[K[20;1H1. one again
3[21;2H[K[22;1H3[22;2H[K[23;1H0[23;2H[K[24;2H[K[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$-9,$w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 10 lines, 81 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cdelfunc Table[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cdelfunc Compute[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cdelfunc Expr1[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cdelfunc Expr2[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cdelfunc ListItem[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cdelfunc ListReset[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet retval counter[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cq![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test35.failed test.ok test.out X* viminfo
cp test35.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test35.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test35.in" 21 lines, 448 characters[1;1HTest Ctrl-A and Ctrl-X, which increment and decrement decimal, hexadecimal,
and octal numbers.

STARTTEST
/^start-here
:set nrformats=octal,hex
j[1m[34m^A[0m102[1m[34m^X^A[0ml[1m[34m^X[0ml[1m[34m^A[0m64[1m[34m^A[0m128[1m[34m^X[0m$[1m[34m^X[0m
:set nrformats=octal
0[1m[34m^A[0m102[1m[34m^X^A[0ml[1m[34m^X[0m2[1m[34m^A[0mw65[1m[34m^A[0m129[1m[34m^X[0mblx6lD
:set nrformats=hex
0101[1m[34m^X[0ml257[1m[34m^X^A[0mTxldt [1m[34m^A[0m [1m[34m^X[0m [1m[34m^X[0m
:set nrformats=
0200[1m[34m^X[0ml100[1m[34m^X[0mw78[1m[34m^X^A[0mk
:$-3,$wq! test.out
ENDTEST

start-here
100     0x100     077     0
100     0x100     077
100     0x100     077     0xfF     0xFf
100     0x100     077
[1m[34m~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest Ctrl-A and Ctrl-X, which increment and decrement decimal, hexadecimal,[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[4;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 10 lines, 200 characters written[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[15;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[16;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^start-here[?25l[?1c[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nrformats=octal,hex[?25l[?1c[17;1H[?25h[?0c
[?25l[?1c101[?25h[?0c[?25l[?1c-1     0x100     077     0[18;27H[K[18;2H[?25h[?0c[?25l[?1c0     0x100     077     0[18;26H[K[18;1H[?25h[?0c0[?25l[?1c[7C0ff[?25h[?0cf[?25l[?1c     0100     0[18;20H[?25h[?0c[?25l[?1c20[?25h[?0c[?25l[?1c00[?25h[?0c0     [?25l[?1c-1[?25h[?0c[19;26H[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nrformats=octal[?25l[?1c[19;26H[?25h[?0c[?25l[?1c101[?25h[?0c[?25l[?1c-1     0x100     077 -[?25h[?0c[?25l[?1c0     0x100     077 [?25h[?0c0[?25l[?1c     -1x100     077[19;8H[?25h[?0c[?25l[?1c1x100     077 [19;7H[?25h[?0c[10C[?25l[?1c0200[?25h[?0c[?25l[?1c1777777777777777777777[?25h[?0c[19;17H0[?25l[?1c7[20C [19;18H[?25h[?0c777777[?25l[?1c[19;24H[K[19;23H[?25h[?0c[20;23H[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nrformats=hex[?25l[?1c[20;23H[?25h[?0c[?25l[?1c-1     0x100     077     0xfF     0xFf[20;39H[K[20;2H[?25h[?0c1[?25l[?1c[7Cffffffffffffffff     077     0xfF     0xFf[20;25H[?25h[?0c[?25l[?1c[20;10H0000000000000000[?25h[?0c[20;10H0[?25l[?1c     077     0xfF     0xFf[20;39H[K[20;11H[?25h[?0c[?25l[?1c[7C8[?25h[?0c8[?25l[?1c[7CFE[?25h[?0cE[?25l[?1c[7Cfe[?25h[?0c[21;26H[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nrformats=[?25l[?1c[21;26H[?25h[?0c[?25l[?1c-100     0x100     077-10[?25h[?0c0[?25l[?1c     -100x100     077[21;13H[?25h[?0c[10C[?25l[?1c-001[?25h[?0c[?25l[?1c000 [?25h[?0c[20;25H[21;25H[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$-3,$wq! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 4 lines, 120 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test36.failed test.ok test.out X* viminfo
cp test36.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test36.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test36.in" 105 lines, 1950 characters[1;1HTest character classes in regexp using regexpengine 0, 1, 2.

STARTTEST
/^start-here/+1
Y:s/\%#=0\d//g
p:s/\%#=1\d//g
p:s/\%#=2\d//g
p:s/\%#=0[0-9]//g
p:s/\%#=1[0-9]//g
p:s/\%#=2[0-9]//g
p:s/\%#=0\D//g
p:s/\%#=1\D//g
p:s/\%#=2\D//g
p:s/\%#=0[^0-9]//g
p:s/\%#=1[^0-9]//g
p:s/\%#=2[^0-9]//g
p:s/\%#=0\o//g
p:s/\%#=1\o//g
p:s/\%#=2\o//g
p:s/\%#=0[0-7]//g
p:s/\%#=1[0-7]//g
p:s/\%#=2[0-7]//g
p:s/\%#=0\O//g
p:s/\%#=1\O//g[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest character classes in regexp using regexpengine 0, 1, 2.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 98 lines, 1775 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1Hp:s/\%#=0\L//g
p:s/\%#=1\L//g
p:s/\%#=2\L//g
p:s/\%#=0[^a-z]//g
p:s/\%#=1[^a-z]//g
p:s/\%#=2[^a-z]//g
p:s/\%#=0\u//g
p:s/\%#=1\u//g
p:s/\%#=2\u//g
p:s/\%#=0[A-Z]//g
p:s/\%#=1[A-Z]//g
p:s/\%#=2[A-Z]//g
p:s/\%#=0\U//g
p:s/\%#=1\U//g
p:s/\%#=2\U//g
p:s/\%#=0[^A-Z]//g
p:s/\%#=1[^A-Z]//g
p:s/\%#=2[^A-Z]//g
:/^start-here/+1,$wq! test.out
ENDTEST

start-here[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[20;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[21;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^start-here/+1[?25l[?1c[23;8H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/\%#=0\d//g[?25l[?1c10 substitutions on 1 line[23;29H:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m[34m^?~@~B~P~[[0m[24;1H[24;7H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1\d//g[?25l[?1c10 substitutions on 1 line[23;29H:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m[34m^?~@~B~P~[[0m[24;1H[24;7H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2\d//g[?25l[?1c10 substitutions on 1 line[23;29H:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m[34m^?~@~B~P~[[0m[24;1H[24;7H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0[0-9]//g[?25l[?1c10 substitutions on 1 line[23;29H:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m[34m^?~@~B~P~[[0m[24;1H[24;7H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1[0-9]//g[?25l[?1c10 substitutions on 1 line[23;29H:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m[34m^?~@~B~P~[[0m[24;1H[24;7H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2[0-9]//g[?25l[?1c10 substitutions on 1 line[23;29H:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m[34m^?~@~B~P~[[0m[24;1H[24;7H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0\D//g[?25l[?1c72 substitutions on 1 line[23;1H0123456789[23;11H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1\D//g[?25l[?1c72 substitutions on 1 line[23;1H0123456789[23;11H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2\D//g[?25l[?1c72 substitutions on 1 line[23;1H0123456789[23;11H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0[^0-9]//g[?25l[?1c72 substitutions on 1 line[23;1H0123456789[23;11H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1[^0-9]//g[?25l[?1c72 substitutions on 1 line[23;1H0123456789[23;11H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2[^0-9]//g[?25l[?1c72 substitutions on 1 line[23;1H0123456789[23;11H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0\o//g[?25l[?1c8 substitutions on 1 line[23;29H89:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m[34m^?~@~B~P[24;1H~[[0m[24;9H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1\o//g[?25l[?1c8 substitutions on 1 line[23;29H89:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m[34m^?~@~B~P[24;1H~[[0m[24;9H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2\o//g[?25l[?1c8 substitutions on 1 line[23;29H89:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m[34m^?~@~B~P[24;1H~[[0m[24;9H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0[0-7]//g[?25l[?1c8 substitutions on 1 line[23;29H89:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m[34m^?~@~B~P[24;1H~[[0m[24;9H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1[0-7]//g[?25l[?1c8 substitutions on 1 line[23;29H89:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m[34m^?~@~B~P[24;1H~[[0m[24;9H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2[0-7]//g[?25l[?1c8 substitutions on 1 line[23;29H89:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[1m[34m^?~@~B~P[24;1H~[[0m[24;9H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0\O//g[?25l[?1c74 substitutions on 1 line[23;1H01234567[23;9H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[1;1H[2M[1;25r[22;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[23;1H[1m[34m^?~@~B~P~[[0m
[1m[34m~                                                                               [0m[25;1H[K[22;9H[?25h[?0c[?25l[?1c


:[?25h[?0cs/\%#=1\O//g[?25l[?1c74 substitutions on 1 line[22;1H01234567[22;9H[K[23;1H[1m[34m~                                                                               [22;1H[?25h[?0c[?25l[?1c[0m
        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[24;17H[K[23;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/\%#=2\O//g[?25l[?1c74 substitutions on 1 line[23;1H01234567[23;9H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[1;1H[2M[1;25r[22;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[23;1H[1m[34m^?~@~B~P~[[0m
[1m[34m~                                                                               [0m[25;1H[K[22;9H[?25h[?0c[?25l[?1c


:[?25h[?0cs/\%#=0[^0-7]//g[?25l[?1c74 substitutions on 1 line[22;1H01234567[22;9H[K[23;1H[1m[34m~                                                                               [22;1H[?25h[?0c[?25l[?1c[0m
        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[24;17H[K[23;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/\%#=1[^0-7]//g[?25l[?1c74 substitutions on 1 line[23;1H01234567[23;9H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2[^0-7]//g[?25l[?1c74 substitutions on 1 line[23;1H01234567[23;9H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0\x//g[?25l[?1c22 substitutions on 1 line[23;29H:;<=>?@GHIXYZ[\]^_`ghiwxyz{|}~[1m[34m^?~@~B~P~[[0m[23;75H[K[24;1H[1m[34m~                                                                               [23;9H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1\x//g[?25l[?1c22 substitutions on 1 line[23;29H:;<=>?@GHIXYZ[\]^_`ghiwxyz{|}~[1m[34m^?~@~B~P~[[0m[23;75H[K[24;1H[1m[34m~                                                                               [23;9H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2\x//g[?25l[?1c22 substitutions on 1 line[23;29H:;<=>?@GHIXYZ[\]^_`ghiwxyz{|}~[1m[34m^?~@~B~P~[[0m[23;75H[K[24;1H[1m[34m~                                                                               [23;9H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0[0-9A-Fa-f]//g[?25l[?1c22 substitutions on 1 line[23;29H:;<=>?@GHIXYZ[\]^_`ghiwxyz{|}~[1m[34m^?~@~B~P~[[0m[23;75H[K[24;1H[1m[34m~                                                                               [23;9H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1[0-9A-Fa-f]//g[?25l[?1c22 substitutions on 1 line[23;29H:;<=>?@GHIXYZ[\]^_`ghiwxyz{|}~[1m[34m^?~@~B~P~[[0m[23;75H[K[24;1H[1m[34m~                                                                               [23;9H[?25h[?0c[?25l[?1c[1;24r[0m[1;1H[2M[1;25r[22;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[23;1H[1m[34m^?~@~B~P~[[0m
[1m[34m~                                                                               [0m[25;1H[K[22;9H[?25h[?0c[?25l[?1c


:[?25h[?0cs/\%#=2[0-9A-Fa-f]//g[?25l[?1c22 substitutions on 1 line[22;29H:;<=>?@GHIXYZ[\]^_`ghiwxyz{|}~[1m[34m^?~@~B~P~[[0m[22;75H[K[23;1H[1m[34m~                                                                               [22;9H[?25h[?0c[?25l[?1c[0m
        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[24;17H[K[23;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/\%#=0\X//g[?25l[?1c60 substitutions on 1 line[23;1H0123456789ABCDEFabcdef[23;23H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[1;1H[2M[1;25r[22;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[23;1H[1m[34m^?~@~B~P~[[0m
[1m[34m~                                                                               [0m[25;1H[K[22;9H[?25h[?0c[?25l[?1c


:[?25h[?0cs/\%#=1\X//g[?25l[?1c60 substitutions on 1 line[22;1H0123456789ABCDEFabcdef[22;23H[K[23;1H[1m[34m~                                                                               [22;1H[?25h[?0c[?25l[?1c[0m
        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[24;17H[K[23;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/\%#=2\X//g[?25l[?1c60 substitutions on 1 line[23;1H0123456789ABCDEFabcdef[23;23H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[1;1H[2M[1;25r[22;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[23;1H[1m[34m^?~@~B~P~[[0m
[1m[34m~                                                                               [0m[25;1H[K[22;9H[?25h[?0c[?25l[?1c


:[?25h[?0cs/\%#=0[^0-9A-Fa-f]//g[?25l[?1c60 substitutions on 1 line[22;1H0123456789ABCDEFabcdef[22;23H[K[23;1H[1m[34m~                                                                               [22;1H[?25h[?0c[?25l[?1c[0m
        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[24;17H[K[23;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/\%#=1[^0-9A-Fa-f]//g[?25l[?1c60 substitutions on 1 line[23;1H0123456789ABCDEFabcdef[23;23H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[1;1H[2M[1;25r[22;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[23;1H[1m[34m^?~@~B~P~[[0m
[1m[34m~                                                                               [0m[25;1H[K[22;9H[?25h[?0c[?25l[?1c


:[?25h[?0cs/\%#=2[^0-9A-Fa-f]//g[?25l[?1c60 substitutions on 1 line[22;1H0123456789ABCDEFabcdef[22;23H[K[23;1H[1m[34m~                                                                               [22;1H[?25h[?0c[?25l[?1c[0m
        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[24;17H[K[23;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/\%#=0\w//g[?25l[?1c36 substitutions on 1 line[23;29H:;<=>?@[\]^`{|}~[1m[34m^?~@~B~P~[[0m[23;61H[K[24;1H[1m[34m~                                                                               [23;9H[?25h[?0c[?25l[?1c[1;24r[0m[1;1H[2M[1;25r[22;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[23;1H[1m[34m^?~@~B~P~[[0m
[1m[34m~                                                                               [0m[25;1H[K[22;9H[?25h[?0c[?25l[?1c


:[?25h[?0cs/\%#=1\w//g[?25l[?1c36 substitutions on 1 line[22;29H:;<=>?@[\]^`{|}~[1m[34m^?~@~B~P~[[0m[22;61H[K[23;1H[1m[34m~                                                                               [22;9H[?25h[?0c[?25l[?1c[0m
        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[24;17H[K[23;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/\%#=2\w//g[?25l[?1c36 substitutions on 1 line[23;29H:;<=>?@[\]^`{|}~[1m[34m^?~@~B~P~[[0m[23;61H[K[24;1H[1m[34m~                                                                               [23;9H[?25h[?0c[?25l[?1c[1;24r[0m[1;1H[2M[1;25r[22;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[23;1H[1m[34m^?~@~B~P~[[0m
[1m[34m~                                                                               [0m[25;1H[K[22;9H[?25h[?0c[?25l[?1c


:[?25h[?0cs/\%#=0[0-9A-Za-z_]//g[?25l[?1c36 substitutions on 1 line[22;29H:;<=>?@[\]^`{|}~[1m[34m^?~@~B~P~[[0m[22;61H[K[23;1H[1m[34m~                                                                               [22;9H[?25h[?0c[?25l[?1c[0m
        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[24;17H[K[23;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/\%#=1[0-9A-Za-z_]//g[?25l[?1c36 substitutions on 1 line[23;29H:;<=>?@[\]^`{|}~[1m[34m^?~@~B~P~[[0m[23;61H[K[24;1H[1m[34m~                                                                               [23;9H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2[0-9A-Za-z_]//g[?25l[?1c36 substitutions on 1 line[23;29H:;<=>?@[\]^`{|}~[1m[34m^?~@~B~P~[[0m[23;61H[K[24;1H[1m[34m~                                                                               [23;9H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0\W//g[?25l[?1c46 substitutions on 1 line[23;1H0123456789ABCDEFGHIXYZ_abcdefghiwxyz[23;37H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1\W//g[?25l[?1c46 substitutions on 1 line[23;1H0123456789ABCDEFGHIXYZ_abcdefghiwxyz[23;37H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2\W//g[?25l[?1c46 substitutions on 1 line[23;1H0123456789ABCDEFGHIXYZ_abcdefghiwxyz[23;37H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0[^0-9A-Za-z_]//g[?25l[?1c46 substitutions on 1 line[23;1H0123456789ABCDEFGHIXYZ_abcdefghiwxyz[23;37H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1[^0-9A-Za-z_]//g[?25l[?1c46 substitutions on 1 line[23;1H0123456789ABCDEFGHIXYZ_abcdefghiwxyz[23;37H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2[^0-9A-Za-z_]//g[?25l[?1c46 substitutions on 1 line[23;1H0123456789ABCDEFGHIXYZ_abcdefghiwxyz[23;37H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0\h//g[?25l[?1c26 substitutions on 1 line[23;46H[\]^`{|}~[1m[34m^?~@~B~P~[[0m[23;71H[K[24;1H[1m[34m~                                                                               [23;9H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1\h//g[?25l[?1c26 substitutions on 1 line[23;46H[\]^`{|}~[1m[34m^?~@~B~P~[[0m[23;71H[K[24;1H[1m[34m~                                                                               [23;9H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2\h//g[?25l[?1c26 substitutions on 1 line[23;46H[\]^`{|}~[1m[34m^?~@~B~P~[[0m[23;71H[K[24;1H[1m[34m~                                                                               [23;9H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0[A-Za-z_]//g[?25l[?1c26 substitutions on 1 line[23;46H[\]^`{|}~[1m[34m^?~@~B~P~[[0m[23;71H[K[24;1H[1m[34m~                                                                               [23;9H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1[A-Za-z_]//g[?25l[?1c26 substitutions on 1 line[23;46H[\]^`{|}~[1m[34m^?~@~B~P~[[0m[23;71H[K[24;1H[1m[34m~                                                                               [23;9H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2[A-Za-z_]//g[?25l[?1c26 substitutions on 1 line[23;46H[\]^`{|}~[1m[34m^?~@~B~P~[[0m[23;71H[K[24;1H[1m[34m~                                                                               [23;9H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0\H//g[?25l[?1c56 substitutions on 1 line[23;1HABCDEFGHIXYZ_abcdefghiwxyz[23;27H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1\H//g[?25l[?1c56 substitutions on 1 line[23;1HABCDEFGHIXYZ_abcdefghiwxyz[23;27H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2\H//g[?25l[?1c56 substitutions on 1 line[23;1HABCDEFGHIXYZ_abcdefghiwxyz[23;27H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0[^A-Za-z_]//g[?25l[?1c56 substitutions on 1 line[23;1HABCDEFGHIXYZ_abcdefghiwxyz[23;27H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1[^A-Za-z_]//g[?25l[?1c56 substitutions on 1 line[23;1HABCDEFGHIXYZ_abcdefghiwxyz[23;27H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2[^A-Za-z_]//g[?25l[?1c56 substitutions on 1 line[23;1HABCDEFGHIXYZ_abcdefghiwxyz[23;27H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0\a//g[?25l[?1c25 substitutions on 1 line[23;46H[\]^_`{|}~[1m[34m^?~@~B~P~[[0m[23;72H[K[24;1H[1m[34m~                                                                               [23;9H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1\a//g[?25l[?1c25 substitutions on 1 line[23;46H[\]^_`{|}~[1m[34m^?~@~B~P~[[0m[23;72H[K[24;1H[1m[34m~                                                                               [23;9H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2\a//g[?25l[?1c25 substitutions on 1 line[23;46H[\]^_`{|}~[1m[34m^?~@~B~P~[[0m[23;72H[K[24;1H[1m[34m~                                                                               [23;9H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0[A-Za-z]//g[?25l[?1c25 substitutions on 1 line[23;46H[\]^_`{|}~[1m[34m^?~@~B~P~[[0m[23;72H[K[24;1H[1m[34m~                                                                               [23;9H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1[A-Za-z]//g[?25l[?1c25 substitutions on 1 line[23;46H[\]^_`{|}~[1m[34m^?~@~B~P~[[0m[23;72H[K[24;1H[1m[34m~                                                                               [23;9H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2[A-Za-z]//g[?25l[?1c25 substitutions on 1 line[23;46H[\]^_`{|}~[1m[34m^?~@~B~P~[[0m[23;72H[K[24;1H[1m[34m~                                                                               [23;9H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0\A//g[?25l[?1c57 substitutions on 1 line[23;1HABCDEFGHIXYZabcdefghiwxyz[23;26H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1\A//g[?25l[?1c57 substitutions on 1 line[23;1HABCDEFGHIXYZabcdefghiwxyz[23;26H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2\A//g[?25l[?1c57 substitutions on 1 line[23;1HABCDEFGHIXYZabcdefghiwxyz[23;26H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0[^A-Za-z]//g[?25l[?1c57 substitutions on 1 line[23;1HABCDEFGHIXYZabcdefghiwxyz[23;26H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1[^A-Za-z]//g[?25l[?1c57 substitutions on 1 line[23;1HABCDEFGHIXYZabcdefghiwxyz[23;26H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2[^A-Za-z]//g[?25l[?1c57 substitutions on 1 line[23;1HABCDEFGHIXYZabcdefghiwxyz[23;26H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0\l//g[?25l[?1c13 substitutions on 1 line[23;64H{|}~[1m[34m^?~@~B~P~[[0m[24;1H[24;4H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1\l//g[?25l[?1c13 substitutions on 1 line[23;64H{|}~[1m[34m^?~@~B~P~[[0m[24;1H[24;4H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2\l//g[?25l[?1c13 substitutions on 1 line[23;64H{|}~[1m[34m^?~@~B~P~[[0m[24;1H[24;4H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0[a-z]//g[?25l[?1c13 substitutions on 1 line[23;64H{|}~[1m[34m^?~@~B~P~[[0m[24;1H[24;4H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1[a-z]//g[?25l[?1c13 substitutions on 1 line[23;64H{|}~[1m[34m^?~@~B~P~[[0m[24;1H[24;4H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2[a-z]//g[?25l[?1c13 substitutions on 1 line[23;64H{|}~[1m[34m^?~@~B~P~[[0m[24;1H[24;4H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0\L//g[?25l[?1c69 substitutions on 1 line[23;1Habcdefghiwxyz[23;14H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1\L//g[?25l[?1c69 substitutions on 1 line[23;1Habcdefghiwxyz[23;14H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2\L//g[?25l[?1c69 substitutions on 1 line[23;1Habcdefghiwxyz[23;14H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0[^a-z]//g[?25l[?1c69 substitutions on 1 line[23;1Habcdefghiwxyz[23;14H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1[^a-z]//g[?25l[?1c69 substitutions on 1 line[23;1Habcdefghiwxyz[23;14H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2[^a-z]//g[?25l[?1c69 substitutions on 1 line[23;1Habcdefghiwxyz[23;14H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0\u//g[?25l[?1c12 substitutions on 1 line[23;46H[\]^_`abcdefghiwxyz{|}~[1m[34m^?~@~B~P~[[0m[24;1H[24;5H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1\u//g[?25l[?1c12 substitutions on 1 line[23;46H[\]^_`abcdefghiwxyz{|}~[1m[34m^?~@~B~P~[[0m[24;1H[24;5H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2\u//g[?25l[?1c12 substitutions on 1 line[23;46H[\]^_`abcdefghiwxyz{|}~[1m[34m^?~@~B~P~[[0m[24;1H[24;5H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0[A-Z]//g[?25l[?1c12 substitutions on 1 line[23;46H[\]^_`abcdefghiwxyz{|}~[1m[34m^?~@~B~P~[[0m[24;1H[24;5H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=1[A-Z]//g[?25l[?1c12 substitutions on 1 line[23;46H[\]^_`abcdefghiwxyz{|}~[1m[34m^?~@~B~P~[[0m[24;1H[24;5H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2[A-Z]//g[?25l[?1c12 substitutions on 1 line[23;46H[\]^_`abcdefghiwxyz{|}~[1m[34m^?~@~B~P~[[0m[24;1H[24;5H[K[23;9H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;9H[1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=0\U//g[?25l[?1c70 substitutions on 1 line[23;1HABCDEFGHIXYZ[23;14H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[1;1H[2M[1;25r[22;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[23;1H[1m[34m^?~@~B~P~[[0m
[1m[34m~                                                                               [0m[25;1H[K[22;9H[?25h[?0c[?25l[?1c


:[?25h[?0cs/\%#=1\U//g[?25l[?1c70 substitutions on 1 line[22;1HABCDEFGHIXYZ[22;14H[K[23;1H[1m[34m~                                                                               [22;1H[?25h[?0c[?25l[?1c[0m
        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[24;17H[K[23;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/\%#=2\U//g[?25l[?1c70 substitutions on 1 line[23;1HABCDEFGHIXYZ[23;14H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[1;1H[2M[1;25r[22;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[23;1H[1m[34m^?~@~B~P~[[0m
[1m[34m~                                                                               [0m[25;1H[K[22;9H[?25h[?0c[?25l[?1c


:[?25h[?0cs/\%#=0[^A-Z]//g[?25l[?1c70 substitutions on 1 line[22;1HABCDEFGHIXYZ[22;14H[K[23;1H[1m[34m~                                                                               [22;1H[?25h[?0c[?25l[?1c[0m
        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[24;17H[K[23;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/\%#=1[^A-Z]//g[?25l[?1c70 substitutions on 1 line[23;1HABCDEFGHIXYZ[23;14H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H        [1m[34m^L^M[0m !"#$%&'()#+'-./0123456789:;<=>?@ABCDEFGHIXYZ[\]^_`abcdefghiwxyz{|}~[24;1H[1m[34m^?~@~B~P~[[0m[25;1H[K[23;9H[?25h[?0c[?25l[?1c

:[?25h[?0cs/\%#=2[^A-Z]//g[?25l[?1c70 substitutions on 1 line[23;1HABCDEFGHIXYZ[23;14H[K[24;1H[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c/^start-here/+1,$wq! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 96 lines, 4032 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test37.failed test.ok test.out X* viminfo
cp test37.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test37.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test37.in" 116 lines, 3262 characters[1;1HTest for 'scrollbind'. <eralston@computer.org>   Do not add a line below!
STARTTEST
:so small.vim
:set noscrollbind
:set scrollopt=ver,jump
:set scrolloff=2
:set nowrap
:set noequalalways
:set splitbelow
:" TEST using two windows open to one buffer, one extra empty window
:split
:new
[1m[34m^W[0mt:
:resize 8
/^start of window 1$/
zt:
:set scrollbind
[1m[34m^W[0mj:
:resize 7
/^start of window 2$/
zt:
:set scrollbind
:" -- start of tests --
:" TEST scrolling down[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for 'scrollbind'. <eralston@computer.org>   Do not add a line below![25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[2;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 72 lines, 1498 characters written[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[3;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1HHk[1m[34m^W[0mtH[1m[34m^W[0mjHyy[1m[34m^W[0mbp[1m[34m^W[0mtyy[1m[34m^W[0mbp:
[1m[34m^W[0mt:set noscb
ggL[1m[34m^W[0mj:set noscb
ggL:set scb
[1m[34m^W[0mt:set scb
[1m[34m^W[0mtG[1m[34m^W[0mjG[1m[34m^W[0mt:syncbind
Hk[1m[34m^W[0mjH[1m[34m^W[0mtHyy[1m[34m^W[0mbp[1m[34m^W[0mt[1m[34m^W[0mjyy[1m[34m^W[0mbp:
[1m[34m^W[0mtH3k[1m[34m^W[0mjH[1m[34m^W[0mtHyy[1m[34m^W[0mbp[1m[34m^W[0mt[1m[34m^W[0mjyy[1m[34m^W[0mbp:
:" ***** done with tests *****
:w! test.out[13C" Write contents of this file
:qa!
ENDTEST


start of window 1
. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02
. line 03 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03
. line 04 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04
. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05
. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06
. line 07 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 07
. line 08 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 08
. line 09 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset noscrollbind[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset scrollopt=ver,jump[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset scrolloff=2[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nowrap[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset noequalalways[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset splitbelow[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" TEST using two windows open to one buffer, one extra empty window[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csplit[?25l[?1c[1;1H[1m[34m^W[0mtH3k[4C[1m[34m^W[0mtHyy[2Cbp[1m[34m^W[0mt[1m[34m^W[0mjyy[1m[34m^W[0mbp:
:" ***** done with tests *****
:w! test.out    [9C" Write contents of this file
:qa![4;5H[K[5;1HENDTEST[5;9H[K[6;1H[K[7;1H[K[8;1Hstart of window 1[8;18H[K[9;1H. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[10;51H[K[11;1H. line 03 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03
[7mtest37.in                                                                       [0m[13;1H[1m[34m^W[0mtH3k[1m[34m^W[0mjH[1m[34m^W[0mtHyy[1m[34m^W[0mbp[1m[34m^W[0mt[1m[34m^W[0mjyy[1m[34m^W[0mbp:
:" ***** done with tests *****
:w! test.out     [8C" Write contents of this file
:qa![16;5H[K[17;1HENDTEST[17;8H[K[18;1H[K[19;1H[K[20;1Hstart of window 1[20;18H[K[21;9H1[39C1[22;9H2[39C2[23;9H3[39C3
[1m[7mtest37.in                                                                       [18;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cnew[?25l[?1c[13;1H:qa![13;5H[K[14;1HENDTEST[14;8H[K[15;1H[K[16;1H[K[17;1Hstart of window 1
[7mtest37.in                                                                       [0m[20;1H[1m[34m~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [0m[24;1H[1m[7m[No Name][19;1H[?25h[?0c[12;1Htest37.in                                                                       [0m[24;1H[7m[No Name]                                                                       [6;1H[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c[?25l[?1c[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cresize 8[?25l[?1c[1;1H:" ***** done with tests *****[1;31H[K[2;2Hw! test.out             " Write contents of this file
:qa![3;5H[K[4;1HENDTEST[5;1H[K[7;1Hstart of window 1
. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
[1m[7mtest37.in                                                                       [0m[10;1H:" ***** done with tests *****[10;31H[K[11;1H:w! test.out             " Write contents of this file
:qa![12;5H[K[13;1HENDTEST[14;1H[K[16;1Hstart of window 1
. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^start of window 1$/[?25l[?1c[25;21H[K[25;1H[1;8r[8;1H
[1;25r[8;1H. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[25;1H[K[6;1H[?25h[?0c[?25l[?1c[1;8r[1;1H[3M[1;25r[6;1H. line 03 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03
. line 04 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04
. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05[3;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset scrollbind[?25l[?1c[3;1H[?25h[?0c[9;1H[7mtest37.in                                                                       [0m[18;1H[1m[7mtest37.in                                                                       [14;1H[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c[?25l[?1c[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cresize 7[?25l[?1c[10;2Hw! test.out             " Write contents of this file
:qa![11;5H[K[12;1HENDTEST[13;1H[K[15;1Hstart of window 1
. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
[1m[7mtest37.in                                                                       [0m[18;1H[K[19;1H[1m[34m~                                                                               [13;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H/[?25h[?0c^start of window 2$/[?25l[?1c[25;21H[K[25;1H[10;1Hend of window 1[10;26H[K[11;1H[K[12;1H[K[13;1Hstart of window 2
. line 01 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 01
. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02[16;9H3 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 03[13;1H[?25h[?0c[?25l[?1c[10;16r[16;1H
[1;25r[16;1H. line 04 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 04[25;1H[K[12;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset scrollbind[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" -- start of tests --[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" TEST scrolling down[?25l[?1c[12;1H[?25h[?0c

[?25l[?1c[1;8r[1;1H[5M[1;25r[4;1H. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06
. line 07 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 07
. line 08 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 08
. line 09 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09
. line 10 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 10[10;16r[10;1H[5M[1;25r[12;1H. line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 05
. line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06
. line 07 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 07
. line 08 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 08
. line 09 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 09[25;1H[K[14;1H[?25h[?0c[12;1H[17;1H[7mtest37.in                                                                       [0m[24;1H[1m[7m[No Name]                                                                       [18;1H[?25l[?1c[0m
. line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 05[19;50H[K[24;11H[1m[7m[+][19;1H[?25h[?0c[?25l[?1c[0m0[?25h[?0c[9;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [3;1H[9;1Htest37.in                                                                       [0m[24;1H[1m[7m[No Name] [+]                                                                   [19;1H[?25l[?1c[0m
. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05[20;50H[K[20;1H[?25h[?0c[?25l[?1c1[?25h[?0c[9;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [3;1H


[?25l[?1c[1;8r[0m[1;1H[6M[1;25r[3;1H. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
. line 12 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 12
. line 13 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 13
. line 14 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 14
. line 15 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 15
end of window 1[10;16r[10;1H[6M[1;25r[11;1H. line 10 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 10
. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11
. line 12 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 12
. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13
. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15[6;1H[?25h[?0c[3;1H[9;1H[7mtest37.in                                                                       [0m[24;1H[1m[7m[No Name] [+]                                                                   [20;1H[?25l[?1c[0m
. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11[21;50H[K[21;1H[?25h[?0c[?25l[?1c2[?25h[?0c[17;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [12;1H[17;1Htest37.in                                                                       [0m[24;1H[1m[7m[No Name] [+]                                                                   [21;1H[?25l[?1c[0m
. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11[22;50H[K[22;1H[?25h[?0c[?25l[?1c3[?25h[?0c[?25l[?1c


:[?25h[?0c[?25l[?1c[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" TEST scrolling up[?25l[?1c[22;1H[?25h[?0c[9;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [3;1H[?25l[?1c[1;8r[0m[1;1H[5L[1;25r[1;1H. line 04 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04
. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05
. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06
. line 07 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 07
. line 08 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 08[10;9H4[39C4[11;8H05[38C05[12;8H06[38C06[13;8H07[38C07[14;8H08[38C08[15;8H09[38C09[16;9H0[39C0[25;1H[K[4;1H[?25h[?0c[9;1H[7mtest37.in                                                                       [0m[17;1H[1m[7mtest37.in                                                                       [14;1H[12;1H[9;1Htest37.in                                                                       [0m[17;1H[7mtest37.in                                                                       [4;1H[3;1H[9;1Htest37.in                                                                       [0m[24;1H[1m[7m[No Name] [+]                                                                   [22;1H[?25l[?1c[0m
. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06[23;50H[K[23;1H[?25h[?0c[?25l[?1c4[?25h[?0c[17;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [12;1H[17;1Htest37.in                                                                       [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[18;23r[0m[23;1H
[1;25r[23;1H. line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06[?25h[?0c[?25l[?1c5[?25h[?0c[17;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [12;1H[?25l[?1c[1;8r[0m[1;1H[4L[1;25r[1;1Hstart of window 1
. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02
. line 03 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03[10;16r[10;1H[4L[1;25r[10;1Hstart of window 2
. line 01 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 01
. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02
. line 03 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 03[?25h[?0c[9;1H[1m[7mtest37.in                                                                       [0m[17;1H[7mtest37.in                                                                       [6;1H[3;1H[9;1Htest37.in                                                                       [0m[17;1H[1m[7mtest37.in                                                                       [13;1H[12;1H[0m[17;1H[7mtest37.in                                                                       [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[18;23r[0m[23;1H
[1;25r[23;1H. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02[?25h[?0c[?25l[?1c6[?25h[?0c[9;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [3;1H[9;1Htest37.in                                                                       [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[18;23r[0m[23;1H
[1;25r[23;1H. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[?25h[?0c[?25l[?1c7[?25h[?0c[?25l[?1c

:[?25h[?0c[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" TEST horizontal scrolling[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset scrollopt+=hor[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[18;23r[18;1H[3L[1;25r[19;1H0 line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 05
1 line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05[25;1H[K[18;1H[?25h[?0c[?25l[?1c[18;23r[18;1H[3M[1;25r[21;1H5 line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06
6 line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02
7 line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[?25h[?0c[?25l[?1c[18;23r[23;1H
[1;25r[23;1H[?25h[?0c[9;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [3;1H[?25l[?1c[0m[1;1H 1[1;3H[K[2;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01[2;35H[K[3;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[3;35H[K[4;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03[4;35H[K[5;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04[5;35H[K[6;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05[6;35H[K[7;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06[7;35H[K[8;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 07[8;35H[K[10;1H 2[10;3H[K[11;1HUTSRQPONMLKJIHGREDCBA9876543210 01[11;35H[K[12;1HUTSRQPONMLKJIHGREDCBA9876543210 02[12;35H[K[13;1HUTSRQPONMLKJIHGREDCBA9876543210 03[13;35H[K[14;1HUTSRQPONMLKJIHGREDCBA9876543210 04[14;35H[K[15;1HUTSRQPONMLKJIHGREDCBA9876543210 05[15;35H[K[16;1HUTSRQPONMLKJIHGREDCBA9876543210 06[16;35H[K[3;1H[?25h[?0c[9;1H[7mtest37.in                                                                       [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[0m56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[?25h[?0c[?25l[?1c[18;23r[23;1H
[1;25r[23;1H[?25h[?0c[17;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [12;1H[17;1Htest37.in                                                                       [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[0mUTSRQPONMLKJIHGREDCBA9876543210 02[?25h[?0c[?25l[?1c[18;23r[23;1H
[1;25r[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0c[?25l[?1c[23;1H[?25h[?0c[17;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [12;1H[?25l[?1c[0m[1;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09[2;33H10[3;33H11[4;33H12[5;33H13[6;33H14[7;33H15[8;1H[K[10;1HUTSRQPONMLKJIHGREDCBA9876543210 09[11;33H10[12;33H11[13;33H12[14;33H13[15;33H14[16;33H15[13;1H[?25h[?0c[?25l[?1c[1;1H. line 09 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09
. line 10 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 10
. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
. line 12 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 12
. line 13 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 13
. line 14 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 14
. line 15 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 15
end of window 1

. line 09 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 09
. line 10 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 10
. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11
. line 12 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 12
. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13
. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15[12;1H[?25h[?0c[?25l[?1c[?25h[?0c[17;1H[7mtest37.in                                                                       [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[0m. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11[?25h[?0c[?25l[?1c[18;23r[23;1H
[1;25r[25;1H[K[23;1H[?25h[?0c[9;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [3;16H[9;1Htest37.in                                                                       [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[0m. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11[?25h[?0c[?25l[?1c[18;23r[23;1H
[1;25r[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0c[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset scrollopt-=hor[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" ****** tests using two different buffers *****[?25l[?1c[23;1H[?25h[?0c[9;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [3;1H[9;1Htest37.in                                                                       [0m[17;1H[1m[7mtest37.in                                                                       [12;1H[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cclose[?25l[?1c[9;1H[K[10;1H[K[11;1Hstart of window 2[11;18H[K[12;8H0[39C0[13;8H0[39C0[14;8H0[39C0[15;8H0[39C0[16;8H0[39C0[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset noscrollbind[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^start of window 2$/,/^end of window 2$/y[?25l[?1c18 lines yanked[25;16H[K[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnew[?25l[?1c[8;1H[7mtest37.in                                                                       [0m[10;1H[1m[34m~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [0m[17;1H[1m[7m[No Name][9;1H[?25h[?0c[8;1Htest37.in                                                                       [0m[17;1H[7m[No Name]                                                                       [3;1H[8;1Htest37.in                                                                       [0m[17;1H[1m[7m[No Name]                                                                       [9;1H[?25l[?1c[0m[25;1H4 more lines[10;1H[K[11;1H[K[12;1H[K[13;1H[K[17;11H[1m[7m[+][10;1H[?25h[?0c


[?25l[?1c[0m[25;1H18 more lines[14;1Hstart of window 2[14;18H[K[15;1H. line 01 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 01[15;50H[K[16;1H. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02[16;50H[K[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[?25l[?1c[14;1H[?25h[?0c[8;1H[1m[7mtest37.in                                                                       [0m[17;1H[7m[No Name] [+]                                                                   [3;1H[?25l[?1c[0m[25;1H[K[25;1H/[?25h[?0c^start of window 1$/[?25l[?1c[25;21H[K[25;1H[1m[31msearch hit BOTTOM, continuing at TOP[0m[1;1HENDTEST[1;8H[K[2;1H[K[3;1H[K[4;1Hstart of window 1[4;18H[K[5;8H01[38C01[6;8H02[38C02[7;8H03[38C03[4;1H[?25h[?0c[?25l[?1c[1;7r[7;1H
[1;25r[7;1H. line 04 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset scrollbind[?25l[?1c[3;1H[?25h[?0c[8;1H[7mtest37.in                                                                       [0m[17;1H[1m[7m[No Name] [+]                                                                   [14;1H[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c[?25l[?1c[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^start of window 2$/[?25l[?1c[25;21H[K[25;1H[1m[31msearch hit BOTTOM, continuing at TOP[14;1H[?25h[?0c[?25l[?1c[9;16r[0m[9;1H[3M[1;25r[14;1H. line 03 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 03
. line 04 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 04
. line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 05[25;1H[K[11;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c[?25l[?1c[11;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset scrollbind[?25l[?1c[11;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" -- start of tests --[?25l[?1c[11;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" TEST scrolling down[?25l[?1c[11;1H[?25h[?0c


[?25l[?1c[1;7r[1;1H[5M[1;25r[3;1H. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05
. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06
. line 07 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 07
. line 08 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 08
. line 09 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09[9;16r[9;1H[5M[1;25r[12;1H. line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06
. line 07 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 07
. line 08 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 08
. line 09 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 09
. line 10 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 10[25;1H[K[14;1H[?25h[?0c[11;1H[17;1H[7m[No Name] [+]                                                                   [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[18;23r[0m[23;1H
[1;25r[23;1H. line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 05[?25h[?0c[?25l[?1c0[?25h[?0c[8;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [3;1H[8;1Htest37.in                                                                       [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[18;23r[0m[23;1H
[1;25r[23;1H. line 05 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05[?25h[?0c[?25l[?1c1[?25h[?0c[8;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [3;1H

[?25l[?1c[1;7r[0m[1;1H[6M[1;25r[2;1H. line 10 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 10
. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
. line 12 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 12
. line 13 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 13
. line 14 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 14
. line 15 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 15[9;16r[9;1H[6M[1;25r[11;1H. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11
. line 12 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 12
. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13
. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16[5;1H[?25h[?0c[3;1H[8;1H[7mtest37.in                                                                       [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[18;23r[0m[23;1H
[1;25r[23;1H. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11[?25h[?0c[?25l[?1c2[?25h[?0c[17;1H[1m[7m[No Name] [+]                                                                   [0m[24;1H[7m[No Name] [+]                                                                   [11;1H[17;1H[No Name] [+]                                                                   [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[18;23r[0m[23;1H
[1;25r[23;1H. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11[?25h[?0c[?25l[?1c3[?25h[?0c[?25l[?1c

:[?25h[?0c[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" TEST scrolling up[?25l[?1c[23;1H[?25h[?0c[8;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [3;1H[?25l[?1c[0m[1;9H4[39C4[2;8H05[38C05[3;8H06[38C06[4;8H07[38C07[5;8H08[38C08[6;8H09[38C09[7;9H0[39C0[9;16r[9;1H[5L[1;25r[9;1H. line 04 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 04
. line 05 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 05
. line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06
. line 07 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 07
. line 08 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 08[25;1H[K[4;1H[?25h[?0c[8;1H[7mtest37.in                                                                       [0m[17;1H[1m[7m[No Name] [+]                                                                   [14;1H[11;1H[8;1Htest37.in                                                                       [0m[17;1H[7m[No Name] [+]                                                                   [4;1H[3;1H[8;1Htest37.in                                                                       [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[18;23r[0m[23;1H
[1;25r[23;1H. line 06 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06[?25h[?0c[?25l[?1c4[?25h[?0c[17;1H[1m[7m[No Name] [+]                                                                   [0m[24;1H[7m[No Name] [+]                                                                   [11;1H[17;1H[No Name] [+]                                                                   [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[18;23r[0m[23;1H
[1;25r[23;1H. line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06[?25h[?0c[?25l[?1c5[?25h[?0c[17;1H[1m[7m[No Name] [+]                                                                   [0m[24;1H[7m[No Name] [+]                                                                   [11;1H[?25l[?1c[1;7r[0m[1;1H[4L[1;25r[1;1Hstart of window 1
. line 01 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01
. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02
. line 03 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03[9;16r[9;1H[4L[1;25r[9;1Hstart of window 2
. line 01 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 01
. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02
. line 03 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 03[?25h[?0c[8;1H[1m[7mtest37.in                                                                       [0m[17;1H[7m[No Name] [+]                                                                   [5;1H[3;1H[8;1Htest37.in                                                                       [0m[17;1H[1m[7m[No Name] [+]                                                                   [12;1H[11;1H[0m[17;1H[7m[No Name] [+]                                                                   [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[18;23r[0m[23;1H
[1;25r[23;1H. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02[?25h[?0c[?25l[?1c6[?25h[?0c[8;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [3;1H[8;1Htest37.in                                                                       [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[18;23r[0m[23;1H
[1;25r[23;1H. line 02 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[?25h[?0c[?25l[?1c7[?25h[?0c[?25l[?1c

:[?25h[?0c[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" TEST horizontal scrolling[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset scrollopt+=hor[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[18;1H[K[19;1H0 line 05[38C05
1[7C5[39C5
2 line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
3 line 11[38C11
4[7C6[39C6[18;1H[?25h[?0c[?25l[?1c2 line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
3 line 11[38C11
4[7C6[39C6
5 line 06 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 06
6 line 02[38C02
7[7C2[39C2[?25h[?0c[?25l[?1c[18;23r[23;1H
[1;25r[25;1H[K[23;1H[?25h[?0c[8;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [3;1H[?25l[?1c[0m[1;1H 1[1;3H[K[2;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 01[2;35H[K[3;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[3;35H[K[4;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 03[4;35H[K[5;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 04[5;35H[K[6;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 05[6;35H[K[7;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 06[7;35H[K[9;1H 2[9;3H[K[10;1HUTSRQPONMLKJIHGREDCBA9876543210 01[10;35H[K[11;1HUTSRQPONMLKJIHGREDCBA9876543210 02[11;35H[K[12;1HUTSRQPONMLKJIHGREDCBA9876543210 03[12;35H[K[13;1HUTSRQPONMLKJIHGREDCBA9876543210 04[13;35H[K[14;1HUTSRQPONMLKJIHGREDCBA9876543210 05[14;35H[K[15;1HUTSRQPONMLKJIHGREDCBA9876543210 06[15;35H[K[16;1HUTSRQPONMLKJIHGREDCBA9876543210 07[16;35H[K[3;1H[?25h[?0c[8;1H[7mtest37.in                                                                       [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[0m56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 02[?25h[?0c[?25l[?1c[18;23r[23;1H
[1;25r[23;1H[?25h[?0c[17;1H[1m[7m[No Name] [+]                                                                   [0m[24;1H[7m[No Name] [+]                                                                   [11;1H[17;1H[No Name] [+]                                                                   [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[0mUTSRQPONMLKJIHGREDCBA9876543210 02[?25h[?0c[?25l[?1c[18;23r[23;1H
[1;25r[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0c[?25l[?1c[23;1H[?25h[?0c[17;1H[1m[7m[No Name] [+]                                                                   [0m[24;1H[7m[No Name] [+]                                                                   [11;1H[?25l[?1c[0m[1;1H56789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09[2;33H10[3;33H11[4;33H12[5;33H13[6;33H14[7;33H15

UTSRQPONMLKJIHGREDCBA9876543210 09[10;33H10[11;33H11[12;33H12[13;33H13[14;33H14[15;33H15[16;33H16[12;1H[?25h[?0c[?25l[?1c[1;1H. line 09 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 09
. line 10 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 10
. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11
. line 12 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 12
. line 13 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 13
. line 14 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 14
. line 15 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 15

. line 09 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 09
. line 10 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 10
. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11
. line 12 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 12
. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13
. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16[11;1H[?25h[?0c[?25l[?1c[?25h[?0c[17;1H[7m[No Name] [+]                                                                   [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[0m. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11[?25h[?0c[?25l[?1c[18;23r[23;1H
[1;25r[25;1H[K[23;1H[?25h[?0c[8;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [3;16H[8;1Htest37.in                                                                       [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[0m. line 11 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ 11[?25h[?0c[?25l[?1c[18;23r[23;1H
[1;25r[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0c[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset scrollopt-=hor[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" TEST syncbind[?25l[?1c[23;1H[?25h[?0c[8;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [3;1H[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset noscb[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[1;1HTest for 'scrollbind'. <eralston@computer.org>   Do not add a line below!
STARTTEST[2;11H[K[3;1H:so small.vim[3;14H[K[4;1H:set noscrollbind[4;18H[K[5;1H:set scrollopt=ver,jump[5;24H[K[6;1H:set scrolloff=2[6;17H[K[7;1H:set nowrap[7;12H[K[1;1H[?25h[?0c[5;1H


[7mtest37.in                                                                       [0m[17;1H[1m[7m[No Name] [+]                                                                   [11;1H[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset noscb[?25l[?1c[11;1H[?25h[?0c[?25l[?1c[9;1H[K[10;1H[K[11;1H[K[12;1H[K[13;1H[K[14;1Hstart of window 2[14;18H[K[15;8H01[38C01[16;8H02[38C02[9;1H[?25h[?0c[14;1H[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset scb[?25l[?1c[14;1H[?25h[?0c[8;1H[1m[7mtest37.in                                                                       [0m[17;1H[7m[No Name] [+]                                                                   [5;1H[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset scb[?25l[?1c[5;1H[?25h[?0c[?25l[?1c[1;1H. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13[1;50H[K[2;1H. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16
end of window 2[5;16H[K[6;1H[K[7;1Hend of test37.in (please don't delete this line)

end of window 2
[1m[34m~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [7;1H[?25h[?0c[?25l[?1c[0m[1;1Hzt:[1;4H[K[2;1H:set scrollbind[2;16H[K[3;1H:" -- start of tests --[3;24H[K[4;1H:" TEST scrolling down[4;23H[K[5;1HL5jHyy[1m[34m^W[0mbpr0[1m[34m^W[0mtHyy[1m[34m^W[0mbpr1[1m[34m^W[0mtL6jHyy[1m[34m^W[0mbpr2[1m[34m^W[0mkHyy[1m[34m^W[0mbpr3:
:" TEST scrolling up
[1m[34m^W[0mtH4k[1m[34m^W[0mjH[1m[34m^W[0mtHyy[1m[34m^W[0mbpr4[1m[34m^W[0mkHyy[1m[34m^W[0mbpr5[1m[34m^W[0mk3k[1m[34m^W[0mtH[1m[34m^W[0mjHyy[1m[34m^W[0mbpr6[1m[34m^W[0mtHyy[1m[34m^W[0mbpr7:
[7mtest37.in                                                                       [9;16r[0m[9;1H[2L[1;25r[9;1H. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16[17;1H[1m[7m[No Name] [+]                                                                   [0m[25;1H[K[11;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0csyncbind[?25l[?1c[11;1H[?25h[?0c[?25l[?1c[1;7r[1;1H[L[1;25r[1;1H/^start of window 2$/[9;16r[9;1H[L[1;25r[9;1H. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14[25;1H[K[11;1H[?25h[?0c[8;1H[1m[7mtest37.in                                                                       [0m[17;1H[7m[No Name] [+]                                                                   [5;1H[3;1H[8;1Htest37.in                                                                       [0m[17;1H[1m[7m[No Name] [+]                                                                   [11;1H[0m[17;1H[7m[No Name] [+]                                                                   [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[18;23r[0m[23;1H
[1;25r[23;1H. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16[?25h[?0c[8;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [3;1H[8;1Htest37.in                                                                       [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[18;23r[0m[23;1H
[1;25r[23;1H:set scrollbind[?25h[?0c[?25l[?1c

:[?25h[?0c[?25l[?1c[23;1H[?25h[?0c[8;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [3;1H[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset noscb[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[1;1HTest for 'scrollbind'. <eralston@computer.org>   Do not add a line below!
STARTTEST
:so small.vim[3;14H[K[4;2Hset noscrollbind[4;18H[K[5;2Hset scrollopt=ver,jump
:set scrolloff=2[6;17H[K[7;2Hset nowrap[7;12H[K[1;1H[?25h[?0c[5;1H


[7mtest37.in                                                                       [0m[17;1H[1m[7m[No Name] [+]                                                                   [11;1H[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset noscb[?25l[?1c[11;1H[?25h[?0c[?25l[?1c[9;1H[K[10;1H[K[11;1H[K[12;1H[K[13;1H[K[14;1Hstart of window 2[14;18H[K[15;1H. line 01 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 01[15;50H[K[16;1H. line 02 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 02[16;50H[K[9;1H[?25h[?0c[14;1H[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset scb[?25l[?1c[14;1H[?25h[?0c[8;1H[1m[7mtest37.in                                                                       [0m[17;1H[7m[No Name] [+]                                                                   [5;1H[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset scb[?25l[?1c[5;1H[?25h[?0c[?25l[?1c[1;1H. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13[1;50H[K[2;1H. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14
. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16
end of window 2[5;16H[K[6;1H[K[7;1Hend of test37.in (please don't delete this line)

end of window 2
[1m[34m~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [7;1H[?25h[?0c[?25l[?1c[0m[1;1Hzt:[1;4H[K[2;1H:set scrollbind[2;16H[K[3;1H:" -- start of tests --[3;24H[K[4;1H:" TEST scrolling down[4;23H[K[5;1HL5jHyy[1m[34m^W[0mbpr0[1m[34m^W[0mtHyy[1m[34m^W[0mbpr1[1m[34m^W[0mtL6jHyy[1m[34m^W[0mbpr2[1m[34m^W[0mkHyy[1m[34m^W[0mbpr3:
:" TEST scrolling up
[1m[34m^W[0mtH4k[1m[34m^W[0mjH[1m[34m^W[0mtHyy[1m[34m^W[0mbpr4[1m[34m^W[0mkHyy[1m[34m^W[0mbpr5[1m[34m^W[0mk3k[1m[34m^W[0mtH[1m[34m^W[0mjHyy[1m[34m^W[0mbpr6[1m[34m^W[0mtHyy[1m[34m^W[0mbpr7:
[7mtest37.in                                                                       [9;16r[0m[9;1H[2L[1;25r[9;1H. line 15 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 15
. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16[17;1H[1m[7m[No Name] [+]                                                                   [0m[25;1H[K[11;1H[?25h[?0c[8;1H[1m[7mtest37.in                                                                       [0m[17;1H[7m[No Name] [+]                                                                   [5;1H[?25l[?1c[25;1H[0m:[?25h[?0csyncbind[?25l[?1c[5;1H[?25h[?0c[3;1H[?25l[?1c[1;7r[1;1H[L[1;25r[1;1H/^start of window 2$/[9;16r[9;1H[L[1;25r[9;1H. line 14 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 14[25;1H[K[3;1H[?25h[?0c[8;1H[7mtest37.in                                                                       [0m[17;1H[1m[7m[No Name] [+]                                                                   [12;1H[11;1H[8;1Htest37.in                                                                       [0m[17;1H[7m[No Name] [+]                                                                   [3;1H[8;1Htest37.in                                                                       [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[18;23r[0m[23;1H
[1;25r[23;1H:set scrollbind[?25h[?0c[8;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [3;1H[8;1Htest37.in                                                                       [0m[17;1H[1m[7m[No Name] [+]                                                                   [11;1H[0m[17;1H[7m[No Name] [+]                                                                   [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[18;23r[0m[23;1H
[1;25r[23;1H. line 16 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 16[?25h[?0c[?25l[?1c

:[?25h[?0c[?25l[?1c[23;1H[?25h[?0c[8;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [3;1H[?25l[?1c[1;7r[0m[1;1H[4L[1;25r[1;1Hzt:
:set scrollbind
[1m[34m^W[0mj:
:resize 7[9;16r[9;1H[4L[1;25r[9;1H. line 10 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 10
. line 11 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 11
. line 12 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 12
. line 13 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 13[25;1H[K[4;1H[?25h[?0c[8;1H[7mtest37.in                                                                       [0m[17;1H[1m[7m[No Name] [+]                                                                   [15;1H[11;1H[8;1Htest37.in                                                                       [0m[17;1H[7m[No Name] [+]                                                                   [4;1H[3;1H[8;1Htest37.in                                                                       [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[18;23r[0m[23;1H
[1;25r[23;1H[1m[34m^W[0mj:[?25h[?0c[8;1H[1m[7mtest37.in                                                                       [0m[24;1H[7m[No Name] [+]                                                                   [3;1H[8;1Htest37.in                                                                       [0m[17;1H[1m[7m[No Name] [+]                                                                   [11;1H[0m[17;1H[7m[No Name] [+]                                                                   [0m[24;1H[1m[7m[No Name] [+]                                                                   [23;1H[?25l[?1c[18;23r[0m[23;1H
[1;25r[23;1H. line 12 ZYXWVUTSRQPONMLKJIHGREDCBA9876543210 12[?25h[?0c[?25l[?1c

:[?25h[?0c[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" ***** done with tests *****[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! test.out             " Write contents of this file[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 33 lines, 1329 characters written[24;1H[1m[7mtest.out     [23;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test38.failed test.ok test.out X* viminfo
cp test38.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test38.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test38.in" 35 lines, 455 characters[2;1HTest Virtual replace mode.

STARTTEST
:so small.vim
:" make sure that backspace works, no matter what termcap is used
:set t_kD=[1m[34m^V[0mx7f t_kb=[1m[34m^V[0mx08
ggdGa
abcdefghi
jk      lmn
    opq rst
[1m[34m^D[0muvwxyz
[1m[34m^[[0mgg:set ai
:set bs=2
gR0[1m[34m^D[0m 1
A
BCDEFGHIJ[18;9HKL
MNO
PQR[1m[34m^[[0mG:ka
o0[1m[34m^D[0m
abcdefghi
jk      lmn
    opq rst[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[4;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 29 lines, 407 characters written[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[10M[1;25r[15;1H[1m[34m^D[0muvwxyz
[1m[34m^[[0m'ajgR0[1m[34m^D[0m 1
A
BCDEFGHIJ[19;9HKL
MNO
PQR[1m[34m^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^[[0m:$
iab     cdefghi jkl[1m[34m^[[0m0gRAB......CDEFGHI.J[1m[34m^[[0mo[1m[34m^[[0m:
iabcdefghijklmnopqrst[1m[34m^[[0m0gRAB    IJKLMNO QR[1m[34m^[[0m:wq! test.out
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" make sure that backspace works, no matter what termcap is used[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset t_kD=^[1m[34m^?[0m t_kb=^[1m[34m^H[?25l[?1c[27m[24m[0m[H[J[1;1H[1m[34m^D[0muvwxyz
[1m[34m^[[0mgg:set ai
:set bs=2
gR0[1m[34m^D[0m 1
A
BCDEFGHIJ[7;9HKL
MNO
PQR[1m[34m^[[0mG:ka
o0[1m[34m^D[0m
abcdefghi
jk      lmn
    opq rst
[1m[34m^D[0muvwxyz
[1m[34m^[[0m'ajgR0[1m[34m^D[0m 1
A
BCDEFGHIJ[18;9HKL
MNO
PQR[1m[34m^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^[[0m:$
iab     cdefghi jkl[1m[34m^[[0m0gRAB......CDEFGHI.J[1m[34m^[[0mo[1m[34m^[[0m:
iabcdefghijklmnopqrst[1m[34m^[[0m0gRAB    IJKLMNO QR[1m[34m^[[0m:wq! test.out
ENDTEST
[?25h[?0c[?25l[?1c[1;24r[1;1H[11L[1;25r[2;1HTest Virtual replace mode.

STARTTEST
:so small.vim
:" make sure that backspace works, no matter what termcap is used
:set t_kD=[1m[34m^V[0mx7f t_kb=[1m[34m^V[0mx08
ggdGa
abcdefghi
jk      lmn
    opq rst[1;1H[?25h[?0c[?25l[?1c
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [0m[25;1H--No lines in buffer--[1;1H[?25h[?0c[?25l[?1c
abcdefghi[2;10H[K[3;1Hjk      lmn[3;12H[K[4;1H    opq rst[4;12H[K[5;1Huvwxyz[5;7H[K[6;1H[K[6;1H[?25h[?0c[1;1H[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ai[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset bs=2[?25l[?1c[1;1H[?25h[?0c[?25l[?1c 1
 A[2;3H[K[3;1H BCDEFGHIJ[3;11H[K[4;5H    KL[4;11H[K[5;1H        MNO[6;9HPQR[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cka[?25l[?1c[6;9H[?25h[?0c[?25l[?1c[7;1H[K[8;1Habcdefghi[8;10H[K[9;1Hjk      lmn[9;12H[K[10;1H    opq rst[10;12H[K[11;1Huvwxyz[11;7H[K[12;1H[K[12;1H[?25h[?0c[6;9H
[?25l[?1c 1[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$[?25l[?1c[12;1H[?25h[?0c[?25l[?1cab      cdefghi jkl[?25h[?0c[?25l[?1cAB......CDEFGHI.J[?25h[?0c[?25l[?1c[13;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[?25l[?1c[13;1H[?25h[?0c[?25l[?1cabcdefghijklmnopqrst[?25h[?0c[?25l[?1cAB      IJKLMNO QR[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwq! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 13 lines, 107 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test39.failed test.ok test.out X* viminfo
cp test39.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test39.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test39.in" 93 lines, 1955 characters[2;1HTest Visual block mode commands
And test "U" in Visual mode, also on German sharp S.

STARTTEST
:so small.vim
:so mbyte.vim
:" This only works when 'encoding' is "latin1", don't depend on the environment
:set enc=latin1
/^abcde
:" Test shift-right of a block
jllll[1m[34m^V[0mjj>wll[1m[34m^V[0mjlll>
:" Test shift-left of a block
G$hhhh[1m[34m^V[0mkk<
:" Test block-insert
Gkl[1m[34m^V[0mkkkIxyz[1m[34m^[[0m
:" Test block-replace
Gllll[1m[34m^V[0mkkklllrq
:" Test block-change
G$khhh[1m[34m^V[0mhhkkcmno[1m[34m^[[0m
:$-4,$w! test.out
:" Test block-insert using cursor keys for movement
/^aaaa/
:exe ":norm! l\<C-V>jjjlllI\<Right>\<Right>  \<Esc>"[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[5;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 63 lines, 1695 characters written[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[6;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1HG3o123456789[1m[34m^[[0m2k05l[1m[34m^V[0m2jr[1m[34m^M[0mG3o98765[1m[34m^[[0m2k02l[1m[34m^V[0m2jr[1m[34m^V^M[0m
G3o123456789[1m[34m^[[0m2k05l[1m[34m^V[0m2jr
G3o98765[1m[34m^[[0m2k02l[1m[34m^V[0m2jr[1m[34m^V[0m
:"
:" Test cursor position. When ve=block and Visual block mode and $gj
:set ve=block
:exe ":norm! 2k\<C-V>$gj\<Esc>"
:let cpos=getpos("'>")
:$put ='col:'.cpos[2].' off:'.cpos[3]
:/^the/,$w >> test.out
:qa!
ENDTEST[14;17Hline1[15;17Hline2[16;17Hline3

aaaaaa
bbbbbb
cccccc
dddddd

A23
4567[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso mbyte.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" This only works when 'encoding' is "latin1", don't depend on the environment[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset enc=latin1[?25l[?1c[27m[24m[0m[H[J[1;1HG3o123456789[1m[34m^[[0m2k05l[1m[34m^V[0m2jr[1m[34m^M[0mG3o98765[1m[34m^[[0m2k02l[1m[34m^V[0m2jr[1m[34m^V^M[0m
G3o123456789[1m[34m^[[0m2k05l[1m[34m^V[0m2jr
G3o98765[1m[34m^[[0m2k02l[1m[34m^V[0m2jr[1m[34m^V[0m
:"
:" Test cursor position. When ve=block and Visual block mode and $gj
:set ve=block
:exe ":norm! 2k\<C-V>$gj\<Esc>"
:let cpos=getpos("'>")
:$put ='col:'.cpos[2].' off:'.cpos[3]
:/^the/,$w >> test.out
:qa!
ENDTEST[14;17Hline1[15;17Hline2[16;17Hline3

aaaaaa
bbbbbb
cccccc
dddddd

A23
4567[13;1H[?25h[?0c[?25l[?1c[25;1H/[?25h[?0c^abcde[?25l[?1c[1;24r[1;1H[8M[1;25r[18;1HB23
4567

C23
4567

abcdefghijklm[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c" Test shift-right of a block[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Habcdefghijklm[25;1H[K[24;1H[?25h[?0cabcd[?25l[?1c[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;5H[7me[0m
abcdefghijklmabcd[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;5H[7me[0m
abcdefghijklmabcd[?25h[?0c[?25l[?1c
3 lines >ed 1 time[22;5H        efghijklm
abcd        efghijklm
abcd        efghijklm[22;8H[?25h[?0c     ef[?25l[?1c[?25h[?0c[?25l[?1c[7mg[23;15H[?25h[?0c[?25l[?1c[22;16Hh[23;15Hg[?25h[?0c[?25l[?1c[22;17Hi[23;16Hh[?25h[?0c[?25l[?1c[22;18Hj[23;17Hi[?25h[?0c[?25l[?1c[0m[22;15H        ghijklm[23;15H        ghijklm[22;16H[?25h[?0c[23;16H[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test shift-left of a block[?25l[?1c[23;16H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Habcdefghijklm[25;1H[K[24;1H[?25h[?0c[12C[?25l[?1c[?25h[?0c[?25l[?1c[7mi[23;9H[?25h[?0c[?25l[?1c [22;9H[?25h[?0c[?25l[?1c[0m


3 lines <ed 1 time[22;9Hef    [23;9Hefghijklm[23;18H[K[24;9Hi[22;9H[?25h[?0c[23;9H[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test block-insert[?25l[?1c[23;9H[?25h[?0c
[23;1Ha[?25l[?1c[?25h[?0c[?25l[?1c[7mb[22;2H[?25h[?0c[?25l[?1cb[21;2H[?25h[?0c[?25l[?1cb[20;2H[?25h[?0c[?25l[?1c[0m
ab
ab
ab[20;2Hxyzbcdefghijklm
axyzbcd
axyzbcd
axyzbcd[20;2H[?25h[?0c
a[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test block-replace[?25l[?1c[21;2H[?25h[?0c


abcd[?25l[?1c[?25h[?0c[?25l[?1c[7me[23;5H[?25h[?0c[?25l[?1cb[22;5H[?25h[?0c[?25l[?1cb[21;5H[?25h[?0c[?25l[?1cb[22;6Hc[23;6Hc[24;6Hf[21;6H[?25h[?0c[?25l[?1cc[22;7Hd[23;7Hd[24;7Hg[21;7H[?25h[?0c[?25l[?1cd[22;8H [23;8H [24;8Hh[21;8H[?25h[?0c[?25l[?1c[0mqqqq
axyzqqqq
axyzqqqq
abcdqqqq[21;5H[?25h[?0c
axyz[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test block-change[?25l[?1c[22;5H[?25h[?0c

[12C[23;17H[?25l[?1c[?25h[?0c[?25l[?1c[7mj[?25h[?0c[?25l[?1ci[?25h[?0c[?25l[?1c[22;12H     [23;11Hghijkl[22;11H[?25h[?0c[?25l[?1c[21;13Hef[0m[22;15H  [23;11Hg[3Ckl[21;12H[?25h[?0c[?25l[?1cmno[22;12Hmno[23;12Hmno[21;14H[?25h[?0c[22;14H[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$-4,$w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 5 lines, 108 characters written[22;14H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test block-insert using cursor keys for movement[?25l[?1c[22;14H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^aaaa/[?25l[?1c[25;7H[K[25;1H[1m[31msearch hit BOTTOM, continuing at TOP[6;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexe ":norm! l\<C-V>jjjlllI\<Right>\<Right>  \<Esc>"[?25l[?1c[6;4H  aaa
bbb  bbb
ccc  ccc
ddd  ddd[6;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^aa/,/^$/w >> test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H5 lines, 37 characters appended[6;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test for Visual block was created with the last <C-v>$[?25l[?1c[6;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^A23$/[?25l[?1c[25;7H[K[25;1H[11;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexe ":norm! l\<C-V>j$Aab\<Esc>"[?25l[?1c[11;4Hab
4567ab[11;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.,/^$/w >> test.out[?25l[?1c"test.out" [25;13H[K[25;12H3 lines, 14 characters appended[11;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test for Visual block was created with the middle <C-v>$ (1)[?25l[?1c[11;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^B23$/[?25l[?1c[25;7H[K[25;1H[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexe ":norm! l\<C-V>j$hAab\<Esc>"[?25l[?1c[14;5Hab
4567ab[14;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.,/^$/w >> test.out[?25l[?1c"test.out" [25;13H[K[25;12H3 lines, 15 characters appended[14;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test for Visual block was created with the middle <C-v>$ (2)[?25l[?1c[14;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^C23$/[?25l[?1c[25;7H[K[25;1H[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexe ":norm! l\<C-V>j$hhAab\<Esc>"[?25l[?1c[17;4Hab
456ab7[17;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.,/^$/w >> test.out[?25l[?1c"test.out" [25;13H[K[25;12H3 lines, 14 characters appended[17;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test for Visual block insert when virtualedit=all[?25l[?1c[17;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ve=all[?25l[?1c[17;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/\t\tline[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[2;17H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexe ":norm! 07l\<C-V>jjIx\<Esc>"[?25l[?1c[2;8Hx[3;8Hx[4;8Hx[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ve=[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.,/^$/w >> test.out[?25l[?1c"test.out" [25;13H[K[25;12H4 lines, 49 characters appended[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" gUe must uppercase a whole word, also when  changes to SS[?25l[?1c[2;1H[?25h[?0c[24;1H[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hthe youtueuu end[25;1H[K[24;17H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hthe youtueuu end[?25h[?0c[23;1Hthe [?25l[?1cYOUTUSSEUU endthe [?25h[?0c
the [?25l[?1c
:[?25h[?0c" gUfx must uppercase until x, inclusive.[?25l[?1c[24;5H[?25h[?0c[?25l[?1c- youtuexu -[24;15H[K[24;14H[?25h[?0c- y[?25l[?1cOUSSTUSSEXu -- y[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hthe youtueuu end[25;1H[K[24;4H[?25h[?0c[?25l[?1c
:[?25h[?0c" VU must uppercase a whole line[?25l[?1c[24;4H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hthe youtueuu end[25;1H[K[24;1H[?25h[?0c[23;1H[?25l[?1ct[7mhe youtueuu end [?25h[?0c[?25l[?1c[0mTHE YOUTUSSEUU END[?25h[?0c
[?25l[?1c
:[?25h[?0c" same, when it's the last line in the buffer[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hthe youtueuu end[25;1H[K[24;1H[?25h[?0c[?25l[?1c111the youtueuu end11[?25h[?0c[?25l[?1c[7m11[0m1[7mthe youtueuu end 11[?25h[?0c[?25l[?1c[0m111THE YOUTUSSEUU END[?25h[?0c[?25l[?1c[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[0m111THE YOUTUSSEUU END
the youtueuu end[24;18H[K[23;1H[?25h[?0c
[?25l[?1c
:[?25h[?0c" Uppercase two lines[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;1Hblah di[23;8H[K[24;1Hdoh dut[25;1H[K[24;7H[?25h[?0c[?25l[?1c[7mdoh du[0mt[7m [?25h[?0c[?25l[?1c[23;1Hblah d[0mi[7m [24;7Ht[23;7H[?25h[?0c[?25l[?1c[0mBLAH DI[23;8H[K[24;1HDOH DUT[24;8H[K[23;7H[?25h[?0c[24;7H[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hthe youtueuu end[24;7H[?25h[?0c[?25l[?1c
:[?25h[?0c" Uppercase part of two lines[?25l[?1c[24;7H[?25h[?0c[?25l[?1c[1m[34m~                                                                               [23;1H[?25h[?0c[?25l[?1c[0m
the youtueuu end[24;18H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hthe youtueuu end[25;1H[K[24;1H[?25h[?0c[?25l[?1c333the youtueuu end33[?25h[?0c[23;3H[?25l[?1c222the youtueuu end22[?25h[?0c2the yo[?25l[?1c[?25h[?0c[?25l[?1c[7mutueuu end 
333the yo[?25h[?0c[?25l[?1cut[?25h[?0c[?25l[?1c[0m[23;10HUTUSSEUU END
333THE YOUTU[23;10H[?25h[?0c[22;7H[23;10H[?25l[?1c

:[?25h[?0c" visual replace using Enter or NL[?25l[?1c[23;10H[?25h[?0c
[?25l[?1c[1;24r[1;1H[3M[1;25r[22;1H123456789
123456789
123456789[25;1H[K[24;9H[?25h[?0c[22;9H12345[?25l[?1c[?25h[?0c[?25l[?1c[7m6[23;6H6[24;6H[?25h[?0c[?25l[?1c[0m[22;6H[K[23;1H789[23;4H[K[24;6H[K[22;5H[?25h[?0c[?25l[?1c[1;24r[1;1H[3M[1;25r[22;1H789
12345
789[?25h[?0c[?25l[?1c[1;24r[1;1H[3M[1;25r[22;1H98765
98765
98765[?25h[?0c[22;5H98[?25l[?1c[?25h[?0c[?25l[?1c[7m7
[0m98[7m7
[0m98[?25h[?0c[?25l[?1c[22;3H[1m[34m^M[0m65
98[1m[34m^M[0m65
98[1m[34m^M[0m65[22;3H[?25h[?0c
98
[?25l[?1c[1;24r[1;1H[3M[1;25r[22;1H123456789
123456789
123456789[?25h[?0c[22;9H12345[?25l[?1c[?25h[?0c[?25l[?1c[7m6[23;6H6[24;6H[?25h[?0c[?25l[?1c[0m[22;6H[K[23;1H789[23;4H[K[24;6H[K[22;5H[?25h[?0c[?25l[?1c[1;24r[1;1H[3M[1;25r[22;1H789
12345
789[?25h[?0c[?25l[?1c[1;24r[1;1H[3M[1;25r[22;1H98765
98765
98765[?25h[?0c[22;5H98[?25l[?1c[?25h[?0c[?25l[?1c[7m7
[0m98[7m7
[0m98[?25h[?0c[?25l[?1c[22;3H[1m[34m^@[0m65
98[1m[34m^@[0m65
98[1m[34m^@[0m65[22;3H[?25h[?0c[?25l[?1c


:[?25h[?0c"[?25l[?1c[22;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test cursor position. When ve=block and Visual block mode and $gj[?25l[?1c[22;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ve=block[?25l[?1c[22;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexe ":norm! 2k\<C-V>$gj\<Esc>"[?25l[?1c[21;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet cpos=getpos("'>")[?25l[?1c[21;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put ='col:'.cpos[2].' off:'.cpos[3][?25l[?1c[1;24r[24;1H
[1;25r[24;1Hcol:4 off:0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c/^the/,$w >> test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H27 lines, 244 characters appended[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test40.failed test.ok test.out X* viminfo
cp test40.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test40.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test40.in" 63 lines, 1536 characters[1;1HTest for "*Cmd" autocommands

STARTTEST
:so small.vim
:/^start/,$w! Xxx[15C" write lines below to Xxx
:au BufReadCmd XtestA 0r Xxx|$del
:e XtestA[23C" will read text of Xxd instead
:au BufWriteCmd XtestA call append(line("$"), "write")
:w[30C" will append a line to the file
:r XtestA[23C" should not read anything
:[31C" now we have:
:[31C" 1     start of Xxx
:[31C" 2[13Ctest40
:[31C" 3     end of Xxx
:[31C" 4     write
:au FileReadCmd XtestB '[r Xxx
:2r XtestB[22C" will read Xxx below line 2 instead
:[31C" 1     start of Xxx
:[31C" 2[13Ctest40
:[31C" 3     start of Xxx
:[31C" 4[13Ctest40
:[31C" 5     end of Xxx
:[31C" 6     end of Xxx
:[31C" 7     write[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for "*Cmd" autocommands[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 55 lines, 1455 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:$r XtestD[22C" should not read anything
:$w >>test.out[18C" append "end of Xxx" to test.out
:au BufReadCmd XtestE 0r test.out|$del
:sp XtestE[22C" split window with test.out
5Goasdf[1m[34m^[^W^W[0m:"
:au BufWriteCmd XtestE w! test.out
:wall[27C" will write other window to test.out
:[31C" 1     start of Xxx
:[31C" 2[13Ctest40
:[31C" 3     start of Xxx
:[31C" 4[13Ctest401
:[31C" 5     end of Xxx
:[31C" 6     asdf
:[31C" 7     end of Xxx
:[31C" 8     write
:[31C" 9[13Ctest401
:[31C" 10    end of Xxx
:[31C" 11    end of Xxx
:qa!
ENDTEST

start of Xxx[23;9Htest40
end of Xxx[20;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[21;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[21;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^start/,$w! Xxx[1m[34m^I^I[0m" write lines below to Xxx[?25l[?1c"Xxx" [25;7H[K[25;7H[New File] 3 lines, 32 characters written[21;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau BufReadCmd XtestA 0r Xxx|$del[?25l[?1c[21;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce XtestA[1m[34m^I^I^I[0m" will read text of Xxd instead[?25l[?1c"Xxx" [25;7H[K[25;7H3 lines, 32 characters[1;1Hstart of Xxx[1;33H[K[2;1H        test40[2;33H[K[3;1Hend of Xxx[3;11H[K[4;1H[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [3;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cau BufWriteCmd XtestA call append(line("$"), "write")[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[1m[34m^I^I^I^I[0m" will append a line to the file[?25l[?1c[4;1Hwrite[4;6H[K[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cr XtestA[1m[34m^I^I^I[0m" should not read anything[?25l[?1c[1m[37m[41mE484: Can't open file XtestA[0m[25;29H[K[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" now we have:[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 1[1m[34m^I[0mstart of Xxx[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 2[1m[34m^I^I[0mtest40[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 3[1m[34m^I[0mend of Xxx[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 4[1m[34m^I[0mwrite[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau FileReadCmd XtestB '[r Xxx[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c2r XtestB[1m[34m^I^I^I[0m" will read Xxx below line 2 instead[?25l[?1c"Xxx" [25;7H[K[25;7H3 lines, 32 characters[3;24r[3;1H[3L[1;25r[3;1Hstart of Xxx[4;9Htest40
end of Xxx[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 1[1m[34m^I[0mstart of Xxx[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 2[1m[34m^I^I[0mtest40[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 3[1m[34m^I[0mstart of Xxx[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 4[1m[34m^I^I[0mtest40[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 5[1m[34m^I[0mend of Xxx[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 6[1m[34m^I[0mend of Xxx[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 7[1m[34m^I[0mwrite[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau FileWriteCmd XtestC '[,']copy $[?25l[?1c[3;1H[?25h[?0c[4;9H[?25l[?1ctest401[?25h[?0c[5;10H[?25l[?1c[25;1H[K[25;1H:[?25h[?0c4,5w XtestC[1m[34m^I^I^I[0m" will copy lines 4 and 5 to the end[?25l[?1c[8;1H        test401[8;16H[K[9;1Hend of Xxx[9;11H[K[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cr XtestC[1m[34m^I^I^I[0m" should not read anything[?25l[?1c[1m[37m[41mE484: Can't open file XtestC[0m[25;29H[K[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 1[1m[34m^I[0mstart of Xxx[?25l[?1c[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 2[1m[34m^I^I[0mtest40[?25l[?1c[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 3[1m[34m^I[0mstart of Xxx[?25l[?1c[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 4[1m[34m^I^I[0mtest401[?25l[?1c[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 5[1m[34m^I[0mend of Xxx[?25l[?1c[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 6[1m[34m^I[0mend of Xxx[?25l[?1c[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 7[1m[34m^I[0mwrite[?25l[?1c[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 8[1m[34m^I^I[0mtest401[?25l[?1c[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 9[1m[34m^I[0mend of Xxx[?25l[?1c[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau FILEAppendCmd XtestD '[,']w! test.out[?25l[?1c[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>XtestD[1m[34m^I^I^I[0m" will write all lines to test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 9 lines, 91 characters written[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$r XtestD[1m[34m^I^I^I[0m" should not read anything[?25l[?1c[1m[37m[41mE484: Can't open file XtestD[0m[25;30H[K[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$w >>test.out[1m[34m^I^I^I[0m" append "end of Xxx" to test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 11 characters appended[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau BufReadCmd XtestE 0r test.out|$del[?25l[?1c[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csp XtestE[1m[34m^I^I^I[0m" split window with test.out[?25l[?1c"test.out" [25;12H[K[25;12H10 lines, 102 characters[10;1Hend of Xxx[10;11H[K[12;1H[1m[7mXtestE                                                                          [0m[13;1Hend of Xxx[13;11H[K[14;1Hend of Xxx[14;11H[K[15;1Hwrite[15;6H[K[16;1H        test401[16;16H[K[17;1Hend of Xxx[17;11H[K[24;1H[7mXtestA                                                                          [10;1H[?25h[?0c[5;1H[?25l[?1c[6;11r[0m[6;1H[L[1;25r[6;1Hasdf[12;8H[1m[7m[+][0m[25;1H[K[6;4H[?25h[?0c[12;1H[7mXtestE [+]                                                                      [0m[24;1H[1m[7mXtestA                                                                          [17;1H[?25l[?1c[25;1H[0m:[?25h[?0c"[?25l[?1c[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau BufWriteCmd XtestE w! test.out[?25l[?1c[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwall[1m[34m^I^I^I^I[0m" will write other window to test.out[?25l[?1c"test.out" [25;12H[K[25;12H11 lines, 107 characters written[12;8H[7m   [17;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 1[1m[34m^I[0mstart of Xxx[?25l[?1c[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 2[1m[34m^I^I[0mtest40[?25l[?1c[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 3[1m[34m^I[0mstart of Xxx[?25l[?1c[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 4[1m[34m^I^I[0mtest401[?25l[?1c[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 5[1m[34m^I[0mend of Xxx[?25l[?1c[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 6[1m[34m^I[0masdf[?25l[?1c[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 7[1m[34m^I[0mend of Xxx[?25l[?1c[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 8[1m[34m^I[0mwrite[?25l[?1c[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 9[1m[34m^I^I[0mtest401[?25l[?1c[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 10[1m[34m^I[0mend of Xxx[?25l[?1c[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[1m[34m^I^I^I^I[0m" 11[1m[34m^I[0mend of Xxx[?25l[?1c[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test41.failed test.ok test.out X* viminfo
cp test41.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test41.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test41.in" 24 lines, 421 characters[1;1HTest for writing and reading a file of over 100 Kbyte

1 line: "This is the start"
3001 lines: "This is the leader"
1 line: "This is the middle"
3001 lines: "This is the trailer"
1 line: "This is the end"

STARTTEST
:%d
aThis is the start
This is the leader
This is the middle
This is the trailer
This is the end[1m[34m^[[0mkY3000p2GY3000p
:w! Xtest
:%d
:e! Xtest
:.w! test.out
3003G:.w >>test.out
6005G:.w >>test.out
:qa!
ENDTEST[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for writing and reading a file of over 100 Kbyte[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[9;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[10;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 13 lines, 196 characters written[10;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[10;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[23;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c%d[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [0m[25;1H--No lines in buffer--[1;1H[?25h[?0c[?25l[?1cThis is the start
This is the leader[2;19H[K[3;1HThis is the middle[3;19H[K[4;1HThis is the trailer[4;20H[K[5;1HThis is the end[5;16H[K[5;15H[?25h[?0c[4;15H[?25l[?1c[25;1H3000 more lines[25;16H[K[5;13Htrailer
This is the trailer[6;20H[K[7;1HThis is the trailer[7;20H[K[8;1HThis is the trailer[8;20H[K[9;1HThis is the trailer[9;20H[K[10;1HThis is the trailer[10;20H[K[11;1HThis is the trailer[11;20H[K[12;1HThis is the trailer[12;20H[K[13;1HThis is the trailer[13;20H[K[14;1HThis is the trailer[14;20H[K[15;1HThis is the trailer[15;20H[K[16;1HThis is the trailer[16;20H[K[17;1HThis is the trailer[17;20H[K[18;1HThis is the trailer[18;20H[K[19;1HThis is the trailer[19;20H[K[20;1HThis is the trailer[20;20H[K[21;1HThis is the trailer[21;20H[K[22;1HThis is the trailer[22;20H[K[23;1HThis is the trailer[23;20H[K[24;1HThis is the trailer[24;20H[K[5;1H[?25h[?0c[2;1H[?25l[?1c[3;13Hleader[4;13Hleader[4;19H[K[5;13Hleader[5;19H[K[6;13Hleader[6;19H[K[7;13Hleader[7;19H[K[8;13Hleader[8;19H[K[9;13Hleader[9;19H[K[10;13Hleader[10;19H[K[11;13Hleader[11;19H[K[12;13Hleader[12;19H[K[13;13Hleader[13;19H[K[14;13Hleader[14;19H[K[15;13Hleader[15;19H[K[16;13Hleader[16;19H[K[17;13Hleader[17;19H[K[18;13Hleader[18;19H[K[19;13Hleader[19;19H[K[20;13Hleader[20;19H[K[21;13Hleader[21;19H[K[22;13Hleader[22;19H[K[23;13Hleader[23;19H[K[24;13Hleader[24;19H[K[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! Xtest[?25l[?1c"Xtest" [25;9H[K[25;9H[New File] 6005 lines, 117092 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c%d[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [0m[25;1H--No lines in buffer--[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! Xtest[?25l[?1c"Xtest" [25;9H[K[25;9H6005 lines, 117092 characters[1;1HThis is the start
This is the leader[2;19H[K[3;1HThis is the leader[3;19H[K[4;1HThis is the leader[4;19H[K[5;1HThis is the leader[5;19H[K[6;1HThis is the leader[6;19H[K[7;1HThis is the leader[7;19H[K[8;1HThis is the leader[8;19H[K[9;1HThis is the leader[9;19H[K[10;1HThis is the leader[10;19H[K[11;1HThis is the leader[11;19H[K[12;1HThis is the leader[12;19H[K[13;1HThis is the leader[13;19H[K[14;1HThis is the leader[14;19H[K[15;1HThis is the leader[15;19H[K[16;1HThis is the leader[16;19H[K[17;1HThis is the leader[17;19H[K[18;1HThis is the leader[18;19H[K[19;1HThis is the leader[19;19H[K[20;1HThis is the leader[20;19H[K[21;1HThis is the leader[21;19H[K[22;1HThis is the leader[22;19H[K[23;1HThis is the leader[23;19H[K[24;1HThis is the leader[24;19H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 1 line, 18 characters written[1;1H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1HThis is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the leader
This is the middle
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer[12;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 19 characters appended[12;1H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1HThis is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the trailer
This is the end[?25h[?0c[?25l[?1c
:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 16 characters appended[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test42.failed test.ok test.out X* viminfo
cp test42.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test42.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test42.in" 130 lines, 2368 characters[1;1HTest for writing and reading a file starting with a BOM

STARTTEST
:so mbyte.vim
:set encoding=utf-8
:set fileencodings=ucs-bom,latin-1
:set ff=unix ffs=unix[11C" This changes the file for DOS and MAC
:" --- Write the test files
:/^latin-1$/+1w! Xtest0
:/^utf-8$/+1w! Xtest1
:/^utf-8-err$/+1w! Xtest2
:/^ucs-2$/+1w! Xtest3
:/^ucs-2le$/+1w! Xtest4
:" Need to add a NUL byte after the NL byte
:set bin
:e! Xtest4[22C" Ignore change from setting 'ff'
o[1m[34m^V^@^[[0m:set noeol
:w
:set ffs& nobinary[14C" Allow default test42.in format
:e #
:set ff=unix[20C" Format for files to write
:/^ucs-4$/+1w! Xtest5
:/^ucs-4le$/+1w! Xtest6
:" Need to add three NUL bytes after the NL byte[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for writing and reading a file starting with a BOM[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 111 lines, 2116 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:e! test.out
:$r Xtest0x
:$r Xtest1x
:$r Xtest2x
:$r Xtest3x
:$r Xtest4x
:$r Xtest5x
:$r Xtest6x
:set nobin ff&[15C" Write the file in default format
:w! test.out
:qa!
ENDTEST

latin-1
latin-1
utf-8
﻿utf-8
utf-8-err
﻿utf-8[1m[34m~@[0merr
ucs-2
[1m[34m^@[0mu[1m[34m^@[0mc[1m[34m^@[0ms[1m[34m^@[0m-[1m[34m^@[0m2[1m[34m^@[0m
ucs-2le
u[1m[34m^@[0mc[1m[34m^@[0ms[1m[34m^@[0m-[1m[34m^@[0m2[1m[34m^@[0ml[1m[34m^@[0me[1m[34m^@[0m
ucs-4[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso mbyte.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset encoding=utf-8[?25l[?1c[27m[24m[0m[H[J[1;1H:e! test.out
:$r Xtest0x
:$r Xtest1x
:$r Xtest2x
:$r Xtest3x
:$r Xtest4x
:$r Xtest5x
:$r Xtest6x
:set nobin ff&[15C" Write the file in default format
:w! test.out
:qa!
ENDTEST

latin-1
[1m[34m<fe><fe>[0mlatin-1
utf-8
[1m[34m<feff>[0mutf-8
utf-8-err
[1m[34m<feff>[0mutf-8[1m[34m<80>[0merr
ucs-2
[1m[34m<fe><ff>^@[0mu[1m[34m^@[0mc[1m[34m^@[0ms[1m[34m^@[0m-[1m[34m^@[0m2[1m[34m^@[0m
ucs-2le
[1m[34m<ff><fe>[0mu[1m[34m^@[0mc[1m[34m^@[0ms[1m[34m^@[0m-[1m[34m^@[0m2[1m[34m^@[0ml[1m[34m^@[0me[1m[34m^@[0m
ucs-4[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset fileencodings=ucs-bom,latin-1[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ff=unix ffs=unix           " This changes the file for DOS and MAC[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- Write the test files[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^latin-1$/+1w! Xtest0[?25l[?1c"Xtest0" [25;10H[K[25;10H[New File] 1 line, 10 characters written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^utf-8$/+1w! Xtest1[?25l[?1c"Xtest1" [25;10H[K[25;10H[New File] 1 line, 9 characters written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^utf-8-err$/+1w! Xtest2[?25l[?1c"Xtest2" [25;10H[K[25;10H[New File] 1 line, 13 characters written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^ucs-2$/+1w! Xtest3[?25l[?1c"Xtest3" [25;10H[K[25;10H[New File] 1 line, 14 characters written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^ucs-2le$/+1w! Xtest4[?25l[?1c"Xtest4" [25;10H[K[25;10H[New File] 1 line, 17 characters written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Need to add a NUL byte after the NL byte[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset bin[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! Xtest4                      " Ignore change from setting 'ff'[?25l[?1c"Xtest4" [25;10H[K[25;10H1 line, 17 characters[1;1H[1m[34m<ff><fe>[0mu[1m[34m^@[0mc[1m[34m^@[0ms[1m[34m^@[0m-[1m[34m^@[0m2[1m[34m^@[0ml[1m[34m^@[0me[1m[34m^@
~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c
[?25l[?1c^@[0m[2;3H[K[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset noeol[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"Xtest4" [Incomplete last line] 2 lines, 18 characters written[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ffs& nobinary              " Allow default test42.in format[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce #[?25l[?1c"test42.in" [converted] 130 lines, 2385 characters[1;1H:$r Xtest0x[1;12H[K[2;1H:$r Xtest1x
:$r Xtest2x[3;12H[K[4;1H:$r Xtest3x[4;12H[K[5;1H:$r Xtest4x[5;12H[K[6;1H:$r Xtest5x[6;12H[K[7;1H:$r Xtest6x[7;12H[K[8;1H:set nobin ff&               " Write the file in default format[8;64H[K[9;1H:w! test.out[9;13H[K[10;1H:qa![10;5H[K[11;1HENDTEST[11;8H[K[12;1H[K[13;1Hlatin-1[13;8H[K[14;1Hþþlatin-1[14;10H[K[15;1Hutf-8[15;6H[K[16;1Hï»¿utf-8[16;9H[K[17;1Hutf-8-err[17;10H[K[18;1Hï»¿utf-8[1m[34m<80>[0merr[18;16H[K[19;1Hucs-2[19;6H[K[20;1Hþÿ[1m[34m^@[0mu[1m[34m^@[0mc[1m[34m^@[0ms[1m[34m^@[0m-[1m[34m^@[0m2[1m[34m^@[0m[20;20H[K[21;1Hucs-2le[21;8H[K[22;1Hÿþu[1m[34m^@[0mc[1m[34m^@[0ms[1m[34m^@[0m-[1m[34m^@[0m2[1m[34m^@[0ml[1m[34m^@[0me[1m[34m^@[0m[22;24H[K[23;1Hucs-4[23;6H[K[24;1H[1m[34m^@^@[0mþÿ[1m[34m^@^@^@[0mu[1m[34m^@^@^@[0mc[1m[34m^@^@^@[0ms[1m[34m^@^@^@[0m-[1m[34m^@^@^@[0m4[1m[34m^@^@^@[0m[24;48H[K[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ff=unix                    " Format for files to write[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^ucs-4$/+1w! Xtest5[?25l[?1c"Xtest5" [25;10H[K[25;10H[converted][New File] 1 line, 30 characters written[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^ucs-4le$/+1w! Xtest6[?25l[?1c"Xtest6" [25;10H[K[25;10H[converted][New File] 1 line, 35 characters written[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Need to add three NUL bytes after the NL byte[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset bin[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! Xtest6                      " ! for when setting 'ff' is a change[?25l[?1c"Xtest6" [25;10H[K[25;10H1 line, 33 characters[1;1H[1m[34m<ff><fe>^@^@[0mu[1m[34m^@^@^@[0mc[1m[34m^@^@^@[0ms[1m[34m^@^@^@[0m-[1m[34m^@^@^@[0m4[1m[34m^@^@^@[0ml[1m[34m^@^@^@[0me[1m[34m^@^@^@
~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c
~   [?25l[?1c^@^@^@[0m[2;7H[K[2;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset noeol[?25l[?1c[2;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"Xtest6" [Incomplete last line] 2 lines, 36 characters written[2;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nobin[?25l[?1c[2;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce #[?25l[?1c"test42.in" [converted] 130 lines, 2385 characters[1;1H:$r Xtest0x[1;12H[K[2;1H:$r Xtest1x
:$r Xtest2x[3;12H[K[4;1H:$r Xtest3x[4;12H[K[5;1H:$r Xtest4x[5;12H[K[6;1H:$r Xtest5x[6;12H[K[7;1H:$r Xtest6x[7;12H[K[8;1H:set nobin ff&               " Write the file in default format[8;64H[K[9;1H:w! test.out[9;13H[K[10;1H:qa![10;5H[K[11;1HENDTEST[11;8H[K[12;1H[K[13;1Hlatin-1[13;8H[K[14;1Hþþlatin-1[14;10H[K[15;1Hutf-8[15;6H[K[16;1Hï»¿utf-8[16;9H[K[17;1Hutf-8-err[17;10H[K[18;1Hï»¿utf-8[1m[34m<80>[0merr[18;16H[K[19;1Hucs-2[19;6H[K[20;1Hþÿ[1m[34m^@[0mu[1m[34m^@[0mc[1m[34m^@[0ms[1m[34m^@[0m-[1m[34m^@[0m2[1m[34m^@[0m[20;20H[K[21;1Hucs-2le[21;8H[K[22;1Hÿþu[1m[34m^@[0mc[1m[34m^@[0ms[1m[34m^@[0m-[1m[34m^@[0m2[1m[34m^@[0ml[1m[34m^@[0me[1m[34m^@[0m[22;24H[K[23;1Hucs-4[23;6H[K[24;1H[1m[34m^@^@[0mþÿ[1m[34m^@^@^@[0mu[1m[34m^@^@^@[0mc[1m[34m^@^@^@[0ms[1m[34m^@^@^@[0m-[1m[34m^@^@^@[0m4[1m[34m^@^@^@[0m[24;48H[K[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- Check that editing a latin-1 file doesn't see a BOM[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! Xtest0[?25l[?1c"Xtest0" [25;10H[K[25;10H[converted] 1 line, 12 characters[1;1Hþþlatin-1[1;10H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0credir! >test.out[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileencoding bomb?[?25l[?1c[25;1H[K[25;1H  fileencoding=latin1
nobomb
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0credir END[?25l[?1c[1;1H[2L[1;1Hþþlatin-1
[1m[34m~                                                                               [0m[25;3H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset fenc=latin-1[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H[converted] 1 line, 12 characters appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset bomb fenc=latin-1[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! Xtest0x[?25l[?1c"Xtest0x" [25;11H[K[25;11H[converted][New File] 1 line, 12 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- Check utf-8[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! Xtest1[?25l[?1c"Xtest1" [25;10H[K[25;10H1 line, 9 characters[1;1Hutf-8[1;6H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir >>test.out[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileencoding bomb?[?25l[?1c[25;1H[K[25;1H  fileencoding=utf-8
  bomb
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0credir END[?25l[?1c[1;1H[2L[1;1Hutf-8
[1m[34m~                                                                               [0m[25;3H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset fenc=latin-1[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H[converted] 1 line, 6 characters appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fenc=utf-8[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! Xtest1x[?25l[?1c"Xtest1x" [25;11H[K[25;11H[New File] 1 line, 9 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- Check utf-8 with an error (will fall back to latin-1)[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! Xtest2[?25l[?1c"Xtest2" [25;10H[K[25;10H[converted] 1 line, 17 characters[1;1Hï»¿utf-8[1m[34m<80>[0merr[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir >>test.out[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileencoding bomb?[?25l[?1c[25;1H[K[25;1H  fileencoding=latin1
nobomb
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0credir END[?25l[?1c[1;1H[2L[1;1Hï»¿utf-8[1m[34m<80>[0merr
[1m[34m~                                                                               [0m[25;3H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset fenc=latin-1[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H[converted] 1 line, 17 characters appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fenc=utf-8[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! Xtest2x[?25l[?1c"Xtest2x" [25;11H[K[25;11H[New File] 1 line, 17 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- Check ucs-2[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! Xtest3[?25l[?1c"Xtest3" [25;10H[K[25;10H[converted] 1 line, 8 characters[1;1Hucs-2[1;6H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir >>test.out[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileencoding bomb?[?25l[?1c[25;1H[K[25;1H  fileencoding=utf-16
  bomb
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0credir END[?25l[?1c[1;1H[2L[1;1Hucs-2
[1m[34m~                                                                               [0m[25;3H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset fenc=latin-1[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H[converted] 1 line, 6 characters appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fenc=ucs-2[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! Xtest3x[?25l[?1c"Xtest3x" [25;11H[K[25;11H[converted][New File] 1 line, 8 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- Check ucs-2le[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! Xtest4[?25l[?1c"Xtest4" [25;10H[K[25;10H[converted] 1 line, 10 characters[1;6Hle[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir >>test.out[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileencoding bomb?[?25l[?1c[25;1H[K[25;1H  fileencoding=utf-16le
  bomb
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0credir END[?25l[?1c[1;1H[2L[1;1Hucs-2le
[1m[34m~                                                                               [0m[25;3H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset fenc=latin-1[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H[converted] 1 line, 8 characters appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fenc=ucs-2le[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! Xtest4x[?25l[?1c"Xtest4x" [25;11H[K[25;11H[converted][New File] 1 line, 10 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- Check ucs-4[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! Xtest5[?25l[?1c"Xtest5" [25;10H[K[25;10H[converted] 1 line, 10 characters[1;5H4[1;6H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir >>test.out[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileencoding bomb?[?25l[?1c[25;1H[K[25;1H  fileencoding=ucs-4
  bomb
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0credir END[?25l[?1c[1;1H[2L[1;1Hucs-4
[1m[34m~                                                                               [0m[25;3H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset fenc=latin-1[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H[converted] 1 line, 6 characters appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fenc=ucs-4[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! Xtest5x[?25l[?1c"Xtest5x" [25;11H[K[25;11H[converted][New File] 1 line, 10 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- Check ucs-4le[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! Xtest6[?25l[?1c"Xtest6" [25;10H[K[25;10H[converted] 1 line, 12 characters[1;6Hle[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir >>test.out[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileencoding bomb?[?25l[?1c[25;1H[K[25;1H  fileencoding=ucs-4le
  bomb
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0credir END[?25l[?1c[1;1H[2L[1;1Hucs-4le
[1m[34m~                                                                               [0m[25;3H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset fenc=latin-1[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H[converted] 1 line, 8 characters appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fenc=ucs-4le[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! Xtest6x[?25l[?1c"Xtest6x" [25;11H[K[25;11H[converted][New File] 1 line, 12 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- Check the files written with BOM[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset bin[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! test.out[?25l[?1c"test.out" [25;12H[K[25;12H35 lines, 275 characters[1;1H[K[2;1H[K[3;1H  fileencoding=latin1[3;22H[K[4;1Hnobomb[4;7H[K[5;1H[1m[34m<fe><fe>[0mlatin-1[5;16H[K[6;1H[K[7;1H[K[8;1H  fileencoding=utf-8[8;21H[K[9;1H  bomb[9;7H[K[10;1Hutf-8[10;6H[K[11;1H[K[12;1H[K[13;1H  fileencoding=latin1[13;22H[K[14;1Hnobomb[14;7H[K[15;1H[1m[34m<feff>[0mutf-8[1m[34m<80>[0merr[15;19H[K[16;1H[K[17;1H[K[18;1H  fileencoding=utf-16[18;22H[K[19;1H  bomb[19;7H[K[20;1Hucs-2[20;6H[K[21;1H[K[22;1H[K[23;1H  fileencoding=utf-16le[23;24H[K[24;1H  bomb[24;7H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$r Xtest0x[?25l[?1c"Xtest0x" [25;11H[K[25;11H1 line, 10 characters[1;24r[1;1H[12M[1;25r[13;1Hucs-2le[16;3Hfileencoding=ucs-4
  bomb
ucs-4[21;3Hfileencoding=ucs-4le
  bomb
ucs-4le
[1m[34m<fe><fe>[0mlatin-1[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$r Xtest1x[?25l[?1c"Xtest1x" [25;11H[K[25;11H1 line, 9 characters[1;24r[24;1H
[1;25r[24;1H[1m[34m<feff>[0mutf-8[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$r Xtest2x[?25l[?1c"Xtest2x" [25;11H[K[25;11H1 line, 17 characters[1;24r[24;1H
[1;25r[24;1Hï»¿utf-8[1m[34m<80>[0merr[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$r Xtest3x[?25l[?1c"Xtest3x" [25;11H[K[25;11H1 line, 14 characters[1;24r[24;1H
[1;25r[24;1H[1m[34m<fe><ff>^@[0mu[1m[34m^@[0mc[1m[34m^@[0ms[1m[34m^@[0m-[1m[34m^@[0m2[1m[34m^@[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$r Xtest4x[?25l[?1c"Xtest4x" [25;11H[K[25;11H[Incomplete last line] 2 lines, 18 characters[1;24r[24;1H
[1;25r[24;1H[1m[34m<ff><fe>[0mu[1m[34m^@[0mc[1m[34m^@[0ms[1m[34m^@[0m-[1m[34m^@[0m2[1m[34m^@[0ml[1m[34m^@[0me[1m[34m^@[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$r Xtest5x[?25l[?1c"Xtest5x" [25;11H[K[25;11H1 line, 28 characters[1;24r[1;1H[2M[1;25r[23;1H[1m[34m^@
^@^@<fe><ff>^@^@^@[0mu[1m[34m^@^@^@[0mc[1m[34m^@^@^@[0ms[1m[34m^@^@^@[0m-[1m[34m^@^@^@[0m4[1m[34m^@^@^@[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$r Xtest6x[?25l[?1c"Xtest6x" [25;11H[K[25;11H[Incomplete last line] 2 lines, 36 characters[1;24r[24;1H
[1;25r[24;1H[1m[34m<ff><fe>^@^@[0mu[1m[34m^@^@^@[0mc[1m[34m^@^@^@[0ms[1m[34m^@^@^@[0m-[1m[34m^@^@^@[0m4[1m[34m^@^@^@[0ml[1m[34m^@^@^@[0me[1m[34m^@^@^@[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset nobin ff&               " Write the file in default format[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! test.out[?25l[?1c"test.out" [25;12H[K[25;12H44 lines, 409 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test43.failed test.ok test.out X* viminfo
cp test43.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test43.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test43.in" 34 lines, 473 characters[1;1HTests for regexp with various magic settings.

STARTTEST
:so small.vim
:set nocompatible viminfo+=nviminfo
/^1
/a*b\{2}c\+/e
x/\Md\*e\{2}f\+/e
x:set nomagic
/g\*h\{2}i\+/e
x/\mj*k\{2}l\+/e
x/\vm*n{2}o+/e
x/\V^aa$
x:set magic
/\v(a)(b)\2\1\1/e
x/\V[ab]\(\[xy]\)\1
x:$
:set undolevels=100
dv?bar?
Yup:"
:?^1?,$w! test.out
:qa!
ENDTEST[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for regexp with various magic settings.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 19 lines, 268 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[23;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nocompatible viminfo+=nviminfo[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^1[?25l[?1c[1;24r[24;1H
[1;25r[24;1H1 a aa abb abbccc[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0ca*b\{2}c\+/e[?25l[?1c[24;17H[?25h[?0c[?25l[?1c[24;17H[K[24;16H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c\Md\*e\{2}f\+/e[?25l[?1c[1;24r[24;1H
[1;25r[24;1H2 d dd dee deefff[25;1H[K[24;17H[?25h[?0c[?25l[?1c[24;17H[K[24;16H[?25h[?0c[?25l[?1c
:[?25h[?0cset nomagic[?25l[?1c[24;16H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cg\*h\{2}i\+/e[?25l[?1c[1;24r[24;1H
[1;25r[24;1H3 g gg ghh ghhiii[25;1H[K[24;17H[?25h[?0c[?25l[?1c[24;17H[K[24;16H[?25h[?0c[?25l[?1c
/[?25h[?0c\mj*k\{2}l\+/e[?25l[?1c[1;24r[24;1H
[1;25r[24;1H4 j jj jkk jkklll[25;1H[K[24;17H[?25h[?0c[?25l[?1c[24;17H[K[24;16H[?25h[?0c[?25l[?1c
/[?25h[?0c\vm*n{2}o+/e[?25l[?1c[1;24r[24;1H
[1;25r[24;1H5 m mm mnn mnnooo[25;1H[K[24;17H[?25h[?0c[?25l[?1c[24;17H[K[24;16H[?25h[?0c[?25l[?1c
/[?25h[?0c\V^aa$[?25l[?1c[1;24r[24;1H
[1;25r[24;1H6 x ^aa$ x[25;1H[K[24;5H[?25h[?0c[?25l[?1caa$ x[24;10H[K[24;5H[?25h[?0c[?25l[?1c
:[?25h[?0cset magic[?25l[?1c[24;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c\v(a)(b)\2\1\1/e[?25l[?1c[1;24r[24;1H
[1;25r[24;1H7 (a)(b) abbaa[25;1H[K[24;14H[?25h[?0c[?25l[?1c[24;14H[K[24;13H[?25h[?0c[?25l[?1c
/[?25h[?0c\V[ab]\(\[xy]\)\1[?25l[?1c[1;24r[24;1H
[1;25r[24;1H8 axx [ab]xx[25;1H[K[24;7H[?25h[?0c[?25l[?1cab]x[24;12H[K[24;7H[?25h[?0c[?25l[?1c
:[?25h[?0c$[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1H9 foobar[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset undolevels=100[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H?[?25h[?0cbar?[?25l[?1c[25;5H[K[25;1H[23;6H[K[24;1H[1m[34m~                                                                               [23;5H[?25h[?0c[?25l[?1c[0m

1 more line; before #2  0 seconds ago[23;6Hbar[24;1H[K[23;6H[?25h[?0c[?25l[?1c
9 foo[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c?^1?,$w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New] 11L, 137C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test44.failed test.ok test.out X* viminfo
cp test44.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test44.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test44.in" 68 lines, 2601 characters[1;1HTests for regexp with multi-byte encoding and various magic settings.
Test matchstr() with a count and multi-byte chars.
See test99 for exactly the same test with re=2.

STARTTEST
:so mbyte.vim
:set nocompatible encoding=utf-8 termencoding=latin1 viminfo+=nviminfo
:set re=1
/^1
/a*b\{2}c\+/e
x/\Md\*e\{2}f\+/e
x:set nomagic
/g\*h\{2}i\+/e
x/\mj*k\{2}l\+/e
x/\vm*n{2}o+/e
x/\V^aa$
x:set magic
/\v(a)(b)\2\1\1/e
x/\V[ab]\(\[xy]\)\1
x:" Now search for multi-byte without composing char
/ม
x:" Now search for multi-byte with composing char
/ม[1m[34m~H[0m
x:" find word by change of word class[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for regexp with multi-byte encoding and various magic settings.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[5;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 41 lines, 1362 characters written[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[6;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1Hx?.
x:let @w=':%s#comb[i]nations#[1m[34m~S[0m[1m[34m~D[0mṣ[1m[34m~A[0mm̥[1m[34m~D[0mα[1m[34m~D[0m[1m[34m~F[0m[1m[34m~A[0m#g'
:@w
:?^1?,$w! test.out
:e! test.out
G:put =matchstr(\"[1m[34m~P[0m[1m[34m~Q[0m[1m[34m~R[0m[1m[34m~S[0m\", \".\", 0, 2) " [1m[34m~Q[0m
:put =matchstr(\"[1m[34m~P[0m[1m[34m~Q[0m[1m[34m~R[0m[1m[34m~S[0m\", \"..\", 0, 2) " [1m[34m~Q[0m[1m[34m~R[0m
:put =matchstr(\"[1m[34m~P[0m[1m[34m~Q[0m[1m[34m~R[0m[1m[34m~S[0m\", \".\", 0, 0) " [1m[34m~P[0m
:put =matchstr(\"[1m[34m~P[0m[1m[34m~Q[0m[1m[34m~R[0m[1m[34m~S[0m\", \".\", 4, -1) " [1m[34m~R[0m
:w!
:qa!
ENDTEST

1 a aa abb abbccc
2 d dd dee deefff
3 g gg ghh ghhiii
4 j jj jkk jkklll
5 m mm mnn mnnooo
6 x ^aa$ x
7 (a)(b) abbaa
8 axx [ab]xx
9 หม[1m[34m~H[0mx อมx
a อมx หม[1m[34m~H[0mx
b [1m[34m~A[0m[1m[34m~B[0m[1m[34m~C[0m[1m[34m~A[0m[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso mbyte.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nocompatible encoding=utf-8 termencoding=latin1 viminfo+=nviminfo[?25l[?1c[27m[24m[0m[H[J[1;1Hx?.
x:let @w=':%s#comb[i]nations#m#g'
:@w
:?^1?,$w! test.out
:e! test.out
G:put =matchstr(\"\", \".\", 0, 2) " 
:put =matchstr(\"\", \"..\", 0, 2) " 
:put =matchstr(\"\", \".\", 0, 0) " 
:put =matchstr(\"\", \".\", 4, -1) " 
:w!
:qa!
ENDTEST

1 a aa abb abbccc
2 d dd dee deefff
3 g gg ghh ghhiii
4 j jj jkk jkklll
5 m mm mnn mnnooo
6 x ^aa$ x
7 (a)(b) abbaa
8 axx [ab]xx
9 x x
a x x
b ????[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset re=1[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^1[?25l[?1c[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0ca*b\{2}c\+/e[?25l[?1c[14;17H[?25h[?0c[?25l[?1c[14;17H[K[14;16H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c\Md\*e\{2}f\+/e[?25l[?1c[15;17H[?25h[?0c[?25l[?1c[15;17H[K[15;16H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nomagic[?25l[?1c[15;16H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cg\*h\{2}i\+/e[?25l[?1c[16;17H[?25h[?0c[?25l[?1c[16;17H[K[16;16H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c\mj*k\{2}l\+/e[?25l[?1c[17;17H[?25h[?0c[?25l[?1c[17;17H[K[17;16H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c\vm*n{2}o+/e[?25l[?1c[18;17H[?25h[?0c[?25l[?1c[18;17H[K[18;16H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c\V^aa$[?25l[?1c[19;5H[?25h[?0c[?25l[?1caa$ x[19;10H[K[19;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset magic[?25l[?1c[19;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c\v(a)(b)\2\1\1/e[?25l[?1c[20;14H[?25h[?0c[?25l[?1c[20;14H[K[20;13H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c\V[ab]\(\[xy]\)\1[?25l[?1c[21;7H[?25h[?0c[?25l[?1cab]x[21;12H[K[21;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Now search for multi-byte without composing char[?25l[?1c[21;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c[?25l[?1c[22;8H[?25h[?0c[?25l[?1cx[22;9H[K[22;8H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Now search for multi-byte with composing char[?25l[?1c[22;8H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c[?25l[?1c[23;8H[?25h[?0c[?25l[?1cx[23;9H[K[23;8H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" find word by change of word class[?25l[?1c[23;8H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c?\<??\>?[?25l[?1c[24;3H[?25h[?0c[?25l[?1c???[24;9H[K[24;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test \%u, [\u] and friends[?25l[?1c[24;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c\%u20ac[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hc x x[25;1H[K[24;6H[?25h[?0c[?25l[?1cx[24;7H[K[24;6H[?25h[?0c[?25l[?1c
/[?25h[?0c[\u4f7f\u5929]\+[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hd ??x[25;1H[K[24;3H[?25h[?0c[?25l[?1c?x [24;7H[K[24;3H[?25h[?0c[?25l[?1c
/[?25h[?0c\%U12345678[?25l[?1c[1;24r[24;1H
[1;25r[24;1He y[25;1H[K[24;3H[?25h[?0c[?25l[?1cy[24;4H[K[24;3H[?25h[?0c[?25l[?1c
/[?25h[?0c[\U1234abcd\u1234\uabcd][?25l[?1c[1;24r[24;1H
[1;25r[24;1Hf z[25;1H[K[24;3H[?25h[?0c[?25l[?1cz[24;4H[K[24;3H[?25h[?0c[?25l[?1c
/[?25h[?0c\%d21879b[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hg a?bb[25;1H[K[24;4H[?25h[?0c[?25l[?1cbb[24;6H[K[24;4H[?25h[?0c[?25l[?1c
/[?25h[?0c [[=A=]]* [[=B=]]* [[=C=]]* [[=D=]]* [[=E=]]* [[=F=]]* [[=G=]]* [[=H=]]* [[=I=
[24;80H][25;1H]* [[=J=]]* [[=K=]]* [[=L=]]* [[=M=]]* [[=N=]]* [[=O=]]* [[=P=]]* [[=Q=]]* [[=R
[24;80H=[25;1H]]* [[=S=]]* [[=T=]]* [[=U=]]* [[=V=]]* [[=W=]]* [[=X=]]* [[=Y=]]* [[=Z=]]*/e[?25l[?1c[23;1H[1m[32mPress ENTER or type command to continue[0m[23;40H[K[24;1H[K[25;1H[K[?25h[?0c[1;1H[2L[?25l[?1c[1;1H:put =matchstr(\"\", \".\", 4, -1) " 
:w!
:qa![3;6H[K[4;1HENDTEST[4;8H[K[5;1H[K[6;1H1 a aa abb abbcc
2 d dd dee deeff
3 g gg ghh ghhii
4 j jj jkk jkkll
5 m mm mnn mnnoo
6 x aa$ x[11;10H[K[12;1H7 (a)(b) abba[12;14H[K[13;1H8 axx ab]xx[13;12H[K[14;1H9 x x[14;9H[K[15;1Ha x x[15;10H[K[16;1Hb ???[16;9H[K[17;1Hc x x[17;7H[K[18;1Hd ?[18;7H[K[19;1He y [19;5H[K[20;1Hf z[20;5H[K[21;1Hg abb
h Aſ B Cǿ D E˿ F G H IϿ[23;1H J K L M Nѿ Oؿ P Q R S T Uܿ[24;1H V W X Yݿ Z[25;1H[K[24;38H[?25h[?0c[?25l[?1c[24;38H[K[24;37H[?25h[?0c[?25l[?1c
/[?25h[?0c [[=a=]]* [[=b=]]* [[=c=]]* [[=d=]]* [[=e=]]* [[=f=]]* [[=g=]]* [[=h=]]* [[=i=
[24;80H][25;1H]* [[=j=]]* [[=k=]]* [[=l=]]* [[=m=]]* [[=n=]]* [[=o=]]* [[=p=]]* [[=q=]]* [[=r
[24;80H=[25;1H]]* [[=s=]]* [[=t=]]* [[=u=]]* [[=v=]]* [[=w=]]* [[=x=]]* [[=y=]]* [[=z=]]*/e[?25l[?1c[23;1H[1m[32mPress ENTER or type command to continue[0m[23;40H[K[24;1H[K[25;1H[K[?25h[?0c[1;1H[2L[?25l[?1c[1;1HENDTEST

1 a aa abb abbcc
2 d dd dee deeff
3 g gg ghh ghhii
4 j jj jkk jkkll
5 m mm mnn mnnoo
6 x aa$ x[8;10H[K[9;1H7 (a)(b) abba[9;14H[K[10;1H8 axx ab]xx[10;12H[K[11;1H9 x x[11;9H[K[12;1Ha x x[12;10H[K[13;1Hb ???[13;9H[K[14;1Hc x x[14;7H[K[15;1Hd ?[15;7H[K[16;1He y [16;5H[K[17;1Hf z[17;5H[K[18;1Hg abb
h Aſ B Cǿ D E˿ F G H IϿ[20;1H J K L M Nѿ Oؿ P Q R S T Uܿ[21;1H V W X Yݿ Z
i a忿 b c翿 d e뿿 f g h i￿[23;2Hj k l m n񿿿 o p q r s t u[24;1H v w x y z[25;1H[K[24;43H[?25h[?0c[?25l[?1c[24;43H[K[24;42H[?25h[?0c[?25l[?1c
:[?25h[?0c" Test backwards search from a multi-byte char[?25l[?1c[24;42H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cx[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hj 0123x[25;1H[K[24;8H[?25h[?0c[?25l[?1c[24;8H[K[24;7H[?25h[?0c[?25l[?1c
?[?25h[?0c.[?25l[?1c[24;6H[?25h[?0c[?25l[?1c[24;7H[K[24;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet @w=':%s#comb[i]nations#mmm[1C#g'[?25l[?1c[24;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c@w[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hk m[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c?^1?,$w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New] 20L, 1011C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! test.out[?25l[?1c"test.out" [25;12H[K[25;12H20L, 1011C[1;1H[?25h[?0c[24;1H[?25l[?1c[25;1H[K[25;1H:[?25h[?0cput =matchstr(\"\", \".\", 0, 2) " [?25l[?1c[1;24r[24;1H
[1;25r[24;1H[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =matchstr(\"\", \"..\", 0, 2) " [?25l[?1c[1;24r[24;1H
[1;25r[24;1H[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =matchstr(\"\", \".\", 0, 0) " [?25l[?1c[1;24r[24;1H
[1;25r[24;1H[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =matchstr(\"\", \".\", 4, -1) " [?25l[?1c[1;24r[24;1H
[1;25r[24;1H[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cw![?25l[?1c"test.out" 24L, 1025C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test45.failed test.ok test.out X* viminfo
cp test45.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test45.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test45.in" 80 lines, 1824 characters[1;1HTests for folding. vim: set ft=vim :

STARTTEST
:so small.vim
:" We also need the +syntax feature here.
:if !has("syntax")
   e! test.ok
   w! test.out
   qa!
:endif
:" basic test if a fold can be created, opened, moving to the end and closed
/^1
zf2j:call append("$", "manual " . getline(foldclosed(".")))
zo:call append("$", foldclosed("."))
]z:call append("$", getline("."))
zc:call append("$", getline(foldclosed(".")))
:" test folding with markers.
:set fdm=marker fdl=1 fdc=3
/^5
:call append("$", "marker " . foldlevel("."))
[z:call append("$", foldlevel("."))
jo{{ [1m[34m^[[0mr{jj:call append("$", foldlevel("."))
kYpj:call append("$", foldlevel("."))
:" test folding with indent[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for folding. vim: set ft=vim :[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 63 lines, 1691 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H/bb$
:call append("$", "expr " . foldlevel("."))
/hh$
:call append("$", foldlevel("."))
/ii$
:call append("$", foldlevel("."))
/kk$
:call append("$", foldlevel("."))
:/^last/+1,$w! test.out
:delfun Flvl
:qa!
ENDTEST

1 aa
2 bb
3 cc
4 dd {{{
5 ee {{{ }}}
6 ff }}}
7 gg
8 hh
9 ii
a jj
b kk[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" We also need the +syntax feature here.[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif !has("syntax")[?25l[?1c
:  [?25h[?0c   e! test.ok
[?25l[?1c:  [?25h[?0c   w! test.out
[?25l[?1c:  [?25h[?0c   qa!
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[1;1H/bb$
:call append("$", "expr " . foldlevel("."))
/hh$
:call append("$", foldlevel("."))[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c" basic test if a fold can be created, opened, moving to the end and closed[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^1[?25l[?1c[14;1H[?25h[?0c[?25l[?1c[1m[36m[40m+--  3 lines: 1 aa--------------------------------------------------------------[0m[15;1H4 dd {{{
5 ee {{{ }}}
6 ff }}}
7 gg[18;6H[K[19;1H8 hh[19;6H[K[20;1H9 ii
a jj
b kk
last
[1m[34m~                                                                               [14;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall append("$", "manual " . getline(foldclosed(".")))[?25l[?1c[24;1Hmanual 1 aa[24;12H[K[14;1H[?25h[?0c[?25l[?1c1 aa[14;5H[K[15;1H2 bb[15;6H[K[16;1H3 cc[16;6H[K[17;1H4 dd {{{
5 ee {{{ }}}
6 ff }}}
7 gg
8 hh
9 ii
a jj
b kk[24;5H[K[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append("$", foldclosed("."))[?25l[?1c[14;1H[?25h[?0c

[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append("$", getline("."))[?25l[?1c[16;1H[?25h[?0c[?25l[?1c[14;1H[1m[36m[40m+--  3 lines: 1 aa--------------------------------------------------------------[0m[15;1H4 dd {{{
5 ee {{{ }}}
6 ff }}}
7 gg[18;6H[K[19;1H8 hh[19;6H[K[20;1H9 ii
a jj
b kk
last
manual 1 aa[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append("$", getline(foldclosed(".")))[?25l[?1c[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test folding with markers.[?25l[?1c[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fdm=marker fdl=1 fdc=3[?25l[?1c[1;1H[1m[36m[40m   [0m/bb$
[1m[36m[40m   [0m:call append("$", "expr " . foldlevel("."))
[1m[36m[40m   [0m/hh$
[1m[36m[40m   [0m:call append("$", foldlevel("."))
[1m[36m[40m   [0m/ii$
[1m[36m[40m   [0m:call append("$", foldlevel("."))
[1m[36m[40m   [0m/kk$
[1m[36m[40m   [0m:call append("$", foldlevel("."))
[1m[36m[40m   [0m:/^last/+1,$w! test.out
[1m[36m[40m   [0m:delfun Flvl
[1m[36m[40m   [0m:qa!
[1m[36m[40m   [0mENDTEST
[1m[36m[40m   
   [0m1 aa[14;8H[K[15;1H[1m[36m[40m   [0m2 bb[15;8H[K[16;1H[1m[36m[40m   [0m3 cc[16;8H[K[17;1H[1m[36m[40m-  [0m4 dd {{{
[1m[36m[40m|- [0m5 ee {{{ }}}
[1m[36m[40m|  [0m6 ff }}}
[1m[36m[40m   [0m7 gg
[1m[36m[40m   [0m8 hh
[1m[36m[40m   [0m9 ii
[1m[36m[40m   [0ma jj
[1m[36m[40m   [0mb kk[24;8H[K[16;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^5[?25l[?1c[18;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append("$", "marker " . foldlevel("."))[?25l[?1c[18;4H[?25h[?0c[17;4H[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append("$", foldlevel("."))[?25l[?1c[17;4H[?25h[?0c[18;4H[?25l[?1c[20;24r[20;1H[L[1;25r[19;4H{{ [19;7H[K[20;1H[1m[36m[40m|  [0m6 ff }}}[25;1H[K[19;6H[?25h[?0c[?25l[?1c[19;2H[1m[36m[40m-[0m[3C{[20;2H[1m[36m[40m|
|
|
|
|[19;6H[?25h[?0c[20;6H[21;6H[?25l[?1c[25;1H[0m:[?25h[?0ccall append("$", foldlevel("."))[?25l[?1c[21;6H[?25h[?0c[20;6H[?25l[?1c[21;4H6 ff }}}
[1m[36m[40m [0m[2C7 gg
[1m[36m[40m [0m[2C8 hh
[1m[36m[40m [0m[2C9 ii[21;4H[?25h[?0c[22;4H[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append("$", foldlevel("."))[?25l[?1c[22;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test folding with indent[?25l[?1c[22;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fdm=indent sw=2[?25l[?1c[17;1H[1m[36m[40m 
  
  
  
 
   [?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H/[?25h[?0c^2 b[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[15;4H[?25h[?0c[?25l[?1c[0m[1m[36m[40m-[0m[2C  2 bb[?25h[?0c[16;5H[?25l[?1c[1m[36m[40m|-[0m[1C    3 cc[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append("$", "indent " . foldlevel("."))[?25l[?1c[16;7H[?25h[?0c[15;7H[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append("$", foldlevel("."))[?25l[?1c[15;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test syntax folding[?25l[?1c[15;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fdm=syntax fdl=0[?25l[?1c[15;1H[1m[36m[40m 
  [15;7H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0csyn region Hup start="dd" end="ii" fold contains=Fd1,Fd2,Fd3[?25l[?1c[17;1H[1m[36m[40m+  +--  8 lines: 4 dd ----------------------------------------------------------[0m[18;4Ha jj[18;9H[K[19;4Hb kk[20;4Hlast[20;9H[K[21;4Hmanual 1 aa[22;4H-1[22;6H[K[23;4H3 cc[24;4H1 aa[15;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csyn region Fd1 start="ee" end="ff" fold contained[?25l[?1c[15;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csyn region Fd2 start="gg" end="hh" fold contained[?25l[?1c[15;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csyn region Fd3 start="commentstart" end="commentend" fold contained[?25l[?1c[15;7H[?25h[?0c[?25l[?1c[1;24r[1;1H[6M[1;25r[19;1H[1m[36m[40m   [0mmarker 2
[1m[36m[40m   [0m1
[1m[36m[40m   [0m1
[1m[36m[40m   [0m0
[1m[36m[40m   [0mindent 2
[1m[36m[40m   [0m1[25;1H[K[24;4H[?25h[?0c[11;4H[?25l[?1c[25;1H:[?25h[?0ccall append("$", "folding " . getline("."))[?25l[?1c[11;4H[?25h[?0c[10;4H[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append("$", getline("."))[?25l[?1c[10;4H[?25h[?0c[11;4H[?25l[?1c[1m[36m[40m--[0m[1C4 dd {{{commentstart  [11;26H[K[12;1H[1m[36m[40m||[0m[1C5 ee {{{ }}}
[1m[36m[40m||[0m[1C{{{[13;7H[K[14;1H[1m[36m[40m||[0m[1C6 ff }}}
[1m[36m[40m||[0m[1C6 ff }}}[15;13H[K[16;1H[1m[36m[40m||[0m[1C7 gg
[1m[36m[40m||[0m[1C8 hh
[1m[36m[40m||[0m[1C9 ii
[1m[36m[40m||[0m[1Ca jj[19;8H[K[20;1H[1m[36m[40m||[0m[1Cb kk
[1m[36m[40m||[0m[1Clast
[1m[36m[40m||[0m[1Cmanual 1 aa
[1m[36m[40m||[0m[1C-1[23;6H[K[24;1H[1m[36m[40m||[0m[1C3 cc[11;25H[?25h[?0c[?25l[?1c[11;2H[1m[36m[40m [0m[23Ccommentend[12;2H[1m[36m[40m-[15;2H 
|-

| 
  
  
  
  
  
  [11;35H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset fdl=1[?25l[?1c[12;2H[1m[36m[40m+ +---  3 lines: 5 ee ---------------------------------------------------------[13;2H [0m[1C6 ff }}}[14;2H[1m[36m[40m+ +---  2 lines: 7 gg----------------------------------------------------------[0m[15;4H9 ii[15;9H[K[16;1H[1m[36m[40m  [0m[1Ca jj
[1m[36m[40m  [0m[1Cb kk
[1m[36m[40m [0m[2Clast[19;4Hmanual 1 aa[20;4H-1[20;6H[K[21;4H3 cc[22;4H1 aa[22;8H[K[23;4Hmarker 2[24;4H1[24;6H[K[11;35H[?25h[?0c[14;4H[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append("$", getline("."))[?25l[?1c[14;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fdl=0[?25l[?1c[11;1H[1m[36m[40m+  +--  8 lines: 4 dd commentstart  commentend----------------------------------[12;1H  [0m[1Ca jj[12;8H[K[13;1H[1m[36m[40m [0m[2Cb kk[13;9H[K[14;1H[1m[36m[40m  [0m[1Clast[14;8H[K[15;1H[1m[36m[40m [0m[2Cmanual 1 aa[16;4H-1[16;6H[K[17;4H3 cc[18;4H1 aa[19;6Hrker 2[19;13H[K[20;4H1[20;5H[K[21;4H1[21;6H[K[22;4H0[22;6H[K[23;4Hindent[11;4H[?25h[?0c[?25l[?1c[1m[36m[40m-[0m[2C4 dd {{{commentstart  commentend[11;36H[K[12;1H[1m[36m[40m|-[0m[1C5 ee {{{ }}}
[1m[36m[40m||[0m[1C{{{[13;7H[K[14;1H[1m[36m[40m||[0m[1C6 ff }}}
[1m[36m[40m|[0m[2C6 ff }}}[15;13H[K[16;1H[1m[36m[40m|-[0m[1C7 gg
[1m[36m[40m||[0m[1C8 hh
[1m[36m[40m|[0m[2C9 ii[19;4Ha jj[19;8H[K[20;4Hb kk[21;4Hlast[22;4Hmanual 1 aa[23;4H-1[23;6H[K[24;4H3 cc[16;7H[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[1;1H[1m[36m[40m   [0m/kk$
[1m[36m[40m   [0m:call append("$", foldlevel("."))
[1m[36m[40m   [0m:/^last/+1,$w! test.out
[1m[36m[40m   [0m:delfun Flvl
[1m[36m[40m   [0m:qa!
[1m[36m[40m   [0mENDTEST
[1m[36m[40m   
   [0m1 aa
[1m[36m[40m   [0m  2 bb
[1m[36m[40m   [0m    3 cc
[1m[36m[40m-  [0m4 dd {{{commentstart  commentend
[1m[36m[40m|- [0m5 ee {{{ }}}
[1m[36m[40m|| [0m{{{
[1m[36m[40m|| [0m6 ff }}}
[1m[36m[40m|  [0m6 ff }}}
[1m[36m[40m|- [0m7 gg
[1m[36m[40m|| [0m8 hh
[1m[36m[40m|  [0m9 ii
[1m[36m[40m   [0ma jj
[1m[36m[40m   [0mb kk
[1m[36m[40m   [0mlast
[1m[36m[40m   [0mmanual 1 aa
[1m[36m[40m   [0m-1
[1m[36m[40m   [0m3 cc[16;7H[?25h[?0c[17;4H[?25l[?1c[25;1H:[?25h[?0ccall append("$", getline("."))[?25l[?1c[17;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test expression folding[?25l[?1c[17;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfun Flvl()[?25l[?1c
:  [?25h[?0c  let l = getline(v:lnum)
[?25l[?1c:  [?25h[?0c  if l =~ "bb$"
[?25l[?1c:    [?25h[?0c    return 2
[?25l[?1c:    [?25h[?0c  elseif l =~ "gg$"
[?25l[?1c:    [?25h[?0c    return "s1"
[?25l[?1c:    [?25h[?0c  elseif l =~ "ii$"
[?25l[?1c:    [?25h[?0c    return ">2"
[?25l[?1c:    [?25h[?0c  elseif l =~ "kk$"
[?25l[?1c:    [?25h[?0c    return "0"
[?25l[?1c:    [?25h[?0c  endif
[?25l[?1c:  [?25h[?0c  return "="
[?25l[?1c:  [?25h[?0cendfun[1;1H[12L[?25l[?1c[1;1H[1m[36m[40m   [0m/kk$
[1m[36m[40m   [0m:call append("$", foldlevel("."))
[1m[36m[40m   [0m:/^last/+1,$w! test.out
[1m[36m[40m   [0m:delfun Flvl
[1m[36m[40m   [0m:qa!
[1m[36m[40m   [0mENDTEST
[1m[36m[40m   
   [0m1 aa
[1m[36m[40m   [0m  2 bb
[1m[36m[40m   [0m    3 cc
[1m[36m[40m-  [0m4 dd {{{commentstart  commentend
[1m[36m[40m|- [0m5 ee {{{ }}}[25;1H[K[17;4H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset fdm=expr fde=Flvl()[?25l[?1c[9;1H[1m[36m[40m+  +-- 11 lines: 2 bb-----------------------------------------------------------[0m[10;4Hb kk[10;8H[K[11;1H[1m[36m[40m [0m[2Clast[11;9H[K[12;1H[1m[36m[40m  [0m[1Cmanual 1 aa[12;15H[K[13;1H[1m[36m[40m  [0m[1C-1[13;6H[K[14;1H[1m[36m[40m  [0m[1C3 cc[14;9H[K[15;1H[1m[36m[40m [0m[2C1 aa[15;9H[K[16;1H[1m[36m[40m  [0m[1Cmarker 2
[1m[36m[40m  [0m[1C1[17;6H[K[18;1H[1m[36m[40m [0m[2C1[18;6H[K[19;4H0[19;6H[K[20;4Hindent 2[21;4H1[21;5H[K[22;1H[1m[36m[40m+  +--  4 lines: folding 9 ii---------------------------------------------------[0m[23;4H[1m[34m~                                                                            [24;4H~                                                                            [9;4H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H/[?25h[?0cbb$[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m[9;1H[1m[36m[40m--[0m[1C  2 bb[9;10H[K[10;1H[1m[36m[40m||[0m[1C    3 cc
[1m[36m[40m||[0m[1C4 dd {{{commentstart  commentend
[1m[36m[40m||[0m[1C5 ee {{{ }}}
[1m[36m[40m||[0m[1C{{{
[1m[36m[40m||[0m[1C6 ff }}}
[1m[36m[40m||[0m[1C6 ff }}}
[1m[36m[40m||[0m[1C7 gg[16;8H[K[17;1H[1m[36m[40m|[0m[2C8 hh
[1m[36m[40m|+ +---  2 lines: 9 ii----------------------------------------------------------[0m[19;4Hb kk[20;4Hlast[20;8H[K[21;4Hmanual 1 aa
[1m[36m[40m [0m[2C-1[22;6H[K[23;4H3 cc[23;8H[K[24;4H1 aa[24;8H[K[9;8H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append("$", "expr " . foldlevel("."))[?25l[?1c[9;8H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0chh$[?25l[?1c[17;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append("$", foldlevel("."))[?25l[?1c[17;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cii$[?25l[?1c[18;2H[1m[36m[40m-[0m[1C9 ii[18;8H[K[19;1H[1m[36m[40m||[0m[1Ca jj[20;4Hb kk[21;4Hlast[21;8H[K[22;4Hmanual 1 aa[23;4H-1[23;6H[K[24;4H3 cc[18;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append("$", foldlevel("."))[?25l[?1c[18;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0ckk$[?25l[?1c[20;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append("$", foldlevel("."))[?25l[?1c[20;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^last/+1,$w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 18 lines, 96 characters written[20;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cdelfun Flvl[?25l[?1c[20;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test46.failed test.ok test.out X* viminfo
cp test46.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test46.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test46.in" 27 lines, 431 characters[1;1HTests for multi-line regexps with ":s". vim: set ft=vim :

STARTTEST
:" test if replacing a line break works with a back reference
:/^1/,/^2/s/\n\(.\)/ \1/
:" test if inserting a line break works with a back reference
:/^3/,/^4/s/\(.\)$/\r\1/
:" test if replacing a line break with another line break works
:/^5/,/^6/s/\(\_d\{3}\)/x\1x/
:/^1/,$w! test.out
:qa!
ENDTEST

1 aa
bb
cc
2 dd
ee
3 ef
gh
4 ij
5 a8
8b c9
9d[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for multi-line regexps with ":s". vim: set ft=vim :[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 8 lines, 292 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[12;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test if replacing a line break works with a back reference[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^1/,/^2/s/\n\(.\)/ \1/[?25l[?1c4 substitutions on 1 line[14;24r[14;1H[4M[1;25r[14;1H1 aa bb cc 2 dd ee[21;1H6 e7
77f
xxxxx
[1m[34m~                                                                               [0m[25;1H[K[25;1H4 substitutions on 1 line[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test if inserting a line break works with a back reference[?25l[?1c[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^3/,/^4/s/\(.\)$/\r\1/[?25l[?1c3 substitutions on 3 lines[18;24r[18;1H[3L[1;25r[15;4H[K[16;1Hf[16;2H[K[17;1Hg[17;3H[K[18;1Hh
4 i
j[25;1H[K[25;1H3 substitutions on 3 lines[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test if replacing a line break with another line break works[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^5/,/^6/s/\(\_d\{3}\)/x\1x/[?25l[?1c3 substitutions on 2 lines[25;27H[K[1;24r[24;1H
[1;25r[20;4Hx8
8xb cx9
9xd
6 ex7
7x7f[25;1H[K[25;1H3 substitutions on 2 lines[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^1/,$w! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 13 lines, 70 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test47.failed test.ok test.out X* viminfo
cp test47.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test47.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test47.in" 62 lines, 1351 characters[1;1HTests for vertical splits and filler lines in diff mode

STARTTEST
:so small.vim
:" Disable the title to avoid xterm keeping the wrong one.
:set notitle noicon
/^1
yG:new
pkdd:w! Xtest
ddGpkkrXoxxx[1m[34m^[[0m:w! Xtest2
:file Nop
ggoyyy[1m[34m^[[0mjjjozzzz[1m[34m^[[0m
:vert diffsplit Xtest
:vert diffsplit Xtest2
:" jump to second window for a moment to have filler line appear at start of
:" first window
[1m[34m^W^W[0mgg[1m[34m^W[0mpgg:let one = winline()
j:let one = one . "-" . winline()
j:let one = one . "-" . winline()
j:let one = one . "-" . winline()
j:let one = one . "-" . winline()
j:let one = one . "-" . winline()
[1m[34m^W^W[0mgg:let two = winline()
j:let two = two . "-" . winline()[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for vertical splits and filler lines in diff mode[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 52 lines, 1250 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:" Test that diffing shows correct filler lines
:diffoff!
:windo :bw!
:enew
:put =range(4,10)
:1d _
:vnew
:put =range(1,10)
:1d _
:windo :diffthis
:wincmd h
:let w0=line('w0')
:enew
:put =w0
:.w >> test.out
:unlet! one two three w0
:qa!
ENDTEST

1 aa
2 bb
3 cc
4 dd
5 ee[18;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[19;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[19;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Disable the title to avoid xterm keeping the wrong one.[?25l[?1c[19;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset notitle noicon[?25l[?1c[19;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^1[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H5 lines yanked[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnew[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7m[No Name]                                                                       [0m[13;2Hwincmd h
:let w0=line('w0')
:enew[15;6H[K[16;2Hput =w0[16;9H[K[17;2H.w >> test.out
:unlet! one two three w0
:qa!
ENDTEST[21;1H[K[22;1H1 aa
2 bb
[7mtest47.in                                                                       [1;1H[?25h[?0c[?25l[?1c[0m[25;1H5 more lines[2;1H1 aa[2;5H[K[3;1H2 bb[3;5H[K[4;1H3 cc[4;5H[K[5;1H4 dd[5;5H[K[6;1H5 ee[6;5H[K[12;11H[1m[7m[+][2;1H[?25h[?0c[1;1H[?25l[?1c[1;11r[0m[11;1H
[1;25r[11;1H[1m[34m~                                                                               [0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cw! Xtest[?25l[?1c"Xtest" [25;9H[K[25;9H[New File] 5 lines, 25 characters written[12;1H[1m[7mXtest        [1;1H[?25h[?0c[?25l[?1c[1;11r[0m[11;1H
[1;25r[11;1H[1m[34m~                                                                               [0m[12;7H[1m[7m[+][0m[25;1H[K[1;1H[?25h[?0c


[?25l[?1c
1 aa[5;5H[K[5;1H[?25h[?0c[4;1H[3;1H[?25l[?1cX[?25h[?0c[?25l[?1c[4;11r[4;1H[L[1;25r[4;1Hxxx[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cw! Xtest2[?25l[?1c"Xtest2" [25;10H[K[25;10H[New File] 6 lines, 29 characters written[12;7H[1m[7m   [4;3H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cfile Nop[?25l[?1c"Nop" [Not edited] line 4 of 6 --66%-- col 3[12;1H[1m[7mNop  [4;3H[?25h[?0c[1;1H[?25l[?1c[2;11r[0m[2;1H[L[1;25r[2;1Hyyy[12;5H[1m[7m[+][0m[25;1H[K[2;3H[?25h[?0c
3 
X 
xx[?25l[?1c[6;11r[6;1H[L[1;25r[6;1Hzzzz[?25h[?0c
5 e[?25l[?1c[25;1H:[?25h[?0cvert diffsplit Xtest[?25l[?1c"Xtest" [25;9H[K[25;9H5 lines, 25 characters[1;1H[1m[36m[40m  [0m[44m1 aa                                  [0m[7m|[0m
[1m[36m[40m  [0m2 bb[34C[7m|[0m
[1m[36m[40m  [0m[1m[34m[46m--------------------------------------[0m[7m|[0m
[1m[36m[40m  [0m3 cc[34C[7m|[0m
[1m[36m[40m  [0m[1m[41m4[0m[45m dd                                  [0m[7m|[0m
[1m[36m[40m  [0m[1m[34m[46m--------------------------------------[0m[7m|[0m
[1m[36m[40m  [0m[1m[34m[46m--------------------------------------[0m[7m|[0m
[1m[36m[40m  [0m5 ee[34C[7m|[9;41H|[10;41H|[11;41H|[0m[9;1H[1m[36m[40m  [0m[1m[34m[46m--------------------------------------[0m
[1m[36m[40m  
  [0m[10;3H[1m[34m~[11;3H~[0m
[1m[7mXtest  [0m[1;42H[1m[36m[40m  [0m[1m[34m[46m-------------------------------------[0m[2;42H[1m[36m[40m  [0m2 bb[3;42H[1m[36m[40m  [0m[44myyy                                  [0m[4;42H[1m[36m[40m  [0m3 cc[5;42H[1m[36m[40m  [0m[1m[41mX[0m[45m dd                                 [0m[6;42H[1m[36m[40m  [0m[44mxxx                                  [0m[7;42H[1m[36m[40m  [0m[44mzzzz                                 [0m[8;42H[1m[36m[40m  [0m5 ee[9;42H[1m[36m[40m  [0m[44m1 aa                                 [0m[10;42H[1m[36m[40m  [11;42H  [0m[10;44H[1m[34m~[11;44H~[0m[12;42H[7mNop [+]                                [1;3H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cvert diffsplit Xtest2[?25l[?1c"Xtest2" [25;10H[K[25;10H6 lines, 29 characters[27m[24m[0m[H[J[1;1H[1m[36m[40m  [0m[1m[34m[46m------------------------[0m[7m|[0m
[1m[36m[40m  [0m2 bb[20C[7m|[0m
[1m[36m[40m  [0m[1m[34m[46m------------------------[0m[7m|[0m
[1m[36m[40m  [0m3 cc[20C[7m|[0m
[1m[36m[40m  [0m[1m[41mX[0m[45m dd                    [0m[7m|[0m
[1m[36m[40m  [0m[45mxxx                     [0m[7m|[0m
[1m[36m[40m  [0m[1m[34m[46m------------------------[0m[7m|[0m
[1m[36m[40m  [0m5 ee[20C[7m|[0m
[1m[36m[40m  [0m[44m1 aa                    [0m[7m|[10;27H|[11;27H|[0m[10;1H[1m[36m[40m  
  [0m[10;3H[1m[34m~                       [11;3H~                       [0m
[1m[7mXtest2                     [0m[1;28H[1m[36m[40m  [0m[44m1 aa                    [0m[7m|[0m[2;28H[1m[36m[40m  [0m2 bb[20C[7m|[0m[3;28H[1m[36m[40m  [0m[1m[34m[46m------------------------[0m[7m|[0m[4;28H[1m[36m[40m  [0m3 cc[20C[7m|[0m[5;28H[1m[36m[40m  [0m[1m[41m4[0m[45m dd                    [0m[7m|[0m[6;28H[1m[36m[40m  [0m[1m[34m[46m------------------------[0m[7m|[0m[7;28H[1m[36m[40m  [0m[1m[34m[46m------------------------[0m[7m|[0m[8;28H[1m[36m[40m  [0m5 ee[20C[7m|[9;54H|[10;54H|[11;54H|[0m[9;28H[1m[36m[40m  [0m[1m[34m[46m------------------------[0m[10;28H[1m[36m[40m  [11;28H  [0m[10;30H[1m[34m~                       [11;30H~                       [0m[12;28H[7mXtest                      [0m[1;55H[1m[36m[40m  [0m[1m[34m[46m------------------------[0m[2;55H[1m[36m[40m  [0m2 bb[3;55H[1m[36m[40m  [0m[44myyy                     [0m[4;55H[1m[36m[40m  [0m3 cc[5;55H[1m[36m[40m  [0m[1m[41mX[0m[45m dd                    [0m[6;55H[1m[36m[40m  [0m[45mxxx                     [0m[7;55H[1m[36m[40m  [0m[44mzzzz                    [0m[8;55H[1m[36m[40m  [0m5 ee[9;55H[1m[36m[40m  [0m[44m1 aa                    [0m[10;55H[1m[36m[40m  [11;55H  [0m[10;57H[1m[34m~                       [11;57H~                       [0m[12;55H[7mNop [+]                   [0m[13;1H:wincmd h
:let w0=line('w0')
:enew
:put =w0
:.w >> test.out
:unlet! one two three w0
:qa!
ENDTEST

1 aa
2 bb
[7mtest47.in                                                                       [2;3H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0c" jump to second window for a moment to have filler line appear at start of[?25l[?1c[2;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" first window[?25l[?1c[2;3H[?25h[?0c[?25l[?1c[12;1H[7mXtest2                     [0m[1m[7mXtest                      [1;30H[?25h[?0c[?25l[?1c[?25h[?0c[?25l[?1c[12;1HXtest2                     [0m[7mXtest                      [2;3H[?25h[?0c[?25l[?1c[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet one = winline()[?25l[?1c[2;3H[?25h[?0c[?25l[?1c[4;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet one = one . "-" . winline()[?25l[?1c[4;3H[?25h[?0c[?25l[?1c[5;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet one = one . "-" . winline()[?25l[?1c[5;3H[?25h[?0c[?25l[?1c[6;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet one = one . "-" . winline()[?25l[?1c[6;3H[?25h[?0c[?25l[?1c[8;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet one = one . "-" . winline()[?25l[?1c[8;3H[?25h[?0c[?25l[?1c[9;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet one = one . "-" . winline()[?25l[?1c[9;3H[?25h[?0c[?25l[?1c


[7mXtest2                     [0m[1m[7mXtest                      [8;30H[?25h[?0c[?25l[?1c[1;30H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet two = winline()[?25l[?1c[1;30H[?25h[?0c[?25l[?1c[2;30H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet two = two . "-" . winline()[?25l[?1c[2;30H[?25h[?0c[?25l[?1c[4;30H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet two = two . "-" . winline()[?25l[?1c[4;30H[?25h[?0c[?25l[?1c[5;30H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet two = two . "-" . winline()[?25l[?1c[5;30H[?25h[?0c[?25l[?1c[8;30H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet two = two . "-" . winline()[?25l[?1c[8;30H[?25h[?0c[?25l[?1c[12;28H[7mXtest                      [0m[1m[7mNop [+]                   [8;57H[?25h[?0c[?25l[?1c[2;57H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet three = winline()[?25l[?1c[2;57H[?25h[?0c[?25l[?1c[3;57H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet three = three . "-" . winline()[?25l[?1c[3;57H[?25h[?0c[?25l[?1c[4;57H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet three = three . "-" . winline()[?25l[?1c[4;57H[?25h[?0c[?25l[?1c[5;57H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet three = three . "-" . winline()[?25l[?1c[5;57H[?25h[?0c[?25l[?1c[6;57H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet three = three . "-" . winline()[?25l[?1c[6;57H[?25h[?0c[?25l[?1c[7;57H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet three = three . "-" . winline()[?25l[?1c[7;57H[?25h[?0c[?25l[?1c[8;57H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet three = three . "-" . winline()[?25l[?1c[8;57H[?25h[?0c[12;55H[7mNop [+]                   [0m[24;1H[1m[7mtest47.in                                                                       [22;1H[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall append("$", one)[?25l[?1c[24;11H[1m[7m[+][22;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall append("$", two)[?25l[?1c[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append("$", three)[?25l[?1c[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$-2,$w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 3 lines, 36 characters written[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test that diffing shows correct filler lines[?25l[?1c[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cdiffoff![?25l[?1c[1;1H[1m[34m[46m--[0m
2 bb  
3 cc                      
X dd  
xxx                       
5 ee                      
1 aa                      
[1m[34m~                         
~                         
~  
~  [0m[1;28H1 aa                      [2;28H2 bb  [3;28H3 cc                      [4;28H4 dd  [5;28H5 ee                      [6;28H[1m[34m~                         [7;28H~                         [8;28H~                         [9;28H~                         [10;28H~  [11;28H~  [0m[1;55H2 bb[1;59H[K[2;55Hyyy[2;59H[K[3;55H3 cc[3;59H[K[4;55HX dd[4;59H[K[5;55Hxxx[5;58H[K[6;55Hzzzz[6;59H[K[7;55H5 ee[7;59H[K[8;55H1 aa[8;59H[K[9;55H[1m[34m~                         [10;55H~  [11;55H~  [22;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cwindo :bw![?25l[?1c[27m[24m[0m[H[J[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0cenew[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cput =range(4,10)[?25l[?1c7 more lines[25;13H[K[2;1H4[2;2H[K[3;1H5[3;2H[K[4;1H6[4;2H[K[5;1H7[5;2H[K[6;1H8[6;2H[K[7;1H9[7;2H[K[8;1H10[8;3H[K[8;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c1d _[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cvnew[?25l[?1c[1;1H [39C[7m|[2;41H|[3;41H|[4;41H|[5;41H|[6;41H|[7;41H|[8;41H|[9;41H|[10;41H|[11;41H|[12;41H|[13;41H|[14;41H|[15;41H|[16;41H|[17;41H|[18;41H|[19;41H|[20;41H|[21;41H|[22;41H|[23;41H|[0m[2;1H[1m[34m~                                       
~                                       
~                                       
~                                       
~                                       
~                                       [0m[24;1H[1m[7m[No Name]                                [0m[1;42H4[2;42H5[3;42H6[4;42H7[5;42H8[6;42H9[7;42H10[8;42H[1m[34m~[9;42H~[10;42H~[11;42H~[12;42H~[13;42H~[14;42H~[15;42H~[16;42H~[17;42H~[18;42H~[19;42H~[20;42H~[21;42H~[22;42H~[23;42H~[0m[24;42H[7m[No Name] [+]                          [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cput =range(1,10)[?25l[?1c10 more lines[25;14H[K[2;1H1                                       
2                                       
3                                       
4                                       
5                                       
6                                       
7                                       
8                                       
9                                       
10                                      [24;11H[1m[7m[+][11;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c1d _[?25l[?1c[1;1H1                                       
2                                       
3                                       
4                                       
5                                       
6                                       
7                                       
8                                       
9                                       
10                                      
[1m[34m~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       [0m
                                        [1m[34m~                                       [0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cwindo :diffthis[?25l[?1c[1;1H[1m[36m[40m  [0m[44m1                                     [0m
[1m[36m[40m  [0m[44m2                                     [0m
[1m[36m[40m  [0m[44m3                                     [0m
[1m[36m[40m  [0m4
[1m[36m[40m  [0m5
[1m[36m[40m  [0m6
[1m[36m[40m  [0m7
[1m[36m[40m  [0m8
[1m[36m[40m  [0m9
[1m[36m[40m- [0m10
[1m[36m[40m  
  
  
  
  
  
  
  
  
  
  
  
  [0m[11;3H[1m[34m~[12;3H~[13;3H~[14;3H~[15;3H~[16;3H~[17;3H~[18;3H~[19;3H~[20;3H~[21;3H~[22;3H~[23;3H~[0m
[7m[No Name] [+]                            [0m[1;42H[1m[36m[40m  [0m[1m[34m[46m-------------------------------------[0m[2;42H[1m[36m[40m  [0m[1m[34m[46m-------------------------------------[0m[3;42H[1m[36m[40m  [0m[1m[34m[46m-------------------------------------[0m[4;42H[1m[36m[40m  [0m4[5;42H[1m[36m[40m  [0m5[6;42H[1m[36m[40m  [0m6[7;42H[1m[36m[40m  [0m7[8;42H[1m[36m[40m  [0m8[8;45H[K[9;42H[1m[36m[40m  [0m9[9;45H[K[10;42H[1m[36m[40m- [0m10[10;46H[K[11;42H[1m[36m[40m  [12;42H  [13;42H  [14;42H  [15;42H  [16;42H  [17;42H  [18;42H  [19;42H  [20;42H  [21;42H  [22;42H  [23;42H  [0m[11;44H[1m[34m~[12;44H~[13;44H~[14;44H~[15;44H~[16;44H~[17;44H~[18;44H~[19;44H~[20;44H~[21;44H~[22;44H~[23;44H~[0m[24;42H[1m[7m[No Name] [+]                          [4;44H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cwincmd h[?25l[?1c[24;1H[1m[7m[No Name] [+]                            [0m[7m[No Name] [+]                          [1;3H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet w0=line('w0')[?25l[?1c[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cenew[?25l[?1c[1m[37m[41mE37: No write since last change (add ! to override)[1;3H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cput =w0[?25l[?1c[2;3H[44m1[3;3H2[4;3H3                                     [0m[5;3H4[6;3H5[7;3H6[8;3H7[9;3H8
[1m[36m[40m [0m[1C9 
[1m[36m[40m-[0m[1C10                                    [4;44H[1m[34m[46m-------------------------------------[0m[5;44H4[6;44H5[7;44H6[8;44H7[9;44H8[10;42H[1m[36m[40m [0m[1C9[10;45H[K[11;42H[1m[36m[40m-[0m[1C10[11;46H[K[2;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >> test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 2 characters appended[2;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet! one two three w0[?25l[?1c[2;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test48.failed test.ok test.out X* viminfo
cp test48.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test48.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test48.in" 78 lines, 1542 characters[1;1HThis is a test of 'virtualedit'.

STARTTEST
:so small.vim
:set noswf
:set ve=all
-dgg
:"
:"   Insert "keyword keyw", ESC, C CTRL-N, shows "keyword ykeyword".
:"    Repeating CTRL-N fixes it. (Mary Ellen Foster)
2/w
C[1m[34m^N^[[0m
:"
:"   Using "C" then then <CR> moves the last remaining character to the next
:"    line.  (Mary Ellen Foster)
j^/are
C[1m[34m^M[0mare belong to vim[1m[34m^[[0m
:"
:"   When past the end of a line that ends in a single character "b" skips
:"    that word.
^$15lbC7[1m[34m^[[0m
:"
:"   Make sure 'i' works
$4li<-- should be 3 ' '[1m[34m^[[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HThis is a test of 'virtualedit'.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 57 lines, 1331 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:set display=
:"
:"   Test for ^Y/^E due to bad w_virtcol value, reported by
:"   Roy <royl@netropolis.net>.
^O[1m[34m^[[0m3li[1m[34m^E^[[0m4li[1m[34m^E^[[0m4li[1m[34m^E[0m   <-- should show the name of a noted text editor[1m[34m^[[0m
^o[1m[34m^[[0m4li[1m[34m^Y^[[0m4li[1m[34m^Y^[[0m4li[1m[34m^Y[0m   <-- and its version number[1m[34m^[[0m-dd
:"
:" Test for yanking and pasting using the small delete register
gg/^foo
dewve"-p
:wq! test.out
ENDTEST
foo, bar
keyword keyw
all your base are belong to us
1 2 3 4 5 6
'i'
'C'
'a'
'A'
'D'
this is a test
this is a test
this is a test[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset noswf[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ve=all[?25l[?1c[13;1H[?25h[?0c[12;1H[?25l[?1c[25;1H61 fewer lines[1;24r[1;1H[12M[1;25r[13;1H"r"
a[1m[34m^V[0mb[1m[34m^M[0msd
abcv6efi.him0kl


[1m[34m~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [0m[25;1H[K[25;1H61 fewer lines[1;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"   Insert "keyword keyw", ESC, C CTRL-N, shows "keyword ykeyword".[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    Repeating CTRL-N fixes it. (Mary Ellen Foster)[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cw[?25l[?1c[2;12H[?25h[?0c[?25l[?1c$[25;1H[1m[32mScanning tags.[0mThe only match[2;16H[25;1H[K[2;12Hword[?25h[?0c[3;15H[?25l[?1c[25;1H:[?25h[?0c"[?25l[?1c[3;15H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"   Using "C" then then <CR> moves the last remaining character to the next[?25l[?1c[3;15H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    line.  (Mary Ellen Foster)[?25l[?1c[3;15H[?25h[?0c[4;15H[?25l[?1c[25;1H[K[25;1H/[?25h[?0care[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[3;15H[?25h[?0c[?25l[?1c[0m[15C$[3;15H[K[4;1Hare belong to vim
1 2 3 4 5 6
'i
'C
'a
'A
'D'[10;4H[K[13;1Hthis is a test
"r"[14;4H[K[15;2H[1m[34m^V[0mb[1m[34m^M[0msd[15;9H[K[16;1Habcv6efi.him0kl[18;1H[K[4;17H[?25h[?0c[5;17H[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[5;17H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"   When past the end of a line that ends in a single character "b" skips[?25l[?1c[5;17H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    that word.[?25l[?1c[5;17H[?25h[?0c[10C[15C[5;11H[?25l[?1c$7[?25h[?0c[6;11H[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[6;11H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"   Make sure 'i' works[?25l[?1c[6;11H[?25h[?0c'i'   [?25l[?1c<-- should be 3 ' '[?25h[?0c[7;25H[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[7;25H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"   Make sure 'C' works[?25l[?1c[7;25H[?25h[?0c'C'   [?25l[?1c$<-- should be 3 ' '[?25h[?0c[8;25H[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[8;25H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"   Make sure 'a' works[?25l[?1c[8;25H[?25h[?0c'a'   [?25l[?1c <-- should be 4 ' '[?25h[?0c[9;26H[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[9;26H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"   Make sure 'A' works[?25l[?1c[9;26H[?25h[?0c'A'   [?25l[?1c<-- should be 0 ' '[?25h[?0c[10;22H[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[10;22H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"   Make sure 'D' works[?25l[?1c[10;22H[?25h[?0c'D'   [?25l[?1c<-- 'D' should be intact[?25h[?0c[11;30H[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[11;30H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"   Test for yank bug reported by Mark Waggoner.[?25l[?1c[11;30H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ve=block[?25l[?1c[11;14H[?25h[?0c[8C[?25l[?1c[?25h[?0c[?25l[?1c[7ma[12;9Ha[13;9Ha[14;9H[?25h[?0c[?25l[?1c[0m[11;9Ha[12;9Ha[13;9Ha[25;1Hblock of 4 lines yanked[11;9H[?25h[?0c[18;1H[?25l[?1c[25;1H3 more lines[25;13H[K[18;1Ha
a[19;2H[K[20;1Ha[20;2H[K[21;1H [21;2H[K[18;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[19;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test "r" beyond the end of the line[?25l[?1c[19;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ve=all[?25l[?1c[19;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^"r"[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[14;1H[?25h[?0c[0m"r"    [?25l[?1cx[?25h[?0c[?25l[?1cx<-- should be 'x'[?25h[?0c[15;25H[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[15;25H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"   Test to make sure 'x' can delete control characters[?25l[?1c[15;25H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset display=uhex[?25l[?1c[15;2H[1m[34m<16>[0mb[1m[34m<0d>[0msd[16C[?25h[?0c[?25l[?1c[1m[34m<16>[0mb[1m[34m<0d>[0msd[15;12H[K[15;1H[?25h[?0c[?25l[?1cb[1m[34m<0d>[0msd[15;8H[K[15;1H[?25h[?0c[?25l[?1c[1m[34m<0d>[0msd[15;7H[K[15;1H[?25h[?0c[?25l[?1csd[15;3H[K[15;1H[?25h[?0c[?25l[?1cd[15;2H[K[15;1H[?25h[?0c[?25l[?1c[15;1H[K[15;1H[?25h[?0c[?25l[?1c[This line should contain only the text between the brackets.][?25h[?0c[16;62H[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset display=[?25l[?1c[16;62H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[16;62H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"   Test for ^Y/^E due to bad w_virtcol value, reported by[?25l[?1c[16;62H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"   Roy <royl@netropolis.net>.[?25l[?1c[16;62H[?25h[?0c[?25l[?1c[16;24r[16;1H[L[1;25r[25;1H[K[16;1H[?25h[?0c   [?25l[?1cv[?25h[?0cv   [?25l[?1ci[?25h[?0ci   [?25l[?1cm   <-- should show the name of a noted text editor[?25h[?0c[17;62H[?25l[?1c[18;24r[18;1H[L[1;25r[18;1H[?25h[?0c    [?25l[?1c6[?25h[?0c6   [?25l[?1c.[?25h[?0c.   [?25l[?1c0   <-- and its version number[?25h[?0c[17;1H[?25l[?1c[17;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [17;5H[?25h[?0c
[0m    [?25l[?1c[25;1H:[?25h[?0c"[?25l[?1c[18;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test for yanking and pasting using the small delete register[?25l[?1c[18;5H[?25h[?0c[1;1H[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^foo[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[1;1H[?25h[?0c[?25l[?1c[0m, bar[1;6H[K[1;1H[?25h[?0c, [?25l[?1c[?25h[?0c[?25l[?1c[7mba[?25h[?0c[?25l[?1c[?25h[?0c[?25l[?1c[0mfoo[?25h[?0c
keyw[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwq! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 22 lines, 449 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test49.failed test.ok test.out X* viminfo
cp test49.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test49.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test49.in" 30 lines, 631 characters[1;1HThis is a test of the script language.

If after adding a new test, the test output doesn't appear properly in
test49.failed, try to add one or more "G"s at the line ending in "test.out"

STARTTEST
:so small.vim
:se nocp nomore viminfo+=nviminfo
:lang mess C
:so test49.vim
GGGGGGGGGGGGGG"rp:.-,$w! test.out
:"
:" make valgrind happy
:redir => funclist
:silent func
:redir END
:for line in split(funclist, "\n")
:  let name = matchstr(line, 'function \zs[A-Z]\w*\ze(')
:  if name != ''
:    exe "delfunc " . name
:  endif
:endfor
:for v in keys(g:)
:  silent! exe "unlet " . v[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HThis is a test of the script language.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[6;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 21 lines, 401 characters written[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[7;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[4M[1;25r[21;1H:endfor
:unlet v
:qa!
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cse nocp nomore viminfo+=nviminfo[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clang mess C[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso test49.vim[?25l[?1c[1m[37m[41mError detected while processing function G:[0m
[1m[33mline   16:[0m
[1m[37m[41mE171: Missing :endif:     endwhile[0m
*** Test   1: OK (34695)
   function F()
1      Xpath 1[37C" X: 1
2      let first = 1
3      XloopINIT 2 8
4      while 1
5[10CXloop 1[33C" X: 2      + 0 * 16
6[10Cif first
7[14CXloop 2[29C" X: 4      + 0 * 32
8[14Clet first = 0
9[14CXloopNEXT
10[13Cbreak
11[9Celse
12[13CXloop 4[29C" X: 0      + 0 * 64
13[13Creturn
14[9Cendif
15     endwhile
   endfunction[9;1H"/tmp/vu9KdKF/0"[10;1H[K[11;1H[K[12;1H[K[13;1H[K[14;1H[K[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;1H[K[23;1H[K[24;1H[K[25;4H[K[9;18H[noeol] 18L, 528C
15 substitutions on 15 lines
Pattern not found: ^\s*$"/tmp/vu9KdKF/0" [11;18H[K[11;18H15L, 476C written"test49.in" [11;13H[K[11;13H30L, 631C
   function G()
1      Xpath 256[35C" X: 256    + 0 * 2048
2      let first = 1
3      XloopINIT 512 8
4      while 1
5[10CXloop 1[33C" X: 512    + 0 * 4096
6[10Cif first
7[14CXloop 2[29C" X: 1024   + 0 * 8192
8[14Clet first = 0
9[14CXloopNEXT
10[13Cbreak
11[9Celse
12[13CXloop 4[29C" X: 0      + 0 * 16384
13[13Creturn
14[9Cendif
15[9Cif 1    " unmatched :if
16     endwhile
   endfunction[8;1H"/tmp/vu9KdKF/1"[9;1H[K[10;1H[K[11;1H[K[12;1H[K[13;1H[K[14;1H[K[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;1H[K[23;1H[K[24;1H[K[25;4H[K[8;18H[noeol] 19L, 588C
16 substitutions on 16 lines
Pattern not found: ^\s*$"/tmp/vu9KdKF/1" [10;18H[K[10;18H16L, 534C written"test49.in" [10;13H[K[10;13H30L, 631C
[1m[37m[41mError detected while processing /tmp/vu9KdKF/1:[0m
[1m[33mline   16:[0m
[1m[37m[41mE171: Missing :endif:      endwhile[0m
*** Test   2: OK (34695)
*** Test   3: OK (1384648195)
*** Test   4: OK (32883)
   function F()
1      if 1
2[10CXpath 1[33C" X: 1
3[10Clet loops = 3
4[10CXloopINIT 2 16
5[10Cwhile loops > 0[25C"    3:  2:     1:
6[14CXloop 1[29C" X: 2 + 2*16 + 0*16*16
7[14Cif (loops == 2)
8[18CXloop 2[25C" X:     4*16
9[18Creturn
10[17CXloop 4[25C" X:     0
11[13Cendif
12[13CXloop 8[29C" X: 16
13[13Clet loops = loops - 1
14[13CXloopNEXT
15[9Cendwhile
16[9CXpath 8192[30C" X: 0
17     else
18[9CXpath 16384[29C" X: 0
19     endif
   endfunction[5;1H"/tmp/vu9KdKF/2"[6;1H[K[7;1H[K[8;1H[K[9;1H[K[10;1H[K[11;1H[K[12;1H[K[13;1H[K[14;1H[K[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;1H[K[23;1H[K[24;1H[K[25;4H[K[5;18H[noeol] 22L, 784C
19 substitutions on 19 lines
Pattern not found: ^\s*$"/tmp/vu9KdKF/2" [7;18H[K[7;18H19L, 724C written"test49.in" [7;13H[K[7;13H30L, 631C
*** Test   5: OK (32883)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"/tmp/vu9KdKF/3" [8;18H[K[8;18H[New] 53L, 1582C written[8;18H[K[8;18H14L, 358C appended[8;18H[K[8;18H26L, 824C appended[8;18H[K[8;18H34L, 986C appended
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/4[?25h[?0c[10;1H[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/4" [25;18H[K[25;18H130L, 2431C appended[25;18H[K[25;18H131L, 2453C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/5[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/5"' -S /tmp/vu9KdK
[24;80HF[25;1H/4[?25h[?0c[25;1H
[?25l[?1c[25;1H"/tmp/vu9KdKF/5" 21L, 130C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test   6: OK (603978947)
[1m[37m[41mError detected while processing /sources/vim74/src/testdir/test49.vim:[0m
[1m[33mline  976:[0m
[1m[37m[41mE492: Not an editor command: ^Iasdf[0m
[1m[33mline  988:[0m
[1m[37m[41mE492: Not an editor command: ^Iasdf[0m
[1m[33mline  996:[0m
[1m[37m[41mE492: Not an editor command: asdf[0m
[1m[33mline  999:[0m
[1m[37m[41mE492: Not an editor command: asdf | Xpath 32768^I^I^I^I" X: 0[0m
*** Test   7: OK (90563)
[1m[37m[41mError detected while processing function F:[0m
[1m[33mline    5:[0m
[1m[37m[41mE492: Not an editor command: ^I    asdf[0m
[1m[33mline    7:[0m
[1m[37m[41mE492: Not an editor command: ^I    asdf | Xpath 8^I^I^I" X: 0[0m
[1m[33mline   19:[0m
[1m[37m[41mE492: Not an editor command: ^I    asdf[0m
[1m[33mline   21:[0m
[1m[37m[41mE492: Not an editor command: ^I    asdf | Xpath 2048^I^I^I" X: 0[0m
[1m[33mline   29:[0m
[1m[37m[41mE121: Undefined variable: novar[0m
[1m[37m[41mE15: Invalid expression: novar^I^I" returns (default return value 0)[0m
[1m[37m[41mError detected while processing function G:[0m
[1m[33mline    5:[0m
[1m[37m[41mE492: Not an editor command: ^I    asdf^I^I" returns -1[0m
[1m[37m[41mError detected while processing function H:[0m
[1m[33mline    5:[0m
[1m[37m[41mE492: Not an editor command: ^I    asdf^I^I" returns -1[0m
*** Test   8: OK (562493431)
[1m[37m[41mError detected while processing function F..G..H..I:[0m
[1m[33mline    2:[0m
[1m[37m[41mE492: Not an editor command:     asdf^I^I" error[0m
*** Test   9: OK (363)
[1m[37m[41mError detected while processing /sources/vim74/src/testdir/test49.vim:[0m
[1m[33mline 1201:[0m
[1m[37m[41mE15: Invalid expression: | strlen("\"") | Xpath 512^I^I" X: 0[0m
[1m[37m[41mE15: Invalid expression: 1 ||| strlen("\"") | Xpath 512^I^I" X: 0[0m
[1m[33mline 1211:[0m
[1m[37m[41mE15: Invalid expression: | strlen("\"") | Xpath 8192^I^I" X: 0[0m
[1m[37m[41mE15: Invalid expression: 1 ||| strlen("\"") | Xpath 8192^I^I" X: 0[0m
[1m[33mline 1220:[0m
[1m[37m[41mE15: Invalid expression: | strlen("\"") | Xpath 131072^I^I" X: 0[0m
[1m[37m[41mE15: Invalid expression: 1 ||| strlen("\"") | Xpath 131072^I^I" X: 0[0m
*** Test  10: OK (559615)
[1m[33mline 1252:[0m
[1m[37m[41mE492: Not an editor command:     asdf^I^I" error[0m
*** Test  11: OK (2049)
1
[1m[33mline 1330:[0m
[1m[37m[41mE492: Not an editor command:     asdf^I^I" error[0m
[1m[33mline 1338:[0m
[1m[37m[41mE492: Not an editor command:     asdf^I^I" error[0m
*** Test  12: OK (352256)
[1m[33mline 1357:[0m
[1m[37m[41mE121: Undefined variable: asdf[0m
[1m[37m[41mE15: Invalid expression: asdf[0m
[1m[33mline 1368:[0m
[1m[37m[41mE121: Undefined variable: asdf[0m
[1m[37m[41mE15: Invalid expression: asdf | Xpath 32 | endwhile | Xpath 64^I" X: 0[0m
*** Test  13: OK (145)
[1m[37m[41mError detected while processing function F:[0m
[1m[33mline    8:[0m
[1m[37m[41mE121: Undefined variable: g:boolvar[0m
[1m[37m[41mE15: Invalid expression: g:boolvar^I" possibly undefined[0m
*** Test  14: OK (42413)
[1m[37m[41mE121: Undefined variable: g:boolvar[0m
[1m[37m[41mE15: Invalid expression: g:boolvar | Xloop 8 | else | Xloop 16 | endif    " X: [0m
[24;80H[1m[37m[41m8[0m[25;1H
*** Test  15: OK (42413)
[1m[33mline    5:[0m
[1m[37m[41mE583: multiple :else:     else^I^I[0m
[1m[37m[41mError detected while processing function G:[0m
[1m[33mline    5:[0m
[1m[37m[41mE584: :elseif after :else:     elseif 1^I^I" aborts function[0m
[1m[37m[41mError detected while processing function H:[0m
[1m[33mline    7:[0m
[1m[37m[41mE583: multiple :else:     else^I^I[0m
[1m[37m[41mError detected while processing function I:[0m
[1m[33mline    7:[0m
[1m[37m[41mE584: :elseif after :else:     elseif 1^I^I" aborts function[0m
*** Test  16: OK (8722)
[1m[37m[41mError detected while processing function F:[0m
[1m[33mline   18:[0m
[1m[37m[41mE171: Missing :endif:     endwhile^I[0m
[1m[37m[41mE171: Missing :endif:     endwhile^I[0m
[1m[33mline   34:[0m
[1m[37m[41mE171: Missing :endif:     endwhile^I[0m
[1m[37m[41mE171: Missing :endif:     endwhile^I[0m
[1m[37m[41mE171: Missing :endif:     endwhile^I[0m
[1m[33mline   47:[0m
[1m[37m[41mE580: :endif without :if: ^Iendif^I[0m
[1m[37m[41mE580: :endif without :if: ^Iendif^I[0m
[1m[37m[41mE580: :endif without :if: ^Iendif^I[0m
[1m[37m[41mError detected while processing /sources/vim74/src/testdir/test49.vim:[0m
[1m[33mline 1626:[0m
[1m[37m[41mE171: Missing :endif: endwhile [0m
*** Test  17: OK (285127993)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/6[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/6" [25;18H[K[25;18H16L, 304C appended[25;18H[K[25;18H17L, 326C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/7[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/7"' -c 'breakad
[24;80Hd[25;2Hfile 8 /tmp/vu9KdKF/6' -S /tmp/vu9KdKF/6[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/7" 3L, 6C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/8[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/8" [25;18H[K[25;18H6L, 127C appended[25;18H[K[25;18H7L, 149C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/9[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/9"' -c 'breakad
[24;80Hd[25;2Hfile 4 /tmp/vu9KdKF/8' -S /tmp/vu9KdKF/8[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/9" 1L, 5C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/10[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/10" [25;19H[K[25;19H21L, 486C appended[25;19H[K[25;19H22L, 508C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/11[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/11"' -c 'breaka
[24;80Hd[25;1Hd func 7 F' -S /tmp/vu9KdKF/10[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/11" 3L, 18C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/12[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/12" [25;19H[K[25;19H13L, 364C appended[25;19H[K[25;19H14L, 386C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/13[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/13"' -c 'breaka
[24;80Hd[25;1Hd func 3 G' -S /tmp/vu9KdKF/12[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/13" 1L, 9C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  18: OK (67224583)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/14[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/14" [25;19H[K[25;19H12L, 201C appended[25;19H[K[25;19H13L, 223C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/15[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/15"' -S /tmp/vu9Kd
[24;80HK[25;1HF/14[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/15" 2L, 4C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/16[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/16" [25;19H[K[25;19H12L, 205C appended[25;19H[K[25;19H13L, 227C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/17[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/17"' -S /tmp/vu9Kd
[24;80HK[25;1HF/16[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/17" 2L, 7C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/18[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/18" [25;19H[K[25;19H6L, 122C appended[25;19H[K[25;19H7L, 144C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/19[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/19"' -S /tmp/vu9Kd
[24;80HK[25;1HF/18[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/19" 1L, 5C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/20[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/20" [25;19H[K[25;19H8L, 176C appended[25;19H[K[25;19H9L, 198C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/21[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/21"' -S /tmp/vu9Kd
[24;80HK[25;1HF/20[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/21" 1L, 6C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/22[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/22" [25;19H[K[25;19H10L, 215C appended[25;19H[K[25;19H11L, 237C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/23[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/23"' -S /tmp/vu9Kd
[24;80HK[25;1HF/22[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/23" 1L, 8C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/24[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/24" [25;19H[K[25;19H7L, 149C appended[25;19H[K[25;19H8L, 171C[25;19H[K[25;19H8L, 170C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/25[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/25"' -S /tmp/vu9Kd
[24;80HK[25;1HF/24[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/25" 1L, 9C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  19: OK (69275973)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/26[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/26" [25;19H[K[25;19H9L, 135C appended[25;19H[K[25;19H10L, 157C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/27[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/27"' -S /tmp/vu9Kd
[24;80HK[25;1HF/26[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/27" 2L, 4C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/28[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/28" [25;19H[K[25;19H10L, 155C appended[25;19H[K[25;19H11L, 177C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/29[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/29"' -S /tmp/vu9Kd
[24;80HK[25;1HF/28[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/29" 3L, 8C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/30[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/30" [25;19H[K[25;19H12L, 204C appended[25;19H[K[25;19H13L, 226C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/31[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/31"' -S /tmp/vu9Kd
[24;80HK[25;1HF/30[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/31" 4L, 18C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/32[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/32" [25;19H[K[25;19H12L, 214C appended[25;19H[K[25;19H13L, 236C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/33[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/33"' -S /tmp/vu9Kd
[24;80HK[25;1HF/32[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/33" 4L, 22C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/34[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/34" [25;19H[K[25;19H12L, 211C appended[25;19H[K[25;19H13L, 233C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/35[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/35"' -S /tmp/vu9Kd
[24;80HK[25;1HF/34[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/35" 3L, 22C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/36[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/36" [25;19H[K[25;19H14L, 263C appended[25;19H[K[25;19H15L, 285C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/37[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/37"' -S /tmp/vu9Kd
[24;80HK[25;1HF/36[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/37" 4L, 34C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/38[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/38" [25;19H[K[25;19H14L, 277C appended[25;19H[K[25;19H15L, 299C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/39[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/39"' -S /tmp/vu9Kd
[24;80HK[25;1HF/38[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/39" 4L, 40C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  20: OK (1874575085)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/40[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/40" [25;19H[K[25;19H58L, 1022C appended[25;19H[K[25;19H59L, 1044C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/41[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/41"' -S /tmp/vu9Kd
[24;80HK[25;1HF/40[?25h[?0c[25;1H
[?25l[?1c[25;1H"/tmp/vu9KdKF/41" 9L, 56C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  21: OK (147932225)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/42[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/42" [25;19H[K[25;19H23L, 418C appended[25;19H[K[25;19H24L, 440C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/43[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/43"' -S /tmp/vu9Kd
[24;80HK[25;1HF/42[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/43" 1L, 2C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/44[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/44" [25;19H[K[25;19H23L, 437C appended[25;19H[K[25;19H24L, 459C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/45[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/45"' -c 'breaka
[24;80Hd[25;1Hd func 2 Interrupt' -S /tmp/vu9KdKF/44[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/45" 1L, 3C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/46[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/46" [25;19H[K[25;19H21L, 386C appended[25;19H[K[25;19H22L, 408C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/47[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/47"' -S /tmp/vu9Kd
[24;80HK[25;1HF/46[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/47" 1L, 5C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  22: OK (4161)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/48[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/48" [25;19H[K[25;19H25L, 432C appended[25;19H[K[25;19H26L, 454C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/49[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/49"' -S /tmp/vu9Kd
[24;80HK[25;1HF/48[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/49" 3L, 8C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  23: OK (49)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/50[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/50" [25;19H[K[25;19H16L, 392C appended[25;19H[K[25;19H17L, 414C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/51[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/51"' -S /tmp/vu9Kd
[24;80HK[25;1HF/50[?25h[?0c[25;1H
[?25l[?1c[25;1H"/tmp/vu9KdKF/51" 3L, 7C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  24: OK (41)
*** Test  25: OK (260177811)
*** Test  26: OK (1681500476)
*** Test  27: OK (1996459)
   function F()
1      try
2[10CXpath 1[33C" X: 1
3[10Ctry
4[14CXpath 2[29C" X: 2
5[14Creturn
6[14CXpath 4[29C" X: 0
7[10Cfinally
8[14CXpath 8[29C" X: 8
9[10Cendtry
10[9CXpath 16[32C" X: 0
11     finally
12[9CXpath 32[32C" X: 32
13     endtry
14     Xpath 64[36C" X: 0
   endfunction[10;1H"/tmp/vu9KdKF/52"[11;1H[K[12;1H[K[13;1H[K[14;1H[K[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;1H[K[23;1H[K[24;1H[K[25;4H[K[10;19H[noeol] 17L, 552C
14 substitutions on 14 lines
Pattern not found: ^\s*$"/tmp/vu9KdKF/52" [12;20H[K[12;19H14L, 502C written"test49.in" [12;13H[K[12;13H30L, 631C
   function G()
1      try
2[10CXpath 128[31C" X: 128
3[10Creturn
4[10CXpath 256[31C" X: 0
5      finally
6[10CXpath 512[31C" X: 512
7[10Ccall F()
8[10CXpath 1024[30C" X: 1024
9      endtry
10     Xpath 2048[34C" X: 0
   endfunction[13;1H"/tmp/vu9KdKF/53"[14;1H[K[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;1H[K[23;1H[K[24;4H[K[13;19H[noeol] 13L, 406C
10 substitutions on 10 lines
Pattern not found: ^\s*$"/tmp/vu9KdKF/53" [15;20H[K[15;19H10L, 378C written"test49.in" [15;13H[K[15;13H30L, 631C
   function H()
1      try
2[10CXpath 4096[30C" X: 4096
3[10Ccall G()
4[10CXpath 8192[30C" X: 8192
5      finally
6[10CXpath 16384[29C" X: 16384
7[10Creturn
8[10CXpath 32768[29C" X: 0
9      endtry
10     Xpath 65536[33C" X: 0
   endfunction[14;1H"/tmp/vu9KdKF/54"[15;1H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;1H[K[23;1H[K[24;1H[K[25;4H[K[14;19H[noeol] 13L, 409C
10 substitutions on 10 lines
Pattern not found: ^\s*$"/tmp/vu9KdKF/54" [16;20H[K[16;19H10L, 381C written"test49.in" [16;13H[K[16;13H30L, 631C
*** Test  28: OK (1996459)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/55[?25h[?0c[19;1H[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/55" [25;19H[K[25;19H39L, 721C appended[25;19H[K[25;19H40L, 743C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/56[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/56"' -S /tmp/vu9Kd
[24;80HK[25;1HF/55[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/56" 6L, 21C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/57[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/57" [25;19H[K[25;19H23L, 509C appended[25;19H[K[25;19H24L, 531C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/58[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/58"' -S /tmp/vu9Kd
[24;80HK[25;1HF/57[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/58" 4L, 34C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  29: OK (170428555)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/59[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/59" [25;19H[K[25;19H60L, 1101C appended[25;19H[K[25;19H61L, 1123C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/60[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nv
[24;80Hi[25;1Hminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/60"' -
[24;80Hc[25;2H'breakadd func 3 F' -c 'breakadd file 19 /tmp/vu9KdKF/59' -c 'breakadd file 31
/tmp/vu9KdKF/59' -S /tmp/vu9KdKF/59[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/60" 16L, 89C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  30: OK (190905173)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/61[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/61" [25;19H[K[25;19H60L, 1122C appended[25;19H[K[25;19H61L, 1144C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/62[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/62"' -S /tmp/vu9Kd
[24;80HK[25;1HF/61[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/62" 16L, 89C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  31: OK (190905173)
*** Test  32: OK (354833067)
*** Test  33: OK (1216907538)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/63[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/63" [25;19H[K[25;19H63L, 1288C appended[25;19H[K[25;19H64L, 1310C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/64[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set vi
[24;80Hm[25;1Hinfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9Kd
[24;80HK[25;1HF/64"' -c 'breakadd func 16 C' -S /tmp/vu9KdKF/63[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/64" 17L, 127C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  34: OK (2146584868)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/65[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/65" [25;19H[K[25;19H63L, 1285C appended[25;19H[K[25;19H64L, 1307C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/66[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set vi
[24;80Hm[25;1Hinfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9Kd
[24;80HK[25;1HF/66"' -c 'breakadd func 16 B' -S /tmp/vu9KdKF/65[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/66" 17L, 127C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  35: OK (2146584868)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/67[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/67" [25;19H[K[25;19H66L, 1430C appended[25;19H[K[25;19H67L, 1452C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/68[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set vimin
[24;80Hf[25;1Ho+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/
[24;80H6[25;1H8"' -c 'breakadd func 16 R' -S /tmp/vu9KdKF/67[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/68" 9L, 81C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  36: OK (1071644672)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/69[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/69" [25;19H[K[25;19H73L, 1488C appended[25;19H[K[25;19H74L, 1510C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/70[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/70"' -c 'breakadd
[24;80Hf[25;1Hunc 16 F' -S /tmp/vu9KdKF/69[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/70" 9L, 81C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  37: OK (1071644672)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/71[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/71" [25;19H[K[25;19H82L, 1519C appended[25;19H[K[25;19H83L, 1541C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/72[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set vi
[24;80Hm[25;1Hinfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9Kd
[24;80HK[25;1HF/72"' -c 'breakadd func 16 E' -S /tmp/vu9KdKF/71[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/72" 8L, 63C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  38: OK (357908480)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/73[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/73" [25;19H[K[25;19H83L, 1538C appended[25;19H[K[25;19H84L, 1560C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/74[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -
[24;80Hc[25;2H'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVi
[24;80Hm[25;1HResult = "/tmp/vu9KdKF/74"' -c 'breakadd func 16 I' -c 'breakadd func 22 I' -S
[24;80H/[25;1Htmp/vu9KdKF/73[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/74" 8L, 63C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  39: OK (357908480)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/75[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/75" [25;19H[K[25;19H82L, 1519C appended[25;19H[K[25;19H83L, 1541C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/76[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set vi
[24;80Hm[25;1Hinfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9Kd
[24;80HK[25;1HF/76"' -c 'breakadd func 16 T' -S /tmp/vu9KdKF/75[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/76" 8L, 63C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  40: OK (357908480)
*** Test  41: OK (3076095)
*** Test  42: OK (1505155949)
*** Test  43: OK (1157763329)
*** Test  44: OK (1031761407)
*** Test  45: OK (1157763329)
*** Test  46: OK (739407)
*** Test  47: OK (371213935)
*** Test  48: OK (756255461)
*** Test  49: OK (179000669)
   function C()
1      try
2[10CXpath 1[33C" X: 1
3[10Cthrow "arrgh"
4[10CXpath 2[33C" X: 0
5      catch /arrgh/
6[10CXpath 4[33C" X: 4
7      endtry
8      Xpath 8[37C" X: 8
   endfunction[16;1H"/tmp/vu9KdKF/77"[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;1H[K[23;1H[K[24;1H[K[25;4H[K[16;19H[noeol] 11L, 334C
8 substitutions on 8 lines
Pattern not found: ^\s*$"/tmp/vu9KdKF/77" [18;20H[K[18;19H8L, 295C written"test49.in" [18;13H[K[18;13H30L, 631C
   function T1()
1      XloopNEXT
2      try
3[10CXloop 1[33C" X: 16 + 16*16
4[10Cthrow "arrgh"
5[10CXloop 2[33C" X: 0
6      finally
7[10CXloop 4[33C" X: 64 + 64*16
8      endtry
9      Xloop 8[37C" X: 0
   endfunction[15;1H"/tmp/vu9KdKF/78"[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;1H[K[23;1H[K[24;1H[K[25;4H[K[15;19H[noeol] 12L, 364C
9 substitutions on 9 lines
Pattern not found: ^\s*$"/tmp/vu9KdKF/78" [17;20H[K[17;19H9L, 323C written"test49.in" [17;13H[K[17;13H30L, 631C
   function T2()
1      try
2[10CXpath 4096[30C" X: 4096
3[10Ccall T1()
4[10CXpath 8192[30C" X: 0
5      finally
6[10CXpath 16384[29C" X: 16384
7      endtry
8      Xpath 32768[33C" X: 0
   endfunction[16;1H"/tmp/vu9KdKF/79"[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;1H[K[23;1H[K[24;1H[K[25;4H[K[16;19H[noeol] 11L, 332C
8 substitutions on 8 lines
Pattern not found: ^\s*$"/tmp/vu9KdKF/79" [18;20H[K[18;19H8L, 305C written"test49.in" [18;13H[K[18;13H30L, 631C
*** Test  50: OK (363550045)
*** Test  51: OK (40744667)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/81[?25h[?0c[22;1H[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/81" [25;19H[K[25;19H2L, 41C appended[25;19H[K[25;19H3L, 63C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/82[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/80' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/82"' -S /tmp/vu9KdKF/81[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/82" 1L, 2C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/80" [25;19H[K[25;19H8L, 182C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/83[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/83" [25;19H[K[25;19H7L, 115C appended[25;19H[K[25;19H8L, 137C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/84[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/80' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/84"' -S /tmp/vu9KdKF/83[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/84" 1L, 2C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/80" [25;19H[K[25;19H8L, 181C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/85[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/85" [25;19H[K[25;19H12L, 180C appended[25;19H[K[25;19H13L, 202C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/86[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/80' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/86"' -S /tmp/vu9KdKF/85[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/86" 2L, 8C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/80" [25;19H[K[25;19H10L, 209C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/87[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/87" [25;19H[K[25;19H8L, 139C appended[25;19H[K[25;19H9L, 161C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/88[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/80' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/88"' -S /tmp/vu9KdKF/87[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/88" 2L, 11C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/80" [25;19H[K[25;19H10L, 217C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/89[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/89" [25;19H[K[25;19H5L, 87C appended[25;19H[K[25;19H6L, 109C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/90[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir!
[24;80H>[25;1H/tmp/vu9KdKF/80' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin =
1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/90"' -c 'breakadd file 4 /tmp/vu9KdKF
[24;80H/[25;1H89' -S /tmp/vu9KdKF/89[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/90" 1L, 7C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/80" [25;19H[K[25;19H[noeol] 9L, 202C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/91[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/91" [25;19H[K[25;19H7L, 189C appended[25;19H[K[25;19H8L, 211C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/92[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/80' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/92"' -S /tmp/vu9KdKF/91[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/92" 1L, 8C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/80" [25;19H[K[25;19H9L, 252C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/93[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/93" [25;19H[K[25;19H7L, 199C appended[25;19H[K[25;19H8L, 221C[25;19H[K[25;19H8L, 220C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/94[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/80' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/94"' -S /tmp/vu9KdKF/93[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/94" 1L, 10C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/80" [25;19H[K[25;19H9L, 214C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  52: OK (1247112011)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/96[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/96" [25;19H[K[25;19H1L, 10C appended[25;19H[K[25;19H2L, 32C[25;19H[K[25;19H2L, 31C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/97[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/97"' -S /tmp/vu9KdKF/96[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/97" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/95" [25;19H[K[25;19H6L, 154C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/98[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/98" [25;19H[K[25;19H3L, 39C appended[25;19H[K[25;19H4L, 61C
3 substitutions on 3 lines"/tmp/vu9KdKF/98" [25;20H[K[25;19H4L, 58C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/99[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/99"' -S /tmp/vu9KdKF/98[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/99" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/95" [25;19H[K[25;19H6L, 158C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/100[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/100" [25;20H[K[25;20H4L, 45C appended[25;20H[K[25;20H5L, 67C
4 substitutions on 4 lines"/tmp/vu9KdKF/100"[25;20H[K[25;20H5L, 63C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/101[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/101"' -S /tmp/vu9KdKF/100[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/101" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/95" [25;19H[K[25;19H6L, 159C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/102[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/102" [25;20H[K[25;20H3L, 33C appended[25;20H[K[25;20H4L, 55C
3 substitutions on 3 lines"/tmp/vu9KdKF/102"[25;20H[K[25;20H4L, 52C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/103[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/103"' -S /tmp/vu9KdKF/102[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/103" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/95" [25;19H[K[25;19H6L, 159C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/104[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/104" [25;20H[K[25;20H5L, 65C appended[25;20H[K[25;20H6L, 87C
5 substitutions on 5 lines"/tmp/vu9KdKF/104"[25;20H[K[25;20H6L, 82C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/105[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/105"' -S /tmp/vu9KdKF/104[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/105" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/95" [25;19H[K[25;19H6L, 159C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/106[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/106" [25;20H[K[25;20H1L, 9C appended[25;20H[K[25;20H2L, 31C[25;20H[K[25;20H2L, 30C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/107[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/107"' -S /tmp/vu9KdKF/106[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/107" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/95" [25;19H[K[25;19H6L, 153C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/108[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/108" [25;20H[K[25;20H3L, 38C appended[25;20H[K[25;20H4L, 60C
3 substitutions on 3 lines"/tmp/vu9KdKF/108"[25;20H[K[25;20H4L, 57C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/109[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/109"' -S /tmp/vu9KdKF/108[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/109" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/95" [25;19H[K[25;19H6L, 157C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/110[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/110" [25;20H[K[25;20H4L, 44C appended[25;20H[K[25;20H5L, 66C
4 substitutions on 4 lines"/tmp/vu9KdKF/110"[25;20H[K[25;20H5L, 62C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/111[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/111"' -S /tmp/vu9KdKF/110[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/111" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/95" [25;19H[K[25;19H6L, 157C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/112[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/112" [25;20H[K[25;20H3L, 32C appended[25;20H[K[25;20H4L, 54C
3 substitutions on 3 lines"/tmp/vu9KdKF/112"[25;20H[K[25;20H4L, 51C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/113[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/113"' -S /tmp/vu9KdKF/112[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/113" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/95" [25;19H[K[25;19H6L, 157C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/114[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/114" [25;20H[K[25;20H5L, 64C appended[25;20H[K[25;20H6L, 86C
5 substitutions on 5 lines"/tmp/vu9KdKF/114"[25;20H[K[25;20H6L, 81C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/115[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/115"' -S /tmp/vu9KdKF/114[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/115" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/95" [25;19H[K[25;19H6L, 157C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/116[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/116" [25;20H[K[25;20H1L, 11C appended[25;20H[K[25;20H2L, 33C[25;20H[K[25;20H2L, 32C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/117[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/117"' -S /tmp/vu9KdKF/116[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/117" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/95" [25;19H[K[25;19H6L, 157C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/118[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/118" [25;20H[K[25;20H3L, 40C appended[25;20H[K[25;20H4L, 62C
3 substitutions on 3 lines"/tmp/vu9KdKF/118"[25;20H[K[25;20H4L, 59C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/119[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/119"' -S /tmp/vu9KdKF/118[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/119" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/95" [25;19H[K[25;19H6L, 161C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/120[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/120" [25;20H[K[25;20H4L, 46C appended[25;20H[K[25;20H5L, 68C
4 substitutions on 4 lines"/tmp/vu9KdKF/120"[25;20H[K[25;20H5L, 64C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/121[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/121"' -S /tmp/vu9KdKF/120[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/121" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/95" [25;19H[K[25;19H6L, 161C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/122[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/122" [25;20H[K[25;20H3L, 34C appended[25;20H[K[25;20H4L, 56C
3 substitutions on 3 lines"/tmp/vu9KdKF/122"[25;20H[K[25;20H4L, 53C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/123[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/123"' -S /tmp/vu9KdKF/122[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/123" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/95" [25;19H[K[25;19H6L, 161C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/124[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/124" [25;20H[K[25;20H5L, 66C appended[25;20H[K[25;20H6L, 88C
5 substitutions on 5 lines"/tmp/vu9KdKF/124"[25;20H[K[25;20H6L, 83C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/125[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/125"' -S /tmp/vu9KdKF/124[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/125" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/95" [25;19H[K[25;19H6L, 161C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/126[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/126" [25;20H[K[25;20H4L, 37C appended[25;20H[K[25;20H5L, 59C
4 substitutions on 4 lines"/tmp/vu9KdKF/126"[25;20H[K[25;20H5L, 55C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/127[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/127"' -S /tmp/vu9KdKF/126[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/127" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/95" [25;19H[K[25;19H6L, 150C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/128[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/128" [25;20H[K[25;20H4L, 41C appended[25;20H[K[25;20H5L, 63C
4 substitutions on 4 lines"/tmp/vu9KdKF/128"[25;20H[K[25;20H5L, 59C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/129[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/95' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1'
-c 'let ExtraVimResult = "/tmp/vu9KdKF/129"' -S /tmp/vu9KdKF/128[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/129" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/95" [25;19H[K[25;19H6L, 159C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  53: OK (131071)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/131[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/131" [25;20H[K[25;20H1L, 13C appended[25;20H[K[25;20H2L, 35C[25;20H[K[25;20H2L, 34C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/132[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/132"' -S /tmp/vu9KdKF/131[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/132" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/130" [25;20H[K[25;20H6L, 164C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/133[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/133" [25;20H[K[25;20H3L, 36C appended[25;20H[K[25;20H4L, 58C
3 substitutions on 3 lines"/tmp/vu9KdKF/133"[25;20H[K[25;20H4L, 55C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/134[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/134"' -S /tmp/vu9KdKF/133[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/134" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/130" [25;20H[K[25;20H6L, 168C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/135[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/135" [25;20H[K[25;20H3L, 38C appended[25;20H[K[25;20H4L, 60C
3 substitutions on 3 lines"/tmp/vu9KdKF/135"[25;20H[K[25;20H4L, 57C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/136[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/136"' -S /tmp/vu9KdKF/135[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/136" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/130" [25;20H[K[25;20H6L, 154C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/137[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/137" [25;20H[K[25;20H4L, 48C appended[25;20H[K[25;20H5L, 70C
4 substitutions on 4 lines"/tmp/vu9KdKF/137"[25;20H[K[25;20H5L, 66C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/138[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/138"' -S /tmp/vu9KdKF/137[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/138" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/130" [25;20H[K[25;20H6L, 168C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/139[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/139" [25;20H[K[25;20H4L, 53C appended[25;20H[K[25;20H5L, 75C
4 substitutions on 4 lines"/tmp/vu9KdKF/139"[25;20H[K[25;20H5L, 71C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/140[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/140"' -S /tmp/vu9KdKF/139[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/140" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/130" [25;20H[K[25;20H6L, 155C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/141[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/141" [25;20H[K[25;20H5L, 62C appended[25;20H[K[25;20H6L, 84C
5 substitutions on 5 lines"/tmp/vu9KdKF/141"[25;20H[K[25;20H6L, 79C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/142[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/142"' -S /tmp/vu9KdKF/141[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/142" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/130" [25;20H[K[25;20H6L, 155C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/143[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/143" [25;20H[K[25;20H5L, 64C appended[25;20H[K[25;20H6L, 86C
5 substitutions on 5 lines"/tmp/vu9KdKF/143"[25;20H[K[25;20H6L, 81C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/144[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/144"' -S /tmp/vu9KdKF/143[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/144" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/130" [25;20H[K[25;20H6L, 154C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/145[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/145" [25;20H[K[25;20H3L, 36C appended[25;20H[K[25;20H4L, 58C
3 substitutions on 3 lines"/tmp/vu9KdKF/145"[25;20H[K[25;20H4L, 55C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/146[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/146"' -S /tmp/vu9KdKF/145[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/146" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/130" [25;20H[K[25;20H6L, 168C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/147[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/147" [25;20H[K[25;20H5L, 67C appended[25;20H[K[25;20H6L, 89C
5 substitutions on 5 lines"/tmp/vu9KdKF/147"[25;20H[K[25;20H6L, 84C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/148[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/148"' -S /tmp/vu9KdKF/147[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/148" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/130" [25;20H[K[25;20H6L, 167C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/149[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/149" [25;20H[K[25;20H5L, 68C appended[25;20H[K[25;20H6L, 90C
5 substitutions on 5 lines"/tmp/vu9KdKF/149"[25;20H[K[25;20H6L, 85C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/150[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/150"' -S /tmp/vu9KdKF/149[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/150" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/130" [25;20H[K[25;20H6L, 168C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/151[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/151" [25;20H[K[25;20H7L, 95C appended[25;20H[K[25;20H8L, 117C
7 substitutions on 7 lines"/tmp/vu9KdKF/151"[25;20H[K[25;20H8L, 110C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/152[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/130' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/152"' -S /tmp/vu9KdKF/151[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/152" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/130" [25;20H[K[25;20H6L, 167C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  54: OK (2047)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/154[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/154" [25;20H[K[25;20H1L, 13C appended[25;20H[K[25;20H2L, 35C[25;20H[K[25;20H2L, 34C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/155[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/155"' -S /tmp/vu9KdKF/154[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/155" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/153" [25;20H[K[25;20H6L, 172C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/156[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/156" [25;20H[K[25;20H3L, 36C appended[25;20H[K[25;20H4L, 58C
3 substitutions on 3 lines"/tmp/vu9KdKF/156"[25;20H[K[25;20H4L, 55C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/157[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/157"' -S /tmp/vu9KdKF/156[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/157" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/153" [25;20H[K[25;20H6L, 176C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/158[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/158" [25;20H[K[25;20H4L, 48C appended[25;20H[K[25;20H5L, 70C
4 substitutions on 4 lines"/tmp/vu9KdKF/158"[25;20H[K[25;20H5L, 66C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/159[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/159"' -S /tmp/vu9KdKF/158[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/159" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/153" [25;20H[K[25;20H6L, 176C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/160[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/160" [25;20H[K[25;20H3L, 36C appended[25;20H[K[25;20H4L, 58C
3 substitutions on 3 lines"/tmp/vu9KdKF/160"[25;20H[K[25;20H4L, 55C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/161[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/161"' -S /tmp/vu9KdKF/160[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/161" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/153" [25;20H[K[25;20H6L, 176C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/162[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/162" [25;20H[K[25;20H5L, 68C appended[25;20H[K[25;20H6L, 90C
5 substitutions on 5 lines"/tmp/vu9KdKF/162"[25;20H[K[25;20H6L, 85C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/163[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/163"' -S /tmp/vu9KdKF/162[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/163" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/153" [25;20H[K[25;20H6L, 176C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/164[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/164" [25;20H[K[25;20H1L, 10C appended[25;20H[K[25;20H2L, 32C[25;20H[K[25;20H2L, 31C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/165[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/165"' -S /tmp/vu9KdKF/164[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/165" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/153" [25;20H[K[25;20H6L, 166C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/166[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/166" [25;20H[K[25;20H3L, 33C appended[25;20H[K[25;20H4L, 55C
3 substitutions on 3 lines"/tmp/vu9KdKF/166"[25;20H[K[25;20H4L, 52C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/167[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/167"' -S /tmp/vu9KdKF/166[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/167" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/153" [25;20H[K[25;20H6L, 170C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/168[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/168" [25;20H[K[25;20H4L, 45C appended[25;20H[K[25;20H5L, 67C
4 substitutions on 4 lines"/tmp/vu9KdKF/168"[25;20H[K[25;20H5L, 63C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/169[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/169"' -S /tmp/vu9KdKF/168[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/169" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/153" [25;20H[K[25;20H6L, 170C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/170[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/170" [25;20H[K[25;20H3L, 33C appended[25;20H[K[25;20H4L, 55C
3 substitutions on 3 lines"/tmp/vu9KdKF/170"[25;20H[K[25;20H4L, 52C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/171[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/171"' -S /tmp/vu9KdKF/170[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/171" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/153" [25;20H[K[25;20H6L, 170C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/172[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/172" [25;20H[K[25;20H5L, 65C appended[25;20H[K[25;20H6L, 87C
5 substitutions on 5 lines"/tmp/vu9KdKF/172"[25;20H[K[25;20H6L, 82C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/173[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/153' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/173"' -S /tmp/vu9KdKF/172[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/173" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/153" [25;20H[K[25;20H6L, 170C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  55: OK (1023)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/175[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/175" [25;20H[K[25;20H1L, 11C appended[25;20H[K[25;20H2L, 33C[25;20H[K[25;20H2L, 32C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/176[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/176"' -S /tmp/vu9KdKF/175[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/176" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/174" [25;20H[K[25;20H6L, 158C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/177[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/177" [25;20H[K[25;20H3L, 34C appended[25;20H[K[25;20H4L, 56C
3 substitutions on 3 lines"/tmp/vu9KdKF/177"[25;20H[K[25;20H4L, 53C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/178[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/178"' -S /tmp/vu9KdKF/177[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/178" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/174" [25;20H[K[25;20H6L, 162C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/179[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/179" [25;20H[K[25;20H3L, 40C appended[25;20H[K[25;20H4L, 62C
3 substitutions on 3 lines"/tmp/vu9KdKF/179"[25;20H[K[25;20H4L, 59C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/180[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/180"' -S /tmp/vu9KdKF/179[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/180" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/174" [25;20H[K[25;20H6L, 162C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/181[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/181" [25;20H[K[25;20H3L, 32C appended[25;20H[K[25;20H4L, 54C
3 substitutions on 3 lines"/tmp/vu9KdKF/181"[25;20H[K[25;20H4L, 51C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/182[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/182"' -S /tmp/vu9KdKF/181[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/182" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/174" [25;20H[K[25;20H6L, 152C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/183[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/183" [25;20H[K[25;20H3L, 35C appended[25;20H[K[25;20H4L, 57C
3 substitutions on 3 lines"/tmp/vu9KdKF/183"[25;20H[K[25;20H4L, 54C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/184[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/184"' -S /tmp/vu9KdKF/183[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/184" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/174" [25;20H[K[25;20H6L, 155C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/185[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/185" [25;20H[K[25;20H4L, 44C appended[25;20H[K[25;20H5L, 66C
4 substitutions on 4 lines"/tmp/vu9KdKF/185"[25;20H[K[25;20H5L, 62C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/186[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/186"' -S /tmp/vu9KdKF/185[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/186" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/174" [25;20H[K[25;20H6L, 152C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/187[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/187" [25;20H[K[25;20H4L, 47C appended[25;20H[K[25;20H5L, 69C
4 substitutions on 4 lines"/tmp/vu9KdKF/187"[25;20H[K[25;20H5L, 65C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/188[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/188"' -S /tmp/vu9KdKF/187[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/188" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/174" [25;20H[K[25;20H6L, 155C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/189[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/189" [25;20H[K[25;20H5L, 64C appended[25;20H[K[25;20H6L, 86C
5 substitutions on 5 lines"/tmp/vu9KdKF/189"[25;20H[K[25;20H6L, 81C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/190[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/190"' -S /tmp/vu9KdKF/189[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/190" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/174" [25;20H[K[25;20H6L, 152C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/191[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/191" [25;20H[K[25;20H5L, 67C appended[25;20H[K[25;20H6L, 89C
5 substitutions on 5 lines"/tmp/vu9KdKF/191"[25;20H[K[25;20H6L, 84C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/192[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'au VimLeave * redir END' -c 'redir! >/t
[24;80Hm[25;1Hp/vu9KdKF/174' -c 'debuggreedy|set viminfo+=nviminfo' -c 'let ExtraVimBegin = 1
[24;80H'[25;2H-c 'let ExtraVimResult = "/tmp/vu9KdKF/192"' -S /tmp/vu9KdKF/191[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/192" 0L, 0C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/174" [25;20H[K[25;20H6L, 155C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  56: OK (511)
   function FuncException()
1      let g:exception = v:exception
   endfunction[23;1H"/tmp/vu9KdKF/193" [23;20H[K[24;1H[K[25;4H[K[23;20H[noeol] 4L, 80C
Pattern not found: ^\s*$"/tmp/vu9KdKF/193"[24;20H[K[24;20H1L, 36C written"test49.in" [24;13H[K[24;13H30L, 631C
   function FuncThrowpoint()
1      let g:throwpoint = v:throwpoint
   endfunction[23;1H"/tmp/vu9KdKF/194" [23;20H[K[24;1H[K[25;4H[K[23;20H[noeol] 4L, 83C
Pattern not found: ^\s*$"/tmp/vu9KdKF/194"[24;20H[K[24;20H1L, 38C written"test49.in" [24;13H[K[24;13H30L, 631C
   function T(arg, line)
1      if a:line == 2
2[10Cthrow a:arg[13C" in line 2
3      elseif a:line == 4
4[10Cthrow a:arg[13C" in line 4
5      elseif a:line == 6
6[10Cthrow a:arg[13C" in line 6
7      elseif a:line == 8
8[10Cthrow a:arg[13C" in line 8
9      endif
   endfunction[15;1H"/tmp/vu9KdKF/195"[15;20H[K[16;1H[K[17;1H[K[18;1H[K[19;1H[K[20;1H[K[21;1H[K[22;1H[K[23;1H[K[24;1H[K[25;4H[K[15;20H[noeol] 12L, 341C
9 substitutions on 9 lines
8 substitutions on 8 lines
Pattern not found: ^\s*$"/tmp/vu9KdKF/195"[18;20H[K[18;20H9L, 292C written"test49.in" [18;13H[K[18;13H30L, 631C
   function G(arg, line)
1      call T(a:arg, a:line)
   endfunction[19;1H"/tmp/vu9KdKF/196"[19;20H[K[20;1H[K[21;4H[K[19;20H[noeol] 4L, 69C
Pattern not found: ^\s*$"/tmp/vu9KdKF/196"[20;20H[K[20;20H1L, 30C written"test49.in" [20;13H[K[20;13H30L, 631C
   function F(arg, line)
1      call G(a:arg, a:line)
   endfunction[21;1H"/tmp/vu9KdKF/197"[21;20H[K[22;1H[K[23;4H[K[21;20H[noeol] 4L, 69C
Pattern not found: ^\s*$"/tmp/vu9KdKF/197"[22;20H[K[22;20H1L, 30C written"test49.in" [22;13H[K[22;13H30L, 631C
*** Test  57: OK (2147450880)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/198[?25h[?0c[25;1H[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/198" [25;20H[K[25;20H87L, 1700C appended[25;20H[K[25;20H88L, 1722C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/199[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/199"' -c 'break
[24;80Ha[25;1Hdd func 4 T' -S /tmp/vu9KdKF/198[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/199" 8L, 36C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  58: OK (624945)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/200[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/200" [25;20H[K[25;20H293L, 5789C appended[25;20H[K[25;20H294L, 5811C
3 substitutions on 3 lines"/tmp/vu9KdKF/200"[25;20H[K[25;20H294L, 5808C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/201[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo
[24;80H'[25;2H-c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/201"' -c 'br
[24;80He[25;1Hakadd file 115 /tmp/vu9KdKF/200' -c 'breakadd file 225 /tmp/vu9KdKF/200' -S /tm
[24;80Hp[25;1H/vu9KdKF/200[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/201" 28L, 162C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  59: OK (2038431743)"/n/o/n/w/r/i/t/a/b/l/e/_/f/i/l/e""/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/202[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/202" [25;20H[K[25;20H33L, 765C appended[25;20H[K[25;20H34L, 787C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/203[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/203"' -c 'break
[24;80Ha[25;1Hdd file 7 /tmp/vu9KdKF/202' -S /tmp/vu9KdKF/202[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/203" 3L, 27C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  60: OK (311511339)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/204[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/204" [25;20H[K[25;20H115L, 2272C appended[25;20H[K[25;20H116L, 2294C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/205[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set vimin
[24;80Hf[25;1Ho+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/
[24;80H2[25;1H05"' -c 'breakadd file 8 /tmp/vu9KdKF/204' -c 'breakadd file 36 /tmp/vu9KdKF/20
[24;80H4[25;1H' -c 'breakadd file 40 /tmp/vu9KdKF/204' -c 'breakadd file 69 /tmp/vu9KdKF/204'
-c 'breakadd file 95 /tmp/vu9KdKF/204' -c 'breakadd file 97 /tmp/vu9KdKF/204' -
[24;80HS[25;2H/tmp/vu9KdKF/204[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/205" 14L, 81C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  61: OK (374889517)
   function F()
1      while 1
2      " Missing :endwhile
   endfunction[22;1H"/tmp/vu9KdKF/206"[23;1H[K[24;1H[K[25;4H[K[22;20H[noeol] 5L, 73C
Pattern not found: ^\s*$"/tmp/vu9KdKF/206"[23;20H[K[23;20H2L, 40C written"test49.in" [23;13H[K[23;13H30L, 631C
*** Test  62: OK (286331153)"/i/m/p/o/s/s/i/b/l/e" [24;24H[K[25;1H[1m[33mline 6342:[0m
[1m[37m[41m"/i/m/p/o/s/s/i/b/l/e" E212: Can't open file for writing[0m
*** Test  63: OK (236978127)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/207[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/207" [25;20H[K[25;20H149L, 2828C appended[25;20H[K[25;20H150L, 2850C
6 substitutions on 6 lines"/tmp/vu9KdKF/207"[25;20H[K[25;20H150L, 2844C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/208[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/208"' -c 'break
[24;80Ha[25;1Hdd file 63 /tmp/vu9KdKF/207' -S /tmp/vu9KdKF/207[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/208" 16L, 97C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  64: OK (1499645335)
*** Test  65: OK (70187)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/209[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/209" [25;20H[K[25;20H78L, 1520C appended[25;20H[K[25;20H79L, 1542C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/210[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/210"' -c 'break
[24;80Ha[25;1Hdd func 8 F' -S /tmp/vu9KdKF/209[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/210" 6L, 22C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  66: OK (5464)
*** Test  67: OK (212514423)
*** Test  68: OK (212514423)
*** Test  69: OK (8995471)
*** Test  70: OK (69544277)
*** Test  71: OK (34886997)
*** Test  72: OK (1789569365)
   function F0()
   endfunction
   function F1()
   endfunction
*** Test  73: OK (9032615)"/tmp/vu9KdKF/211" [New File]"test49.in" [25;13H[K[25;13H30L, 631C"/tmp/vu9KdKF/212" [New File]"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  74: OK (224907669)
*** Test  75: OK (2000403408)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/213[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/213" [25;20H[K[25;20H253L, 6369C appended[25;20H[K[25;20H254L, 6391C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/214[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|
[24;80Hs[25;1Het viminfo+=nviminfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp
[24;80H/[25;1Hvu9KdKF/214"' -c 'breakadd func 2 INT' -S /tmp/vu9KdKF/213[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/214" 28L, 167C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  76: OK (1610087935)
[1m[37m[41mError detected while processing function ERR:[0m
[1m[33mline    2:[0m
[1m[37m[41mE492: Not an editor command:     asdf[0m
[1m[37m[41mE492: Not an editor command:     asdf[0m
[1m[37m[41mE492: Not an editor command:     asdf[0m
*** Test  77: OK (1388671)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/215[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/215" [25;20H[K[25;20H161L, 4543C appended[25;20H[K[25;20H162L, 4565C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/216[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/216"' -S /tmp/vu9K
[24;80Hd[25;1HKF/215[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/216" 1L, 10C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  78: OK (134217728)
[1m[37m[41mError detected while processing function NEXT:[0m
[1m[33mline    1:[0m
[1m[37m[41mE121: Undefined variable: novar[0m
[1m[37m[41mE15: Invalid expression: novar | Xloop 1[0m
[1m[37m[41mE121: Undefined variable: novar[0m
[1m[37m[41mE488: Trailing characters[0m
[1m[37m[41mE108: No such variable: "novar"[0m
[1m[37m[41mE488: Trailing characters[0m
[1m[37m[41mE121: Undefined variable: novar[0m
[1m[37m[41mE15: Invalid expression: novar[0m
[1m[37m[41mE475: Invalid argument: {novar} | Xloop 1[0m
[1m[37m[41mE121: Undefined variable: novar[0m
[1m[37m[41mE15: Invalid expression:  novar[0m
[1m[37m[41mE475: Invalid argument: { novar} | Xloop 1[0m
*** Test  79: OK (70288929)
[1m[37m[41mError detected while processing /sources/vim74/src/testdir/test49.vim:[0m
[1m[33mline 8828:[0m
[1m[37m[41mE584: :elseif after :else: elseif 1 ||| 2[0m
[1m[33mline 8838:[0m
[1m[37m[41mE584: :elseif after :else: elseif 1 ||| 2[0m
[1m[33mline 8846:[0m
[1m[37m[41mE582: :elseif without :if: elseif 1 ||| 2[0m
[1m[33mline 8854:[0m
[1m[37m[41mE582: :elseif without :if:     elseif 1 ||| 2[0m
*** Test  80: OK (17895765)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/217[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/217" [25;20H[K[25;20H15L, 272C appended[25;20H[K[25;20H16L, 294C[25;20H[K[25;20H16L, 293C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/218[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/218"' -S /tmp/vu9K
[24;80Hd[25;1HKF/217[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/218" 2L, 4C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/219[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/219" [25;20H[K[25;20H12L, 227C appended[25;20H[K[25;20H13L, 249C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/220[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/220"' -c 'break
[24;80Ha[25;1Hdd file 8 /tmp/vu9KdKF/219' -S /tmp/vu9KdKF/219[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/220" 2L, 8C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  81: OK (387)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/221[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/221" [25;20H[K[25;20H20L, 417C appended[25;20H[K[25;20H21L, 439C[25;20H[K[25;20H21L, 438C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/222[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/222"' -S /tmp/vu9K
[24;80Hd[25;1HKF/221[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/222" 1L, 2C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/223[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/223" [25;20H[K[25;20H24L, 480C appended[25;20H[K[25;20H25L, 502C[25;20H[K[25;20H25L, 501C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/224[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/224"' -S /tmp/vu9K
[24;80Hd[25;1HKF/223[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/224" 1L, 4C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/225[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/225" [25;20H[K[25;20H17L, 390C appended[25;20H[K[25;20H18L, 412C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/226[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/226"' -c 'break
[24;80Ha[25;1Hdd file 7 /tmp/vu9KdKF/225' -S /tmp/vu9KdKF/225[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/226" 1L, 6C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/227[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/227" [25;20H[K[25;20H21L, 444C appended[25;20H[K[25;20H22L, 466C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/228[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/228"' -c 'break
[24;80Ha[25;1Hdd func 6 I' -S /tmp/vu9KdKF/227[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/228" 1L, 8C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  82: OK (8454401)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/229[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/229" [25;20H[K[25;20H17L, 307C appended[25;20H[K[25;20H18L, 329C[25;20H[K[25;20H18L, 328C written"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/230[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -c '
[24;80Hl[25;1Het ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/230"' -S /tmp/vu9K
[24;80Hd[25;1HKF/229[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/230" 3L, 7C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/231[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/231" [25;20H[K[25;20H14L, 266C appended[25;20H[K[25;20H15L, 288C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/232[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo' -
[24;80Hc[25;2H'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/232"' -c 'break
[24;80Ha[25;1Hdd file 8 /tmp/vu9KdKF/231' -S /tmp/vu9KdKF/231[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/232" 3L, 13C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  83: OK (2835)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/233[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/233" [25;20H[K[25;20H154L, 3580C appended[25;20H[K[25;20H155L, 3602C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/234[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nviminfo
[24;80H'[25;2H-c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/234"' -c 'br
[24;80He[25;1Hakadd func 1 INT' -S /tmp/vu9KdKF/233[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/234" 18L, 118C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  84: OK (934782101)
TMP"/tmp/vu9KdKF/235" [noeol] 2L, 6C[25;1H[K[25;1H/  "test49.in" 30L, 631C"/n/o/n/e/x/i/s/t/e/n/t"
"/tmp/vu9KdKF/237" 1L, 1C"test49.in" [25;13H[K[25;13H30L, 631C
:!echo XYZ >/tmp/vu9KdKF/238[?25h[?0c[25;1H
[?25l[?1c[25;1H"/tmp/vu9KdKF/239" [New File]"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  85: OK (198689)
[1m[33mline 9612:[0m
[1m[37m[41mE123: Undefined function: F[0m
Make_amiga.mak(1 of 1): tango down
[1m[33mline 9616:[0m
[1m[37m[41mE193: :endfunction not inside a function[0m
[1m[37m[41mError detected while processing function ExecAsScript..MakeScript:[0m
[1m[33mline    3:[0m
[1m[37m[41mE123: Undefined function: F[0m"/tmp/vu9KdKF/240" [25;20H[K[25;20H[noeol] 4L, 106C
[1m[31msearch hit BOTTOM, continuing at TOP[0m[1m[33mline   10:[0m[25;11H[K[25;1H
[1m[37m[41mE486: Pattern not found: .*F(.*)[0m
[1m[31msearch hit BOTTOM, continuing at TOP[0m[1m[33mline   11:[0m[25;11H[K[25;1H
[1m[37m[41mE486: Pattern not found: ^\d*\s*endfunction\>[0m
4 substitutions on 4 lines"/tmp/vu9KdKF/240"[25;20H[K[25;20H3L, 106C written"test49.in" [25;13H[K[25;13H30L, 631C
[1m[37m[41mError detected while processing /tmp/vu9KdKF/240:[0m
[1m[33mline    1:[0m
[1m[37m[41mE492: Not an editor command: Error detected while processing function ExecAsScr[0m
[24;80H[1m[37m[41mi[25;1Hpt..MakeScript:[0m
[1m[33mline    2:[0m
[1m[37m[41mE492: Not an editor command: line    3:[0m
[1m[33mline    3:[0m
[1m[37m[41mE492: Not an editor command: E123: Undefined function: F[0m
[1m[37m[41mError detected while processing /sources/vim74/src/testdir/test49.vim:[0m
[1m[33mline 9622:[0m
[1m[37m[41mE130: Unknown function: F[0m
*** Test  86: OK (0)
5
*** Test  87: OK (0)"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!echo 'source /tmp/vu9KdKF/3' >/tmp/vu9KdKF/241[?25h[?0c[25;1H
[?25l[?1c[25;1H/^\s*if\s\+ExtraVim(.*)/+[25C1"/tmp/vu9KdKF/241" [25;20H[K[25;20H151L, 3929C appended[25;20H[K[25;20H152L, 3951C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C
:!>/tmp/vu9KdKF/242[?25h[?0c[25;1H
[?25l[?1c[25;1H:!echo 'q[1m[34m^M[0mq[1m[34m^M[0mq[1m[34m^M[0mq' | ../vim -u NONE -N -Xes -c 'debuggreedy|set viminfo+=nvimi
[24;80Hn[25;1Hfo' -c 'let ExtraVimBegin = 1' -c 'let ExtraVimResult = "/tmp/vu9KdKF/242"' -c
[24;80H'[25;1Hbreakadd func 5 ThrowOnInterrupt' -S /tmp/vu9KdKF/241[?25h[?0c[25;1H

shell returned 1
[?25l[?1c[25;1H"/tmp/vu9KdKF/242" 16L, 281C"/sources/vim74/src/testdir/test49.vim" [readonly] 9852L, 225409C"test49.in" [25;13H[K[25;13H30L, 631C
*** Test  88: OK (50443995)
[1m[32mPress ENTER or type command to continue[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[1;1HThis is a test of the script language.

If after adding a new test, the test output doesn't appear properly in
test49.failed, try to add one or more "G"s at the line ending in "test.out"

STARTTEST
:so small.vim
:se nocp nomore viminfo+=nviminfo
:lang mess C
:so test49.vim
GGGGGGGGGGGGGG"rp:.-,$w! test.out
:"
:" make valgrind happy
:redir => funclist
:silent func
:redir END
:for line in split(funclist, "\n")
:  let name = matchstr(line, 'function \zs[A-Z]\w*\ze(')
:  if name != ''
:    exe "delfunc " . name
:  endif
:endfor
:for v in keys(g:)
:  silent! exe "unlet " . v[1;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[6M[1;25r[19;1H:endfor
:unlet v
:qa!
ENDTEST

Results of test49.vim:[?25h[?0c[?25l[?1c
98 more lines[1;24r[24;1H
[1;25r[24;1H*** Test   1: OK (34695)[25;1H[K[25;1H98 more lines[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.-,$w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New] 99L, 2869C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" make valgrind happy[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir => funclist[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csilent func[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir END[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfor line in split(funclist, "\n")[?25l[?1c
:  [?25h[?0c:  let name = matchstr(line, 'function \zs[A-Z]\w*\ze(')
[?25l[?1c:  [?25h[?0c:  if name != ''
[?25l[?1c:    [?25h[?0c:    exe "delfunc " . name
[?25l[?1c:    [?25h[?0c:  endif
[?25l[?1c:  [?25h[?0c:endfor[1;1H[5L[?25l[?1c[1;1H:se nocp nomore viminfo+=nviminfo
:lang mess C
:so test49.vim
GGGGGGGGGGGGGG"rp:.-,$w! test.out
:"[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cfor v in keys(g:)[?25l[?1c
:  [?25h[?0c:  silent! exe "unlet " . v
[?25l[?1c:  [?25h[?0c:endfor[1;1H[2L[?25l[?1c[1;1H:se nocp nomore viminfo+=nviminfo
:lang mess C[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cunlet v[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test51.failed test.ok test.out X* viminfo
cp test51.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test51.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test51.in" 36 lines, 808 characters[1;1HTests for ":highlight". vim: set ft=vim :

STARTTEST
:so small.vim
:" basic test if ":highlight" doesn't crash
:highlight
:hi Search
:" test setting colors.
:" test clearing one color and all doesn't generate error or warning
:hi NewGroup term=bold cterm=italic ctermfg=DarkBlue ctermbg=Grey gui= guifg=#00[11;1Hff00 guibg=Cyan
:hi Group2 term= cterm=
:hi Group3 term=underline cterm=bold
:redir! >test.out
:hi NewGroup
:hi Group2
:hi Group3
:hi clear NewGroup
:hi NewGroup
:hi Group2
:hi Group2 NONE
:hi Group2
:hi clear
:hi Group3[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for ":highlight". vim: set ft=vim :[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 31 lines, 746 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[12M[1;25r[13;1H:hi Crash term='asdf
:redir END
:" filter ctermfg and ctermbg, the numbers depend on the terminal
:e test.out
:%s/ctermfg=\d*/ctermfg=2/
:%s/ctermbg=\d*/ctermbg=3/
:" filter out possibly translated error message
:%s/E475: [^:]*:/E475:/
:" fix the fileformat
:set ff&
:wq!
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" basic test if ":highlight" doesn't crash[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0chighlight[?25l[?1c
SpecialKey     [1m[34mxxx[0m [1m[36mterm=[0mbold [1m[36mcterm=[0mbold [1m[36mctermfg=[0m4 [1m[36mguifg=[0mCyan
NonText[8C[1m[34mxxx[0m [1m[36mterm=[0mbold [1m[36mcterm=[0mbold [1m[36mctermfg=[0m4 [1m[36mgui=[0mbold [1m[36mguifg=[0mBlue
Directory      [1m[36mxxx[0m [1m[36mterm=[0mbold [1m[36mcterm=[0mbold [1m[36mctermfg=[0m6 [1m[36mguifg=[0mCyan
ErrorMsg[7C[1m[37m[41mxxx[0m [1m[36mterm=[0mstandout [1m[36mcterm=[0mbold [1m[36mctermfg=[0m7 [1m[36mctermbg=[0m1 [1m[36mguifg=[0mWhite
[19C[1m[36mguibg=[0mRed
IncSearch      [7mxxx[0m [1m[36mterm=[0mreverse [1m[36mcterm=[0mreverse [1m[36mgui=[0mreverse
Search[9C[30m[43mxxx[0m [1m[36mterm=[0mreverse [1m[36mctermfg=[0m0 [1m[36mctermbg=[0m3 [1m[36mguifg=[0mBlack [1m[36mguibg=[0mYellow
MoreMsg[8C[1m[32mxxx[0m [1m[36mterm=[0mbold [1m[36mcterm=[0mbold [1m[36mctermfg=[0m2 [1m[36mgui=[0mbold [1m[36mguifg=[0mSeaGreen
ModeMsg[8C[1mxxx[0m [1m[36mterm=[0mbold [1m[36mcterm=[0mbold [1m[36mgui=[0mbold
LineNr[9C[1m[33mxxx[0m [1m[36mterm=[0munderline [1m[36mcterm=[0mbold [1m[36mctermfg=[0m3 [1m[36mguifg=[0mYellow
CursorLineNr   [1m[33mxxx[0m [1m[36mterm=[0mbold [1m[36mcterm=[0mbold [1m[36mctermfg=[0m3 [1m[36mgui=[0mbold [1m[36mguifg=[0mYellow
Question[7C[1m[32mxxx[0m [1m[36mterm=[0mstandout [1m[36mcterm=[0mbold [1m[36mctermfg=[0m2 [1m[36mgui=[0mbold [1m[36mguifg=[0mGreen
StatusLine     [1m[7mxxx[0m [1m[36mterm=[0mbold,reverse [1m[36mcterm=[0mbold,reverse [1m[36mgui=[0mbold,reverse
StatusLineNC   [7mxxx[0m [1m[36mterm=[0mreverse [1m[36mcterm=[0mreverse [1m[36mgui=[0mreverse
VertSplit      [7mxxx[0m [1m[36mterm=[0mreverse [1m[36mcterm=[0mreverse [1m[36mgui=[0mreverse
Title[10C[1m[35mxxx[0m [1m[36mterm=[0mbold [1m[36mcterm=[0mbold [1m[36mctermfg=[0m5 [1m[36mgui=[0mbold [1m[36mguifg=[0mMagenta
Visual[9C[7mxxx[0m [1m[36mterm=[0mreverse [1m[36mcterm=[0mreverse [1m[36mguibg=[0mDarkGrey
VisualNOS      xxx cleared
WarningMsg     [1m[31mxxx[0m [1m[36mterm=[0mstandout [1m[36mcterm=[0mbold [1m[36mctermfg=[0m1 [1m[36mguifg=[0mRed
WildMenu[7C[30m[43mxxx[0m [1m[36mterm=[0mstandout [1m[36mctermfg=[0m0 [1m[36mctermbg=[0m3 [1m[36mguifg=[0mBlack [1m[36mguibg=[0mYellow
Folded[9C[1m[36m[40mxxx[0m [1m[36mterm=[0mstandout [1m[36mcterm=[0mbold [1m[36mctermfg=[0m6 [1m[36mctermbg=[0m0 [1m[36mguifg=[0mCyan
[19C[1m[36mguibg=[0mDarkGrey
FoldColumn     [1m[36m[40mxxx[0m [1m[36mterm=[0mstandout [1m[36mcterm=[0mbold [1m[36mctermfg=[0m6 [1m[36mctermbg=[0m0 [1m[36mguifg=[0mCyan
[19C[1m[36mguibg=[0mGrey
DiffAdd[8C[44mxxx[0m [1m[36mterm=[0mbold [1m[36mctermbg=[0m4 [1m[36mguibg=[0mDarkBlue
DiffChange     [45mxxx[0m [1m[36mterm=[0mbold [1m[36mctermbg=[0m5 [1m[36mguibg=[0mDarkMagenta
DiffDelete     [1m[34m[46mxxx[0m [1m[36mterm=[0mbold [1m[36mcterm=[0mbold [1m[36mctermfg=[0m4 [1m[36mctermbg=[0m6 [1m[36mgui=[0mbold [1m[36mguifg=[0mBlue
[19C[1m[36mguibg=[0mDarkCyan
DiffText[7C[1m[41mxxx[0m [1m[36mterm=[0mreverse [1m[36mcterm=[0mbold [1m[36mctermbg=[0m1 [1m[36mgui=[0mbold [1m[36mguibg=[0mRed
SignColumn     [1m[36m[40mxxx[0m [1m[36mterm=[0mstandout [1m[36mcterm=[0mbold [1m[36mctermfg=[0m6 [1m[36mctermbg=[0m0 [1m[36mguifg=[0mCyan
[19C[1m[36mguibg=[0mGrey
Conceal[8Cxxx cleared
SpellBad[7C[41mxxx[0m [1m[36mterm=[0mreverse [1m[36mctermbg=[0m1 [1m[36mgui=[0mundercurl [1m[36mguisp=[0mRed
SpellCap[7C[44mxxx[0m [1m[36mterm=[0mreverse [1m[36mctermbg=[0m4 [1m[36mgui=[0mundercurl [1m[36mguisp=[0mBlue
SpellRare      [45mxxx[0m [1m[36mterm=[0mreverse [1m[36mctermbg=[0m5 [1m[36mgui=[0mundercurl [1m[36mguisp=[0mMagenta
SpellLocal     [46mxxx[0m [1m[36mterm=[0munderline [1m[36mctermbg=[0m6 [1m[36mgui=[0mundercurl [1m[36mguisp=[0mCyan
Pmenu[10C[30m[45mxxx[0m [1m[36mctermfg=[0m0 [1m[36mctermbg=[0m5 [1m[36mguibg=[0mMagenta
PmenuSel[7C[1m[30m[40mxxx[0m [1m[36mcterm=[0mbold [1m[36mctermfg=[0m0 [1m[36mctermbg=[0m0 [1m[36mguibg=[0mDarkGrey
PmenuSbar      [47mxxx[0m [1m[36mctermbg=[0m7 [1m[36mguibg=[0mGrey
PmenuThumb     [47mxxx[0m [1m[36mctermbg=[0m7 [1m[36mguibg=[0mWhite
TabLine[8C[1m[4m[37m[40mxxx[24m[0m [1m[36mterm=[0munderline [1m[36mcterm=[0mbold,underline [1m[36mctermfg=[0m7 [1m[36mctermbg=[0m0
[19C[1m[36mgui=[0munderline [1m[36mguibg=[0mDarkGrey
TabLineSel     [1mxxx[0m [1m[36mterm=[0mbold [1m[36mcterm=[0mbold [1m[36mgui=[0mbold
TabLineFill    [7mxxx[0m [1m[36mterm=[0mreverse [1m[36mcterm=[0mreverse [1m[36mgui=[0mreverse
CursorColumn   [40mxxx[0m [1m[36mterm=[0mreverse [1m[36mctermbg=[0m0 [1m[36mguibg=[0mGrey40
CursorLine     [4mxxx[24m [1m[36mterm=[0munderline [1m[36mcterm=[0munderline [1m[36mguibg=[0mGrey40
ColorColumn    [41mxxx[0m [1m[36mterm=[0mreverse [1m[36mctermbg=[0m1 [1m[36mguibg=[0mDarkRed
MatchParen     [46mxxx[0m [1m[36mterm=[0mreverse [1m[36mctermbg=[0m6 [1m[36mguibg=[0mDarkCyan
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0chi Search[?25l[?1c
Search[9C[30m[43mxxx[0m [1m[36mterm=[0mreverse [1m[36mctermfg=[0m0 [1m[36mctermbg=[0m3 [1m[36mguifg=[0mBlack [1m[36mguibg=[0mYellow
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c" test setting colors.[?25l[?1c[27m[24m[0m[H[J[1;1H:redir! >test.out
:hi NewGroup
:hi Group2
:hi Group3
:hi clear NewGroup
:hi NewGroup
:hi Group2
:hi Group2 NONE
:hi Group2
:hi clear
:hi Group3
:hi Crash term='asdf
:redir END
:" filter ctermfg and ctermbg, the numbers depend on the terminal
:e test.out
:%s/ctermfg=\d*/ctermfg=2/
:%s/ctermbg=\d*/ctermbg=3/
:" filter out possibly translated error message
:%s/E475: [^:]*:/E475:/
:" fix the fileformat
:set ff&
:wq!
ENDTEST
[?25h[?0c[?25l[?1c
:[?25h[?0c" test clearing one color and all doesn't generate error or warning[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0chi NewGroup term=bold cterm=italic ctermfg=DarkBlue ctermbg=Grey gui= guifg=#0
[24;80H0[25;1Hff00 guibg=Cyan[?25l[?1c[24;1H[1m[37m[41mE418: Illegal value: guifg=#00ff00[0m[24;35H[K[25;1H[K[25;1H[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0chi Group2 term= cterm=[?25l[?1c[1m[37m[41mE418: Illegal value: cterm=[0m
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0chi Group3 term=underline cterm=bold[?25l[?1c[1;1H[2L[1;1H:redir! >test.out
:hi NewGroup[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0credir! >test.out[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0chi NewGroup[?25l[?1c
NewGroup[7C[7m[34m[47mxxx[0m [1m[36mterm=[0mbold [1m[36mcterm=[0mitalic [1m[36mctermfg=[0m4 [1m[36mctermbg=[0m7
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0chi Group2[?25l[?1c
Group2[9Cxxx cleared
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0chi Group3[?25l[?1c
Group3[9C[1mxxx[0m [1m[36mterm=[0munderline [1m[36mcterm=[0mbold
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0chi clear NewGroup[?25l[?1c[1;1H[6L[1;1H:redir! >test.out
:hi NewGroup
:hi Group2
:hi Group3
:hi clear NewGroup
:hi NewGroup[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0chi NewGroup[?25l[?1c
NewGroup[7Cxxx cleared
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0chi Group2[?25l[?1c
Group2[9Cxxx cleared
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0chi Group2 NONE[?25l[?1c[1;1H[4L[1;1H:redir! >test.out
:hi NewGroup
:hi Group2
:hi Group3[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0chi Group2[?25l[?1c
Group2[9Cxxx cleared
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0chi clear[?25l[?1c[27m[24m[0m[H[J[1;1H:redir! >test.out
:hi NewGroup
:hi Group2
:hi Group3
:hi clear NewGroup
:hi NewGroup
:hi Group2
:hi Group2 NONE
:hi Group2
:hi clear
:hi Group3
:hi Crash term='asdf
:redir END
:" filter ctermfg and ctermbg, the numbers depend on the terminal
:e test.out
:%s/ctermfg=\d*/ctermfg=2/
:%s/ctermbg=\d*/ctermbg=3/
:" filter out possibly translated error message
:%s/E475: [^:]*:/E475:/
:" fix the fileformat
:set ff&
:wq!
ENDTEST
[?25h[?0c[?25l[?1c
:[?25h[?0chi Group3[?25l[?1c
Group3[9Cxxx cleared
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0chi Crash term='asdf[?25l[?1c[1m[37m[41mE475: Invalid argument: term='asdf[0m
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0credir END[?25l[?1c[1;1H[3L[1;1H:redir! >test.out
:hi NewGroup
:hi Group2[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c" filter ctermfg and ctermbg, the numbers depend on the terminal[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce test.out[?25l[?1c"test.out" 20 lines, 289 characters[1;1H[K[2;1H[K[3;1HNewGroup       xxx term=bold cterm=italic ctermfg=4 ctermbg=7[4;1H[K[5;1HGroup2         xxx cleared[6;1H[K[7;1HGroup3         xxx term=underline cterm=bold[8;1H[K[9;1H[K[10;1HNewGroup       xxx cleared[11;1H[K[12;1HGroup2         xxx cleared[13;1H[K[14;1H[K[15;1HGroup2         xxx cleared[16;1H[K[17;1H[K[18;1HGroup3         xxx cleared[18;27H[K[19;1H[K[20;1HE475: Invalid argument: term='asdf
[1m[34m~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c%s/ctermfg=\d*/ctermfg=2/[?25l[?1c[3;51H2[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c%s/ctermbg=\d*/ctermbg=3/[?25l[?1c[3;61H3[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" filter out possibly translated error message[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c%s/E475: [^:]*:/E475:/[?25l[?1c[20;7Hterm='asdf[20;17H[K[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" fix the fileformat[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ff&[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwq![?25l[?1c"test.out" 20 lines, 271 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test52.failed test.ok test.out X* viminfo
cp test52.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test52.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test52.in" 65 lines, 1645 characters[1;1HTests for reading and writing files with conversion for Win32.

STARTTEST
:so mbyte.vim
:" make this a dummy test for non-Win32 systems
:if !has("win32") | e! test.ok | wq! test.out | endif
:"
:" write tests:
:" combine three values for 'encoding' with three values for 'fileencoding'
:" also write files for read tests
/^1
:set encoding=utf-8
:.w! ++enc=utf-8 test.out
:.w ++enc=cp1251 >>test.out
:.w ++enc=cp866 >>test.out
:.w! ++enc=utf-8 Xutf8
/^2
:set encoding=cp1251
:.w ++enc=utf-8 >>test.out
:.w ++enc=cp1251 >>test.out
:.w ++enc=cp866 >>test.out
:.w! ++enc=cp1251 Xcp1251
/^3
:set encoding=cp866[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for reading and writing files with conversion for Win32.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 57 lines, 1333 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:.w ++enc=cp1251 >>test.out
:e Xcp1251
:.w ++enc=cp1251 >>test.out
:set fencs=utf-8,cp866
:e Xcp866
:.w ++enc=cp1251 >>test.out
:"
:" read three 'fileencoding's with cp866 'encoding'
:set encoding=cp866 fencs=utf-8,cp1251
:e Xutf8
:.w ++enc=cp866 >>test.out
:e Xcp1251
:.w ++enc=cp866 >>test.out
:set fencs=utf-8,cp866
:e Xcp866
:.w ++enc=cp866 >>test.out
:"
:qa!
ENDTEST

1 utf-8 text: [1m[34m~T[0mл[1m[34m~O[0m Vim version 6.2.  [1m[34m~_[0mо[1m[34m~A[0mледнее изменение[22;1H: 1970 Jan 01
2 cp1251 text:  Vim version 6.2.   : 1970 Jan 01
3 cp866 text: [1m[34m~D[0m Vim version 6.2.  [1m[34m~O[0m᫥ : 1970 Jan 01[19;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso mbyte.vim[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" make this a dummy test for non-Win32 systems[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif !has("win32") | e! test.ok | wq! test.out | endif[?25l[?1c"test.ok" [25;11H[K[25;11H18 lines, 1374 characters
"test.out" [New File] 18 lines, 1374 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test53.failed test.ok test.out X* viminfo
cp test53.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test53.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test53.in" 123 lines, 2343 characters[1;1HTests for string and html text objects. vim: set ft=vim :

Note that the end-of-line moves the cursor to the next test line.

Also test match() and matchstr()

Also test the gn command and repeating it.

STARTTEST
:so small.vim
/^start:/
da"
0va'a'rx
02f`da`
0fXdi"
03f'vi'ry
:set quoteescape=+*-
di`
$F"va"oha"i"rz
:"
/^<begin
jfXdit
0fXdit
fXdat[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for string and html text objects. vim: set ft=vim :[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[9;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[10;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 73 lines, 1554 characters written[10;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[10;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1Hcgnj[1m[34m^[[0m
:" Make sure there is no other match y uppercase.
/[1m[34m^V[0mx59
gggnd
:" test repeating dgn
/^Johnny
ggdgn.
:" test repeating gUgn
/^Depp
gggUgn.
:/^start:/,/^end:/wq! test.out
ENDTEST

start: "wo\"rd\\" foo
'foo' 'bar' 'piep'
bla bla `quote` blah
out " in "noXno"
"'" 'blah' rep 'buh'
bla `s*`d-`+++`l**` b`la
voo "nah" sdf " asdf" sdf " sdf" sd

<begin>
-<b>asdf<i>Xasdf</i>asdf</b>-
-<b>asdX<i>a<i />sdf</i>asdf</b>-[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^start:/[?25l[?1c[25;9H[K[25;1H[14;1H[?25h[?0c[?25l[?1c[7Cfo[14;11H[K[14;8H[?25h[?0c[15;8H[?25l[?1c[?25h[?0c[?25l[?1c[7m'foo'[?25h[?0c[?25l[?1c 'bar'[?25h[?0c[?25l[?1c[0mxxxxxxxxxxxx[?25h[?0c
[14C[?25l[?1cblah[16;13H[K[16;9H[?25h[?0c[17;9H[12C[?25l[?1c"[17;12H[K[17;11H[?25h[?0c[18;11H[9C[?25l[?1c[?25h[?0c[?25l[?1c'[7m rep[?25h[?0c[?25l[?1c[0myyyyy[?25h[?0c[19;11H[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset quoteescape=+*-[?25l[?1c[19;11H[?25h[?0c[?25l[?1c` b`la[19;12H[K[19;6H[?25h[?0c[20;6H[29C[?25l[?1c[?25h[?0c[?25l[?1c[7m" sdf"[?25h[?0c[?25l[?1c[0m"[5C[7m [20;27H[?25h[?0c[?25l[?1c"[?25h[?0c[?25l[?1c[20;16H asdf" sdf [20;15H[?25h[?0c[?25l[?1c[20;7Hah" sdf "[0mvoo "[?25h[?0c[?25l[?1czzzzzzzzzzzzzzzzzzzzzzzzzzzzvoo "[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[21;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^<begin[?25l[?1c[22;1H[?25h[?0c
[11C[?25l[?1c</i>asdf</b>-[23;25H[K[23;12H[?25h[?0c[24;12H[7C[?25l[?1c</b>-[24;10H[K[24;5H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H-<b>asdf<i>Xasdf</i>asdf</b>-[25;1H[K[24;5H[?25h[?0c[7C[?25l[?1casdf</b>-[24;18H[K[24;9H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H-<b>asdX<i>as<b />df</i>asdf</b>-[24;9H[?25h[?0c[7C[?25l[?1c--[24;3H[K[24;2H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H</begin><[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cput =matchstr(\"abcd\", \".\", 0, 2) " b[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hb[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =matchstr(\"abcd\", \"..\", 0, 2) " bc[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hbc[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =matchstr(\"abcd\", \".\", 2, 0) " c (zero and negative -> first match)[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hc[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =matchstr(\"abcd\", \".\", 0, -1) " a[?25l[?1c[1;24r[24;1H
[1;25r[24;1Ha[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match(\"abcd\", \".\", 0, 5) " -1[?25l[?1c[1;24r[24;1H
[1;25r[24;1H-1[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match(\"abcd\", \".\", 0, -1) " 0[?25l[?1c[1;24r[24;1H
[1;25r[24;1H0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '.', 0, 1) " 0[?25l[?1c[1;24r[24;1H
[1;25r[24;1H0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '.', 0, 2) " 1[?25l[?1c[1;24r[24;1H
[1;25r[24;1H1[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '.', 0, 3) " 2[?25l[?1c[1;24r[24;1H
[1;25r[24;1H2[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '.', 0, 4) " -1[?25l[?1c[1;24r[24;1H
[1;25r[24;1H-1[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '.', 1, 1) " 1[?25l[?1c[1;24r[24;1H
[1;25r[24;1H1[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '.', 2, 1) " 2[?25l[?1c[1;24r[24;1H
[1;25r[24;1H2[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '.', 3, 1) " -1[?25l[?1c[1;24r[24;1H
[1;25r[24;1H-1[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '$', 0, 1) " 3[?25l[?1c[1;24r[24;1H
[1;25r[24;1H3[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '$', 0, 2) " -1[?25l[?1c[1;24r[24;1H
[1;25r[24;1H-1[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '$', 1, 1) " 3[?25l[?1c[1;24r[24;1H
[1;25r[24;1H3[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '$', 2, 1) " 3[?25l[?1c[1;24r[24;1H
[1;25r[24;1H3[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '$', 3, 1) " 3[?25l[?1c[1;24r[24;1H
[1;25r[24;1H3[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '$', 4, 1) " -1[?25l[?1c[1;24r[24;1H
[1;25r[24;1H-1[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '\zs', 0, 1) " 0[?25l[?1c[1;24r[24;1H
[1;25r[24;1H0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '\zs', 0, 2) " 1[?25l[?1c[1;24r[24;1H
[1;25r[24;1H1[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '\zs', 0, 3) " 2[?25l[?1c[1;24r[24;1H
[1;25r[24;1H2[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '\zs', 0, 4) " 3[?25l[?1c[1;24r[24;1H
[1;25r[24;1H3[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '\zs', 0, 5) " -1[?25l[?1c[1;24r[24;1H
[1;25r[24;1H-1[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '\zs', 1, 1) " 1[?25l[?1c[1;24r[24;1H
[1;25r[24;1H1[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '\zs', 2, 1) " 2[?25l[?1c[1;24r[24;1H
[1;25r[24;1H2[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '\zs', 3, 1) " 3[?25l[?1c[1;24r[24;1H
[1;25r[24;1H3[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =match('abc', '\zs', 4, 1) " -1[?25l[?1c[1;24r[24;1H
[1;25r[24;1H-1[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0c^foobar[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1HSEARCH:
foobar[25;1H[K[24;1H[?25h[?0c[?25l[?1c[7mfooba[?25h[?0c[?25l[?1c[0msearchmatch[?25h[?0c[?25l[?1c
/[?25h[?0cone\_s*two\_s[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hone[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c1[?25l[?1c[27m[24m[0m[H[J[1;1HTests for string and html text objects. vim: set ft=vim :

Note that the end-of-line moves the cursor to the next test line.

Also test match() and matchstr()

Also test the gn command and repeating it.

STARTTEST
:so small.vim
/^start:/
da"
0va'a'rx
02f`da`
0fXdi"
03f'vi'ry
:set quoteescape=+*-
di`
$F"va"oha"i"rz
:"
/^<begin
jfXdit
0fXdit
fXdat[1;1H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1H1
2
3
-1
1
2
3
-1
SEARCH:
searchmatch
[7mone 
two[0m
abcdx | abcdx | abcdx
join
lines
zero width pattern
delete first and last chars
uniquepattern uniquepattern
my very excellent mother just served us nachos
for (i=0; i<=10; i++)
Y
text
Y
--1[12;4H[?25h[?0c[?25l[?1c[11;24r[11;1H[2M[1;25r[23;1HJohnny
--2[11;1H[?25h[?0c
[?25l[?1c[25;1H/[?25h[?0c[a]bcdx[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[11;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c1[?25l[?1c[27m[24m[0m[H[J[1;1HTests for string and html text objects. vim: set ft=vim :

Note that the end-of-line moves the cursor to the next test line.

Also test match() and matchstr()

Also test the gn command and repeating it.

STARTTEST
:so small.vim
/^start:/
da"
0va'a'rx
02f`da`
0fXdi"
03f'vi'ry
:set quoteescape=+*-
di`
$F"va"oha"i"rz
:"
/^<begin
jfXdit
0fXdit
fXdat[1;1H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1H0
1
2
3
-1
1
2
3
-1
SEARCH:
searchmatch
abcdx | [7mabcd[0mx | abcdx
join
lines
zero width pattern
delete first and last chars
uniquepattern uniquepattern
my very excellent mother just served us nachos
for (i=0; i<=10; i++)
Y
text
Y
--1
Johnny[12;13H[?25h[?0c[?25l[?1c | abcdx[12;17H[K[12;9H[?25h[?0c[?25l[?1c[25;1H/[?25h[?0cjoin[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c$[?25l[?1c[13;5H[?25h[?0c[?25l[?1cjoin [?25h[?0c[?25l[?1c[13;24r[24;1H
[1;25r[13;1Hjoin lines[24;1H--2[25;1H[K[13;6H[?25h[?0c[14;6H[?25l[?1c[25;1H/[?25h[?0c\>\zs[?25l[?1c[14;11H[?25h[?0c[?25l[?1czero[?25h[?0c[?25l[?1cwidth pattern[14;18H[K[14;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^[?25l[?1c[15;1H[?25h[?0c[?25l[?1c[?25h[?0c[?25l[?1celete first and last chars[15;27H[K[15;1H[?25h[?0c[25C[?25l[?1c[25;1H[K[25;1H/[?25h[?0c\zs[?25l[?1c[15;26H[?25h[?0c[?25l[?1c[?25h[?0c[?25l[?1c[15;26H[K[15;25H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c[u]niquepattern/s[?25l[?1c[25;17H[K[25;1H[16;1H[?25h[?0c[?25l[?1c[?25h[?0c[?25l[?1c[7mu[?25h[?0c[?25l[?1cniquepatter[?25h[?0c[?25l[?1c[0m uniquepattern[16;15H[K[16;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H/[?25h[?0cmother[?25l[?1c[17;19H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset selection=exclusive[?25l[?1c[17;19H[?25h[?0c[27C[?25l[?1c[17;21Hngoose just served us nachos[17;26H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0ci[?25l[?1c[18;6H[?25h[?0c[?25l[?1cj[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Make sure there is no other match y uppercase.[?25l[?1c[19;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^Y[?25l[?1c[21;1H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1HTests for string and html text objects. vim: set ft=vim :

Note that the end-of-line moves the cursor to the next test line.

Also test match() and matchstr()

Also test the gn command and repeating it.

STARTTEST
:so small.vim
/^start:/
da"
0va'a'rx
02f`da`
0fXdi"
03f'vi'ry
:set quoteescape=+*-
di`
$F"va"oha"i"rz
:"
/^<begin
jfXdit
0fXdit
fXdat[1;1H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1H3
-1
SEARCH:
searchmatch
abcdx |  | abcdx
join lines
zerowidth pattern
elete first and last char
 uniquepattern
my very excellent mongoose just served us nachos
for (j=0; i<=10; i++)
[7mY[0m
text
Y
--1
Johnny
--2
Johnny
--3
Depp
--4
Depp
--5
end:[12;2H[?25h[?0c[?25l[?1c[12;1H[K[12;1H[?25h[?0c
[?25l[?1c[25;1H:[?25h[?0c" test repeating dgn[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^Johnny[?25l[?1c[16;1H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1HTests for string and html text objects. vim: set ft=vim :

Note that the end-of-line moves the cursor to the next test line.

Also test match() and matchstr()

Also test the gn command and repeating it.

STARTTEST
:so small.vim
/^start:/
da"
0va'a'rx
02f`da`
0fXdi"
03f'vi'ry
:set quoteescape=+*-
di`
$F"va"oha"i"rz
:"
/^<begin
jfXdit
0fXdit
fXdat[1;1H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1H3
-1
SEARCH:
searchmatch
abcdx |  | abcdx
join lines
zerowidth pattern
elete first and last char
 uniquepattern
my very excellent mongoose just served us nachos
for (j=0; i<=10; i++)

text
Y
--1

--2
Johnny
--3
Depp
--4
Depp
--5
end:[16;1H[?25h[?0c[?25l[?1c[18;1H[K[18;1H[?25h[?0c
[?25l[?1c[25;1H:[?25h[?0c" test repeating gUgn[?25l[?1c[19;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^Depp[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1HTests for string and html text objects. vim: set ft=vim :

Note that the end-of-line moves the cursor to the next test line.

Also test match() and matchstr()

Also test the gn command and repeating it.

STARTTEST
:so small.vim
/^start:/
da"
0va'a'rx
02f`da`
0fXdi"
03f'vi'ry
:set quoteescape=+*-
di`
$F"va"oha"i"rz
:"
/^<begin
jfXdit
0fXdit
fXdat[1;1H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1H3
-1
SEARCH:
searchmatch
abcdx |  | abcdx
join lines
zerowidth pattern
elete first and last char
 uniquepattern
my very excellent mongoose just served us nachos
for (j=0; i<=10; i++)

text
Y
--1

--2

--3
DEPP
--4
Depp
--5
end:[20;1H[?25h[?0c[?25l[?1c

DEPP[?25h[?0c
[?25l[?1c

:[?25h[?0c/^start:/,/^end:/wq! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 64 lines, 485 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test54.failed test.ok test.out X* viminfo
cp test54.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test54.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test54.in" 22 lines, 658 characters[1;1HSome tests for buffer-local autocommands

STARTTEST
:so small.vim
:e xx
:if has("vms")
: !del test.out.*
: au BufLeave <buffer> :!write sys$output "buffer-local autommand in %" > test.o[9;1Hut
:else
: !rm -f test.out
: au BufLeave <buffer> :!echo buffer-local autommand in %>> test.out
:endif
:e somefile[11C" here, autocommand for xx shall write test.out
:[21C" but autocommand shall not apply to buffer named <buffer>[16;1H:bwipe xx[13C" here, autocommand shall be auto-deleted
:e xx[17C" nothing shall be written
:e somefile[11C" nothing shall be written
:qa!
ENDTEST

start of test file xx
end of test file xx
[1m[34m~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HSome tests for buffer-local autocommands[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 15 lines, 555 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[20;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[21;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[21;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce xx[?25l[?1c"xx" [New File][1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cif has("vms")[?25l[?1c
:  [?25h[?0c: !del test.out.*
[?25l[?1c:  [?25h[?0c: au BufLeave <buffer> :!write sys$output "buffer-local autommand in %" > te
[24;80Hs[25;1Ht.out
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c: !rm -f test.out
[?25l[?1c:!rm -f test.out[?25h[?0c[25;1H
[?25l[?1c[25;1H:  [?25h[?0c: au BufLeave <buffer> :!echo buffer-local autommand in %>> test.out
[?25l[?1c:  [?25h[?0c:endif[27m[24m[0m[H[J[?25l[?1c[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0ce somefile           " here, autocommand for xx shall write test.out [?25l[?1c:!echo buffer-local autommand in xx>> test.out[25;47H[K[25;47H
[?25h[?0c[?25l[?1c[24m[0m"somefile" [New File]
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c                     " but autocommand shall not apply to buffer named <buffer
[24;80H>[25;1H[?25l[?1c[27m[24m[0m[H[J[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0cbwipe xx             " here, autocommand shall be auto-deleted[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce xx                 " nothing shall be written[?25l[?1c"xx" [New File][25;23H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce somefile           " nothing shall be written[?25l[?1c"somefile" [New File][25;23H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test55.failed test.ok test.out X* viminfo
cp test55.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test55.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test55.in" 404 lines, 8463 characters[1;1HTests for List and Dictionary types.     vim: set ft=vim :

STARTTEST
:so small.vim
:fun Test(...)
:lang C
:" Creating List directly with different types
:let l = [1, 'as''d', [1, 2, function("strlen")], {'a': 1},]
:$put =string(l)
:$put =string(l[-1])
:$put =string(l[-4])
:try
:  $put =string(l[-5])
:catch
:  $put =v:exception[:14]
:endtry
:" List slices
:$put =string(l[:])
:$put =string(l[1:])
:$put =string(l[:-2])
:$put =string(l[0:8])
:$put =string(l[8:-1])
:"
:" List identity[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for List and Dictionary types.     vim: set ft=vim :[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 398 lines, 8377 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:endtry
:$put =string(d)
:endfun
:"
:call Test(1, 2, [3, 4], {5: 6})  " This may take a while
:"
:delfunc Test
:unlet dict
:call garbagecollect(1)
:"
:" test for patch 7.3.637
:let a = 'No error caught'
:try|foldopen|catch|let a = matchstr(v:exception,'^[^ ]*')|endtry
o[1m[34m^R[0m=a[1m[34m^M^[[0m:"
:lang C
:redir => a
:try|foobar|catch|let a = matchstr(v:exception,'^[^ ]*')|endtry
:redir END
o[1m[34m^R[0m=a[1m[34m^M^[[0m:"
:"
:/^start:/,$wq! test.out
ENDTEST

start:[22;1H[?25h[?0c
[?25l[?1c

:so! Xdotest[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfun Test(...)[?25l[?1c
:  [?25h[?0c:lang C
[?25l[?1c:  [?25h[?0c:" Creating List directly with different types
[?25l[?1c:  [?25h[?0c:let l = [1, 'as''d', [1, 2, function("strlen")], {'a': 1},]
[?25l[?1c:  [?25h[?0c:$put =string(l)
[?25l[?1c:  [?25h[?0c:$put =string(l[-1])
[?25l[?1c:  [?25h[?0c:$put =string(l[-4])
[?25l[?1c:  [?25h[?0c:try
[?25l[?1c:    [?25h[?0c:  $put =string(l[-5])
[?25l[?1c:    [?25h[?0c:catch
[?25l[?1c:    [?25h[?0c:  $put =v:exception[:14]
[?25l[?1c:    [?25h[?0c:endtry
[?25l[?1c:  [?25h[?0c:" List slices
[?25l[?1c:  [?25h[?0c:$put =string(l[:])
[?25l[?1c:  [?25h[?0c:$put =string(l[1:])
[?25l[?1c:  [?25h[?0c:$put =string(l[:-2])
[?25l[?1c:  [?25h[?0c:$put =string(l[0:8])
[?25l[?1c:  [?25h[?0c:$put =string(l[8:-1])
[?25l[?1c:  [?25h[?0c:"
[?25l[?1c:  [?25h[?0c:" List identity
[?25l[?1c:  [?25h[?0c:let ll = l
[?25l[?1c:  [?25h[?0c:let lx = copy(l)
[?25l[?1c:  [?25h[?0c:try
[?25l[?1c:    [?25h[?0c:  $put =(l == ll) . (l isnot ll) . (l is ll) . (l == lx) . (l is lx) . (l
isnot lx)
[?25l[?1c:    [?25h[?0c:catch
[?25l[?1c:    [?25h[?0c:  $put =v:exception
[?25l[?1c:    [?25h[?0c:endtry
[?25l[?1c:  [?25h[?0c:"
[?25l[?1c:  [?25h[?0c:" Creating Dictionary directly with different types
[?25l[?1c:  [?25h[?0c:let d = {001: 'asd', 'b': [1, 2, function('strlen')], -1: {'a': 1},}
[?25l[?1c:  [?25h[?0c:$put =string(d) . d.1
[?25l[?1c:  [?25h[?0c:$put =string(sort(keys(d)))
[?25l[?1c:  [?25h[?0c:$put =string (values(d))
[?25l[?1c:  [?25h[?0c:for [key, val] in items(d)
[?25l[?1c:    [?25h[?0c:  $put =key . ':' . string(val)
[?25l[?1c:    [?25h[?0c:  unlet key val
[?25l[?1c:    [?25h[?0c:endfor
[?25l[?1c:  [?25h[?0c:call extend  (d, {3:33, 1:99})
[?25l[?1c:  [?25h[?0c:call extend(d, {'b':'bbb', 'c':'ccc'}, "keep")
[?25l[?1c:  [?25h[?0c:try
[?25l[?1c:    [?25h[?0c:  call extend(d, {3:333,4:444}, "error")
[?25l[?1c:    [?25h[?0c:catch
[?25l[?1c:    [?25h[?0c:  $put =v:exception[:15] . v:exception[-1:-1]
[?25l[?1c:    [?25h[?0c:endtry
[?25l[?1c:  [?25h[?0c:$put =string(d)
[?25l[?1c:  [?25h[?0c:call filter(d, 'v:key =~ ''[ac391]''')
[?25l[?1c:  [?25h[?0c:$put =string(d)
[?25l[?1c:  [?25h[?0c:"
[?25l[?1c:  [?25h[?0c:" Dictionary identity
[?25l[?1c:  [?25h[?0c:let dd = d
[?25l[?1c:  [?25h[?0c:let dx = copy(d)
[?25l[?1c:  [?25h[?0c:try
[?25l[?1c:    [?25h[?0c:  $put =(d == dd) . (d isnot dd) . (d is dd) . (d == dx) . (d is dx) . (d
isnot dx)
[?25l[?1c:    [?25h[?0c:catch
[?25l[?1c:    [?25h[?0c:  $put =v:exception
[?25l[?1c:    [?25h[?0c:endtry
[?25l[?1c:  [?25h[?0c:"
[?25l[?1c:  [?25h[?0c:" Changing var type should fail
[?25l[?1c:  [?25h[?0c:try
[?25l[?1c:    [?25h[?0c:  let d = []
[?25l[?1c:    [?25h[?0c:catch
[?25l[?1c:    [?25h[?0c:  $put =v:exception[:14] . v:exception[-1:-1]
[?25l[?1c:    [?25h[?0c:endtry
[?25l[?1c:  [?25h[?0c:try
[?25l[?1c:    [?25h[?0c:  let l = {}
[?25l[?1c:    [?25h[?0c:catch
[?25l[?1c:    [?25h[?0c:  $put =v:exception[:14] . v:exception[-1:-1]
[?25l[?1c:    [?25h[?0c:endtry
[?25l[?1c:  [?25h[?0c:"
[?25l[?1c:  [?25h[?0c:" removing items with :unlet
[?25l[?1c:  [?25h[?0c:unlet l[2]
[?25l[?1c:  [?25h[?0c:$put =string(l)
[?25l[?1c:  [?25h[?0c:let l = range(8)
[?25l[?1c:  [?25h[?0c:try
[?25l[?1c:    [?25h[?0c:unlet l[:3]
[?25l[?1c:    [?25h[?0c:unlet l[1:]
[?25l[?1c:    [?25h[?0c:catch
[?25l[?1c:    [?25h[?0c:$put =v:exception
[?25l[?1c:    [?25h[?0c:endtry
[?25l[?1c:  [?25h[?0c:$put =string(l)
[?25l[?1c:  [?25h[?0c:"
[?25l[?1c:  [?25h[?0c:unlet d.c
[?25l[?1c:  [?25h[?0c:unlet d[-1]
[?25l[?1c:  [?25h[?0c:$put =string(d)
[?25l[?1c:  [?25h[?0c:"
[?25l[?1c:  [?25h[?0c:" removing items out of range: silently skip items that don't exist
[?25l[?1c:  [?25h[?0clet l = [0, 1, 2, 3]
[?25l[?1c:  [?25h[?0c:unlet l[2:1]
[?25l[?1c:  [?25h[?0c:$put =string(l)
[?25l[?1c:  [?25h[?0clet l = [0, 1, 2, 3]
[?25l[?1c:  [?25h[?0c:unlet l[2:2]
[?25l[?1c:  [?25h[?0c:$put =string(l)
[?25l[?1c:  [?25h[?0clet l = [0, 1, 2, 3]
[?25l[?1c:  [?25h[?0c:unlet l[2:3]
[?25l[?1c:  [?25h[?0c:$put =string(l)
[?25l[?1c:  [?25h[?0clet l = [0, 1, 2, 3]
[?25l[?1c:  [?25h[?0c:unlet l[2:4]
[?25l[?1c:  [?25h[?0c:$put =string(l)
[?25l[?1c:  [?25h[?0clet l = [0, 1, 2, 3]
[?25l[?1c:  [?25h[?0c:unlet l[2:5]
[?25l[?1c:  [?25h[?0c:$put =string(l)
[?25l[?1c:  [?25h[?0clet l = [0, 1, 2, 3]
[?25l[?1c:  [?25h[?0c:unlet l[-1:2]
[?25l[?1c:  [?25h[?0c:$put =string(l)
[?25l[?1c:  [?25h[?0clet l = [0, 1, 2, 3]
[?25l[?1c:  [?25h[?0c:unlet l[-2:2]
[?25l[?1c:  [?25h[?0c:$put =string(l)
[?25l[?1c:  [?25h[?0clet l = [0, 1, 2, 3]
[?25l[?1c:  [?25h[?0c:unlet l[-3:2]
[?25l[?1c:  [?25h[?0c:$put =string(l)
[?25l[?1c:  [?25h[?0clet l = [0, 1, 2, 3]
[?25l[?1c:  [?25h[?0c:unlet l[-4:2]
[?25l[?1c:  [?25h[?0c:$put =string(l)
[?25l[?1c:  [?25h[?0clet l = [0, 1, 2, 3]
[?25l[?1c:  [?25h[?0c:unlet l[-5:2]
[?25l[?1c:  [?25h[?0c:$put =string(l)
[?25l[?1c:  [?25h[?0clet l = [0, 1, 2, 3]
[?25l[?1c:  [?25h[?0c:unlet l[-6:2]
[?25l[?1c:  [?25h[?0c:$put =string(l)
[?25l[?1c:  [?25h[?0c:"
[?25l[?1c:  [?25h[?0c:" assignment to a list
[?25l[?1c:  [?25h[?0c:let l = [0, 1, 2, 3]
[?25l[?1c:  [?25h[?0c:let [va, vb] = l[2:3]
[?25l[?1c:  [?25h[?0c:$put =va
[?25l[?1c:  [?25h[?0c:$put =vb
[?25l[?1c:  [?25h[?0c:try
[?25l[?1c:    [?25h[?0c:  let [va, vb] = l
[?25l[?1c:    [?25h[?0c:catch
[?25l[?1c:    [?25h[?0c:  $put =v:exception[:14]
[?25l[?1c:    [?25h[?0c:endtry
[?25l[?1c:  [?25h[?0c:try
[?25l[?1c:    [?25h[?0c:  let [va, vb] = l[1:1]
[?25l[?1c:    [?25h[?0c:catch
[?25l[?1c:    [?25h[?0c:  $put =v:exception[:14]
[?25l[?1c:    [?25h[?0c:endtry
[?25l[?1c:  [?25h[?0c:"
[?25l[?1c:  [?25h[?0c:" manipulating a big Dictionary (hashtable.c has a border of 1000 entries)
[?25l[?1c:  [?25h[?0c:let d = {}
[?25l[?1c:  [?25h[?0c:for i in range(1500)
[?25l[?1c:    [?25h[?0c: let d[i] = 3000 - i
[?25l[?1c:    [?25h[?0c:endfor
[?25l[?1c:  [?25h[?0c:$put =d[0] . ' ' . d[100] . ' ' . d[999] . ' ' . d[1400] . ' ' . d[1499]
[?25l[?1c:  [?25h[?0c:try
[?25l[?1c:    [?25h[?0c:  let n = d[1500]
[?25l[?1c:    [?25h[?0c:catch
[?25l[?1c:    [?25h[?0c:  $put =substitute(v:exception, '\v(.{14}).*( \d{4}).*', '\1\2', '')
[?25l[?1c:    [?25h[?0c:endtry
[?25l[?1c:  [?25h[?0c:" lookup each items
[?25l[?1c:  [?25h[?0c:for i in range(1500)
[?25l[?1c:    [?25h[?0c: if d[i] != 3000 - i
[?25l[?1c:      [?25h[?0c:  $put =d[i]
[?25l[?1c:      [?25h[?0c: endif
[?25l[?1c:    [?25h[?0c:endfor
[?25l[?1c:  [?25h[?0c: let i += 1
[?25l[?1c:  [?25h[?0c:" delete even items
[?25l[?1c:  [?25h[?0c:while i >= 2
[?25l[?1c:    [?25h[?0c: let i -= 2
[?25l[?1c:    [?25h[?0c: unlet d[i]
[?25l[?1c:    [?25h[?0c:endwhile
[?25l[?1c:  [?25h[?0c:$put =get(d, 1500 - 100, 'NONE') . ' ' . d[1]
[?25l[?1c:  [?25h[?0c:" delete odd items, checking value, one intentionally wrong
[?25l[?1c:  [?25h[?0c:let d[33] = 999
[?25l[?1c:  [?25h[?0c:let i = 1
[?25l[?1c:  [?25h[?0c:while i < 1500
[?25l[?1c:    [?25h[?0c: if d[i] != 3000 - i
[?25l[?1c:      [?25h[?0c:  $put =i . '=' . d[i]
[?25l[?1c:      [?25h[?0c: else
[?25l[?1c:      [?25h[?0c:  unlet d[i]
[?25l[?1c:      [?25h[?0c: endif
[?25l[?1c:    [?25h[?0c: let i += 2
[?25l[?1c:    [?25h[?0c:endwhile
[?25l[?1c:  [?25h[?0c:$put =string(d)  " must be almost empty now
[?25l[?1c:  [?25h[?0c:unlet d
[?25l[?1c:  [?25h[?0c:"
[?25l[?1c:  [?25h[?0c:" Dictionary function
[?25l[?1c:  [?25h[?0c:let dict = {}
[?25l[?1c:  [?25h[?0c:func dict.func(a) dict
[?25l[?1c:    [?25h[?0c:  $put =a:a . len(self.data)
[?25l[?1c:    [?25h[?0c:endfunc
[?25l[?1c:    [?25h[?0c:let dict.data = [1,2,3]
[?25l[?1c:    [?25h[?0c:call dict.func("len: ")
[?25l[?1c:    [?25h[?0c:let x = dict.func("again: ")
[?25l[?1c:    [?25h[?0c:try
[?25l[?1c:      [?25h[?0c:  let Fn = dict.func
[?25l[?1c:      [?25h[?0c:  call Fn('xxx')
[?25l[?1c:      [?25h[?0c:catch
[?25l[?1c:      [?25h[?0c:  $put =v:exception[:15]
[?25l[?1c:      [?25h[?0c:endtry
[?25l[?1c:    [?25h[?0c:" 
[?25l[?1c:    [?25h[?0c:" Function in script-local List or Dict
[?25l[?1c:    [?25h[?0c:let g:dict = {}
[?25l[?1c:    [?25h[?0c:function g:dict.func() dict
[?25l[?1c:      [?25h[?0c:  $put ='g:dict.func'.self.foo[1].self.foo[0]('asdf')
[?25l[?1c:      [?25h[?0c:endfunc
[?25l[?1c:      [?25h[?0c:let g:dict.foo = ['-', 2, 3]
[?25l[?1c:      [?25h[?0c:call insert(g:dict.foo, function('strlen'))
[?25l[?1c:      [?25h[?0c:call g:dict.func()
[?25l[?1c:      [?25h[?0c:" 
[?25l[?1c:      [?25h[?0c:" Nasty: remove func from Dict that's being called (works)
[?25l[?1c:      [?25h[?0c:let d = {1:1}
[?25l[?1c:      [?25h[?0c:func d.func(a)
[?25l[?1c:[8C[?25h[?0c:  return "a:". a:a
[?25l[?1c:[8C[?25h[?0c:endfunc
[?25l[?1c:[8C[?25h[?0c:$put =d.func(string(remove(d, 'func')))
[?25l[?1c:[8C[?25h[?0c:"
[?25l[?1c:[8C[?25h[?0c:" Nasty: deepcopy() dict that refers to itself (fails when noref used
[24;80H)[25;1H
[?25l[?1c:[8C[?25h[?0c:let d = {1:1, 2:2}
[?25l[?1c:[8C[?25h[?0c:let l = [4, d, 6]
[?25l[?1c:[8C[?25h[?0c:let d[3] = l
[?25l[?1c:[8C[?25h[?0c:let dc = deepcopy(d)
[?25l[?1c:[8C[?25h[?0c:try
[?25l[?1c:[10C[?25h[?0c:  let dc = deepcopy(d, 1)
[?25l[?1c:[10C[?25h[?0c:catch
[?25l[?1c:[10C[?25h[?0c:  $put =v:exception[:14]
[?25l[?1c:[10C[?25h[?0c:endtry
[?25l[?1c:[8C[?25h[?0c:let l2 = [0, l, l, 3]
[?25l[?1c:[8C[?25h[?0c:let l[1] = l2
[?25l[?1c:[8C[?25h[?0c:let l3 = deepcopy(l2)
[?25l[?1c:[8C[?25h[?0c:$put ='same list: ' . (l3[1] is l3[2])
[?25l[?1c:[8C[?25h[?0c:"
[?25l[?1c:[8C[?25h[?0c:" Locked variables
[?25l[?1c:[8C[?25h[?0c:for depth in range(5)
[?25l[?1c:[10C[?25h[?0c:  $put ='depth is ' . depth
[?25l[?1c:[10C[?25h[?0c:  for u in range(3)
[?25l[?1c:[12C[?25h[?0c:    unlet l
[?25l[?1c:[12C[?25h[?0c:    let l = [0, [1, [2, 3]], {4: 5, 6: {7: 8}}]
[?25l[?1c:[12C[?25h[?0c:    exe "lockvar " . depth . " l"
[?25l[?1c:[12C[?25h[?0c:    if u == 1
[?25l[?1c:[14C[?25h[?0c:      exe "unlockvar l"
[?25l[?1c:[14C[?25h[?0c:    elseif u == 2
[?25l[?1c:[14C[?25h[?0c:      exe "unlockvar " . depth . " l"
[?25l[?1c:[14C[?25h[?0c:    endif
[?25l[?1c:[12C[?25h[?0c:    let ps = islocked("l").islocked("l[1]").islocked("l[1][1]").i
[24;80Hs[25;1Hlocked("l[1][1][0]").'-'.islocked("l[2]").islocked("l[2]['6']").islocked("l[2][
[24;80H'[25;1H6'][7]")
[?25l[?1c:[12C[?25h[?0c:    $put =ps
[?25l[?1c:[12C[?25h[?0c:    let ps = ''
[?25l[?1c:[12C[?25h[?0c:    try
[?25l[?1c:[14C[?25h[?0c:      let l[1][1][0] = 99
[?25l[?1c:[14C[?25h[?0c:      let ps .= 'p'
[?25l[?1c:[14C[?25h[?0c:    catch
[?25l[?1c:[14C[?25h[?0c:      let ps .= 'F'
[?25l[?1c:[14C[?25h[?0c:    endtry
[?25l[?1c:[12C[?25h[?0c:    try
[?25l[?1c:[14C[?25h[?0c:      let l[1][1] = [99]
[?25l[?1c:[14C[?25h[?0c:      let ps .= 'p'
[?25l[?1c:[14C[?25h[?0c:    catch
[?25l[?1c:[14C[?25h[?0c:      let ps .= 'F'
[?25l[?1c:[14C[?25h[?0c:    endtry
[?25l[?1c:[12C[?25h[?0c:    try
[?25l[?1c:[14C[?25h[?0c:      let l[1] = [99]
[?25l[?1c:[14C[?25h[?0c:      let ps .= 'p'
[?25l[?1c:[14C[?25h[?0c:    catch
[?25l[?1c:[14C[?25h[?0c:      let ps .= 'F'
[?25l[?1c:[14C[?25h[?0c:    endtry
[?25l[?1c:[12C[?25h[?0c:    try
[?25l[?1c:[14C[?25h[?0c:      let l[2]['6'][7] = 99
[?25l[?1c:[14C[?25h[?0c:      let ps .= 'p'
[?25l[?1c:[14C[?25h[?0c:    catch
[?25l[?1c:[14C[?25h[?0c:      let ps .= 'F'
[?25l[?1c:[14C[?25h[?0c:    endtry
[?25l[?1c:[12C[?25h[?0c:    try
[?25l[?1c:[14C[?25h[?0c:      let l[2][6] = {99: 99}
[?25l[?1c:[14C[?25h[?0c:      let ps .= 'p'
[?25l[?1c:[14C[?25h[?0c:    catch
[?25l[?1c:[14C[?25h[?0c:      let ps .= 'F'
[?25l[?1c:[14C[?25h[?0c:    endtry
[?25l[?1c:[12C[?25h[?0c:    try
[?25l[?1c:[14C[?25h[?0c:      let l[2] = {99: 99}
[?25l[?1c:[14C[?25h[?0c:      let ps .= 'p'
[?25l[?1c:[14C[?25h[?0c:    catch
[?25l[?1c:[14C[?25h[?0c:      let ps .= 'F'
[?25l[?1c:[14C[?25h[?0c:    endtry
[?25l[?1c:[12C[?25h[?0c:    try
[?25l[?1c:[14C[?25h[?0c:      let l = [99]
[?25l[?1c:[14C[?25h[?0c:      let ps .= 'p'
[?25l[?1c:[14C[?25h[?0c:    catch
[?25l[?1c:[14C[?25h[?0c:      let ps .= 'F'
[?25l[?1c:[14C[?25h[?0c:    endtry
[?25l[?1c:[12C[?25h[?0c:    $put =ps
[?25l[?1c:[12C[?25h[?0c:  endfor
[?25l[?1c:[10C[?25h[?0c:endfor
[?25l[?1c:[8C[?25h[?0c:" :lockvar/islocked() triggering script autoloading
[?25l[?1c:[8C[?25h[?0c:set rtp+=./sautest
[?25l[?1c:[8C[?25h[?0c:lockvar g:footest#x
[?25l[?1c:[8C[?25h[?0c:unlockvar g:footest#x
[?25l[?1c:[8C[?25h[?0c:$put ='locked g:footest#x:'.islocked('g:footest#x')
[?25l[?1c:[8C[?25h[?0c:$put ='exists g:footest#x:'.exists('g:footest#x')
[?25l[?1c:[8C[?25h[?0c:$put ='g:footest#x: '.g:footest#x
[?25l[?1c:[8C[?25h[?0c:"
[?25l[?1c:[8C[?25h[?0c:" a:000 function argument
[?25l[?1c:[8C[?25h[?0c:" first the tests that should fail
[?25l[?1c:[8C[?25h[?0c:try
[?25l[?1c:[10C[?25h[?0c:  let a:000 = [1, 2]
[?25l[?1c:[10C[?25h[?0c:catch
[?25l[?1c:[10C[?25h[?0c:  $put ='caught a:000'
[?25l[?1c:[10C[?25h[?0c:endtry
[?25l[?1c:[8C[?25h[?0c:try
[?25l[?1c:[10C[?25h[?0c:  let a:000[0] = 9
[?25l[?1c:[10C[?25h[?0c:catch
[?25l[?1c:[10C[?25h[?0c:  $put ='caught a:000[0]'
[?25l[?1c:[10C[?25h[?0c:endtry
[?25l[?1c:[8C[?25h[?0c:try
[?25l[?1c:[10C[?25h[?0c:  let a:000[2] = [9, 10]
[?25l[?1c:[10C[?25h[?0c:catch
[?25l[?1c:[10C[?25h[?0c:  $put ='caught a:000[2]'
[?25l[?1c:[10C[?25h[?0c:endtry
[?25l[?1c:[8C[?25h[?0c:try
[?25l[?1c:[10C[?25h[?0c:  let a:000[3] = {9: 10}
[?25l[?1c:[10C[?25h[?0c:catch
[?25l[?1c:[10C[?25h[?0c:  $put ='caught a:000[3]'
[?25l[?1c:[10C[?25h[?0c:endtry
[?25l[?1c:[8C[?25h[?0c:" now the tests that should pass
[?25l[?1c:[8C[?25h[?0c:try
[?25l[?1c:[10C[?25h[?0c:  let a:000[2][1] = 9
[?25l[?1c:[10C[?25h[?0c:  call extend(a:000[2], [5, 6])
[?25l[?1c:[10C[?25h[?0c:  let a:000[3][5] = 8
[?25l[?1c:[10C[?25h[?0c:  let a:000[3]['a'] = 12
[?25l[?1c:[10C[?25h[?0c:  $put =string(a:000)
[?25l[?1c:[10C[?25h[?0c:catch
[?25l[?1c:[10C[?25h[?0c:  $put ='caught ' . v:exception
[?25l[?1c:[10C[?25h[?0c:endtry
[?25l[?1c:[8C[?25h[?0c:"
[?25l[?1c:[8C[?25h[?0c:" reverse(), sort(), uniq()
[?25l[?1c:[8C[?25h[?0c:let l = ['-0', 'A11', 2, 2, 'xaaa', 4, 'foo', 'foo6', 'foo', [0, 1, 2
[24;80H][25;1H, 'x8', [0, 1, 2], 1.5]
[?25l[?1c:[8C[?25h[?0c:$put =string(uniq(copy(l)))
[?25l[?1c:[8C[?25h[?0c:$put =string(reverse(l))
[?25l[?1c:[8C[?25h[?0c:$put =string(reverse(reverse(l)))
[?25l[?1c:[8C[?25h[?0c:$put =string(sort(l))
[?25l[?1c:[8C[?25h[?0c:$put =string(reverse(sort(l)))
[?25l[?1c:[8C[?25h[?0c:$put =string(sort(reverse(sort(l))))
[?25l[?1c:[8C[?25h[?0c:$put =string(uniq(sort(l)))
[?25l[?1c:[8C[?25h[?0c:"
[?25l[?1c:[8C[?25h[?0c:" splitting a string to a List
[?25l[?1c:[8C[?25h[?0c:$put =string(split('  aa  bb '))
[?25l[?1c:[8C[?25h[?0c:$put =string(split('  aa  bb  ', '\W\+', 0))
[?25l[?1c:[8C[?25h[?0c:$put =string(split('  aa  bb  ', '\W\+', 1))
[?25l[?1c:[8C[?25h[?0c:$put =string(split('  aa  bb  ', '\W', 1))
[?25l[?1c:[8C[?25h[?0c:$put =string(split(':aa::bb:', ':', 0))
[?25l[?1c:[8C[?25h[?0c:$put =string(split(':aa::bb:', ':', 1))
[?25l[?1c:[8C[?25h[?0c:$put =string(split('aa,,bb, cc,', ',\s*', 1))
[?25l[?1c:[8C[?25h[?0c:$put =string(split('abc', '\zs'))
[?25l[?1c:[8C[?25h[?0c:$put =string(split('abc', '\zs', 1))
[?25l[?1c:[8C[?25h[?0c:"
[?25l[?1c:[8C[?25h[?0c:" compare recursively linked list and dict
[?25l[?1c:[8C[?25h[?0c:let l = [1, 2, 3, 4]
[?25l[?1c:[8C[?25h[?0c:let d = {'1': 1, '2': l, '3': 3}
[?25l[?1c:[8C[?25h[?0c:let l[1] = d
[?25l[?1c:[8C[?25h[?0c:$put =(l == l)
[?25l[?1c:[8C[?25h[?0c:$put =(d == d)
[?25l[?1c:[8C[?25h[?0c:$put =(l != deepcopy(l))
[?25l[?1c:[8C[?25h[?0c:$put =(d != deepcopy(d))
[?25l[?1c:[8C[?25h[?0c:"
[?25l[?1c:[8C[?25h[?0c:" compare complex recursively linked list and dict
[?25l[?1c:[8C[?25h[?0c:let l = []
[?25l[?1c:[8C[?25h[?0c:call add(l, l)
[?25l[?1c:[8C[?25h[?0c:let dict4 = {"l": l}
[?25l[?1c:[8C[?25h[?0c:call add(dict4.l, dict4)
[?25l[?1c:[8C[?25h[?0c:let lcopy = deepcopy(l)
[?25l[?1c:[8C[?25h[?0c:let dict4copy = deepcopy(dict4)
[?25l[?1c:[8C[?25h[?0c:$put =(l == lcopy)
[?25l[?1c:[8C[?25h[?0c:$put =(dict4 == dict4copy)
[?25l[?1c:[8C[?25h[?0c:"
[?25l[?1c:[8C[?25h[?0c:" Pass the same List to extend()
[?25l[?1c:[8C[?25h[?0c:let l = [1, 2, 3, 4, 5]
[?25l[?1c:[8C[?25h[?0c:call extend(l, l)
[?25l[?1c:[8C[?25h[?0c:$put =string(l)
[?25l[?1c:[8C[?25h[?0c:"
[?25l[?1c:[8C[?25h[?0c:" Pass the same Dict to extend()
[?25l[?1c:[8C[?25h[?0c:let d = { 'a': {'b': 'B'}}
[?25l[?1c:[8C[?25h[?0c:call extend(d, d)
[?25l[?1c:[8C[?25h[?0c:$put =string(d)
[?25l[?1c:[8C[?25h[?0c:"
[?25l[?1c:[8C[?25h[?0c:" Pass the same Dict to extend() with "error"
[?25l[?1c:[8C[?25h[?0c:try
[?25l[?1c:[10C[?25h[?0c:  call extend(d, d, "error")
[?25l[?1c:[10C[?25h[?0c:catch
[?25l[?1c:[10C[?25h[?0c:  $put =v:exception[:15] . v:exception[-1:-1]
[?25l[?1c:[10C[?25h[?0c:endtry
[?25l[?1c:[8C[?25h[?0c:$put =string(d)
[?25l[?1c:[8C[?25h[?0c:endfun[27m[24m[0m[H[J[?25l[?1c[1;1H:endtry
:$put =string(d)
:endfun
:"
:call Test(1, 2, [3, 4], {5: 6})  " This may take a while
:"
:delfunc Test
:unlet dict
:call garbagecollect(1)
:"
:" test for patch 7.3.637
:let a = 'No error caught'
:try|foldopen|catch|let a = matchstr(v:exception,'^[^ ]*')|endtry
o[1m[34m^R[0m=a[1m[34m^M^[[0m:"
:lang C
:redir => a
:try|foobar|catch|let a = matchstr(v:exception,'^[^ ]*')|endtry
:redir END
o[1m[34m^R[0m=a[1m[34m^M^[[0m:"
:"
:/^start:/,$wq! test.out
ENDTEST

start:[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0c"[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall Test(1, 2, [3, 4], {5: 6})  " This may take a while[?25l[?1c[1m[37m[41mError detected while processing function Test:[0m[25;47H[K[25;1H
[1m[33mline   87:[0m
[1m[37m[41mE684: list index out of range: 1[0m
[1m[33mline  102:[0m
[1m[37m[41mE684: list index out of range: 2[0m
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[5L[1;1H[[0, 1, 2], [0, 1, 2], 4, 2, 2, 1.5, 'xaaa', 'x8', 'foo6', 'foo', 'foo', 'A11',
'-0']
['-0', 'A11', 'foo', 'foo', 'foo6', 'x8', 'xaaa', 1.5, 2, 2, 4, [0, 1, 2], [0, 1[4;1H, 2]]
['-0', 'A11', 'foo', 'foo6', 'x8', 'xaaa', 1.5, 2, 4, [0, 1, 2]]
['aa', 'bb']
['aa', 'bb'][7;13H[K[8;1H['', 'aa', 'bb', '']
['', '', 'aa', '', 'bb', '', '']
['aa', '', 'bb']
['', 'aa', '', 'bb', ''][11;25H[K[12;1H['aa', '', 'bb', 'cc', '']
['a', 'b', 'c'][13;16H[K[14;1H['', 'a', '', 'b', '', 'c', '']
1[15;2H[K[16;1H1[16;2H[K[17;1H0[17;2H[K[18;1H0[18;2H[K[19;1H1[19;2H[K[20;1H1[20;2H[K[21;1H[1, 2, 3, 4, 5, 1, 2, 3, 4, 5]
{'a': {'b': 'B'}}
Vim(call):E737: a
{'a': {'b': 'B'}}[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cdelfunc Test[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet dict[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall garbagecollect(1)[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test for patch 7.3.637[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet a = 'No error caught'[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctry|foldopen|catch|let a = matchstr(v:exception,'^[^ ]*')|endtry[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H=[?25h[?0ca[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1HVim(foldopen):E490:
[1m[34m~                                                                               [0m[25;1H[K[23;19H[?25h[?0c[?25l[?1c

:[?25h[?0c"[?25l[?1c[23;19H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clang C[?25l[?1c[23;19H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir => a[?25l[?1c[23;19H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctry|foobar|catch|let a = matchstr(v:exception,'^[^ ]*')|endtry[?25l[?1c[1m[37m[41mError detected while processing :[0m[25;34H[K[25;1H
[1m[37m[41mE492: Not an editor command: foobar|catch|let a = matchstr(v:exception,'^[^ ]*'[0m
[24;80H[1m[37m[41m)[25;1H|endtry[0m
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0credir END[?25l[?1c[1;1H[3L[1;1H['-0', 'A11', 'foo', 'foo', 'foo6', 'x8', 'xaaa', 1.5, 2, 2, 4, [0, 1, 2], [0, 1[2;1H, 2]]
['-0', 'A11', 'foo', 'foo6', 'x8', 'xaaa', 1.5, 2, 4, [0, 1, 2]][25;1H[K[23;19H[?25h[?0c[?25l[?1c

=[?25h[?0ca[?25l[?1c[1;24r[1;1H[4M[1;25r[20;1H[K[22;1HError detected while processing :
E492: Not an editor command: foobar|catch|let a = matchstr(v:exception,'^[^ ]*')[24;1H|endtry[1;24r[24;1H
[1;25r[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^start:/,$wq! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 128 lines, 2469 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test56.failed test.ok test.out X* viminfo
cp test56.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test56.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test56.in" 21 lines, 457 characters[1;1HTest for script-local function.     vim: set ft=vim :

STARTTEST
:so small.vim
:"
:set nocp viminfo+=nviminfo
:/^start:/+1,/^end:/-1w! Xtest.vim
:source Xtest.vim
_x
:$-1,$wq! test.out
ENDTEST

start:
fun <SID>DoLast()
  call append(line('$'), "last line")
endfun
fun s:DoNothing()
  call append(line('$'), "nothing line")
endfun
nnoremap <buffer> _x    :call <SID>DoNothing()<bar>call <SID>DoLast()<bar>delfun[21;1Hc <SID>DoNothing<bar>delfunc <SID>DoLast<cr>
end:
[1m[34m~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for script-local function.     vim: set ft=vim :[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 7 lines, 120 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[11;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nocp viminfo+=nviminfo[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^start:/+1,/^end:/-1w! Xtest.vim[?25l[?1c"Xtest.vim" [25;13H[K[25;13H[New] 7L, 251C written[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csource Xtest.vim[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:call <SNR>3_DoNothing()|call <SNR>3_DoLast()|delfunc <SNR>3_DoNothing|delfunc 
[24;80H<[25;1HSNR>3_DoLast[1m[32mPress ENTER or type command to continue[?25h[?0c[0m[1;1H[L[?25l[?1c[1;1HTest for script-local function.     vim: set ft=vim :[23;1Hnothing line[23;13H[K[24;1Hlast line[24;10H[K[25;1H[K[12;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c$-1,$wq! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New] 2L, 23C written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test57.failed test.ok test.out X* viminfo
cp test57.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test57.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test57.in" 500 lines, 3666 characters[1;1HTests for :sort command.     vim: set ft=vim :

STARTTEST
:so small.vim
:"
:/^t01:/+1,/^t02/-1sort
:/^t02:/+1,/^t03/-1sort n
:/^t03:/+1,/^t04/-1sort x
:/^t04:/+1,/^t05/-1sort u
:/^t05:/+1,/^t06/-1sort!
:/^t06:/+1,/^t07/-1sort! n
:/^t07:/+1,/^t08/-1sort! u
:/^t08:/+1,/^t09/-1sort o
:/^t09:/+1,/^t10/-1sort! x
:/^t10:/+1,/^t11/-1sort/./
:/^t11:/+1,/^t12/-1sort/../
:/^t12:/+1,/^t13/-1sort/../u
:/^t13:/+1,/^t14/-1sort/./n
:/^t14:/+1,/^t15/-1sort/./r
:/^t15:/+1,/^t16/-1sort/../r
:/^t16:/+1,/^t17/-1sort/./rn
:/^t17:/+1,/^t18/-1sort/\d/
:/^t18:/+1,/^t19/-1sort/\d/r
:/^t19:/+1,/^t20/-1sort/\d/n[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for :sort command.     vim: set ft=vim :[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 30 lines, 842 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[10M[1;25r[15;1H:/^t20:/+1,/^t21/-1sort/\d/rn
:/^t21:/+1,/^t22/-1sort/\d\d/
:/^t22:/+1,/^t23/-1sort/\d\d/n
:/^t23:/+1,/^t24/-1sort/\d\d/x
:/^t24:/+1,/^t25/-1sort/\d\d/r
:/^t25:/+1,/^t26/-1sort/\d\d/rn
:/^t26:/+1,/^t27/-1sort/\d\d/rx
:/^t27:/+1,/^t28/-1sort no
:/^t01:/,$wq! test.out
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^t01:/+1,/^t02/-1sort[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Ht01: alphebetical[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c/^t02:/+1,/^t03/-1sort n[?25l[?1c[27m[24m[0m[H[J[1;1Ha321
ab
abc
b123
b321
b321
b321b
b322b
c123d
c321d
t02: numeric
abc
ab
a[18;1H-24
x-22
0
a122
a123
b123
c123d[12;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c/^t03:/+1,/^t04/-1sort x[?25l[?1c[1;24r[1;1H[9M[1;25r[16;2H123b
a321
b321
c321d
b321
b321b
b322b
t03: hexadecimal[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c/^t04:/+1,/^t05/-1sort u[?25l[?1c[27m[24m[0m[H[J[1;1Ha122
a123
a321
b123
b321
b321
b321b
b322b
c123d
c321d
t04: alpha, unique

 123b
a
a122
a123
a321
ab
abc
b123
b321
b321b
b322b
c123d[12;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c/^t05:/+1,/^t06/-1sort![?25l[?1c[1;24r[1;1H[3M[1;25r[22;1Hc321d
t05: alpha, reverse
c321d[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c/^t06:/+1,/^t07/-1sort! n        [?25l[?1c[27m[24m[0m[H[J[1;1Hb123
abc
ab
a321
a123
a122
a
 123b


t06: numeric, reverse
b322b
b321b
b321
c321d
b321
a321
 123b
c123d
b123
a123
a122[12;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c/^t07:/+1,/^t08/-1sort! u[?25l[?1c[1;24r[1;1H[5M[1;25r[20;1Ha
ab
abc
t07: unique, reverse
c321d[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c/^t08:/+1,/^t09/-1sort o         [?25l[?1c[27m[24m[0m[H[J[1;1Hb321
b123
abc
ab
a321
a123
a122
a
 123b

t08: octal
abc
ab
a


a122
a123
b123
c123d
 123b
a321
b321
c321d[12;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c/^t09:/+1,/^t10/-1sort! x        [?25l[?1c[1;24r[1;1H[5M[1;25r[20;1Hb321
b321b
b322b
t09: reverse, hexadecimal
c321d[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c/^t10:/+1,/^t11/-1sort/./        [?25l[?1c[27m[24m[0m[H[J[1;1Hb123
a321
a123
a122
 123b
abc
ab
a


t10: alpha, skip first character
a


a122
a123
b123
 123b
c123d
a321
b321
b321
b321b
c321d[12;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c/^t11:/+1,/^t12/-1sort/../       [?25l[?1c[1;24r[1;1H[5M[1;25r[20;1Hb322b
ab
abc
t11: alpha, skip first 2 characters
ab[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c/^t12:/+1,/^t13/-1sort/../u[?25l[?1c[27m[24m[0m[H[J[1;1Hb321
b321b
c321d
a122
b322b
a123
b123
 123b
c123d
abc
t12: alpha, unique, skip first 2 characters
ab
a

a321
b321
b321b
c321d
a122
b322b
a123
b123
 123b
c123d[12;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c/^t13:/+1,/^t14/-1sort/./n[?25l[?1c[1;24r[1;1H[3M[1;25r[22;1Habc
t13: numeric, skip first character
abc[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c/^t14:/+1,/^t15/-1sort/./r[?25l[?1c[27m[24m[0m[H[J[1;1Ha123
b123
c123d
 123b
a321
b321
c321d
b321
b321b
b322b
t14: alpha, sort on first character[14;2H123b
abc
ab
a
a321
a123
a122
b321
b123
b322b
b321[12;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c/^t15:/+1,/^t16/-1sort/../r[?25l[?1c[1;24r[1;1H[5M[1;25r[20;1Hb321b
c123d
c321d
t15: alpha, sort on first 2 characters
a[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c/^t16:/+1,/^t17/-1sort/./rn[?25l[?1c[27m[24m[0m[H[J[1;1Ha321
abc
ab
b123
b321
b322b
b321
b321b
c123d
c321d
t16: numeric, sort on first character
abc
ab
a
a321
a123
a122
b321
b123
c123d
 123b
c321d
b322b
b321[12;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c/^t17:/+1,/^t18/-1sort/\d/[?25l[?1c[1;24r[1;1H[5M[1;25r[20;1Hb321b


t17: alpha, skip past first digit
abc[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c/^t18:/+1,/^t19/-1sort/\d/r[?25l[?1c[27m[24m[0m[H[J[1;1Hb321
b321
b321b
c321d
a122
b322b
a123
b123
 123b
c123d
t18: alpha, sort on first digit
abc
ab
a


a123
a122
b123
c123d
 123b
a321
b321
c321d[12;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c/^t19:/+1,/^t20/-1sort/\d/n[?25l[?1c[1;24r[1;1H[5M[1;25r[20;1Hb322b
b321
b321b
t19: numeric, skip past first digit
abc[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c/^t20:/+1,/^t21/-1sort/\d/rn[?25l[?1c[27m[24m[0m[H[J[1;1Hb321
c321d
b321
b321b
a122
b322b
a123
b123
c123d
 123b
t20: numeric, sort on first digit
abc
ab
a


a123
a122
b123
c123d
 123b
a321
b321
c321d[12;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c/^t21:/+1,/^t22/-1sort/\d\d/[?25l[?1c[1;24r[1;1H[5M[1;25r[20;1Hb322b
b321
b321b
t21: alpha, skip past first 2 digits
abc[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c/^t22:/+1,/^t23/-1sort/\d\d/n[?25l[?1c[27m[24m[0m[H[J[1;1Hb321
b321
b321b
c321d
a122
b322b
a123
b123
 123b
c123d
t22: numeric, skip past first 2 digits
abc
ab
a


a321
b321
c321d
b321
b321b
a122
b322b
a123[12;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c/^t23:/+1,/^t24/-1sort/\d\d/x[?25l[?1c[1;24r[1;1H[5M[1;25r[20;1Hb123
c123d
 123b
t23: hexadecimal, skip past first 2 digits
abc[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c/^t24:/+1,/^t25/-1sort/\d\d/r[?25l[?1c[27m[24m[0m[H[J[1;1Hb321
b321
a122
a123
b123
b321b
c321d
b322b
 123b
c123d
t24: alpha, sort on first 2 digits
abc
ab
a


a123
a122
b123
c123d
 123b
a321
b321
c321d[12;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c/^t25:/+1,/^t26/-1sort/\d\d/rn[?25l[?1c[1;24r[1;1H[5M[1;25r[20;1Hb322b
b321
b321b
t25: numeric, sort on first 2 digits
abc[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c/^t26:/+1,/^t27/-1sort/\d\d/rx[?25l[?1c[27m[24m[0m[H[J[1;1Ha122
b123
c123d
 123b
a321
b321
c321d
b322b
b321
b321b
t26: hexadecimal, sort on first 2 digits
abc
ab
a


a123
a122
b123
c123d
 123b
a321
b321
c321d[12;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c/^t27:/+1,/^t28/-1sort no[?25l[?1c[1m[37m[41mE474: Invalid argument[0m[25;23H[K[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^t01:/,$wq! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 459 lines, 2739 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test58.failed test.ok test.out X* viminfo
cp test58.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test58.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test58.in" 639 lines, 10884 characters[1;1HTests for spell checking.     vim: set ft=vim :

STARTTEST
:so small.vim
:"
:" Don't want to depend on the locale from the environment
:set enc=latin1
:e!
:"
:" Check using z= in new buffer (crash fixed by patch 7.4a.028).
:set maxmem=512 spell
iasd[1m[34m^[[0mz=:"
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest
  " use that spell file
  set spl=Xtest.latin1.spl spell[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for spell checking.     vim: set ft=vim :[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 109 lines, 2556 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:call TestOne('6', '6')
:call TestOne('7', '7')
:"
:" NOSLITSUGS
:call TestOne('8', '8')
:"
:" clean up for valgrind
:delfunc TestOne
:set spl= enc=latin1
:"
gg:/^test output:/,$wq! test.out
ENDTEST

1affstart
SET ISO8859-1
TRY esianrtolcdugmphbyfvkwjkqxz-'ESIANRTOLCDUGMPHBYFVKWJKQXZ

FOL  
LOW  
UPP  

SOFOFROM abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ[23;1H޿
SOFOTO   ebctefghejklnnepkrstevvkesebctefghejklnnepkrstevvkeseeeeeeeceeeeeeeedne[24;1H[1m[34m@                                                                               [12;1H[?25h[?0c
[?25l[?1c[25;1H[0m:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Don't want to depend on the locale from the environment[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset enc=latin1[?25l[?1c[27m[24m[0m[H[J[1;1H:call TestOne('6', '6')
:call TestOne('7', '7')
:"
:" NOSLITSUGS
:call TestOne('8', '8')
:"
:" clean up for valgrind
:delfunc TestOne
:set spl= enc=latin1
:"
gg:/^test output:/,$wq! test.out
ENDTEST

1affstart
SET ISO8859-1
TRY esianrtolcdugmphbyfvkwjkqxz-'ESIANRTOLCDUGMPHBYFVKWJKQXZ

FOL  
LOW  
UPP  

SOFOFROM abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ[23;1H޿
SOFOTO   ebctefghejklnnepkrstevvkesebctefghejklnnepkrstevvkeseeeeeeeceeeeeeeedne[24;1H[1m[34m@                                                                               [13;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0ce![?25l[?1c"test58.in" 639 lines, 10884 characters[1;1HTests for spell checking.     vim: set ft=vim :[2;1H[K[3;1HSTARTTEST
:so small.vim
:"[5;3H[K[6;4HDon't want to depend on the locale from the environment
:set enc=latin1[7;17H[K[8;2He![8;4H[K[9;2H"[9;3H[K[10;4HCheck using z= in new buffer (crash fixed by patch 7.4a.028).
:set maxmem=512 spell[11;22H[K[12;1Hiasd[1m[34m^[[0mz=:"
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=[16;17H[K[17;3H$put =''
  $put ='test '. a:aff . '-' . a:dic[18;37H[K[19;1H  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest[22;23H[K[23;1H  " use that spell file[23;24H[K[24;1H  set spl=Xtest.latin1.spl spell[24;33H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Check using z= in new buffer (crash fixed by patch 7.4a.028).[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset maxmem=512 spell[?25l[?1c[1;31H[44mvim[0m[9C[45mvim[0m

[41mSTARTTEST[0m[4;11H[45mvim[0m[7;10H[41mlatin1
[0m:[41me[10;16Hz[11;6Hmaxmem
iasd[2Cz[14;22Haff[0m/.[41mdic
[0m:[41mfunc[0m [41mTestOne[0m([41maff[0m, [41mdic[16;7Hspellfile[0m[18;18H[44ma[0m:[41maff[0m[9C[44ma[0m:[41mdic[19;17Hspl[14Cdic[0m and .[41maff
[0m  [41mexe[0m[10C[44ma[0m:[41maff[0m . '[41maffstart[0m[10C[44ma[0m:[41maff[0m . '[41maffend[0m/-1[41mw[0m! [41mXtest[0m.[41maff
[0m  [41mexe[0m[10C[44ma[0m:[41mdic[0m . '[41mdicstart[0m[10C[44ma[0m:[41mdic[0m . '[41mdicend[0m/-1[41mw[0m! [41mXtest[0m.[41mdic
[0m  [41mmkspell[0m! [41mXtest[0m [41mXtest[24;7Hspl[0m=[41mXtest[0m.[41mlatin1[0m.[41mspl[1;1H[?25h[?0c[?25l[?1casdTests[0m for spell checking.     [44mvim[0m: set ft=[45mvim[0m :[1;3H[?25h[?0c[?25l[?1c[25;1HChange "asdTests" to:
 1 "Acid tests"
 2 "Attests"
 3 "Ass Tests"
 4 "Asa Tests"
 5 "Ase Tests"
 6 "As Tests"
 7 "Sad Tests"
 8 "Ads Tests"
 9 "As tests"
10 "As detests"
11 "Add Tests"
12 "Aid Tests"
13 "Ash Tests"
14 "Ad Tests"
15 "And Tests"
16 "Ask Tests"
17 "Asp Tests"
18 "USD Tests"
19 "Astutest"
20 "Sadists"
21 "Asst Tests"
22 "Assad Tests"
23 "Detests"
Type number and <Enter> or click with mouse (empty cancels): [?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[27m[24m[0m[H[J[1;1H[41masdTests[0m for spell checking.     [44mvim[0m: set ft=[45mvim[0m :

[41mSTARTTEST[0m
:so small.[45mvim[0m
:"
:" Don't want to depend on the locale from the environment
:set enc=[41mlatin1[0m
:[41me[0m!
:"
:" Check using [41mz[0m= in new buffer (crash fixed by patch 7.4a.028).
:set [41mmaxmem[0m=512 spell
[41miasd[0m[1m[34m^[[0m[41mz[0m=:"
:"
:" Function to test .[41maff[0m/.[41mdic[0m with list of good and bad words.
:[41mfunc[0m [41mTestOne[0m([41maff[0m, [41mdic[0m)
  set [41mspellfile[0m=
  $put =''
  $put ='test '. [44ma[0m:[41maff[0m . '-' . [44ma[0m:[41mdic[0m
  " Generate a .[41mspl[0m file from a .[41mdic[0m and .[41maff[0m file.
  [41mexe[0m '1;/^' . [44ma[0m:[41maff[0m . '[41maffstart[0m/+1,/^' . [44ma[0m:[41maff[0m . '[41maffend[0m/-1[41mw[0m! [41mXtest[0m.[41maff[0m'
  [41mexe[0m '1;/^' . [44ma[0m:[41mdic[0m . '[41mdicstart[0m/+1,/^' . [44ma[0m:[41mdic[0m . '[41mdicend[0m/-1[41mw[0m! [41mXtest[0m.[41mdic[0m'
  [41mmkspell[0m! [41mXtest[0m [41mXtest[0m
  " use that spell file
  set [41mspl[0m=[41mXtest[0m.[41mlatin1[0m.[41mspl[0m spell[1;3H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c"[?25l[?1c[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Function to test .aff/.dic with list of good and bad words.[?25l[?1c[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunc TestOne(aff, dic)[?25l[?1c
:  [?25h[?0c  set spellfile=
[?25l[?1c:  [?25h[?0c  $put =''
[?25l[?1c:  [?25h[?0c  $put ='test '. a:aff . '-' . a:dic
[?25l[?1c:  [?25h[?0c  " Generate a .spl file from a .dic and .aff file.
[?25l[?1c:  [?25h[?0c  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
[?25l[?1c:  [?25h[?0c  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
[?25l[?1c:  [?25h[?0c  mkspell! Xtest Xtest
[?25l[?1c:  [?25h[?0c  " use that spell file
[?25l[?1c:  [?25h[?0c  set spl=Xtest.latin1.spl spell
[?25l[?1c:  [?25h[?0c  " list all valid words
[?25l[?1c:  [?25h[?0c  spelldump
[?25l[?1c:  [?25h[?0c  %yank
[?25l[?1c:  [?25h[?0c  quit
[?25l[?1c:  [?25h[?0c  $put
[?25l[?1c:  [?25h[?0c  $put ='-------'
[?25l[?1c:  [?25h[?0c  " find all bad words and suggestions for them
[?25l[?1c:  [?25h[?0c  exe '1;/^' . a:aff . 'good:'
[?25l[?1c:  [?25h[?0c  normal 0f:]s
[?25l[?1c:  [?25h[?0c  let prevbad = ''
[?25l[?1c:  [?25h[?0c  while 1
[?25l[?1c:    [?25h[?0c    let [bad, a] = spellbadword()
[?25l[?1c:    [?25h[?0c    if bad == '' || bad == prevbad || bad == 'badend'
[?25l[?1c:      [?25h[?0c      break
[?25l[?1c:      [?25h[?0c    endif
[?25l[?1c:    [?25h[?0c    let prevbad = bad
[?25l[?1c:    [?25h[?0c    let lst = spellsuggest(bad, 3)
[?25l[?1c:    [?25h[?0c    normal mm
[?25l[?1c:    [?25h[?0c    $put =bad
[?25l[?1c:    [?25h[?0c    $put =string(lst)
[?25l[?1c:    [?25h[?0c    normal `m]s
[?25l[?1c:    [?25h[?0c  endwhile
[?25l[?1c:  [?25h[?0cendfunc[27m[24m[0m[H[J[?25l[?1c[1;1H[41masdTests[0m for spell checking.     [44mvim[0m: set ft=[45mvim[0m :

[41mSTARTTEST[0m
:so small.[45mvim[0m
:"
:" Don't want to depend on the locale from the environment
:set enc=[41mlatin1[0m
:[41me[0m!
:"
:" Check using [41mz[0m= in new buffer (crash fixed by patch 7.4a.028).
:set [41mmaxmem[0m=512 spell
[41miasd[0m[1m[34m^[[0m[41mz[0m=:"
:"
:" Function to test .[41maff[0m/.[41mdic[0m with list of good and bad words.
:[41mfunc[0m [41mTestOne[0m([41maff[0m, [41mdic[0m)
  set [41mspellfile[0m=
  $put =''
  $put ='test '. [44ma[0m:[41maff[0m . '-' . [44ma[0m:[41mdic[0m
  " Generate a .[41mspl[0m file from a .[41mdic[0m and .[41maff[0m file.
  [41mexe[0m '1;/^' . [44ma[0m:[41maff[0m . '[41maffstart[0m/+1,/^' . [44ma[0m:[41maff[0m . '[41maffend[0m/-1[41mw[0m! [41mXtest[0m.[41maff[0m'
  [41mexe[0m '1;/^' . [44ma[0m:[41mdic[0m . '[41mdicstart[0m/+1,/^' . [44ma[0m:[41mdic[0m . '[41mdicend[0m/-1[41mw[0m! [41mXtest[0m.[41mdic[0m'
  [41mmkspell[0m! [41mXtest[0m [41mXtest[0m
  " use that spell file
  set [41mspl[0m=[41mXtest[0m.[41mlatin1[0m.[41mspl[0m spell[1;3H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c"[?25l[?1c[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall TestOne('1', '1')[?25l[?1c"Xtest.aff" [25;13H[K[25;13H[New File] 46 lines, 754 characters written
"Xtest.dic" [New File] 11 lines, 71 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[25;26H[K[25;1H
Compressed 29 of 127 nodes; 98 (77%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 490 bytes
Reading back spell file...
Performing soundfolding...
Total number of words: 16
Number of words after soundfolding: 16
Compressing word tree...
Compressed 39 of 104 nodes; 65 (62%) remaining
Writing suggestion file Xtest.latin1.sug ...
Estimated runtime memory use: 357 bytes
17 lines yanked
17 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c$put =soundfold('goobledygoook')[?25l[?1c[1;1H[19L[1;1Htestn
the end
uk
wrong
-------
[41mbad[0m
['put', 'uk', 'OK']
[41minputs[0m
['input', 'puts', 'outputs']
[41mcomment[0m
['Comment', 'outtest', 'the end']
[41mok[0m
['OK', 'uk', 'put']
[41mOk[0m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[0m
['deol', 'dr', 'test']
[41mend[0m[20;4H[K[21;1H['put', 'uk', 'test'][21;22H[K[22;1H[41mthe[0m[22;4H[K[23;1H['put', 'uk', 'test'][23;22H[K[24;1H[41mgebletegek[0m[24;11H[K[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =soundfold('koprnven')[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[41mkepereneven[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =soundfold('oeverloos gezwets edale')[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[41meverles[0m [41mgesvets[0m [41metele[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" and now with SAL instead of SOFO items; test automatic reloading[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1H[41masdTests[0m [41mfor[0m [41mspell[0m [41mchecking[0m.     [41mvim[0m: [41mset[0m [41mft[0m=[41mvim[0m :

[41mSTARTTEST[0m
:[41mso[0m [41msmall[0m.[41mvim[0m
:"
:" [41mDon't[0m [41mwant[0m [41mto[0m [41mdepend[0m [41mon[0m [41mthe[0m [41mlocale[0m [41mfrom[0m [41mthe[0m [41menvironment[0m
:[41mset[0m [41menc[0m=[41mlatin1[0m
:[41me[0m!
:"
:" [41mCheck[0m [41musing[0m [41mz[0m= [41min[0m [41mnew[0m [41mbuffer[0m ([41mcrash[0m [41mfixed[0m [41mby[0m [41mpatch[0m 7.4[41ma[0m.028).
:[41mset[0m [41mmaxmem[0m=512 [41mspell
iasd[0m[1m[34m^[[0m[41mz[0m=:"
:"
:" [41mFunction[0m [41mto[0m test .[41maff[0m/.[41mdic[0m [41mwith[0m [41mlist[0m [41mof[0m [41mgood[0m [41mand[0m [41mbad[0m [41mwords[0m.
:[41mfunc[0m [41mTestOne[0m([41maff[0m, [41mdic[0m)
  [41mset[0m [41mspellfile[0m=
  $put =''
  $put ='test '. [41ma[0m:[41maff[0m . '-' . [41ma[0m:[41mdic[0m
  " [41mGenerate[0m [41ma[0m .[41mspl[0m [41mfile[0m [41mfrom[0m [41ma[0m .[41mdic[0m [41mand[0m .[41maff[0m [41mfile[0m.
  [41mexe[0m '1;/^' . [41ma[0m:[41maff[0m . '[41maffstart[0m/+1,/^' . [41ma[0m:[41maff[0m . '[41maffend[0m/-1[41mw[0m! [41mXtest[0m.[41maff[0m'
  [41mexe[0m '1;/^' . [41ma[0m:[41mdic[0m . '[41mdicstart[0m/+1,/^' . [41ma[0m:[41mdic[0m . '[41mdicend[0m/-1[41mw[0m! [41mXtest[0m.[41mdic[0m'
  [41mmkspell[0m! [41mXtest[0m [41mXtest[0m
  " [41muse[0m [41mthat[0m [41mspell[0m [41mfile
[0m  [41mset[0m [41mspl[0m=[41mXtest[0m.[41mlatin1[0m.[41mspl[0m [41mspell[1;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0c/^affstart_sal/+1,/^affend_sal/-1w! Xtest.aff[?25l[?1c"Xtest.aff" [25;13H[K[25;13H151 lines, 3412 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmkspell! Xtest Xtest[?25l[?1cReading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[25;26H[K[25;1H
Compressed 29 of 127 nodes; 98 (77%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 490 bytes
Performing soundfolding...
Total number of words: 16
Number of words after soundfolding: 15
Compressing word tree...
Compressed 33 of 75 nodes; 42 (56%) remaining
Writing suggestion file Xtest.latin1.sug ...
Estimated runtime memory use: 241 bytes
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c$put =soundfold('goobledygoook')[?25l[?1c[1;1H[14L[1;1Hwrong
-------
[41mbad[0m
['put', 'uk', 'OK']
[41minputs[0m
['input', 'puts', 'outputs']
[41mcomment[0m
['Comment', 'outtest', 'the end']
[41mok[0m
['OK', 'uk', 'put']
[41mOk[0m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[0m[15;5H[K[16;1H['deol', 'dr', 'test']
[41mend[0m[17;4H[K[18;1H['put', 'uk', 'test'][18;22H[K[19;1H[41mthe[0m[19;5H[K[20;1H['put', 'uk', 'test'][20;22H[K[21;1H[41mgebletegek[0m[21;11H[K[22;1H[41mkepereneven[0m[22;12H[K[23;1H[41meverles[0m [41mgesvets[0m [41metele[0m[23;22H[K[24;1H[41mkbltykk[0m[24;8H[K[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =soundfold('koprnven')[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[41mkprnfn[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =soundfold('oeverloos gezwets edale')[?25l[?1c[1;24r[24;1H
[1;25r[24;1H*[41mfls[0m [41mkswts[0m [41mtl[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" also use an addition file[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1H[41masdTests[0m [41mfor[0m [41mspell[0m [41mchecking[0m.     [41mvim[0m: [41mset[0m [41mft[0m=[41mvim[0m :

[41mSTARTTEST[0m
:[41mso[0m [41msmall[0m.[41mvim[0m
:"
:" [41mDon't[0m [41mwant[0m [41mto[0m [41mdepend[0m [41mon[0m [41mthe[0m [41mlocale[0m [41mfrom[0m [41mthe[0m [41menvironment[0m
:[41mset[0m [41menc[0m=[41mlatin1[0m
:[41me[0m!
:"
:" [41mCheck[0m [41musing[0m [41mz[0m= [41min[0m [41mnew[0m [41mbuffer[0m ([41mcrash[0m [41mfixed[0m [41mby[0m [41mpatch[0m 7.4[41ma[0m.028).
:[41mset[0m [41mmaxmem[0m=512 [41mspell
iasd[0m[1m[34m^[[0m[41mz[0m=:"
:"
:" [41mFunction[0m [41mto[0m test .[41maff[0m/.[41mdic[0m [41mwith[0m [41mlist[0m [41mof[0m [41mgood[0m [41mand[0m [41mbad[0m [41mwords[0m.
:[41mfunc[0m [41mTestOne[0m([41maff[0m, [41mdic[0m)
  [41mset[0m [41mspellfile[0m=
  $put =''
  $put ='test '. [41ma[0m:[41maff[0m . '-' . [41ma[0m:[41mdic[0m
  " [41mGenerate[0m [41ma[0m .[41mspl[0m [41mfile[0m [41mfrom[0m [41ma[0m .[41mdic[0m [41mand[0m .[41maff[0m [41mfile[0m.
  [41mexe[0m '1;/^' . [41ma[0m:[41maff[0m . '[41maffstart[0m/+1,/^' . [41ma[0m:[41maff[0m . '[41maffend[0m/-1[41mw[0m! [41mXtest[0m.[41maff[0m'
  [41mexe[0m '1;/^' . [41ma[0m:[41mdic[0m . '[41mdicstart[0m/+1,/^' . [41ma[0m:[41mdic[0m . '[41mdicend[0m/-1[41mw[0m! [41mXtest[0m.[41mdic[0m'
  [41mmkspell[0m! [41mXtest[0m [41mXtest[0m
  " [41muse[0m [41mthat[0m [41mspell[0m [41mfile
[0m  [41mset[0m [41mspl[0m=[41mXtest[0m.[41mlatin1[0m.[41mspl[0m [41mspell[1;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0c/^addstart/+1,/^addend/-1w! Xtest.latin1.add[?25l[?1c"Xtest.latin1.add" [25;20H[K[25;20H[New File] 3 lines, 38 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmkspell! Xtest.latin1.add.spl Xtest.latin1.add[?25l[?1cReading word file Xtest.latin1.add ...[25;39H[K[25;1H
Compressing word tree...
Compressed 0 of 29 nodes; 29 (100%) remaining
Writing spell file Xtest.latin1.add.spl ...
Done!
Estimated runtime memory use: 145 bytes
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset spellfile=Xtest.latin1.add[?25l[?1c[1;1H[6L[1;1H[41masdTests[0m [41mfor[0m [41mspell[0m [41mchecking[0m.     [41mvim[0m: [41mset[0m [41mft[0m=[41mvim[0m :

[41mSTARTTEST[0m
:[41mso[0m [41msmall[0m.[41mvim[0m
:"
:" [41mDon't[0m [41mwant[0m [41mto[0m [41mdepend[0m [41mon[0m [41mthe[0m [41mlocale[0m [41mfrom[0m [41mthe[0m [41menvironment[0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/[?25h[?0c^test2:[?25l[?1c[27m[24m[0m[H[J[2;1H2[41mgood[0m: puts
[41mbad[0m: [41minputs[0m [41mcomment[0m [41mok[0m [41mOk[0m [41mend[0m [41mthe[0m. [44mtest[0m [41mdl
badend

addstart[0m
/[41mregions[0m=[41musgbnz[0m
elequint/2
elekwint/3
[41maddend

test2[0m:
elequint test elekwint test [41melekwent[0m [41masdf[0m

Test [41mrules[0m [41mfor[0m [41mcompounding[0m.

3[41maffstart
SET[0m [41mISO8859-1

COMPOUNDMIN[0m 3
[41mCOMPOUNDRULE[0m [41mm[0m*
[41mNEEDCOMPOUND[0m [41mx[0m
3[41maffend[12;1H[?25h[?0c[13;29H[?25l[?1c[25;1H[0m:[?25h[?0clet [str, a] = spellbadword()[?25l[?1c[13;29H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =str[?25l[?1c[27m[24m[0m[H[J[1;1H['put', 'uk', 'OK']
[41minputs[0m
['input', 'puts', 'outputs']
[41mcomment[0m
['Comment', 'outtest', 'the end']
[41mok[0m
['OK', 'uk', 'put']
[41mOk[0m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[0m
['deol', 'dr', 'test']
[41mend[0m
['put', 'uk', 'test']
[41mthe[0m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[0m [41mgesvets[0m [41metele
kbltykk
kprnfn[0m
*[41mfls[0m [41mkswts[0m [41mtl
elekwent[?25h[?0c[?25l[?1c
[0m:[?25h[?0cset spl=Xtest_us.latin1.spl[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^test2:[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[2;1H2[41mgood[0m: puts
[41mbad[0m: [41minputs[0m [41mcomment[0m [41mok[0m [41mOk[0m [41mend[0m [41mthe[0m. [44mtest[0m [41mdl
badend

addstart[0m
/[41mregions[0m=[41musgbnz[0m
[46melequint[0m/2
[46melekwint[0m/3
[41maddend

test2[0m:
[46melequint[0m test [46melekwint[0m test [41melekwent[0m [41masdf[0m

Test [41mrules[0m [41mfor[0m [41mcompounding[0m.

3[41maffstart
SET[0m [41mISO8859-1

COMPOUNDMIN[0m 3
[41mCOMPOUNDRULE[0m [41mm[0m*
[41mNEEDCOMPOUND[0m [41mx[0m
3[41maffend[0m

[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c
[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet [str, a] = spellbadword()[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =str[?25l[?1c[27m[24m[0m[H[J[1;1H[41minputs[0m
['input', 'puts', 'outputs']
[41mcomment[0m
['Comment', 'outtest', 'the end']
[41mok[0m
['OK', 'uk', 'put']
[41mOk[0m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[0m
['deol', 'dr', 'test']
[41mend[0m
['put', 'uk', 'test']
[41mthe[0m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[0m [41mgesvets[0m [41metele
kbltykk
kprnfn[0m
*[41mfls[0m [41mkswts[0m [41mtl
elekwent[0m
[46melequint[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1H2[41mgood[0m: puts
[41mbad[0m: [41minputs[0m [41mcomment[0m [41mok[0m [41mOk[0m [41mend[0m [41mthe[0m. [44mtest[0m [41mdl
badend

addstart[0m
/[41mregions[0m=[41musgbnz[0m
[46melequint[0m/2
[46melekwint[0m/3
[41maddend

test2[0m:
[46melequint[0m test [46melekwint[0m test [41melekwent[0m [41masdf[0m

Test [41mrules[0m [41mfor[0m [41mcompounding[0m.

3[41maffstart
SET[0m [41mISO8859-1

COMPOUNDMIN[0m 3
[41mCOMPOUNDRULE[0m [41mm[0m*
[41mNEEDCOMPOUND[0m [41mx[0m
3[41maffend[0m

3[41mdicstart[12;1H[?25h[?0c[14C[?25l[?1c[25;1H[0m:[?25h[?0clet [str, a] = spellbadword()[?25l[?1c[12;15H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =str[?25l[?1c[27m[24m[0m[H[J[1;1H['input', 'puts', 'outputs']
[41mcomment[0m
['Comment', 'outtest', 'the end']
[41mok[0m
['OK', 'uk', 'put']
[41mOk[0m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[0m
['deol', 'dr', 'test']
[41mend[0m
['put', 'uk', 'test']
[41mthe[0m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[0m [41mgesvets[0m [41metele
kbltykk
kprnfn[0m
*[41mfls[0m [41mkswts[0m [41mtl
elekwent[0m
[46melequint
elekwint[?25h[?0c[?25l[?1c
[0m:[?25h[?0cset spl=Xtest_gb.latin1.spl[?25l[?1c[23;1Helequint
[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^test2:[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[2;1H2[41mgood[0m: puts
[41mbad[0m: [41minputs[0m [41mcomment[0m [41mok[0m [41mOk[0m [41mend[0m [41mthe[0m. [44mtest[0m [41mdl
badend

addstart[0m
/[41mregions[0m=[41musgbnz[0m
elequint/2
[46melekwint[0m/3
[41maddend

test2[0m:
elequint test [46melekwint[0m test [41melekwent[0m [41masdf[0m

Test [41mrules[0m [41mfor[0m [41mcompounding[0m.

3[41maffstart
SET[0m [41mISO8859-1

COMPOUNDMIN[0m 3
[41mCOMPOUNDRULE[0m [41mm[0m*
[41mNEEDCOMPOUND[0m [41mx[0m
3[41maffend[0m

[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c[13;15H[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet [str, a] = spellbadword()[?25l[?1c[13;15H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =str[?25l[?1c[27m[24m[0m[H[J[1;1H[41mcomment[0m
['Comment', 'outtest', 'the end']
[41mok[0m
['OK', 'uk', 'put']
[41mOk[0m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[0m
['deol', 'dr', 'test']
[41mend[0m
['put', 'uk', 'test']
[41mthe[0m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[0m [41mgesvets[0m [41metele
kbltykk
kprnfn[0m
*[41mfls[0m [41mkswts[0m [41mtl
elekwent[0m
elequint
[46melekwint
elekwint[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1H2[41mgood[0m: puts
[41mbad[0m: [41minputs[0m [41mcomment[0m [41mok[0m [41mOk[0m [41mend[0m [41mthe[0m. [44mtest[0m [41mdl
badend

addstart[0m
/[41mregions[0m=[41musgbnz[0m
elequint/2
[46melekwint[0m/3
[41maddend

test2[0m:
elequint test [46melekwint[0m test [41melekwent[0m [41masdf[0m

Test [41mrules[0m [41mfor[0m [41mcompounding[0m.

3[41maffstart
SET[0m [41mISO8859-1

COMPOUNDMIN[0m 3
[41mCOMPOUNDRULE[0m [41mm[0m*
[41mNEEDCOMPOUND[0m [41mx[0m
3[41maffend[0m

3[41mdicstart[12;15H[?25h[?0c[14C[?25l[?1c[25;1H[0m:[?25h[?0clet [str, a] = spellbadword()[?25l[?1c[12;29H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =str[?25l[?1c[27m[24m[0m[H[J[1;1H['Comment', 'outtest', 'the end']
[41mok[0m
['OK', 'uk', 'put']
[41mOk[0m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[0m
['deol', 'dr', 'test']
[41mend[0m
['put', 'uk', 'test']
[41mthe[0m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[0m [41mgesvets[0m [41metele
kbltykk
kprnfn[0m
*[41mfls[0m [41mkswts[0m [41mtl
elekwent[0m
elequint
[46melekwint
elekwint[0m
[41melekwent[?25h[?0c[?25l[?1c
[0m:[?25h[?0cset spl=Xtest_nz.latin1.spl[?25l[?1c[21;1H[46melequint[0m
elekwint
elekwint
[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^test2:[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[2;1H2[41mgood[0m: puts
[41mbad[0m: [41minputs[0m [41mcomment[0m [41mok[0m [41mOk[0m [41mend[0m [41mthe[0m. [44mtest[0m [41mdl
badend

addstart[0m
/[41mregions[0m=[41musgbnz[0m
[46melequint[0m/2
elekwint/3
[41maddend

test2[0m:
[46melequint[0m test elekwint test [41melekwent[0m [41masdf[0m

Test [41mrules[0m [41mfor[0m [41mcompounding[0m.

3[41maffstart
SET[0m [41mISO8859-1

COMPOUNDMIN[0m 3
[41mCOMPOUNDRULE[0m [41mm[0m*
[41mNEEDCOMPOUND[0m [41mx[0m
3[41maffend[0m

[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c
[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet [str, a] = spellbadword()[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =str[?25l[?1c[27m[24m[0m[H[J[1;1H[41mok[0m
['OK', 'uk', 'put']
[41mOk[0m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[0m
['deol', 'dr', 'test']
[41mend[0m
['put', 'uk', 'test']
[41mthe[0m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[0m [41mgesvets[0m [41metele
kbltykk
kprnfn[0m
*[41mfls[0m [41mkswts[0m [41mtl
elekwent[0m
[46melequint[0m
elekwint
elekwint
[41melekwent[0m
[46melequint[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1H2[41mgood[0m: puts
[41mbad[0m: [41minputs[0m [41mcomment[0m [41mok[0m [41mOk[0m [41mend[0m [41mthe[0m. [44mtest[0m [41mdl
badend

addstart[0m
/[41mregions[0m=[41musgbnz[0m
[46melequint[0m/2
elekwint/3
[41maddend

test2[0m:
[46melequint[0m test elekwint test [41melekwent[0m [41masdf[0m

Test [41mrules[0m [41mfor[0m [41mcompounding[0m.

3[41maffstart
SET[0m [41mISO8859-1

COMPOUNDMIN[0m 3
[41mCOMPOUNDRULE[0m [41mm[0m*
[41mNEEDCOMPOUND[0m [41mx[0m
3[41maffend[0m

3[41mdicstart[12;1H[?25h[?0c[28C[?25l[?1c[25;1H[0m:[?25h[?0clet [str, a] = spellbadword()[?25l[?1c[12;29H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =str[?25l[?1c[27m[24m[0m[H[J[1;1H['OK', 'uk', 'put']
[41mOk[0m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[0m
['deol', 'dr', 'test']
[41mend[0m
['put', 'uk', 'test']
[41mthe[0m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[0m [41mgesvets[0m [41metele
kbltykk
kprnfn[0m
*[41mfls[0m [41mkswts[0m [41mtl
elekwent[0m
[46melequint[0m
elekwint
elekwint
[41melekwent[0m
[46melequint[0m
[41melekwent[?25h[?0c[?25l[?1c
[0m:[?25h[?0cset spl=Xtest_ca.latin1.spl[?25l[?1c[19;1H[41melequint
elekwint
elekwint

elequint
[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H/[?25h[?0c^test2:[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[2;1H2[41mgood[0m: puts
[41mbad[0m: [41minputs[0m [41mcomment[0m [41mok[0m [41mOk[0m [41mend[0m [41mthe[0m. [44mtest[0m [41mdl
badend

addstart[0m
/[41mregions[0m=[41musgbnz
elequint[0m/2
[41melekwint[0m/3
[41maddend

test2[0m:
[41melequint[0m test [41melekwint[0m test [41melekwent[0m [41masdf[0m

Test [41mrules[0m [41mfor[0m [41mcompounding[0m.

3[41maffstart
SET[0m [41mISO8859-1

COMPOUNDMIN[0m 3
[41mCOMPOUNDRULE[0m [41mm[0m*
[41mNEEDCOMPOUND[0m [41mx[0m
3[41maffend[0m

[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c
[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet [str, a] = spellbadword()[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =str[?25l[?1c[27m[24m[0m[H[J[1;1H[41mOk[0m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[0m
['deol', 'dr', 'test']
[41mend[0m
['put', 'uk', 'test']
[41mthe[0m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[0m [41mgesvets[0m [41metele
kbltykk
kprnfn[0m
*[41mfls[0m [41mkswts[0m [41mtl
elekwent
elequint
elekwint
elekwint
elekwent
elequint
elekwent
elequint[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1H2[41mgood[0m: puts
[41mbad[0m: [41minputs[0m [41mcomment[0m [41mok[0m [41mOk[0m [41mend[0m [41mthe[0m. [44mtest[0m [41mdl
badend

addstart[0m
/[41mregions[0m=[41musgbnz
elequint[0m/2
[41melekwint[0m/3
[41maddend

test2[0m:
[41melequint[0m test [41melekwint[0m test [41melekwent[0m [41masdf[0m

Test [41mrules[0m [41mfor[0m [41mcompounding[0m.

3[41maffstart
SET[0m [41mISO8859-1

COMPOUNDMIN[0m 3
[41mCOMPOUNDRULE[0m [41mm[0m*
[41mNEEDCOMPOUND[0m [41mx[0m
3[41maffend[0m

3[41mdicstart[12;1H[?25h[?0c[14C[?25l[?1c[25;1H[0m:[?25h[?0clet [str, a] = spellbadword()[?25l[?1c[12;15H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =str[?25l[?1c[27m[24m[0m[H[J[1;1H['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdl[0m
['deol', 'dr', 'test']
[41mend[0m
['put', 'uk', 'test']
[41mthe[0m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[0m [41mgesvets[0m [41metele
kbltykk
kprnfn[0m
*[41mfls[0m [41mkswts[0m [41mtl
elekwent
elequint
elekwint
elekwint
elekwent
elequint
elekwent
elequint
elekwint[?25h[?0c[?25l[?1c
[0m:[?25h[?0cunlet str a[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Postponed prefixes[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall TestOne('2', '1')[?25l[?1c"Xtest.aff" [25;13H[K[25;13H44 lines, 447 characters written
"Xtest.dic" 11 lines, 71 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[25;26H[K[25;1H
Compressed 10 of 98 nodes; 88 (89%) remaining
Compressed 0 of 13 nodes; 13 (100%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 505 bytes
17 lines yanked
17 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[12L[1;1H[41mMAP[0m [41me
MAP[0m [41mi
MAP[0m [41mo
MAP[0m [41mu
MAP[0m [41mn
MAP[0m [41mc
MAP[0m [41my
MAP[0m [41ms[0m
2[41maffend[0m

2[41mgood[0m: puts
[41mbad[0m: [41minputs[0m [41mcomment[0m [41mok[0m [41mOk[0m [41mend[0m [41mthe[0m. [44mtest[0m [41mdl
badend[0m[13;7H[K[14;1H[K[15;1H[41maddstart[0m[15;9H[K[16;1H/[41mregions[0m=[41musgbnz[0m[17;9H/2[18;9H/3
[41maddend[0m[19;7H[K[20;1H[K[21;1H[41mtest2[0m:[21;7H[K[22;4H[41mqui[0m[3Ctest [41melekwint[0m test [41melekwent[0m [41masdf[0m[23;1H[K[24;1HTest [41mrules[0m [41mfor[0m [41mcompounding[0m.[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c" Compound words[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall TestOne('3', '3')[?25l[?1c"Xtest.aff" [25;13H[K[25;13H5 lines, 60 characters written
"Xtest.dic" 5 lines, 29 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - fooCompressing word tree...[25;26H[K[25;1H
Compressed 6 of 29 nodes; 23 (79%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 115 bytes
3 lines yanked
3 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall TestOne('4', '4')[?25l[?1c"Xtest.aff" [25;13H[K[25;13H45 lines, 559 characters written
"Xtest.dic" 8 lines, 59 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - wordCompressing word tree...[25;26H[K[25;1H
Compressed 2 of 91 nodes; 89 (97%) remaining
Compressed 0 of 15 nodes; 15 (100%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 520 bytes
12 lines yanked
12 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall TestOne('5', '5')[?25l[?1c"Xtest.aff" [25;13H[K[25;13H25 lines, 237 characters written
"Xtest.dic" 6 lines, 57 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - fooCompressing word tree...[25;26H[K[25;1H
Compressed 19 of 105 nodes; 86 (81%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 440 bytes
10 lines yanked
10 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall TestOne('6', '6')[?25l[?1c"Xtest.aff" [25;13H[K[25;13H23 lines, 211 characters written
"Xtest.dic" 6 lines, 53 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - meeCompressing word tree...[25;26H[K[25;1H
Compressed 19 of 87 nodes; 68 (78%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 350 bytes
9 lines yanked
9 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall TestOne('7', '7')[?25l[?1c"Xtest.aff" [25;13H[K[25;13H22 lines, 223 characters written
"Xtest.dic" 6 lines, 67 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - meeCompressing word tree...[25;26H[K[25;1H
Compressed 19 of 89 nodes; 70 (78%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 360 bytes
9 lines yanked
9 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[27m[24m[0m[H[J[1;1H1234
[41mmee[0m/391,111,9999
bar/17,61003,123
lead/2
tail/123
[41mmiddle[0m/77,1
7[41mdicend[0m

7[41mgood[0m: meea1 meea bar prebar barmeat prebarmeat  leadprebar[10;7Hlead tail leadtail  leadmiddletail
[41mbad[0m: [41mmee[0m [41mmeea2[0m [41mprabar[0m [41mprobarmaat[0m [41mmiddle[0m [41mleadmiddle[0m [41mmiddletail[0m [41mtaillead[12;9Hleadprobar
badend

Test[0m [41mNOSLITSUGS[0m

8[41maffstart
SET[0m [41mISO8859[0m-1

[41mNOSPLITSUGS[0m
8[41maffend[0m

8[41mdicstart[0m
1234[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c" NOSLITSUGS[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall TestOne('8', '8')[?25l[?1c"Xtest.aff" [25;13H[K[25;13H3 lines, 27 characters written
"Xtest.dic" 4 lines, 20 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - fooCompressing word tree...[25;26H[K[25;1H
Compressed 8 of 26 nodes; 18 (69%) remaining
Writing spell file Xtest.latin1.spl ...
Done!
Estimated runtime memory use: 90 bytes
4 lines yanked
4 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[11L[1;1H[41mNOSPLITSUGS[0m
8[41maffend[0m

8[41mdicstart[0m
1234
foo
bar
faabar
8[41mdicend[0m

8[41mgood[0m: foo bar faabar
[41mbad[0m: [41mfoobar[0m [41mbarfoo[0m[15;1H[K[16;1H[41mtest[0m [41moutput[0m:[17;1H[K[18;1H[41mtest[0m 1-1[18;9H[K[19;1H# [41mfile[0m: [41mXtest[0m.[41mlatin1[0m.[41mspl
Comment[0m[20;8H[K[21;1H[41mdeol[0m[21;5H[K[22;1H[41mdr
input[0m[23;6H[K[24;1H[41mOK[0m[24;3H[K[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c" clean up for valgrind[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cdelfunc TestOne[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset spl= enc=latin1[?25l[?1c[27m[24m[0m[H[J[1;1HNOSPLITSUGS
8affend

8dicstart
1234
foo
bar
faabar
8dicend

8good: foo bar faabar
bad: foobar barfoo
badend


test output:

test 1-1
# file: Xtest.latin1.spl
Comment
deol
dr
input
OK[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1HasdTests for spell checking.     vim: set ft=vim :

STARTTEST
:so small.vim
:"
:" Don't want to depend on the locale from the environment
:set enc=latin1
:e!
:"
:" Check using z= in new buffer (crash fixed by patch 7.4a.028).
:set maxmem=512 spell
iasd[1m[34m^[[0mz=:"
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest
  " use that spell file
  set spl=Xtest.latin1.spl spell[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c/^test output:/,$wq! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 283 lines, 3793 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test59.failed test.ok test.out X* viminfo
cp test59.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test59.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test59.in" 626 lines, 10897 characters[1;1HTests for spell checking with 'encoding' set to "utf-8".  vim: set ft=vim :

STARTTEST
:so small.vim
:so mbyte.vim
:"
:" Don't want to depend on the locale from the environment.  The .aff and .dic
:" text is in latin1, the test text is utf-8.
:set enc=latin1
:e!
:set enc=utf-8
:set fenc=
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest
  " use that spell file
  set spl=Xtest.utf-8.spl spell[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for spell checking with 'encoding' set to "utf-8".  vim: set ft=vim :[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 106 lines, 2520 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:call TestOne('3', '3')
:call TestOne('4', '4')
:call TestOne('5', '5')
:call TestOne('6', '6')
:call TestOne('7', '7')
:"
:" clean up for valgrind
:delfunc TestOne
:set spl= enc=latin1
:"
gg:/^test output:/,$wq! test.out
ENDTEST

1affstart
SET ISO8859-1
TRY esianrtolcdugmphbyfvkwjkqxz-'ESIANRTOLCDUGMPHBYFVKWJKQXZ

FOL  
LOW  
UPP  

SOFOFROM abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ[23;1H޿
SOFOTO   ebctefghejklnnepkrstevvkesebctefghejklnnepkrstevvkeseeeeeeeceeeeeeeedne[24;1H[1m[34m@                                                                               [12;1H[?25h[?0c
[?25l[?1c[25;1H[0m:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso mbyte.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Don't want to depend on the locale from the environment.  The .aff and .dic[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" text is in latin1, the test text is utf-8.[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset enc=latin1[?25l[?1c[27m[24m[0m[H[J[1;1H:call TestOne('3', '3')
:call TestOne('4', '4')
:call TestOne('5', '5')
:call TestOne('6', '6')
:call TestOne('7', '7')
:"
:" clean up for valgrind
:delfunc TestOne
:set spl= enc=latin1
:"
gg:/^test output:/,$wq! test.out
ENDTEST

1affstart
SET ISO8859-1
TRY esianrtolcdugmphbyfvkwjkqxz-'ESIANRTOLCDUGMPHBYFVKWJKQXZ

FOL  
LOW  
UPP  

SOFOFROM abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ[23;1H޿
SOFOTO   ebctefghejklnnepkrstevvkesebctefghejklnnepkrstevvkeseeeeeeeceeeeeeeedne[24;1H[1m[34m@                                                                               [13;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0ce![?25l[?1c"test59.in" 626 lines, 10897 characters[1;1HTests for spell checking with 'encoding' set to "utf-8".  vim: set ft=vim :[2;1H[K[3;1HSTARTTEST[3;10H[K[4;2Hso small.vim[4;14H[K[5;2Hso mbyte.vim[5;14H[K[7;4HDon't want to depend on the locale from the environment.  The .aff and .dic
:" text is in latin1, the test text is utf-8.[9;6Henc=latin1[9;16H[K[10;2He!
:set enc=utf-8[11;15H[K[12;1H:set fenc=
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=[16;17H[K[17;3H$put =''
  $put ='test '. a:aff . '-' . a:dic[18;37H[K[19;1H  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest[22;23H[K[23;1H  " use that spell file[23;24H[K[24;1H  set spl=Xtest.utf-8.spl spell[24;32H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset enc=utf-8[?25l[?1c[27m[24m[0m[H[J[1;1HTests for spell checking with 'encoding' set to "utf-8".  vim: set ft=vim :

STARTTEST
:so small.vim
:so mbyte.vim
:"
:" Don't want to depend on the locale from the environment.  The .aff and .dic
:" text is in latin1, the test text is utf-8.
:set enc=latin1
:e!
:set enc=utf-8
:set fenc=
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest
  " use that spell file
  set spl=Xtest.utf-8.spl spell[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset fenc=[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Function to test .aff/.dic with list of good and bad words.[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunc TestOne(aff, dic)[?25l[?1c
:  [?25h[?0c  set spellfile=
[?25l[?1c:  [?25h[?0c  $put =''
[?25l[?1c:  [?25h[?0c  $put ='test '. a:aff . '-' . a:dic
[?25l[?1c:  [?25h[?0c  " Generate a .spl file from a .dic and .aff file.
[?25l[?1c:  [?25h[?0c  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
[?25l[?1c:  [?25h[?0c  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
[?25l[?1c:  [?25h[?0c  mkspell! Xtest Xtest
[?25l[?1c:  [?25h[?0c  " use that spell file
[?25l[?1c:  [?25h[?0c  set spl=Xtest.utf-8.spl spell
[?25l[?1c:  [?25h[?0c  " list all valid words
[?25l[?1c:  [?25h[?0c  spelldump
[?25l[?1c:  [?25h[?0c  %yank
[?25l[?1c:  [?25h[?0c  quit
[?25l[?1c:  [?25h[?0c  $put
[?25l[?1c:  [?25h[?0c  $put ='-------'
[?25l[?1c:  [?25h[?0c  " find all bad words and suggestions for them
[?25l[?1c:  [?25h[?0c  exe '1;/^' . a:aff . 'good:'
[?25l[?1c:  [?25h[?0c  normal 0f:]s
[?25l[?1c:  [?25h[?0c  let prevbad = ''
[?25l[?1c:  [?25h[?0c  while 1
[?25l[?1c:    [?25h[?0c    let [bad, a] = spellbadword()
[?25l[?1c:    [?25h[?0c    if bad == '' || bad == prevbad || bad == 'badend'
[?25l[?1c:      [?25h[?0c      break
[?25l[?1c:      [?25h[?0c    endif
[?25l[?1c:    [?25h[?0c    let prevbad = bad
[?25l[?1c:    [?25h[?0c    let lst = spellsuggest(bad, 3)
[?25l[?1c:    [?25h[?0c    normal mm
[?25l[?1c:    [?25h[?0c    $put =bad
[?25l[?1c:    [?25h[?0c    $put =string(lst)
[?25l[?1c:    [?25h[?0c    normal `m]s
[?25l[?1c:    [?25h[?0c  endwhile
[?25l[?1c:  [?25h[?0cendfunc[27m[24m[0m[H[J[?25l[?1c[1;1HTests for spell checking with 'encoding' set to "utf-8".  vim: set ft=vim :

STARTTEST
:so small.vim
:so mbyte.vim
:"
:" Don't want to depend on the locale from the environment.  The .aff and .dic
:" text is in latin1, the test text is utf-8.
:set enc=latin1
:e!
:set enc=utf-8
:set fenc=
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest
  " use that spell file
  set spl=Xtest.utf-8.spl spell[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall TestOne('1', '1')[?25l[?1c"Xtest.aff" [25;13H[K[25;13H[New File] 48 lines, 768 characters written
"Xtest.dic" [New File] 11 lines, 71 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[25;26H[K[25;1H
Compressed 29 of 131 nodes; 102 (77%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 510 bytes
Reading back spell file...
Performing soundfolding...
Total number of words: 16
Number of words after soundfolding: 16
Compressing word tree...
Compressed 39 of 104 nodes; 65 (62%) remaining
Writing suggestion file Xtest.utf-8.sug ...
Estimated runtime memory use: 357 bytes
17 lines yanked
17 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c$put =soundfold('goobledygoook')[?25l[?1c[1;1H[19L[1;1Htestn
the end
uk
wrong
-------
[41mbad[0m
['put', 'uk', 'OK']
[41minputs[0m
['input', 'puts', 'outputs']
[41mcomment[0m
['Comment', 'outtest', 'the end']
[41mok[0m
['OK', 'uk', 'put']
[41mOk[0m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[0m
['deol', 'déôr', 'test']
[41mend[0m[20;4H[K[21;1H['put', 'uk', 'test'][21;22H[K[22;1H[41mthe[0m[22;4H[K[23;1H['put', 'uk', 'test'][23;22H[K[24;1H[41mgebletegek[0m[24;11H[K[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =soundfold('kóopërÿnôven')[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[41mkepereneven[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =soundfold('oeverloos gezwets edale')[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[41meverles[0m [41mgesvets[0m [41metele[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" and now with SAL instead of SOFO items; test automatic reloading[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1H[41mTests[0m [41mfor[0m [41mspell[0m [41mchecking[0m [41mwith[0m '[41mencoding[0m' [41mset[0m [41mto[0m "[41mutf-8[0m".  [41mvim[0m: [41mset[0m [41mft[0m=[41mvim[0m :

[41mSTARTTEST[0m
:[41mso[0m [41msmall[0m.[41mvim[0m
:[41mso[0m [41mmbyte[0m.[41mvim[0m
:"
:" [41mDon't[0m [41mwant[0m [41mto[0m [41mdepend[0m [41mon[0m [41mthe[0m [41mlocale[0m [41mfrom[0m [41mthe[0m [41menvironment[0m.  [41mThe[0m .[41maff[0m [41mand[0m .[41mdic[0m
:" [41mtext[0m [41mis[0m [41min[0m [41mlatin1[0m, [41mthe[0m test [41mtext[0m [41mis[0m [41mutf-8[0m.
:[41mset[0m [41menc[0m=[41mlatin1[0m
:[41me[0m!
:[41mset[0m [41menc[0m=[41mutf-8[0m
:[41mset[0m [41mfenc[0m=
:"
:" [41mFunction[0m [41mto[0m test .[41maff[0m/.[41mdic[0m [41mwith[0m [41mlist[0m [41mof[0m [41mgood[0m [41mand[0m [41mbad[0m [41mwords[0m.
:[41mfunc[0m [41mTestOne[0m([41maff[0m, [41mdic[0m)
  [41mset[0m [41mspellfile[0m=
  $put =''
  $put ='test '. [41ma[0m:[41maff[0m . '-' . [41ma[0m:[41mdic[0m
  " [41mGenerate[0m [41ma[0m .[41mspl[0m [41mfile[0m [41mfrom[0m [41ma[0m .[41mdic[0m [41mand[0m .[41maff[0m [41mfile[0m.
  [41mexe[0m '1;/^' . [41ma[0m:[41maff[0m . '[41maffstart[0m/+1,/^' . [41ma[0m:[41maff[0m . '[41maffend[0m/-1[41mw[0m! [41mXtest[0m.[41maff[0m'
  [41mexe[0m '1;/^' . [41ma[0m:[41mdic[0m . '[41mdicstart[0m/+1,/^' . [41ma[0m:[41mdic[0m . '[41mdicend[0m/-1[41mw[0m! [41mXtest[0m.[41mdic[0m'
  [41mmkspell[0m! [41mXtest[0m [41mXtest[0m
  " [41muse[0m [41mthat[0m [41mspell[0m [41mfile
[0m  [41mset[0m [41mspl[0m=[41mXtest[0m.[41mutf-8[0m.[41mspl[0m [41mspell[1;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0c/^affstart_sal/+1,/^affend_sal/-1w! Xtest.aff[?25l[?1c"Xtest.aff" [25;13H[K[25;13H153 lines, 3426 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmkspell! Xtest Xtest[?25l[?1cReading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[25;26H[K[25;1H
Compressed 29 of 131 nodes; 102 (77%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 510 bytes
Performing soundfolding...
Total number of words: 16
Number of words after soundfolding: 15
Compressing word tree...
Compressed 33 of 75 nodes; 42 (56%) remaining
Writing suggestion file Xtest.utf-8.sug ...
Estimated runtime memory use: 241 bytes
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c$put =soundfold('goobledygoook')[?25l[?1c[1;1H[14L[1;1Hwrong
-------
[41mbad[0m
['put', 'uk', 'OK']
[41minputs[0m
['input', 'puts', 'outputs']
[41mcomment[0m
['Comment', 'outtest', 'the end']
[41mok[0m
['OK', 'uk', 'put']
[41mOk[0m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[0m[15;5H[K[16;1H['deol', 'déôr', 'test']
[41mend[0m[17;4H[K[18;1H['put', 'uk', 'test'][18;22H[K[19;1H[41mthe[0m[19;5H[K[20;1H['put', 'uk', 'test'][20;22H[K[21;1H[41mgebletegek[0m[21;11H[K[22;1H[41mkepereneven[0m[22;12H[K[23;1H[41meverles[0m [41mgesvets[0m [41metele[0m[23;22H[K[24;1H[41mkbltykk[0m[24;8H[K[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =soundfold('kóopërÿnôven')[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[41mkprnfn[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =soundfold('oeverloos gezwets edale')[?25l[?1c[1;24r[24;1H
[1;25r[24;1H*[41mfls[0m [41mkswts[0m [41mtl[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" also use an addition file[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1H[41mTests[0m [41mfor[0m [41mspell[0m [41mchecking[0m [41mwith[0m '[41mencoding[0m' [41mset[0m [41mto[0m "[41mutf-8[0m".  [41mvim[0m: [41mset[0m [41mft[0m=[41mvim[0m :

[41mSTARTTEST[0m
:[41mso[0m [41msmall[0m.[41mvim[0m
:[41mso[0m [41mmbyte[0m.[41mvim[0m
:"
:" [41mDon't[0m [41mwant[0m [41mto[0m [41mdepend[0m [41mon[0m [41mthe[0m [41mlocale[0m [41mfrom[0m [41mthe[0m [41menvironment[0m.  [41mThe[0m .[41maff[0m [41mand[0m .[41mdic[0m
:" [41mtext[0m [41mis[0m [41min[0m [41mlatin1[0m, [41mthe[0m test [41mtext[0m [41mis[0m [41mutf-8[0m.
:[41mset[0m [41menc[0m=[41mlatin1[0m
:[41me[0m!
:[41mset[0m [41menc[0m=[41mutf-8[0m
:[41mset[0m [41mfenc[0m=
:"
:" [41mFunction[0m [41mto[0m test .[41maff[0m/.[41mdic[0m [41mwith[0m [41mlist[0m [41mof[0m [41mgood[0m [41mand[0m [41mbad[0m [41mwords[0m.
:[41mfunc[0m [41mTestOne[0m([41maff[0m, [41mdic[0m)
  [41mset[0m [41mspellfile[0m=
  $put =''
  $put ='test '. [41ma[0m:[41maff[0m . '-' . [41ma[0m:[41mdic[0m
  " [41mGenerate[0m [41ma[0m .[41mspl[0m [41mfile[0m [41mfrom[0m [41ma[0m .[41mdic[0m [41mand[0m .[41maff[0m [41mfile[0m.
  [41mexe[0m '1;/^' . [41ma[0m:[41maff[0m . '[41maffstart[0m/+1,/^' . [41ma[0m:[41maff[0m . '[41maffend[0m/-1[41mw[0m! [41mXtest[0m.[41maff[0m'
  [41mexe[0m '1;/^' . [41ma[0m:[41mdic[0m . '[41mdicstart[0m/+1,/^' . [41ma[0m:[41mdic[0m . '[41mdicend[0m/-1[41mw[0m! [41mXtest[0m.[41mdic[0m'
  [41mmkspell[0m! [41mXtest[0m [41mXtest[0m
  " [41muse[0m [41mthat[0m [41mspell[0m [41mfile
[0m  [41mset[0m [41mspl[0m=[41mXtest[0m.[41mutf-8[0m.[41mspl[0m [41mspell[1;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0c/^addstart/+1,/^addend/-1w! Xtest.utf-8.add[?25l[?1c"Xtest.utf-8.add" [25;19H[K[25;19H[New File] 3 lines, 38 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmkspell! Xtest.utf-8.add.spl Xtest.utf-8.add[?25l[?1cReading word file Xtest.utf-8.add ...[25;38H[K[25;1H
Compressing word tree...
Compressed 0 of 29 nodes; 29 (100%) remaining
Writing spell file Xtest.utf-8.add.spl ...
Done!
Estimated runtime memory use: 145 bytes
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset spellfile=Xtest.utf-8.add[?25l[?1c[1;1H[6L[1;1H[41mTests[0m [41mfor[0m [41mspell[0m [41mchecking[0m [41mwith[0m '[41mencoding[0m' [41mset[0m [41mto[0m "[41mutf-8[0m".  [41mvim[0m: [41mset[0m [41mft[0m=[41mvim[0m :

[41mSTARTTEST[0m
:[41mso[0m [41msmall[0m.[41mvim[0m
:[41mso[0m [41mmbyte[0m.[41mvim[0m
:"[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/[?25h[?0c^test2:[?25l[?1c[27m[24m[0m[H[J[1;9H[41mtomato[0m [41mtomatotomato[0m [41mstartend[0m [41mstartword[0m [41mstartwordword[0m [41mstartwordend[2;9Hstartwordwordend[0m [41mstartwordwordwordend[0m [41mprebork[0m [41mpreborkbork[3;9Hpreborkborkbork[4;9Hnouword
bad[0m: [41mwordutilize[0m [41mpro[0m [41mborkborkborkborkborkbork[0m [41mtomatotomatotomato[6;9Hendstart[0m [41mendend[0m [41mstartstart[0m [41mwordend[0m [41mwordstart[7;9Hpreborkprebork[0m  [41mpreborkpreborkbork[8;9Hstartwordwordwordwordend[0m [41mborkpreborkpreborkbork[9;9Hutilsbork[0m  [41mstartnouword
badend

test2[0m:
elequint test elekwint test [41melekwent[0m [41masdf[0m

Test [41maffix[0m [41mflags[0m [41mwith[0m [41mtwo[0m [41mcharacters[0m

5[41maffstart
SET[0m [41mISO8859-1

FLAG[0m [41mlong

NEEDAFFIX[0m !!

[41mCOMPOUNDRULE[0m [41mssmm[0m*[41mee[12;1H[?25h[?0c[13;29H[?25l[?1c[25;1H[0m:[?25h[?0clet [str, a] = spellbadword()[?25l[?1c[13;29H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =str[?25l[?1c[27m[24m[0m[H[J[1;1H['put', 'uk', 'OK']
[41minputs[0m
['input', 'puts', 'outputs']
[41mcomment[0m
['Comment', 'outtest', 'the end']
[41mok[0m
['OK', 'uk', 'put']
[41mOk[0m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[0m
['deol', 'déôr', 'test']
[41mend[0m
['put', 'uk', 'test']
[41mthe[0m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[0m [41mgesvets[0m [41metele
kbltykk
kprnfn[0m
*[41mfls[0m [41mkswts[0m [41mtl
elekwent[?25h[?0c[?25l[?1c
[0m:[?25h[?0cset spl=Xtest_us.utf-8.spl[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^test2:[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[1;9H[41mtomato[0m [41mtomatotomato[0m [41mstartend[0m [41mstartword[0m [41mstartwordword[0m [41mstartwordend[2;9Hstartwordwordend[0m [41mstartwordwordwordend[0m [41mprebork[0m [41mpreborkbork[3;9Hpreborkborkbork[4;9Hnouword
bad[0m: [41mwordutilize[0m [41mpro[0m [41mborkborkborkborkborkbork[0m [41mtomatotomatotomato[6;9Hendstart[0m [41mendend[0m [41mstartstart[0m [41mwordend[0m [41mwordstart[7;9Hpreborkprebork[0m  [41mpreborkpreborkbork[8;9Hstartwordwordwordwordend[0m [41mborkpreborkpreborkbork[9;9Hutilsbork[0m  [41mstartnouword
badend

test2[0m:
[46melequint[0m test [46melekwint[0m test [41melekwent[0m [41masdf[0m

Test [41maffix[0m [41mflags[0m [41mwith[0m [41mtwo[0m [41mcharacters[0m

5[41maffstart
SET[0m [41mISO8859-1

FLAG[0m [41mlong

NEEDAFFIX[0m !!

[41mCOMPOUNDRULE[0m [41mssmm[0m*[41mee[0m
[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c
[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet [str, a] = spellbadword()[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =str[?25l[?1c[27m[24m[0m[H[J[1;1H[41minputs[0m
['input', 'puts', 'outputs']
[41mcomment[0m
['Comment', 'outtest', 'the end']
[41mok[0m
['OK', 'uk', 'put']
[41mOk[0m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[0m
['deol', 'déôr', 'test']
[41mend[0m
['put', 'uk', 'test']
[41mthe[0m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[0m [41mgesvets[0m [41metele
kbltykk
kprnfn[0m
*[41mfls[0m [41mkswts[0m [41mtl
elekwent[0m
[46melequint[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;9H[41mstartwordwordend[0m [41mstartwordwordwordend[0m [41mprebork[0m [41mpreborkbork[2;9Hpreborkborkbork[3;9Hnouword
bad[0m: [41mwordutilize[0m [41mpro[0m [41mborkborkborkborkborkbork[0m [41mtomatotomatotomato[5;9Hendstart[0m [41mendend[0m [41mstartstart[0m [41mwordend[0m [41mwordstart[6;9Hpreborkprebork[0m  [41mpreborkpreborkbork[7;9Hstartwordwordwordwordend[0m [41mborkpreborkpreborkbork[8;9Hutilsbork[0m  [41mstartnouword
badend

test2[0m:
[46melequint[0m test [46melekwint[0m test [41melekwent[0m [41masdf[0m

Test [41maffix[0m [41mflags[0m [41mwith[0m [41mtwo[0m [41mcharacters[0m

5[41maffstart
SET[0m [41mISO8859-1

FLAG[0m [41mlong

NEEDAFFIX[0m !!

[41mCOMPOUNDRULE[0m [41mssmm[0m*[41mee[12;1H[?25h[?0c[14C[?25l[?1c[25;1H[0m:[?25h[?0clet [str, a] = spellbadword()[?25l[?1c[12;15H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =str[?25l[?1c[27m[24m[0m[H[J[1;1H['input', 'puts', 'outputs']
[41mcomment[0m
['Comment', 'outtest', 'the end']
[41mok[0m
['OK', 'uk', 'put']
[41mOk[0m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[0m
['deol', 'déôr', 'test']
[41mend[0m
['put', 'uk', 'test']
[41mthe[0m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[0m [41mgesvets[0m [41metele
kbltykk
kprnfn[0m
*[41mfls[0m [41mkswts[0m [41mtl
elekwent[0m
[46melequint
elekwint[?25h[?0c[?25l[?1c
[0m:[?25h[?0cset spl=Xtest_gb.utf-8.spl[?25l[?1c[23;1Helequint
[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^test2:[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[1;9H[41mtomato[0m [41mtomatotomato[0m [41mstartend[0m [41mstartword[0m [41mstartwordword[0m [41mstartwordend[2;9Hstartwordwordend[0m [41mstartwordwordwordend[0m [41mprebork[0m [41mpreborkbork[3;9Hpreborkborkbork[4;9Hnouword
bad[0m: [41mwordutilize[0m [41mpro[0m [41mborkborkborkborkborkbork[0m [41mtomatotomatotomato[6;9Hendstart[0m [41mendend[0m [41mstartstart[0m [41mwordend[0m [41mwordstart[7;9Hpreborkprebork[0m  [41mpreborkpreborkbork[8;9Hstartwordwordwordwordend[0m [41mborkpreborkpreborkbork[9;9Hutilsbork[0m  [41mstartnouword
badend

test2[0m:
elequint test [46melekwint[0m test [41melekwent[0m [41masdf[0m

Test [41maffix[0m [41mflags[0m [41mwith[0m [41mtwo[0m [41mcharacters[0m

5[41maffstart
SET[0m [41mISO8859-1

FLAG[0m [41mlong

NEEDAFFIX[0m !!

[41mCOMPOUNDRULE[0m [41mssmm[0m*[41mee[0m
[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c[13;15H[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet [str, a] = spellbadword()[?25l[?1c[13;15H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =str[?25l[?1c[27m[24m[0m[H[J[1;1H[41mcomment[0m
['Comment', 'outtest', 'the end']
[41mok[0m
['OK', 'uk', 'put']
[41mOk[0m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[0m
['deol', 'déôr', 'test']
[41mend[0m
['put', 'uk', 'test']
[41mthe[0m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[0m [41mgesvets[0m [41metele
kbltykk
kprnfn[0m
*[41mfls[0m [41mkswts[0m [41mtl
elekwent[0m
elequint
[46melekwint
elekwint[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;9H[41mstartwordwordend[0m [41mstartwordwordwordend[0m [41mprebork[0m [41mpreborkbork[2;9Hpreborkborkbork[3;9Hnouword
bad[0m: [41mwordutilize[0m [41mpro[0m [41mborkborkborkborkborkbork[0m [41mtomatotomatotomato[5;9Hendstart[0m [41mendend[0m [41mstartstart[0m [41mwordend[0m [41mwordstart[6;9Hpreborkprebork[0m  [41mpreborkpreborkbork[7;9Hstartwordwordwordwordend[0m [41mborkpreborkpreborkbork[8;9Hutilsbork[0m  [41mstartnouword
badend

test2[0m:
elequint test [46melekwint[0m test [41melekwent[0m [41masdf[0m

Test [41maffix[0m [41mflags[0m [41mwith[0m [41mtwo[0m [41mcharacters[0m

5[41maffstart
SET[0m [41mISO8859-1

FLAG[0m [41mlong

NEEDAFFIX[0m !!

[41mCOMPOUNDRULE[0m [41mssmm[0m*[41mee[12;15H[?25h[?0c[14C[?25l[?1c[25;1H[0m:[?25h[?0clet [str, a] = spellbadword()[?25l[?1c[12;29H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =str[?25l[?1c[27m[24m[0m[H[J[1;1H['Comment', 'outtest', 'the end']
[41mok[0m
['OK', 'uk', 'put']
[41mOk[0m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[0m
['deol', 'déôr', 'test']
[41mend[0m
['put', 'uk', 'test']
[41mthe[0m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[0m [41mgesvets[0m [41metele
kbltykk
kprnfn[0m
*[41mfls[0m [41mkswts[0m [41mtl
elekwent[0m
elequint
[46melekwint
elekwint[0m
[41melekwent[?25h[?0c[?25l[?1c
[0m:[?25h[?0cset spl=Xtest_nz.utf-8.spl[?25l[?1c[21;1H[46melequint[0m
elekwint
elekwint
[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^test2:[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[1;9H[41mtomato[0m [41mtomatotomato[0m [41mstartend[0m [41mstartword[0m [41mstartwordword[0m [41mstartwordend[2;9Hstartwordwordend[0m [41mstartwordwordwordend[0m [41mprebork[0m [41mpreborkbork[3;9Hpreborkborkbork[4;9Hnouword
bad[0m: [41mwordutilize[0m [41mpro[0m [41mborkborkborkborkborkbork[0m [41mtomatotomatotomato[6;9Hendstart[0m [41mendend[0m [41mstartstart[0m [41mwordend[0m [41mwordstart[7;9Hpreborkprebork[0m  [41mpreborkpreborkbork[8;9Hstartwordwordwordwordend[0m [41mborkpreborkpreborkbork[9;9Hutilsbork[0m  [41mstartnouword
badend

test2[0m:
[46melequint[0m test elekwint test [41melekwent[0m [41masdf[0m

Test [41maffix[0m [41mflags[0m [41mwith[0m [41mtwo[0m [41mcharacters[0m

5[41maffstart
SET[0m [41mISO8859-1

FLAG[0m [41mlong

NEEDAFFIX[0m !!

[41mCOMPOUNDRULE[0m [41mssmm[0m*[41mee[0m
[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c
[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet [str, a] = spellbadword()[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =str[?25l[?1c[27m[24m[0m[H[J[1;1H[41mok[0m
['OK', 'uk', 'put']
[41mOk[0m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[0m
['deol', 'déôr', 'test']
[41mend[0m
['put', 'uk', 'test']
[41mthe[0m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[0m [41mgesvets[0m [41metele
kbltykk
kprnfn[0m
*[41mfls[0m [41mkswts[0m [41mtl
elekwent[0m
[46melequint[0m
elekwint
elekwint
[41melekwent[0m
[46melequint[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;9H[41mstartwordwordend[0m [41mstartwordwordwordend[0m [41mprebork[0m [41mpreborkbork[2;9Hpreborkborkbork[3;9Hnouword
bad[0m: [41mwordutilize[0m [41mpro[0m [41mborkborkborkborkborkbork[0m [41mtomatotomatotomato[5;9Hendstart[0m [41mendend[0m [41mstartstart[0m [41mwordend[0m [41mwordstart[6;9Hpreborkprebork[0m  [41mpreborkpreborkbork[7;9Hstartwordwordwordwordend[0m [41mborkpreborkpreborkbork[8;9Hutilsbork[0m  [41mstartnouword
badend

test2[0m:
[46melequint[0m test elekwint test [41melekwent[0m [41masdf[0m

Test [41maffix[0m [41mflags[0m [41mwith[0m [41mtwo[0m [41mcharacters[0m

5[41maffstart
SET[0m [41mISO8859-1

FLAG[0m [41mlong

NEEDAFFIX[0m !!

[41mCOMPOUNDRULE[0m [41mssmm[0m*[41mee[12;1H[?25h[?0c[28C[?25l[?1c[25;1H[0m:[?25h[?0clet [str, a] = spellbadword()[?25l[?1c[12;29H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =str[?25l[?1c[27m[24m[0m[H[J[1;1H['OK', 'uk', 'put']
[41mOk[0m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[0m
['deol', 'déôr', 'test']
[41mend[0m
['put', 'uk', 'test']
[41mthe[0m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[0m [41mgesvets[0m [41metele
kbltykk
kprnfn[0m
*[41mfls[0m [41mkswts[0m [41mtl
elekwent[0m
[46melequint[0m
elekwint
elekwint
[41melekwent[0m
[46melequint[0m
[41melekwent[?25h[?0c[?25l[?1c
[0m:[?25h[?0cset spl=Xtest_ca.utf-8.spl[?25l[?1c[19;1H[41melequint
elekwint
elekwint

elequint
[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H/[?25h[?0c^test2:[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[1;9H[41mtomato[0m [41mtomatotomato[0m [41mstartend[0m [41mstartword[0m [41mstartwordword[0m [41mstartwordend[2;9Hstartwordwordend[0m [41mstartwordwordwordend[0m [41mprebork[0m [41mpreborkbork[3;9Hpreborkborkbork[4;9Hnouword
bad[0m: [41mwordutilize[0m [41mpro[0m [41mborkborkborkborkborkbork[0m [41mtomatotomatotomato[6;9Hendstart[0m [41mendend[0m [41mstartstart[0m [41mwordend[0m [41mwordstart[7;9Hpreborkprebork[0m  [41mpreborkpreborkbork[8;9Hstartwordwordwordwordend[0m [41mborkpreborkpreborkbork[9;9Hutilsbork[0m  [41mstartnouword
badend

test2[0m:
[41melequint[0m test [41melekwint[0m test [41melekwent[0m [41masdf[0m

Test [41maffix[0m [41mflags[0m [41mwith[0m [41mtwo[0m [41mcharacters[0m

5[41maffstart
SET[0m [41mISO8859-1

FLAG[0m [41mlong

NEEDAFFIX[0m !!

[41mCOMPOUNDRULE[0m [41mssmm[0m*[41mee[0m
[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c
[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet [str, a] = spellbadword()[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =str[?25l[?1c[27m[24m[0m[H[J[1;1H[41mOk[0m
['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[0m
['deol', 'déôr', 'test']
[41mend[0m
['put', 'uk', 'test']
[41mthe[0m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[0m [41mgesvets[0m [41metele
kbltykk
kprnfn[0m
*[41mfls[0m [41mkswts[0m [41mtl
elekwent
elequint
elekwint
elekwint
elekwent
elequint
elekwent
elequint[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;9H[41mstartwordwordend[0m [41mstartwordwordwordend[0m [41mprebork[0m [41mpreborkbork[2;9Hpreborkborkbork[3;9Hnouword
bad[0m: [41mwordutilize[0m [41mpro[0m [41mborkborkborkborkborkbork[0m [41mtomatotomatotomato[5;9Hendstart[0m [41mendend[0m [41mstartstart[0m [41mwordend[0m [41mwordstart[6;9Hpreborkprebork[0m  [41mpreborkpreborkbork[7;9Hstartwordwordwordwordend[0m [41mborkpreborkpreborkbork[8;9Hutilsbork[0m  [41mstartnouword
badend

test2[0m:
[41melequint[0m test [41melekwint[0m test [41melekwent[0m [41masdf[0m

Test [41maffix[0m [41mflags[0m [41mwith[0m [41mtwo[0m [41mcharacters[0m

5[41maffstart
SET[0m [41mISO8859-1

FLAG[0m [41mlong

NEEDAFFIX[0m !!

[41mCOMPOUNDRULE[0m [41mssmm[0m*[41mee[12;1H[?25h[?0c[14C[?25l[?1c[25;1H[0m:[?25h[?0clet [str, a] = spellbadword()[?25l[?1c[12;15H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =str[?25l[?1c[27m[24m[0m[H[J[1;1H['OK', 'Uk', 'Put']
test
['Test', 'testn', 'testen']
[41mdéôl[0m
['deol', 'déôr', 'test']
[41mend[0m
['put', 'uk', 'test']
[41mthe[0m
['put', 'uk', 'test']
[41mgebletegek
kepereneven
everles[0m [41mgesvets[0m [41metele
kbltykk
kprnfn[0m
*[41mfls[0m [41mkswts[0m [41mtl
elekwent
elequint
elekwint
elekwint
elekwent
elequint
elekwent
elequint
elekwint[?25h[?0c[?25l[?1c
[0m:[?25h[?0cunlet str a[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Postponed prefixes[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall TestOne('2', '1')[?25l[?1c"Xtest.aff" [25;13H[K[25;13H46 lines, 461 characters written
"Xtest.dic" 11 lines, 71 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - testCompressing word tree...[25;26H[K[25;1H
Compressed 10 of 102 nodes; 92 (90%) remaining
Compressed 0 of 13 nodes; 13 (100%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 525 bytes
17 lines yanked
17 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[12L[1;1H[41maddstart[0m
/[41mregions[0m=[41musgbnz
elequint[0m/2
[41melekwint[0m/3
[41maddend[0m

1[41mgood[0m: wrong OK puts. Test the end
[41mbad[0m:  [41minputs[0m [41mcomment[0m [41mok[0m [41mOk[0m. [44mtest[0m [41mdéôl[0m [41mend[0m [41mthe
badend[0m

2[41mgood[0m: puts
[41mbad[0m: [41minputs[0m [41mcomment[0m [41mok[0m [41mOk[0m [41mend[0m [41mthe[0m. [44mtest[0m [41mdéôl
badend[0m[13;7H[K[14;1H[K[15;1HTest [41mrules[0m [41mfor[0m [41mcompounding[0m.[16;1H[K[17;1H3[41maffstart
SET[0m [41mISO8859-1[0m[19;1H[K[20;1H[41mCOMPOUNDMIN[0m 3
[41mCOMPOUNDRULE[0m [41mm[0m*
[41mNEEDCOMPOUND[0m [41mx[0m
3[41maffend[0m[23;8H[K[24;1H[K[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c" Compound words[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall TestOne('3', '3')[?25l[?1c"Xtest.aff" [25;13H[K[25;13H5 lines, 60 characters written
"Xtest.dic" 5 lines, 29 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - fooCompressing word tree...[25;26H[K[25;1H
Compressed 6 of 31 nodes; 25 (80%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 125 bytes
3 lines yanked
3 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall TestOne('4', '4')[?25l[?1c"Xtest.aff" [25;13H[K[25;13H45 lines, 559 characters written
"Xtest.dic" 8 lines, 59 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - wordCompressing word tree...[25;26H[K[25;1H
Compressed 2 of 91 nodes; 89 (97%) remaining
Compressed 0 of 15 nodes; 15 (100%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 520 bytes
12 lines yanked
12 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall TestOne('5', '5')[?25l[?1c"Xtest.aff" [25;13H[K[25;13H25 lines, 237 characters written
"Xtest.dic" 6 lines, 57 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - fooCompressing word tree...[25;26H[K[25;1H
Compressed 19 of 107 nodes; 88 (82%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 440 bytes
10 lines yanked
10 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall TestOne('6', '6')[?25l[?1c"Xtest.aff" [25;13H[K[25;13H23 lines, 211 characters written
"Xtest.dic" 6 lines, 53 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - meeCompressing word tree...[25;26H[K[25;1H
Compressed 19 of 89 nodes; 70 (78%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 350 bytes
9 lines yanked
9 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall TestOne('7', '7')[?25l[?1c"Xtest.aff" [25;13H[K[25;13H26 lines, 338 characters written
"Xtest.dic" 6 lines, 67 characters written
Reading affix file Xtest.aff ...
Reading dictionary file Xtest.dic ...
line      2, word      0 - meeCompressing word tree...[25;26H[K[25;1H
Compressed 19 of 91 nodes; 72 (79%) remaining
Writing spell file Xtest.utf-8.spl ...
Done!
Estimated runtime memory use: 360 bytes
9 lines yanked
9 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[27m[24m[0m[H[J[1;1H1234
[41mmee[0m/391,111,9999
bar/17,61003,123
lead/2
tail/123
[41mmiddle[0m/77,1
7[41mdicend[0m

7[41mgood[0m: meea1 meeaé bar prebar barmeat prebarmeat  leadprebar[10;7Hlead tail leadtail  leadmiddletail
[41mbad[0m: [41mmee[0m [41mmeea2[0m [41mprabar[0m [41mprobarmaat[0m [41mmiddle[0m [41mleadmiddle[0m [41mmiddletail[0m [41mtaillead[12;9Hleadprobar
badend

test[0m [41moutput[0m:

[41mtest[0m 1-1
# [41mfile[0m: [41mXtest[0m.[41mutf[0m-8.[41mspl
Comment
deol
déôr
input
OK
output[13;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0c" clean up for valgrind[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cdelfunc TestOne[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset spl= enc=latin1[?25l[?1c[27m[24m[0m[H[J[1;1H1234
mee/391,111,9999
bar/17,61003,123
lead/2
tail/123
middle/77,1
7dicend

7good: meea1 meeaé bar prebar barmeat prebarmeat  leadprebar[10;7Hlead tail leadtail  leadmiddletail
bad: mee meea2 prabar probarmaat middle leadmiddle middletail taillead[12;9Hleadprobar
badend

test output:

test 1-1
# file: Xtest.utf-8.spl
Comment
deol
déôr
input
OK
output[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1HTests for spell checking with 'encoding' set to "utf-8".  vim: set ft=vim :

STARTTEST
:so small.vim
:so mbyte.vim
:"
:" Don't want to depend on the locale from the environment.  The .aff and .dic
:" text is in latin1, the test text is utf-8.
:set enc=latin1
:e!
:set enc=utf-8
:set fenc=
:"
:" Function to test .aff/.dic with list of good and bad words.
:func TestOne(aff, dic)
  set spellfile=
  $put =''
  $put ='test '. a:aff . '-' . a:dic
  " Generate a .spl file from a .dic and .aff file.
  exe '1;/^' . a:aff . 'affstart/+1,/^' . a:aff . 'affend/-1w! Xtest.aff'
  exe '1;/^' . a:dic . 'dicstart/+1,/^' . a:dic . 'dicend/-1w! Xtest.dic'
  mkspell! Xtest Xtest
  " use that spell file
  set spl=Xtest.utf-8.spl spell[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c/^test output:/,$wq! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 270 lines, 3685 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test60.failed test.ok test.out X* viminfo
cp test60.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test60.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test60.in" 610 lines, 13323 characters[1;1HTests for the exists() and has() functions.  vim: set ft=vim ts=8 sw=2 :

STARTTEST
:so small.vim
:function! RunTest(str, result)
    if exists(a:str) == a:result[7;9Hecho "OK"
    else[9;9Hecho "FAILED: Checking for " . a:str
    endif
endfunction
:function! TestExists()
    augroup myagroup[14;9Hautocmd! BufEnter[7C*.my     echo "myfile edited"[15;9Hautocmd! FuncUndefined  UndefFun exec "fu UndefFun()\nendfu"
    augroup END
    set rtp+=./sautest[19;5Hlet test_cases = [][21;5H" valid autocmd group
    let test_cases += [['#myagroup', 1]]
    " valid autocmd group with garbage
    let test_cases += [['#myagroup+b', 0]][1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for the exists() and has() functions.  vim: set ft=vim ts=8 sw=2 :[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 605 lines, 13230 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[2;5Hredir END
endfunction
:call TestExists()
:"
:function TestHas()
  redir >> test.out
  for pl in ['6.9.999', '7.1.999', '7.4.123', '9.1.0', '9.9.1']
    echo 'has patch ' . pl . ': ' . has('patch-' . pl)
  endfor
  redir END
endfunc
:call TestHas()
:"
:delfunc TestExists
:delfunc RunTest
:delfunc TestFuncArg
:edit! test.out
:set ff=unix
:w
:qa!
:while getchar(1) | call getchar() | endwhile
ENDTEST[?25h[?0c
[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunction! RunTest(str, result)[?25l[?1c
:  [?25h[?0c    if exists(a:str) == a:result
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED: Checking for " . a:str
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0cendfunction[1;1H[6L[?25l[?1c[2;5Hredir END
endfunction
:call TestExists()
:"
:function TestHas()[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cfunction! TestExists()[?25l[?1c
:  [?25h[?0c    augroup myagroup
[?25l[?1c:  [?25h[?0c[1m[34m^I[0mautocmd! BufEnter       *.my     echo "myfile edited"
[?25l[?1c:  [?25h[?0c[1m[34m^I[0mautocmd! FuncUndefined  UndefFun exec "fu UndefFun()\nendfu"
[?25l[?1c:  [?25h[?0c    augroup END
[?25l[?1c:  [?25h[?0c    set rtp+=./sautest
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    let test_cases = []
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " valid autocmd group
[?25l[?1c:  [?25h[?0c    let test_cases += [['#myagroup', 1]]
[?25l[?1c:  [?25h[?0c    " valid autocmd group with garbage
[?25l[?1c:  [?25h[?0c    let test_cases += [['#myagroup+b', 0]]
[?25l[?1c:  [?25h[?0c    " Valid autocmd group and event
[?25l[?1c:  [?25h[?0c    let test_cases += [['#myagroup#BufEnter', 1]]
[?25l[?1c:  [?25h[?0c    " Valid autocmd group, event and pattern
[?25l[?1c:  [?25h[?0c    let test_cases += [['#myagroup#BufEnter#*.my', 1]]
[?25l[?1c:  [?25h[?0c    " Valid autocmd event
[?25l[?1c:  [?25h[?0c    let test_cases += [['#BufEnter', 1]]
[?25l[?1c:  [?25h[?0c    " Valid autocmd event and pattern
[?25l[?1c:  [?25h[?0c    let test_cases += [['#BufEnter#*.my', 1]]
[?25l[?1c:  [?25h[?0c    " Non-existing autocmd group or event
[?25l[?1c:  [?25h[?0c    let test_cases += [['#xyzagroup', 0]]
[?25l[?1c:  [?25h[?0c    " Non-existing autocmd group and valid autocmd event
[?25l[?1c:  [?25h[?0c    let test_cases += [['#xyzagroup#BufEnter', 0]]
[?25l[?1c:  [?25h[?0c    " Valid autocmd group and event with no matching pattern
[?25l[?1c:  [?25h[?0c    let test_cases += [['#myagroup#CmdwinEnter', 0]]
[?25l[?1c:  [?25h[?0c    " Valid autocmd group and non-existing autocmd event
[?25l[?1c:  [?25h[?0c    let test_cases += [['#myagroup#xyzacmd', 0]]
[?25l[?1c:  [?25h[?0c    " Valid autocmd group and event and non-matching pattern
[?25l[?1c:  [?25h[?0c    let test_cases += [['#myagroup#BufEnter#xyzpat', 0]]
[?25l[?1c:  [?25h[?0c    " Valid autocmd event and non-matching pattern
[?25l[?1c:  [?25h[?0c    let test_cases += [['#BufEnter#xyzpat', 0]]
[?25l[?1c:  [?25h[?0c    " Empty autocmd group, event and pattern
[?25l[?1c:  [?25h[?0c    let test_cases += [['###', 0]]
[?25l[?1c:  [?25h[?0c    " Empty autocmd group and event or empty event and pattern
[?25l[?1c:  [?25h[?0c    let test_cases += [['##', 0]]
[?25l[?1c:  [?25h[?0c    " Valid autocmd event
[?25l[?1c:  [?25h[?0c    let test_cases += [['##FileReadCmd', 1]]
[?25l[?1c:  [?25h[?0c    " Non-existing autocmd event
[?25l[?1c:  [?25h[?0c    let test_cases += [['##MySpecialCmd', 0]]
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Existing and working option (long form)
[?25l[?1c:  [?25h[?0c    let test_cases += [['&textwidth', 1]]
[?25l[?1c:  [?25h[?0c    " Existing and working option (short form)
[?25l[?1c:  [?25h[?0c    let test_cases += [['&tw', 1]]
[?25l[?1c:  [?25h[?0c    " Existing and working option with garbage
[?25l[?1c:  [?25h[?0c    let test_cases += [['&tw-', 0]]
[?25l[?1c:  [?25h[?0c    " Global option
[?25l[?1c:  [?25h[?0c    let test_cases += [['&g:errorformat', 1]]
[?25l[?1c:  [?25h[?0c    " Local option
[?25l[?1c:  [?25h[?0c    let test_cases += [['&l:errorformat', 1]]
[?25l[?1c:  [?25h[?0c    " Negative form of existing and working option (long form)
[?25l[?1c:  [?25h[?0c    let test_cases += [['&nojoinspaces', 0]]
[?25l[?1c:  [?25h[?0c    " Negative form of existing and working option (short form)
[?25l[?1c:  [?25h[?0c    let test_cases += [['&nojs', 0]]
[?25l[?1c:  [?25h[?0c    " Non-existing option
[?25l[?1c:  [?25h[?0c    let test_cases += [['&myxyzoption', 0]]
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Existing and working option (long form)
[?25l[?1c:  [?25h[?0c    let test_cases += [['+incsearch', 1]]
[?25l[?1c:  [?25h[?0c    " Existing and working option with garbage
[?25l[?1c:  [?25h[?0c    let test_cases += [['+incsearch!1', 0]]
[?25l[?1c:  [?25h[?0c    " Existing and working option (short form)
[?25l[?1c:  [?25h[?0c    let test_cases += [['+is', 1]]
[?25l[?1c:  [?25h[?0c    " Existing option that is hidden.
[?25l[?1c:  [?25h[?0c    let test_cases += [['+autoprint', 0]]
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Existing environment variable
[?25l[?1c:  [?25h[?0c    let $EDITOR_NAME = 'Vim Editor'
[?25l[?1c:  [?25h[?0c    let test_cases += [['$EDITOR_NAME', 1]]
[?25l[?1c:  [?25h[?0c    " Non-existing environment variable
[?25l[?1c:  [?25h[?0c    let test_cases += [['$NON_ENV_VAR', 0]]
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Valid internal function
[?25l[?1c:  [?25h[?0c    let test_cases += [['*bufnr', 1]]
[?25l[?1c:  [?25h[?0c    " Valid internal function with ()
[?25l[?1c:  [?25h[?0c    let test_cases += [['*bufnr()', 1]]
[?25l[?1c:  [?25h[?0c    " Non-existing internal function
[?25l[?1c:  [?25h[?0c    let test_cases += [['*myxyzfunc', 0]]
[?25l[?1c:  [?25h[?0c    " Valid internal function with garbage
[?25l[?1c:  [?25h[?0c    let test_cases += [['*bufnr&6', 0]]
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Valid user defined function
[?25l[?1c:  [?25h[?0c    let test_cases += [['*TestExists', 1]]
[?25l[?1c:  [?25h[?0c    " Non-existing user defined function
[?25l[?1c:  [?25h[?0c    let test_cases += [['*MyxyzFunc', 0]]
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Function that may be created by FuncUndefined event
[?25l[?1c:  [?25h[?0c    let test_cases += [['*UndefFun', 0]]
[?25l[?1c:  [?25h[?0c    " Function that may be created by script autoloading
[?25l[?1c:  [?25h[?0c    let test_cases += [['*footest#F', 0]]
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    redir! > test.out
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    for [test_case, result] in test_cases
[?25l[?1c:    [?25h[?0c        echo test_case . ": " . result
[?25l[?1c:    [?25h[?0c        call RunTest(test_case, result)
[?25l[?1c:    [?25h[?0c    endfor
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Valid internal command (full match)
[?25l[?1c:  [?25h[?0c    echo ':edit: 2'
[?25l[?1c:  [?25h[?0c    if exists(':edit') == 2
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Valid internal command (full match) with garbage
[?25l[?1c:  [?25h[?0c    echo ':edit/a: 0'
[?25l[?1c:  [?25h[?0c    if exists(':edit/a') == 0
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Valid internal command (partial match)
[?25l[?1c:  [?25h[?0c    echo ':q: 1'
[?25l[?1c:  [?25h[?0c    if exists(':q') == 1
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Non-existing internal command
[?25l[?1c:  [?25h[?0c    echo ':invalidcmd: 0'
[?25l[?1c:  [?25h[?0c    if !exists(':invalidcmd')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " User defined command (full match)
[?25l[?1c:  [?25h[?0c    command! MyCmd :echo 'My command'
[?25l[?1c:  [?25h[?0c    echo ':MyCmd: 2'
[?25l[?1c:  [?25h[?0c    if exists(':MyCmd') == 2
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " User defined command (partial match)
[?25l[?1c:  [?25h[?0c    command! MyOtherCmd :echo 'Another command'
[?25l[?1c:  [?25h[?0c    echo ':My: 3'
[?25l[?1c:  [?25h[?0c    if exists(':My') == 3
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Command modifier
[?25l[?1c:  [?25h[?0c    echo ':rightbelow: 2'
[?25l[?1c:  [?25h[?0c    if exists(':rightbelow') == 2
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Non-existing user defined command (full match)
[?25l[?1c:  [?25h[?0c    delcommand MyCmd
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    echo ':MyCmd: 0'
[?25l[?1c:  [?25h[?0c    if !exists(':MyCmd')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Non-existing user defined command (partial match)
[?25l[?1c:  [?25h[?0c    delcommand MyOtherCmd
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    echo ':My: 0'
[?25l[?1c:  [?25h[?0c    if !exists(':My')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Valid local variable
[?25l[?1c:  [?25h[?0c    let local_var = 1
[?25l[?1c:  [?25h[?0c    echo 'local_var: 1'
[?25l[?1c:  [?25h[?0c    if exists('local_var')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Valid local variable with garbage
[?25l[?1c:  [?25h[?0c    let local_var = 1
[?25l[?1c:  [?25h[?0c    echo 'local_var%n: 0'
[?25l[?1c:  [?25h[?0c    if !exists('local_var%n')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Non-existing local variable
[?25l[?1c:  [?25h[?0c    unlet local_var
[?25l[?1c:  [?25h[?0c    echo 'local_var: 0'
[?25l[?1c:  [?25h[?0c    if !exists('local_var')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Non-existing autoload variable that may be autoloaded
[?25l[?1c:  [?25h[?0c    echo 'footest#x: 0'
[?25l[?1c:  [?25h[?0c    if !exists('footest#x')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Valid local list
[?25l[?1c:  [?25h[?0c    let local_list = ["blue", "orange"]
[?25l[?1c:  [?25h[?0c    echo 'local_list: 1'
[?25l[?1c:  [?25h[?0c    if exists('local_list')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Valid local list item
[?25l[?1c:  [?25h[?0c    echo 'local_list[1]: 1'
[?25l[?1c:  [?25h[?0c    if exists('local_list[1]')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Valid local list item with garbage
[?25l[?1c:  [?25h[?0c    echo 'local_list[1]+5: 0'
[?25l[?1c:  [?25h[?0c    if !exists('local_list[1]+5')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Invalid local list item
[?25l[?1c:  [?25h[?0c    echo 'local_list[2]: 0'
[?25l[?1c:  [?25h[?0c    if !exists('local_list[2]')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Non-existing local list
[?25l[?1c:  [?25h[?0c    unlet local_list
[?25l[?1c:  [?25h[?0c    echo 'local_list: 0'
[?25l[?1c:  [?25h[?0c    if !exists('local_list')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Valid local dictionary
[?25l[?1c:  [?25h[?0c    let local_dict = {"xcord":100, "ycord":2}
[?25l[?1c:  [?25h[?0c    echo 'local_dict: 1'
[?25l[?1c:  [?25h[?0c    if exists('local_dict')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Non-existing local dictionary
[?25l[?1c:  [?25h[?0c    unlet local_dict
[?25l[?1c:  [?25h[?0c    echo 'local_dict: 0'
[?25l[?1c:  [?25h[?0c    if !exists('local_dict')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Existing local curly-brace variable
[?25l[?1c:  [?25h[?0c    let str = "local"
[?25l[?1c:  [?25h[?0c    let curly_{str}_var = 1
[?25l[?1c:  [?25h[?0c    echo 'curly_' . str . '_var: 1'
[?25l[?1c:  [?25h[?0c    if exists('curly_{str}_var')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Non-existing local curly-brace variable
[?25l[?1c:  [?25h[?0c    unlet curly_{str}_var
[?25l[?1c:  [?25h[?0c    echo 'curly_' . str . '_var: 0'
[?25l[?1c:  [?25h[?0c    if !exists('curly_{str}_var')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Existing global variable
[?25l[?1c:  [?25h[?0c    let g:global_var = 1
[?25l[?1c:  [?25h[?0c    echo 'g:global_var: 1'
[?25l[?1c:  [?25h[?0c    if exists('g:global_var')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Existing global variable with garbage
[?25l[?1c:  [?25h[?0c    echo 'g:global_var-n: 1'
[?25l[?1c:  [?25h[?0c    if !exists('g:global_var-n')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Non-existing global variable
[?25l[?1c:  [?25h[?0c    unlet g:global_var
[?25l[?1c:  [?25h[?0c    echo 'g:global_var: 0'
[?25l[?1c:  [?25h[?0c    if !exists('g:global_var')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Existing global list
[?25l[?1c:  [?25h[?0c    let g:global_list = ["blue", "orange"]
[?25l[?1c:  [?25h[?0c    echo 'g:global_list: 1'
[?25l[?1c:  [?25h[?0c    if exists('g:global_list')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Non-existing global list
[?25l[?1c:  [?25h[?0c    unlet g:global_list
[?25l[?1c:  [?25h[?0c    echo 'g:global_list: 0'
[?25l[?1c:  [?25h[?0c    if !exists('g:global_list')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Existing global dictionary
[?25l[?1c:  [?25h[?0c    let g:global_dict = {"xcord":100, "ycord":2}
[?25l[?1c:  [?25h[?0c    echo 'g:global_dict: 1'
[?25l[?1c:  [?25h[?0c    if exists('g:global_dict')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Non-existing global dictionary
[?25l[?1c:  [?25h[?0c    unlet g:global_dict
[?25l[?1c:  [?25h[?0c    echo 'g:global_dict: 0'
[?25l[?1c:  [?25h[?0c    if !exists('g:global_dict')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Existing global curly-brace variable
[?25l[?1c:  [?25h[?0c    let str = "global"
[?25l[?1c:  [?25h[?0c    let g:curly_{str}_var = 1
[?25l[?1c:  [?25h[?0c    echo 'g:curly_' . str . '_var: 1'
[?25l[?1c:  [?25h[?0c    if exists('g:curly_{str}_var')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Non-existing global curly-brace variable
[?25l[?1c:  [?25h[?0c    unlet g:curly_{str}_var
[?25l[?1c:  [?25h[?0c    echo 'g:curly_' . str . '_var: 0'
[?25l[?1c:  [?25h[?0c    if !exists('g:curly_{str}_var')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Existing window variable
[?25l[?1c:  [?25h[?0c    echo 'w:window_var: 1'
[?25l[?1c:  [?25h[?0c    let w:window_var = 1
[?25l[?1c:  [?25h[?0c    if exists('w:window_var')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Non-existing window variable
[?25l[?1c:  [?25h[?0c    unlet w:window_var
[?25l[?1c:  [?25h[?0c    echo 'w:window_var: 0'
[?25l[?1c:  [?25h[?0c    if !exists('w:window_var')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Existing window list
[?25l[?1c:  [?25h[?0c    let w:window_list = ["blue", "orange"]
[?25l[?1c:  [?25h[?0c    echo 'w:window_list: 1'
[?25l[?1c:  [?25h[?0c    if exists('w:window_list')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Non-existing window list
[?25l[?1c:  [?25h[?0c    unlet w:window_list
[?25l[?1c:  [?25h[?0c    echo 'w:window_list: 0'
[?25l[?1c:  [?25h[?0c    if !exists('w:window_list')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Existing window dictionary
[?25l[?1c:  [?25h[?0c    let w:window_dict = {"xcord":100, "ycord":2}
[?25l[?1c:  [?25h[?0c    echo 'w:window_dict: 1'
[?25l[?1c:  [?25h[?0c    if exists('w:window_dict')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Non-existing window dictionary
[?25l[?1c:  [?25h[?0c    unlet w:window_dict
[?25l[?1c:  [?25h[?0c    echo 'w:window_dict: 0'
[?25l[?1c:  [?25h[?0c    if !exists('w:window_dict')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Existing window curly-brace variable
[?25l[?1c:  [?25h[?0c    let str = "window"
[?25l[?1c:  [?25h[?0c    let w:curly_{str}_var = 1
[?25l[?1c:  [?25h[?0c    echo 'w:curly_' . str . '_var: 1'
[?25l[?1c:  [?25h[?0c    if exists('w:curly_{str}_var')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Non-existing window curly-brace variable
[?25l[?1c:  [?25h[?0c    unlet w:curly_{str}_var
[?25l[?1c:  [?25h[?0c    echo 'w:curly_' . str . '_var: 0'
[?25l[?1c:  [?25h[?0c    if !exists('w:curly_{str}_var')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Existing buffer variable
[?25l[?1c:  [?25h[?0c    echo 'b:buffer_var: 1'
[?25l[?1c:  [?25h[?0c    let b:buffer_var = 1
[?25l[?1c:  [?25h[?0c    if exists('b:buffer_var')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Non-existing buffer variable
[?25l[?1c:  [?25h[?0c    unlet b:buffer_var
[?25l[?1c:  [?25h[?0c    echo 'b:buffer_var: 0'
[?25l[?1c:  [?25h[?0c    if !exists('b:buffer_var')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Existing buffer list
[?25l[?1c:  [?25h[?0c    let b:buffer_list = ["blue", "orange"]
[?25l[?1c:  [?25h[?0c    echo 'b:buffer_list: 1'
[?25l[?1c:  [?25h[?0c    if exists('b:buffer_list')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Non-existing buffer list
[?25l[?1c:  [?25h[?0c    unlet b:buffer_list
[?25l[?1c:  [?25h[?0c    echo 'b:buffer_list: 0'
[?25l[?1c:  [?25h[?0c    if !exists('b:buffer_list')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Existing buffer dictionary
[?25l[?1c:  [?25h[?0c    let b:buffer_dict = {"xcord":100, "ycord":2}
[?25l[?1c:  [?25h[?0c    echo 'b:buffer_dict: 1'
[?25l[?1c:  [?25h[?0c    if exists('b:buffer_dict')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Non-existing buffer dictionary
[?25l[?1c:  [?25h[?0c    unlet b:buffer_dict
[?25l[?1c:  [?25h[?0c    echo 'b:buffer_dict: 0'
[?25l[?1c:  [?25h[?0c    if !exists('b:buffer_dict')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Existing buffer curly-brace variable
[?25l[?1c:  [?25h[?0c    let str = "buffer"
[?25l[?1c:  [?25h[?0c    let b:curly_{str}_var = 1
[?25l[?1c:  [?25h[?0c    echo 'b:curly_' . str . '_var: 1'
[?25l[?1c:  [?25h[?0c    if exists('b:curly_{str}_var')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Non-existing buffer curly-brace variable
[?25l[?1c:  [?25h[?0c    unlet b:curly_{str}_var
[?25l[?1c:  [?25h[?0c    echo 'b:curly_' . str . '_var: 0'
[?25l[?1c:  [?25h[?0c    if !exists('b:curly_{str}_var')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Script-local tests
[?25l[?1c:  [?25h[?0c    source test60.vim
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Existing Vim internal variable
[?25l[?1c:  [?25h[?0c    echo 'v:version: 1'
[?25l[?1c:  [?25h[?0c    if exists('v:version')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Non-existing Vim internal variable
[?25l[?1c:  [?25h[?0c    echo 'v:non_exists_var: 0'
[?25l[?1c:  [?25h[?0c    if !exists('v:non_exists_var')
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "OK"
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c[1m[34m^I[0mecho "FAILED"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c    " Function arguments
[?25l[?1c:  [?25h[?0c    function TestFuncArg(func_arg, ...)
[?25l[?1c:    [?25h[?0c        echo 'a:func_arg: 1'
[?25l[?1c:    [?25h[?0c        if exists('a:func_arg')
[?25l[?1c:      [?25h[?0c            echo "OK"
[?25l[?1c:      [?25h[?0c        else
[?25l[?1c:      [?25h[?0c            echo "FAILED"
[?25l[?1c:      [?25h[?0c        endif
[?25l[?1c:    [?25h[?0c
[?25l[?1c:    [?25h[?0c        echo 'a:non_exists_arg: 0'
[?25l[?1c:    [?25h[?0c        if !exists('a:non_exists_arg')
[?25l[?1c:      [?25h[?0c            echo "OK"
[?25l[?1c:      [?25h[?0c        else
[?25l[?1c:      [?25h[?0c            echo "FAILED"
[?25l[?1c:      [?25h[?0c        endif
[?25l[?1c:    [?25h[?0c
[?25l[?1c:    [?25h[?0c        echo 'a:1: 1'
[?25l[?1c:    [?25h[?0c        if exists('a:1')
[?25l[?1c:      [?25h[?0c            echo "OK"
[?25l[?1c:      [?25h[?0c        else
[?25l[?1c:      [?25h[?0c            echo "FAILED"
[?25l[?1c:      [?25h[?0c        endif
[?25l[?1c:    [?25h[?0c
[?25l[?1c:    [?25h[?0c        echo 'a:2: 0'
[?25l[?1c:    [?25h[?0c        if !exists('a:2')
[?25l[?1c:      [?25h[?0c            echo "OK"
[?25l[?1c:      [?25h[?0c        else
[?25l[?1c:      [?25h[?0c            echo "FAILED"
[?25l[?1c:      [?25h[?0c        endif
[?25l[?1c:    [?25h[?0c    endfunction
[?25l[?1c:    [?25h[?0c
[?25l[?1c:    [?25h[?0c    call TestFuncArg("arg1", "arg2")
[?25l[?1c:    [?25h[?0c
[?25l[?1c:    [?25h[?0c    echo ' g:footest#x =' g:footest#x
[?25l[?1c:    [?25h[?0c    echo '   footest#F()' footest#F()
[?25l[?1c:    [?25h[?0c    echo 'UndefFun()' UndefFun()
[?25l[?1c:    [?25h[?0c
[?25l[?1c:    [?25h[?0c    redir END
[?25l[?1c:    [?25h[?0cendfunction[27m[24m[0m[H[J[?25l[?1c[2;5Hredir END
endfunction
:call TestExists()
:"
:function TestHas()
  redir >> test.out
  for pl in ['6.9.999', '7.1.999', '7.4.123', '9.1.0', '9.9.1']
    echo 'has patch ' . pl . ': ' . has('patch-' . pl)
  endfor
  redir END
endfunc
:call TestHas()
:"
:delfunc TestExists
:delfunc RunTest
:delfunc TestFuncArg
:edit! test.out
:set ff=unix
:w
:qa!
:while getchar(1) | call getchar() | endwhile
ENDTEST
[?25h[?0c[?25l[?1c
:[?25h[?0ccall TestExists()[?25l[?1c#myagroup: 1[25;13H[K[25;1H
OK
#myagroup+b: 0
OK
#myagroup#BufEnter: 1
OK
#myagroup#BufEnter#*.my: 1
OK
#BufEnter: 1
OK
#BufEnter#*.my: 1
OK
#xyzagroup: 0
OK
#xyzagroup#BufEnter: 0
OK
#myagroup#CmdwinEnter: 0
OK
#myagroup#xyzacmd: 0
OK
#myagroup#BufEnter#xyzpat: 0
OK
#BufEnter#xyzpat: 0
OK
###: 0
OK
##: 0
OK
##FileReadCmd: 1
OK
##MySpecialCmd: 0
OK
&textwidth: 1
OK
&tw: 1
OK
&tw-: 0
OK
&g:errorformat: 1
OK
&l:errorformat: 1
OK
&nojoinspaces: 0
OK
&nojs: 0
OK
&myxyzoption: 0
OK
+incsearch: 1
OK
+incsearch!1: 0
OK
+is: 1
OK
+autoprint: 0
OK
$EDITOR_NAME: 1
OK
$NON_ENV_VAR: 0
OK
*bufnr: 1
OK
*bufnr(): 1
OK
*myxyzfunc: 0
OK
*bufnr&6: 0
OK
*TestExists: 1
OK
*MyxyzFunc: 0
OK
*UndefFun: 0
OK
*footest#F: 0
OK
:edit: 2
OK
:edit/a: 0
OK
:q: 1
OK
:invalidcmd: 0
OK
:MyCmd: 2
OK
:My: 3
OK
:rightbelow: 2
OK
:MyCmd: 0
OK
:My: 0
OK
local_var: 1
OK
local_var%n: 0
OK
local_var: 0
OK
footest#x: 0
OK
local_list: 1
OK
local_list[1]: 1
OK
local_list[1]+5: 0
OK
local_list[2]: 0
OK
local_list: 0
OK
local_dict: 1
OK
local_dict: 0
OK
curly_local_var: 1
OK
curly_local_var: 0
OK
g:global_var: 1
OK
g:global_var-n: 1
OK
g:global_var: 0
OK
g:global_list: 1
OK
g:global_list: 0
OK
g:global_dict: 1
OK
g:global_dict: 0
OK
g:curly_global_var: 1
OK
g:curly_global_var: 0
OK
w:window_var: 1
OK
w:window_var: 0
OK
w:window_list: 1
OK
w:window_list: 0
OK
w:window_dict: 1
OK
w:window_dict: 0
OK
w:curly_window_var: 1
OK
w:curly_window_var: 0
OK
b:buffer_var: 1
OK
b:buffer_var: 0
OK
b:buffer_list: 1
OK
b:buffer_list: 0
OK
b:buffer_dict: 1
OK
b:buffer_dict: 0
OK
b:curly_buffer_var: 1
OK
b:curly_buffer_var: 0
OK
s:script_var: 1
OK
s:script_var: 0
OK
s:script_list: 1
OK
s:script_list: 0
OK
s:script_dict: 1
OK
s:script_dict: 0
OK
s:curly_script_var: 1
OK
s:curly_script_var: 0
OK
*s:my_script_func: 1
OK
*s:my_script_func: 0
OK
v:version: 1
OK
v:non_exists_var: 0
OK
a:func_arg: 1
OK
a:non_exists_arg: 0
OK
a:1: 1
OK
a:2: 0
OK
 g:footest#x = 1
   footest#F() 0
UndefFun() 0
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[27m[24m[0m[H[J[2;5Hredir END
endfunction
:call TestExists()
:"
:function TestHas()
  redir >> test.out
  for pl in ['6.9.999', '7.1.999', '7.4.123', '9.1.0', '9.9.1']
    echo 'has patch ' . pl . ': ' . has('patch-' . pl)
  endfor
  redir END
endfunc
:call TestHas()
:"
:delfunc TestExists
:delfunc RunTest
:delfunc TestFuncArg
:edit! test.out
:set ff=unix
:w
:qa!
:while getchar(1) | call getchar() | endwhile
ENDTEST
[?25h[?0c[?25l[?1c
:[?25h[?0cfunction TestHas()[?25l[?1c
:  [?25h[?0c  redir >> test.out
[?25l[?1c:  [?25h[?0c  for pl in ['6.9.999', '7.1.999', '7.4.123', '9.1.0', '9.9.1']
[?25l[?1c:    [?25h[?0c    echo 'has patch ' . pl . ': ' . has('patch-' . pl)
[?25l[?1c:    [?25h[?0c  endfor
[?25l[?1c:  [?25h[?0c  redir END
[?25l[?1c:  [?25h[?0cendfunc[1;1H[6L[?25l[?1c[2;5Hredir END
endfunction
:call TestExists()
:"
:function TestHas()[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0ccall TestHas()[?25l[?1chas patch 6.9.999: 1
has patch 7.1.999: 1
has patch 7.4.123: 1
has patch 9.1.0: 0
has patch 9.9.1: 0
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[5L[2;5Hredir END
endfunction
:call TestExists()
:"[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cdelfunc TestExists[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cdelfunc RunTest[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cdelfunc TestFuncArg[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cedit! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[Incomplete last line] 211 lines, 2041 characters[2;1H#myagroup: 1[2;13H[K[3;1HOK[3;3H[K[4;1H#myagroup+b: 0[4;15H[K[5;1HOK
#myagroup#BufEnter: 1
OK[7;3H[K[8;1H#myagroup#BufEnter#*.my: 1[8;27H[K[9;1HOK[9;5H[K[10;1H#BufEnter: 1
OK[11;3H[K[12;1H#BufEnter#*.my: 1
OK[13;3H[K[14;1H#xyzagroup: 0
OK[15;3H[K[16;1H#xyzagroup#BufEnter: 0
OK[17;3H[K[18;1H#myagroup#CmdwinEnter: 0
OK[19;3H[K[20;1H#myagroup#xyzacmd: 0
OK[21;3H[K[22;1H#myagroup#BufEnter#xyzpat: 0[22;29H[K[23;1HOK[23;3H[K[24;1H#BufEnter#xyzpat: 0[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ff=unix[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"test.out" 211 lines, 2042 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test61.failed test.ok test.out X* viminfo
cp test61.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test61.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test61.in" 113 lines, 1774 characters[1;1HTests for undo tree.
Since this script is sourced we need to explicitly break changes up in
undo-able pieces.  Do that by setting 'undolevels'.
Also tests :earlier and :later.

STARTTEST
:echo undotree().entries
ENDTEST

STARTTEST
:" Delete three characters and undo
Gx:set ul=100
x:set ul=100
x:.w! test.out
g-:.w >>test.out
g-:.w >>test.out
g-:.w >>test.out
g-:.w >>test.out
:"
:/^111/w >>test.out
:" Delete three other characters and go back in time step by step
$x:set ul=100
x:set ul=100
x:.w >>test.out[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for undo tree.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[6;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 1 line, 25 characters written[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[7;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[8;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cecho undotree().entries[?25l[?1c[][25;3H[K[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[10;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[11;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H97 lines, 1501 characters written[11;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[11;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1Hoa[1m[34m^[[0m
:set ul=100
ob[1m[34m^[[0m
:set ul=100
o1[1m[34m^[[0ma2[1m[34m^R[0m=setline('.','1234')

[1m[34m^[[0muu:"
oc[1m[34m^[[0m
:set ul=100
o1[1m[34m^[[0ma2[1m[34m^R[0m=setline('.','1234')

[1m[34m^[[0mu:"
od[1m[34m^[[0m
:set ul=100
o1[1m[34m^[[0ma2[1m[34m^R[0m=string(123)
[1m[34m^[[0mu:"
:%w >>test.out
:qa!
ENDTEST

1111 -----
2222 -----

123456789[19;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Delete three characters and undo[?25l[?1c[20;1H[?25h[?0c[24;1H[?25l[?1c23456789[24;9H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ul=100[?25l[?1c[24;1H[?25h[?0c[?25l[?1c3456789[24;8H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ul=100[?25l[?1c[24;1H[?25h[?0c[?25l[?1c456789[24;7H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 1 line, 7 characters written[24;1H[?25h[?0c[?25l[?1c
1 change; before #3  0 seconds ago[25;35H[K[24;1H3456789[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 8 characters appended[24;1H[?25h[?0c[?25l[?1c
1 change; before #2  0 seconds ago[25;35H[K[24;1H23456789[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 9 characters appended[24;1H[?25h[?0c[?25l[?1c
1 change; before #1  0 seconds ago[25;35H[K[24;1H123456789[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 10 characters appended[24;1H[?25h[?0c[?25l[?1c
Already at oldest change[25;25H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 10 characters appended[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^111/w >>test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H1 line, 11 characters appended[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Delete three other characters and go back in time step by step[?25l[?1c[24;1H[?25h[?0c[8C[?25l[?1c[24;9H[K[24;8H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ul=100[?25l[?1c[24;8H[?25h[?0c[?25l[?1c[24;8H[K[24;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ul=100[?25l[?1c[24;7H[?25h[?0c[?25l[?1c[24;7H[K[24;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 7 characters appended[24;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csleep 1[?25l[?1c[24;6H[?25h[?0c[?25l[?1c
1 change; before #6  1 seconds ago[24;7H7[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 8 characters appended[24;7H[?25h[?0c[?25l[?1c
1 change; before #5  1 seconds ago[25;35H[K[24;8H8[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 9 characters appended[24;8H[?25h[?0c[?25l[?1c
4 changes; after #3  1 seconds ago[25;35H[K[24;1H456789[24;7H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 7 characters appended[24;1H[?25h[?0c[?25l[?1c
1 change; before #3  1 seconds ago[25;35H[K[24;1H3456789[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 8 characters appended[24;1H[?25h[?0c[?25l[?1c
1 change; before #2  1 seconds ago[25;35H[K[24;1H23456789[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 9 characters appended[24;1H[?25h[?0c[?25l[?1c
1 change; before #1  1 seconds ago[25;35H[K[24;1H123456789[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 10 characters appended[24;1H[?25h[?0c[?25l[?1c
Already at oldest change[25;25H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 10 characters appended[24;1H[?25h[?0c[?25l[?1c
Already at oldest change[25;25H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 10 characters appended[24;1H[?25h[?0c[?25l[?1c
3 changes; after #6  1 seconds ago[25;35H[K[24;7H[K[24;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 7 characters appended[24;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^222/w >>test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H1 line, 11 characters appended[24;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Delay for three seconds and go some seconds forward and backward[?25l[?1c[24;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csleep 2[?25l[?1c[24;6H[?25h[?0c[?25l[?1c6a[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ul=100[?25l[?1c[24;7H[?25h[?0c[?25l[?1cab[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ul=100[?25l[?1c[24;8H[?25h[?0c[?25l[?1cbc[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ul=100[?25l[?1c[24;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 10 characters appended[24;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cear 1s[?25l[?1c3 changes; before #7  0 seconds ago[24;7H[K[24;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 7 characters appended[24;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cear 3s[?25l[?1c3 changes; before #1  3 seconds ago[24;7H789[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 10 characters appended[24;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clater 1s[?25l[?1c3 changes; after #6  3 seconds ago[24;7H[K[24;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 7 characters appended[24;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clater 1h[?25l[?1c3 changes; after #9  0 seconds ago[24;7Habc[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 10 characters appended[24;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test undojoin[?25l[?1c[24;9H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Haaaa[25;1H[K[24;4H[?25h[?0c[?25l[?1c
:[?25h[?0cset ul=100[?25l[?1c[24;4H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hbbbb[25;1H[K[24;4H[?25h[?0c[?25l[?1c
1 line less; before #11  0 seconds ago[24;1H[1m[34m~                                                                               [23;4H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 5 characters appended[23;4H[?25h[?0c[?25l[?1c
bbbb[24;5H[K[24;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ul=100[?25l[?1c[24;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cundojoin[?25l[?1c[24;4H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hcccc[25;1H[K[24;4H[?25h[?0c[?25l[?1c
2 fewer lines; before #12  0 seconds ago[23;1H[1m[34m~                                                                               [24;1H~                                                                               [22;4H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1 line, 5 characters appended[22;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! Xtest[?25l[?1c"Xtest" [New File][1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0mone one one[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ul=100[?25l[?1c[1;11H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw![?25l[?1c"Xtest" [New File] 1 line, 12 characters written[1;11H[?25h[?0c[?25l[?1c
two[2;4H[K[2;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ul=100[?25l[?1c[2;3H[?25h[?0c[?25l[?1c
two[3;4H[K[3;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ul=100[?25l[?1c[3;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"Xtest" 3 lines, 20 characters written[3;3H[?25h[?0c[?25l[?1c
three[4;6H[K[4;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cearlier 1f[?25l[?1c1 line less; before #4  0 seconds ago[4;1H[1m[34m~                                                                               [3;3H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c" expect "one one one\ntwo\ntwo"[?25l[?1c[3;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c%yank a[?25l[?1c3 lines yanked[3;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cearlier 1f[?25l[?1c2 fewer lines; before #2  0 seconds ago[2;1H[1m[34m~                                                                               [3;1H~                                                                               [1;11H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c" expect "one one one"[?25l[?1c[1;11H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c%yank b[?25l[?1c[1;11H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cearlier 1f[?25l[?1c1 line less; before #1  1 seconds ago[1;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" expect empty line[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c%yank c[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clater 1f[?25l[?1c1 more line; after #1  1 seconds ago[1;1Hone one one[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" expect "one one one"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c%yank d[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clater 1f[?25l[?1c2 more lines; after #3  0 seconds ago[2;1Htwo[2;4H[K[3;1Htwo[3;4H[K[2;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" expect "one one one\ntwo\ntwo"[?25l[?1c[2;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c%yank e[?25l[?1c3 lines yanked[2;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clater 1f[?25l[?1c1 more line; after #4  0 seconds ago[4;1Hthree[4;6H[K[3;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" expect "one one one\ntwo\ntwo\nthree"[?25l[?1c[3;3H[?25h[?0c[1;1H[?25l[?1c[1;24r[1;1H[L[1;25r[1;1H---[25;1H[K[1;3H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c0put e[?25l[?1c3 more lines[1;24r[1;1H[3L[1;25r[1;1Hone one one
two
two[25;1H[K[25;1H3 more lines[3;1H[?25h[?0c[1;1H[?25l[?1c[1;24r[1;1H[L[1;25r[1;1H---[25;1H[K[1;3H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c0put d[?25l[?1c[1;24r[1;1H[L[1;25r[1;1Hone one one[25;1H[K[1;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[L[1;25r[1;1H---[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c0put c[?25l[?1c[1;24r[1;1H[L[1;25r[25;1H[K[1;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[L[1;25r[1;1H---[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c0put b[?25l[?1c[1;24r[1;1H[L[1;25r[1;1Hone one one[25;1H[K[1;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[L[1;25r[1;1H---[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c0put a[?25l[?1c3 more lines[1;24r[1;1H[3L[1;25r[1;1Hone one one
two
two[25;1H[K[25;1H3 more lines[3;1H[?25h[?0c[1;1H[?25l[?1c[1;24r[1;1H[L[1;25r[1;1H---[25;1H[K[1;3H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H19 lines, 115 characters appended[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nocp viminfo+=nviminfo[?25l[?1c[1;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cenew![?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[1m-- INSERT --[0m[25;1H[K[2;1Ha[2;2H[K[2;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset ul=100[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT --[0m[25;1H[K[3;1Hb[3;2H[K[3;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset ul=100[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT --[0m[25;1H[K[4;1H1[4;2H[K[4;1H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT --[0m[25;1H[K[25;1H=[?25h[?0csetline('.','1234')[?25l[?1c[4;2H20
34[5;3H[K[25;1H[1m-- INSERT --[0m[25;13H[K[5;1Hu[?25h[?0c3[25;1H[K[?25l[?1c[5;1H[?25h[?0c[?25l[?1c[25;1H1 line less; before #4  0 seconds ago[4;3H[K[5;1H[1m[34m~                                                                               [4;2H[?25h[?0c[?25l[?1c[0m[25;22H3[4;1H[1m[34m~                                                                               [3;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT --[0m[25;1H[K[4;1Hc[4;2H[K[4;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset ul=100[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT --[0m[25;1H[K[5;1H1[5;2H[K[5;1H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT --[0m[25;1H[K[25;1H=[?25h[?0csetline('.','1234')[?25l[?1c[5;2H20
34[6;3H[K[25;1H[1m-- INSERT --[0m[25;13H[K[6;1Hu[?25h[?0c3[25;1H[K[?25l[?1c[6;1H[?25h[?0c[?25l[?1c[25;1H1 line less; before #7  0 seconds ago[5;3H[K[6;1H[1m[34m~                                                                               [5;2H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[5;2H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT --[0m[25;1H[K[6;1Hd[6;2H[K[6;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset ul=100[?25l[?1c[6;1H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT --[0m[25;1H[K[7;1H1[7;2H[K[7;1H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT --[0m[25;1H[K[25;1H=[?25h[?0cstring(123)[?25l[?1c[25;1H[K[7;2H2123[?25h[?0c[?25l[?1c[25;1H1 line less; before #9  0 seconds ago[7;1H[1m[34m~                                                                               [6;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c%w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H6L, 12C appended[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
flaky test ok first time
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test62.failed test.ok test.out X* viminfo
cp test62.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test62.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test62.in" 191 lines, 5514 characters[1;1HTests for tab pages

STARTTEST
:so small.vim
:lang C
:" Simple test for opening and closing a tab page
:tabnew
:let nr = tabpagenr()
:q
:call append(line('$'), 'tab page ' . nr)
:unlet nr
:"
:" Open three tab pages and use ":tabdo"
:0tabnew
:1tabnew
:888tabnew
:tabdo call append(line('$'), 'this is tab page ' . tabpagenr())
:tabclose! 2
:tabrewind
:let line1 = getline('$')
:undo
:q
:tablast
:let line2 = getline('$')[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for tab pages[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 185 lines, 5465 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;9HC tabnew[2;9HC tabnext 1[3;9Hautocmd TabDestructive TabEnter * nested :C tabnext 2 | C tabclose 3[4;9HC tabnext 3[5;9Hlet g:r+=[tabpagenr().'/'.tabpagenr('$')]
    else[7;9Hlet g:r+=["=== tabnext 3 ===","BufLeave","WinLeave","TabLeave","WinEnter[8;1H","TabEnter","=== tabnext 2 ===","=== tabclose 3 ===","2/2","=== tabnew ===","Wi[9;1HnLeave","TabLeave","WinEnter","TabEnter","BufLeave","BufEnter","=== tabnext 1 ==[10;1H=","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","BufEnter","=== tabnex[11;1Ht 3 ===","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 =[12;1H==","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 ===","[13;1H=== tabclose 3 ===","BufEnter","=== tabclose 3 ===","2/2",]
    endif
endfunction
:call Test()
:$ put =g:r
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:[22;1H[?25h[?0c
[?25l[?1c

:so! Xdotest[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clang C[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Simple test for opening and closing a tab page[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctabnew[?25l[?1c[27m[24m[0m[H[J[1;1H[1m[4m[37m[40m test62.in [24m[0m[1m [No Name] [0m[7m                                                          [0m[1;80H[1m[4m[37m[40mX[24m[0m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0clet nr = tabpagenr()[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cq[?25l[?1c[27m[24m[0m[H[J[1;9HC tabnew[2;9HC tabnext 1[3;9Hautocmd TabDestructive TabEnter * nested :C tabnext 2 | C tabclose 3[4;9HC tabnext 3[5;9Hlet g:r+=[tabpagenr().'/'.tabpagenr('$')]
    else[7;9Hlet g:r+=["=== tabnext 3 ===","BufLeave","WinLeave","TabLeave","WinEnter[8;1H","TabEnter","=== tabnext 2 ===","=== tabclose 3 ===","2/2","=== tabnew ===","Wi[9;1HnLeave","TabLeave","WinEnter","TabEnter","BufLeave","BufEnter","=== tabnext 1 ==[10;1H=","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","BufEnter","=== tabnex[11;1Ht 3 ===","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 =[12;1H==","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 ===","[13;1H=== tabclose 3 ===","BufEnter","=== tabclose 3 ===","2/2",]
    endif
endfunction
:call Test()
:$ put =g:r
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0ccall append(line('$'), 'tab page ' . nr)[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet nr[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Open three tab pages and use ":tabdo"[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c0tabnew[?25l[?1c[27m[24m[0m[H[J[1;1H[1m [No Name] [0m[1m[4m[37m[40m + test62.in [24m[0m[7m                                                        [0m[1;80H[1m[4m[37m[40mX[24m[0m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0c1tabnew[?25l[?1c[27m[24m[0m[H[J[1;1H[1m[4m[37m[40m [No Name] [24m[0m[1m [No Name] [0m[1m[4m[37m[40m + test62.in [24m[0m[7m                                             [0m[1;80H[1m[4m[37m[40mX[24m[0m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0c888tabnew[?25l[?1c[27m[24m[0m[H[J[1;1H[1m[4m[37m[40m [No Name]  [No Name]  + test62.in [24m[0m[1m [No Name] [0m[7m                                  [0m[1;80H[1m[4m[37m[40mX[24m[0m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0ctabdo call append(line('$'), 'this is tab page ' . tabpagenr())[?25l[?1c[27m[24m[0m[H[J[1;1H[1m[4m[37m[40m + [No Name]  + [No Name]  + test62.in [24m[0m[1m + [No Name] [0m[7m                            [0m[1;80H[1m[4m[37m[40mX[24m[0m[3;1Hthis is tab page 4
[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0ctabclose! 2[?25l[?1c[1;17H[1m[4m[37m[40mtest62.in[24m[0m[1C[1m + [No Name] [0m[7m             [27C [0m[1;80H[1m[4m[37m[40mX[2;1H[?25h[?0c[?25l[?1c[24m[0m[25;1H[K[25;1H:[?25h[?0ctabrewind[?25l[?1c[27m[24m[0m[H[J[1;1H[1m + [No Name] [0m[1m[4m[37m[40m + test62.in  + [No Name] [24m[0m[7m                                         [0m[1;80H[1m[4m[37m[40mX[24m[0m[3;1Hthis is tab page 1
[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0clet line1 = getline('$')[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cundo[?25l[?1c2 fewer lines; before #1  0 seconds ago[1;2H[1m[No Name] [0m[1m[4m[37m[40m + test62.in  + [No Name] [24m[0m[7m  [40C [0m[1;80H[1m[4m[37m[40mX[24m[0m[3;1H[1m[34m~                                                                               [2;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cq[?25l[?1c[27m[24m[0m[H[J[1;1H[1m + test62.in [0m[1m[4m[37m[40m + [No Name] [24m[0m[7m                                                      [0m[1;80H[1m[4m[37m[40mX[24m[0m[2;9HC tabnext 1[3;9Hautocmd TabDestructive TabEnter * nested :C tabnext 2 | C tabclose 3[4;9HC tabnext 3[5;9Hlet g:r+=[tabpagenr().'/'.tabpagenr('$')]
    else[7;9Hlet g:r+=["=== tabnext 3 ===","BufLeave","WinLeave","TabLeave","WinEnter[8;1H","TabEnter","=== tabnext 2 ===","=== tabclose 3 ===","2/2","=== tabnew ===","Wi[9;1HnLeave","TabLeave","WinEnter","TabEnter","BufLeave","BufEnter","=== tabnext 1 ==[10;1H=","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","BufEnter","=== tabnex[11;1Ht 3 ===","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 =[12;1H==","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 ===","[13;1H=== tabclose 3 ===","BufEnter","=== tabclose 3 ===","2/2",]
    endif
endfunction
:call Test()
:$ put =g:r
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0ctablast[?25l[?1c[27m[24m[0m[H[J[1;1H[1m[4m[37m[40m + test62.in [24m[0m[1m + [No Name] [0m[7m                                                      [0m[1;80H[1m[4m[37m[40mX[24m[0m[3;1Hthis is tab page 4
[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0clet line2 = getline('$')[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cq![?25l[?1c[27m[24m[0m[H[J[1;9HC tabnew[2;9HC tabnext 1[3;9Hautocmd TabDestructive TabEnter * nested :C tabnext 2 | C tabclose 3[4;9HC tabnext 3[5;9Hlet g:r+=[tabpagenr().'/'.tabpagenr('$')]
    else[7;9Hlet g:r+=["=== tabnext 3 ===","BufLeave","WinLeave","TabLeave","WinEnter[8;1H","TabEnter","=== tabnext 2 ===","=== tabclose 3 ===","2/2","=== tabnew ===","Wi[9;1HnLeave","TabLeave","WinEnter","TabEnter","BufLeave","BufEnter","=== tabnext 1 ==[10;1H=","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","BufEnter","=== tabnex[11;1Ht 3 ===","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 =[12;1H==","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 ===","[13;1H=== tabclose 3 ===","BufEnter","=== tabclose 3 ===","2/2",]
    endif
endfunction
:call Test()
:$ put =g:r
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0ccall append(line('$'), line1)[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append(line('$'), line2)[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet line1 line2[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test for settabvar() and gettabvar() functions. Open a new tab page and [?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" set 3 variables to a number, string and a list. Verify that the variables[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" are correctly set.[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctabnew[?25l[?1c[27m[24m[0m[H[J[1;1H[1m[4m[37m[40m + test62.in [24m[0m[1m [No Name] [0m[7m                                                        [0m[1;80H[1m[4m[37m[40mX[24m[0m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0ctabfirst[?25l[?1c[27m[24m[0m[H[J[1;1H[1m + test62.in [0m[1m[4m[37m[40m [No Name] [24m[0m[7m                                                        [0m[1;80H[1m[4m[37m[40mX[24m[0m[2;9HC tabnext 1[3;9Hautocmd TabDestructive TabEnter * nested :C tabnext 2 | C tabclose 3[4;9HC tabnext 3[5;9Hlet g:r+=[tabpagenr().'/'.tabpagenr('$')]
    else[7;9Hlet g:r+=["=== tabnext 3 ===","BufLeave","WinLeave","TabLeave","WinEnter[8;1H","TabEnter","=== tabnext 2 ===","=== tabclose 3 ===","2/2","=== tabnew ===","Wi[9;1HnLeave","TabLeave","WinEnter","TabEnter","BufLeave","BufEnter","=== tabnext 1 ==[10;1H=","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","BufEnter","=== tabnex[11;1Ht 3 ===","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 =[12;1H==","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 ===","[13;1H=== tabclose 3 ===","BufEnter","=== tabclose 3 ===","2/2",]
    endif
endfunction
:call Test()
:$ put =g:r
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0ccall settabvar(2, 'val_num', 100)[?25l[?1c[27m[24m[0m[H[J[1;1H[1m + test62.in [0m[1m[4m[37m[40m [No Name] [24m[0m[7m                                                        [0m[1;80H[1m[4m[37m[40mX[24m[0m[2;9HC tabnext 1[3;9Hautocmd TabDestructive TabEnter * nested :C tabnext 2 | C tabclose 3[4;9HC tabnext 3[5;9Hlet g:r+=[tabpagenr().'/'.tabpagenr('$')]
    else[7;9Hlet g:r+=["=== tabnext 3 ===","BufLeave","WinLeave","TabLeave","WinEnter[8;1H","TabEnter","=== tabnext 2 ===","=== tabclose 3 ===","2/2","=== tabnew ===","Wi[9;1HnLeave","TabLeave","WinEnter","TabEnter","BufLeave","BufEnter","=== tabnext 1 ==[10;1H=","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","BufEnter","=== tabnex[11;1Ht 3 ===","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 =[12;1H==","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 ===","[13;1H=== tabclose 3 ===","BufEnter","=== tabclose 3 ===","2/2",]
    endif
endfunction
:call Test()
:$ put =g:r
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0ccall settabvar(2, 'val_str', 'SetTabVar test')[?25l[?1c[27m[24m[0m[H[J[1;1H[1m + test62.in [0m[1m[4m[37m[40m [No Name] [24m[0m[7m                                                        [0m[1;80H[1m[4m[37m[40mX[24m[0m[2;9HC tabnext 1[3;9Hautocmd TabDestructive TabEnter * nested :C tabnext 2 | C tabclose 3[4;9HC tabnext 3[5;9Hlet g:r+=[tabpagenr().'/'.tabpagenr('$')]
    else[7;9Hlet g:r+=["=== tabnext 3 ===","BufLeave","WinLeave","TabLeave","WinEnter[8;1H","TabEnter","=== tabnext 2 ===","=== tabclose 3 ===","2/2","=== tabnew ===","Wi[9;1HnLeave","TabLeave","WinEnter","TabEnter","BufLeave","BufEnter","=== tabnext 1 ==[10;1H=","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","BufEnter","=== tabnex[11;1Ht 3 ===","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 =[12;1H==","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 ===","[13;1H=== tabclose 3 ===","BufEnter","=== tabclose 3 ===","2/2",]
    endif
endfunction
:call Test()
:$ put =g:r
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0ccall settabvar(2, 'val_list', ['red', 'blue', 'green'])[?25l[?1c[27m[24m[0m[H[J[1;1H[1m + test62.in [0m[1m[4m[37m[40m [No Name] [24m[0m[7m                                                        [0m[1;80H[1m[4m[37m[40mX[24m[0m[2;9HC tabnext 1[3;9Hautocmd TabDestructive TabEnter * nested :C tabnext 2 | C tabclose 3[4;9HC tabnext 3[5;9Hlet g:r+=[tabpagenr().'/'.tabpagenr('$')]
    else[7;9Hlet g:r+=["=== tabnext 3 ===","BufLeave","WinLeave","TabLeave","WinEnter[8;1H","TabEnter","=== tabnext 2 ===","=== tabclose 3 ===","2/2","=== tabnew ===","Wi[9;1HnLeave","TabLeave","WinEnter","TabEnter","BufLeave","BufEnter","=== tabnext 1 ==[10;1H=","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","BufEnter","=== tabnex[11;1Ht 3 ===","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 =[12;1H==","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 ===","[13;1H=== tabclose 3 ===","BufEnter","=== tabclose 3 ===","2/2",]
    endif
endfunction
:call Test()
:$ put =g:r
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0c"[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet test_status = 'gettabvar: fail'[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif gettabvar(2, 'val_num') == 100 && gettabvar(2, 'val_str') == 'SetTabVar tes
[24;80Ht[25;1H' && gettabvar(2, 'val_list') == ['red', 'blue', 'green'][?25l[?1c[25;1H[K[25;1H:  [?25h[?0c:    let test_status = 'gettabvar: pass'
[?25l[?1c:  [?25h[?0c:endif[1;1H[2L[1;1H[1m + test62.in [0m[1m[4m[37m[40m [No Name] [24m[0m[7m                                                        [0m[1;80H[1m[4m[37m[40mX[?25l[?1c[24m[0m[2;9HC tabnext 1[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0ccall append(line('$'), test_status)[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctabnext 2[?25l[?1c[27m[24m[0m[H[J[1;1H[1m[4m[37m[40m + test62.in [24m[0m[1m [No Name] [0m[7m                                                        [0m[1;80H[1m[4m[37m[40mX[24m[0m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0clet test_status = 'settabvar: fail'[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif t:val_num == 100 && t:val_str == 'SetTabVar test'  && t:val_list == ['red',
'blue', 'green'][?25l[?1c[25;1H[K[25;1H:  [?25h[?0c:   let test_status = 'settabvar: pass'
[?25l[?1c:  [?25h[?0c:endif[1;1H[2L[1;1H[1m[4m[37m[40m + test62.in [24m[0m[1m [No Name] [0m[7m                                                        [0m[1;80H[1m[4m[37m[40mX[?25l[?1c[24m[0m[25;1H[K[2;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ctabclose[?25l[?1c[27m[24m[0m[H[J[1;9HC tabnew[2;9HC tabnext 1[3;9Hautocmd TabDestructive TabEnter * nested :C tabnext 2 | C tabclose 3[4;9HC tabnext 3[5;9Hlet g:r+=[tabpagenr().'/'.tabpagenr('$')]
    else[7;9Hlet g:r+=["=== tabnext 3 ===","BufLeave","WinLeave","TabLeave","WinEnter[8;1H","TabEnter","=== tabnext 2 ===","=== tabclose 3 ===","2/2","=== tabnew ===","Wi[9;1HnLeave","TabLeave","WinEnter","TabEnter","BufLeave","BufEnter","=== tabnext 1 ==[10;1H=","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","BufEnter","=== tabnex[11;1Ht 3 ===","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 =[12;1H==","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 ===","[13;1H=== tabclose 3 ===","BufEnter","=== tabclose 3 ===","2/2",]
    endif
endfunction
:call Test()
:$ put =g:r
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0ccall append(line('$'), test_status)[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif has('gui') || has('clientserver')[?25l[?1c
:  [?25h[?0c:" Test for ":tab drop exist-file" to keep current window.
[?25l[?1c:  [?25h[?0c:sp test1
[?25l[?1c:  [?25h[?0c:tab drop test1
[?25l[?1c:  [?25h[?0c:let test_status = 'tab drop 1: fail'
[?25l[?1c:  [?25h[?0c:if tabpagenr('$') == 1 && winnr('$') == 2 && winnr() == 1
[?25l[?1c:    [?25h[?0c:    let test_status = 'tab drop 1: pass'
[?25l[?1c:    [?25h[?0c:endif
[?25l[?1c:  [?25h[?0c:close
[?25l[?1c:  [?25h[?0c:call append(line('$'), test_status)
[?25l[?1c:  [?25h[?0c:"
[?25l[?1c:  [?25h[?0c:"
[?25l[?1c:  [?25h[?0c:" Test for ":tab drop new-file" to keep current window of tabpage 1.
[?25l[?1c:  [?25h[?0c:split
[?25l[?1c:  [?25h[?0c:tab drop newfile
[?25l[?1c:  [?25h[?0c:let test_status = 'tab drop 2: fail'
[?25l[?1c:  [?25h[?0c:if tabpagenr('$') == 2 && tabpagewinnr(1, '$') == 2 && tabpagewinnr(1) == 1
[?25l[?1c:    [?25h[?0c:    let test_status = 'tab drop 2: pass'
[?25l[?1c:    [?25h[?0c:endif
[?25l[?1c:  [?25h[?0c:tabclose
[?25l[?1c:  [?25h[?0c:q
[?25l[?1c:  [?25h[?0c:call append(line('$'), test_status)
[?25l[?1c:  [?25h[?0c:"
[?25l[?1c:  [?25h[?0c:"
[?25l[?1c:  [?25h[?0c:" Test for ":tab drop multi-opend-file" to keep current tabpage and window.
[?25l[?1c:  [?25h[?0c:new test1
[?25l[?1c:  [?25h[?0c:tabnew
[?25l[?1c:  [?25h[?0c:new test1
[?25l[?1c:  [?25h[?0c:tab drop test1
[?25l[?1c:  [?25h[?0c:let test_status = 'tab drop 3: fail'
[?25l[?1c:  [?25h[?0c:if tabpagenr() == 2 && tabpagewinnr(2, '$') == 2 && tabpagewinnr(2) == 1
[?25l[?1c:    [?25h[?0c:    let test_status = 'tab drop 3: pass'
[?25l[?1c:    [?25h[?0c:endif
[?25l[?1c:  [?25h[?0c:tabclose
[?25l[?1c:  [?25h[?0c:q
[?25l[?1c:  [?25h[?0c:call append(line('$'), test_status)
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c:" :drop not supported
[?25l[?1c:  [?25h[?0c:call append(line('$'), 'tab drop 1: pass')
[?25l[?1c:  [?25h[?0c:call append(line('$'), 'tab drop 2: pass')
[?25l[?1c:  [?25h[?0c:call append(line('$'), 'tab drop 3: pass')
[?25l[?1c:  [?25h[?0c:endif[27m[24m[0m[H[J[?25l[?1c[1;9HC tabnew[2;9HC tabnext 1[3;9Hautocmd TabDestructive TabEnter * nested :C tabnext 2 | C tabclose 3[4;9HC tabnext 3[5;9Hlet g:r+=[tabpagenr().'/'.tabpagenr('$')]
    else[7;9Hlet g:r+=["=== tabnext 3 ===","BufLeave","WinLeave","TabLeave","WinEnter[8;1H","TabEnter","=== tabnext 2 ===","=== tabclose 3 ===","2/2","=== tabnew ===","Wi[9;1HnLeave","TabLeave","WinEnter","TabEnter","BufLeave","BufEnter","=== tabnext 1 ==[10;1H=","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","BufEnter","=== tabnex[11;1Ht 3 ===","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 =[12;1H==","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 ===","[13;1H=== tabclose 3 ===","BufEnter","=== tabclose 3 ===","2/2",]
    endif
endfunction
:call Test()
:$ put =g:r
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0c"[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfor i in range(9) | tabnew | endfor[?25l[?1c[27m[24m[0m[H[J[1;1H[1m[4m[37m[40m + 2.in   Name]   Name]   Name]   Name]   Name]   Name]   Name]   Name] [24m[0m[1m  Name] [0m[1;80H[1m[4m[37m[40mX[24m[0m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?25h[?0c[27m[24m[0m[H[J[1;1H[1m + 2.in [0m[1m[4m[37m[40m  Name]   Name]   Name]   Name]   Name]   Name]   Name]   Name]   Name] [1;80HX[?25l[?1c[24m[0m[2;9HC tabnext 1[3;9Hautocmd TabDestructive TabEnter * nested :C tabnext 2 | C tabclose 3[4;9HC tabnext 3[5;9Hlet g:r+=[tabpagenr().'/'.tabpagenr('$')]
    else[7;9Hlet g:r+=["=== tabnext 3 ===","BufLeave","WinLeave","TabLeave","WinEnter[8;1H","TabEnter","=== tabnext 2 ===","=== tabclose 3 ===","2/2","=== tabnew ===","Wi[9;1HnLeave","TabLeave","WinEnter","TabEnter","BufLeave","BufEnter","=== tabnext 1 ==[10;1H=","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","BufEnter","=== tabnex[11;1Ht 3 ===","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 =[12;1H==","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 ===","[13;1H=== tabclose 3 ===","BufEnter","=== tabclose 3 ===","2/2",]
    endif
endfunction
:call Test()
:$ put =g:r
:"
:"
:/^Results/,$w! test.out
:qa!
ENDTEST

Results:[23;1H[?25h[?0c
[?25l[?1c[2;24r[2;1H[12M[1;25r[13;1Htab page 2
this is tab page 3
this is tab page 1
this is tab page 4
gettabvar: pass
settabvar: pass
tab drop 1: pass
tab drop 2: pass
tab drop 3: pass
[1m[34m~                                                                               [23;1H~                                                                               [24;1H~                                                                               [21;1H[?25h[?0c[?25l[?1c[25;1H[0m=[?25h[?0ctabpagenr()[?25l[?1c[22;1H1[22;2H[K[23;1H[K[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctabmove 5[?25l[?1c[1;1H[1m[4m[37m[40m  Name] [24m[0m[32C[1m + 2.in [0m[31C[1m[4m[37m[40m [1;80HX[23;1H[?25h[?0c[?25l[?1c[24m[0m[25;1H[K[25;1H=[?25h[?0ctabpagenr()[?25l[?1c[23;1H6[24;1H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctabmove -2[?25l[?1c[1;25H[1m + 2.in [0m[8C[1m[4m[37m[40m  Name] [31C [1;80HX[24;1H[?25h[?0c[?25l[?1c[24m[0m[25;1H[K[25;1H=[?25h[?0ctabpagenr()[?25l[?1c[2;24r[24;1H
[1;25r[23;1H4[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0ctabmove +4[?25l[?1c[1;25H[1m[4m[37m[40m  Name] [24m[0m[24C[1m + 2.in [0m[15C[1m[4m[37m[40m [1;80HX[24;1H[?25h[?0c[?25l[?1c[24m[0m[25;1H[K[25;1H=[?25h[?0ctabpagenr()[?25l[?1c[2;24r[24;1H
[1;25r[23;1H8[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0ctabmove[?25l[?1c[1;57H[1m[4m[37m[40m  Name] [24m[0m[8C[1m + 2.in [0m[1;80H[1m[4m[37m[40mX[24;1H[?25h[?0c[?25l[?1c[24m[0m[25;1H[K[25;1H=[?25h[?0ctabpagenr()[?25l[?1c[2;24r[24;1H
[1;25r[23;1H10[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0ctabmove -20[?25l[?1c[1;1H[1m + 2.in [0m[64C[1m[4m[37m[40m  Name] [1;80HX[24;1H[?25h[?0c[?25l[?1c[24m[0m[25;1H[K[25;1H=[?25h[?0ctabpagenr()[?25l[?1c[2;24r[24;1H
[1;25r[23;1H1[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0ctabmove +20[?25l[?1c[1;1H[1m[4m[37m[40m  Name] [24m[0m[64C[1m + 2.in [0m[1;80H[1m[4m[37m[40mX[24;1H[?25h[?0c[?25l[?1c[24m[0m[25;1H[K[25;1H=[?25h[?0ctabpagenr()[?25l[?1c[2;24r[24;1H
[1;25r[23;1H10[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c3tabmove[?25l[?1c[1;25H[1m + 2.in [0m[40C[1m[4m[37m[40m  Name] [1;80HX[24;1H[?25h[?0c[?25l[?1c[24m[0m[25;1H[K[25;1H=[?25h[?0ctabpagenr()[?25l[?1c[2;24r[24;1H
[1;25r[23;1H4[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c7tabmove 5[?25l[?1c[1;25H[1m[4m[37m[40m  Name] [24m[0m[8C[1m + 2.in [0m[31C[1m[4m[37m[40m [1;80HX[24;1H[?25h[?0c[?25l[?1c[24m[0m[25;1H[K[25;1H=[?25h[?0ctabpagenr()[?25l[?1c[2;24r[24;1H
[1;25r[23;1H6[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet a='No error caught.'[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctry[?25l[?1c
:  [?25h[?0c:tabmove foo
[?25l[?1c:  [?25h[?0c:catch E474
[?25l[?1c:  [?25h[?0c:let a='E474 caught.'
[?25l[?1c:  [?25h[?0c:endtry[1;1H[4L[1;1H[1m[4m[37m[40m  Name]   Name]   Name]   Name]   Name] [24m[0m[1m + 2.in [0m[1m[4m[37m[40m  Name]   Name]   Name]   Name] [1;80HX[?25l[?1c[24m[0m[2;1H:qa!
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c
=[?25h[?0ca[?25l[?1c[24;1HE474 caught.[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test autocommands[?25l[?1c[24;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctabonly![?25l[?1c[1;1H:/^Results/,$w! test.out[1;25H[K[24;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet g:r=[][?25l[?1c[24;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccommand -nargs=1 -bar C :call add(g:r, '=== ' . <q-args> . ' ===')|<args>[?25l[?1c[24;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunction Test()[?25l[?1c
:  [?25h[?0c    let hasau=has('autocmd')
[?25l[?1c:  [?25h[?0c    if hasau
[?25l[?1c:    [?25h[?0c        autocmd TabEnter * :call add(g:r, 'TabEnter')
[?25l[?1c:    [?25h[?0c        autocmd WinEnter * :call add(g:r, 'WinEnter')
[?25l[?1c:    [?25h[?0c        autocmd BufEnter * :call add(g:r, 'BufEnter')
[?25l[?1c:    [?25h[?0c        autocmd TabLeave * :call add(g:r, 'TabLeave')
[?25l[?1c:    [?25h[?0c        autocmd WinLeave * :call add(g:r, 'WinLeave')
[?25l[?1c:    [?25h[?0c        autocmd BufLeave * :call add(g:r, 'BufLeave')
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c    let t:a='a'
[?25l[?1c:  [?25h[?0c    C tab split
[?25l[?1c:  [?25h[?0c    if !hasau
[?25l[?1c:    [?25h[?0c        let g:r+=['WinLeave', 'TabLeave', 'WinEnter', 'TabEnter']
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c    let t:a='b'
[?25l[?1c:  [?25h[?0c    C tabnew
[?25l[?1c:  [?25h[?0c    if !hasau
[?25l[?1c:    [?25h[?0c        let g:r+=['WinLeave', 'TabLeave', 'WinEnter', 'TabEnter', 'BufLeav
[24;80He[25;1H', 'BufEnter']
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c    let t:a='c'
[?25l[?1c:  [?25h[?0c    call add(g:r, join(map(range(1, tabpagenr('$')), 'gettabvar(v:val, "a")'
[24;80H)[25;1H))
[?25l[?1c:  [?25h[?0c    C call map(range(1, tabpagenr('$')), 'settabvar(v:val, ''a'', v:val*2)')
[?25l[?1c:  [?25h[?0c    call add(g:r, join(map(range(1, tabpagenr('$')), 'gettabvar(v:val, "a")'
[24;80H)[25;1H))
[?25l[?1c:  [?25h[?0c    let w:a='a'
[?25l[?1c:  [?25h[?0c    C vsplit
[?25l[?1c:  [?25h[?0c    if !hasau
[?25l[?1c:    [?25h[?0c        let g:r+=['WinLeave', 'WinEnter']
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c    let w:a='a'
[?25l[?1c:  [?25h[?0c    let tabn=tabpagenr()
[?25l[?1c:  [?25h[?0c    let winr=range(1, winnr('$'))
[?25l[?1c:  [?25h[?0c    C tabnext 1
[?25l[?1c:  [?25h[?0c    if !hasau
[?25l[?1c:    [?25h[?0c        let g:r+=['BufLeave', 'WinLeave', 'TabLeave', 'WinEnter', 'TabEnte
[24;80Hr[25;1H', 'BufEnter']
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0c    call add(g:r, join(map(copy(winr), 'gettabwinvar('.tabn.', v:val, "a")')
[24;80H)[25;1H)
[?25l[?1c:  [?25h[?0c    C call map(copy(winr), 'settabwinvar('.tabn.', v:val, ''a'', v:val*2)')
[?25l[?1c:  [?25h[?0c    call add(g:r, join(map(copy(winr), 'gettabwinvar('.tabn.', v:val, "a")')
[24;80H)[25;1H)
[?25l[?1c:  [?25h[?0c    if hasau
[?25l[?1c:    [?25h[?0c        augroup TabDestructive
[?25l[?1c:    [?25h[?0c            autocmd TabEnter * :C tabnext 2 | C tabclose 3
[?25l[?1c:    [?25h[?0c        augroup END
[?25l[?1c:    [?25h[?0c        C tabnext 3
[?25l[?1c:    [?25h[?0c        let g:r+=[tabpagenr().'/'.tabpagenr('$')]
[?25l[?1c:    [?25h[?0c        autocmd! TabDestructive TabEnter
[?25l[?1c:    [?25h[?0c        C tabnew
[?25l[?1c:    [?25h[?0c        C tabnext 1
[?25l[?1c:    [?25h[?0c        autocmd TabDestructive TabEnter * nested :C tabnext 2 | C tabclose
3
[?25l[?1c:    [?25h[?0c        C tabnext 3
[?25l[?1c:    [?25h[?0c        let g:r+=[tabpagenr().'/'.tabpagenr('$')]
[?25l[?1c:    [?25h[?0c    else
[?25l[?1c:    [?25h[?0c        let g:r+=["=== tabnext 3 ===","BufLeave","WinLeave","TabLeave","Wi
[24;80Hn[25;1HEnter","TabEnter","=== tabnext 2 ===","=== tabclose 3 ===","2/2","=== tabnew ==
[24;80H=[25;1H","WinLeave","TabLeave","WinEnter","TabEnter","BufLeave","BufEnter","=== tabnex
[24;80Ht[25;1H 1 ===","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","BufEnter","=== 
[24;80Ht[25;1Habnext 3 ===","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabne
[24;80Hx[25;1Ht 2 ===","BufLeave","WinLeave","TabLeave","WinEnter","TabEnter","=== tabnext 2 
[24;80H=[25;1H==","=== tabclose 3 ===","BufEnter","=== tabclose 3 ===","2/2",]
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0cendfunction[27m[24m[0m[H[J[?25l[?1c[1;1H:/^Results/,$w! test.out
:qa!
ENDTEST

Results:
tab page 2
this is tab page 3
this is tab page 1
this is tab page 4
gettabvar: pass
settabvar: pass
tab drop 1: pass
tab drop 2: pass
tab drop 3: pass
1
6
4
8
10
1
10
4
6
E474 caught.[?25h[?0c[?25l[?1c
:[?25h[?0ccall Test()[?25l[?1c[27m[24m[0m[H[J[1;1H[1m[4m[37m[40m + test62.in [24m[0m[1m + test62.in [0m[7m                                                      [0m[1;80H[1m[4m[37m[40mX[24m[0m[2;1H:qa!
ENDTEST

Results:
tab page 2
this is tab page 3
this is tab page 1
this is tab page 4
gettabvar: pass
settabvar: pass
tab drop 1: pass
tab drop 2: pass
tab drop 3: pass
1
6
4
8
10
1
10
4
6
E474 caught.[?25h[?0c[?25l[?1c
:[?25h[?0c$ put =g:r[?25l[?1c68 more lines[2;1HBufLeave
WinLeave
TabLeave
WinEnter
TabEnter[6;10H[K[7;1HBufEnter[7;9H[K[8;1H=== tabnext 3 ===[8;18H[K[9;1HBufLeave[9;9H[K[10;1HWinLeave[10;9H[K[11;1HTabLeave[11;9H[K[12;1HWinEnter[12;10H[K[13;1HTabEnter[13;10H[K[14;1H=== tabnext 2 ===
BufLeave
WinLeave
TabLeave
WinEnter
TabEnter
=== tabnext 2 ===
=== tabclose 3 ===
BufEnter
=== tabclose 3 ===
2/2[24;4H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^Results/,$w! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 88 lines, 1038 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test63.failed test.ok test.out X* viminfo
cp test63.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test63.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test63.in" 157 lines, 4784 characters[1;1HTest for ":match", ":2match", ":3match", "clearmatches()", "getmatches()",
"matchadd()", "matcharg()", "matchdelete()", and "setmatches()".

STARTTEST
:so small.vim
:" --- Check that "matcharg()" returns the correct group and pattern if a match
:" --- is defined.
:let @r = "*** Test 1: "
:highlight MyGroup1 ctermbg=red
:highlight MyGroup2 ctermbg=green
:highlight MyGroup3 ctermbg=blue
:match MyGroup1 /TODO/
:2match MyGroup2 /FIXME/
:3match MyGroup3 /XXX/
:if matcharg(1) == ['MyGroup1', 'TODO'] && matcharg(2) == ['MyGroup2', 'FIXME']
&& matcharg(3) == ['MyGroup3', 'XXX']
:  let @r .= "OK\n"
:else
:  let @r .= "FAILED\n"
:endif
:" --- Check that "matcharg()" returns an empty list if the argument is not 1,
:" --- 2 or 3 (only 0 and 4 are tested).
:let @r .= "*** Test 2: "
:if matcharg(0) == [] && matcharg(4) == [][1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for ":match", ":2match", ":3match", "clearmatches()", "getmatches()",[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[4;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 150 lines, 4605 characters written[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': 'TODO', 'priority': 10,
'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)
:let rf2 = setmatches([0])
:let rf3 = setmatches([{'wrong key': 'wrong value'}])
:if rs1 == 0 && rs2 == 0 && rf1 == -1 && rf2 == -1 && rf3 == -1
:  let @r .= "OK\n"
:else
:  let @r .= "FAILED\n"
:endif
:unlet rs1
:unlet rs2
:unlet rf1
:unlet rf2
:unlet rf3
:highlight clear MyGroup1
:highlight clear MyGroup2
:highlight clear MyGroup3
G"rp
:/^Results/,$wq! test.out
ENDTEST

Results of test63:[22;1H[?25h[?0c
[?25l[?1c

:so! Xdotest[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- Check that "matcharg()" returns the correct group and pattern if a match[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- is defined.[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet @r = "*** Test 1: "[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0chighlight MyGroup1 ctermbg=red[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0chighlight MyGroup2 ctermbg=green[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0chighlight MyGroup3 ctermbg=blue[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmatch MyGroup1 /TODO/[?25l[?1c[1;58H[41mTODO[23;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c2match MyGroup2 /FIXME/[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c3match MyGroup3 /XXX/[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif matcharg(1) == ['MyGroup1', 'TODO'] && matcharg(2) == ['MyGroup2', 'FIXME']
&& matcharg(3) == ['MyGroup3', 'XXX'][?25l[?1c[25;1H[K[25;1H:  [?25h[?0c:  let @r .= "OK\n"
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c:  let @r .= "FAILED\n"
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': '[41mTODO[0m', 'priority': 10,
'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0c" --- Check that "matcharg()" returns an empty list if the argument is not 1,[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- 2 or 3 (only 0 and 4 are tested).[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet @r .= "*** Test 2: "[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif matcharg(0) == [] && matcharg(4) == [][?25l[?1c
:  [?25h[?0c:  let @r .= "OK\n"
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c:  let @r .= "FAILED\n"
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': '[41mTODO[0m', 'priority': 10,
'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0c" --- Check that "matcharg()" returns ['', ''] if a match is not defined.[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet @r .= "*** Test 3: "[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmatch[?25l[?1c[1;58HTODO[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c2match[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c3match[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif matcharg(1) == ['', ''] && matcharg(2) == ['', ''] && matcharg(3) == ['', '
[24;80H'[25;1H][?25l[?1c[25;1H[K[25;1H:  [?25h[?0c:  let @r .= "OK\n"
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c:  let @r .= "FAILED\n"
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': 'TODO', 'priority': 10,
'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0c" --- Check that "matchadd()" and "getmatches()" agree on added matches and[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- that default values apply.[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet @r .= "*** Test 4: "[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet m1 = matchadd("MyGroup1", "TODO")[?25l[?1c[1;58H[41mTODO[23;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet m2 = matchadd("MyGroup2", "FIXME", 42)[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet m3 = matchadd("MyGroup3", "XXX", 60, 17)[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif getmatches() == [{'group': 'MyGroup1', 'pattern': 'TODO', 'priority': 10, '
[24;80Hi[25;1Hd': 4}, {'group': 'MyGroup2', 'pattern': 'FIXME', 'priority': 42, 'id': 5}, {'g
[24;80Hr[25;1Houp': 'MyGroup3', 'pattern': 'XXX', 'priority': 60, 'id': 17}][?25l[?1c[24;1H[K[25;1H[K[24;1H:  [?25h[?0c:  let @r .= "OK\n"[?25l[?1c
:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c:  let @r .= "FAILED\n"
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': '[41mTODO[0m', 'priority': 10,
'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0c" --- Check that "matchdelete()" deletes the matches defined in the previous[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- test correctly.[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet @r .= "*** Test 5: "[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall matchdelete(m1)[?25l[?1c[1;58HTODO[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall matchdelete(m2)[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall matchdelete(m3)[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet m1[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet m2[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet m3[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif getmatches() == [][?25l[?1c
:  [?25h[?0c:  let @r .= "OK\n"
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c:  let @r .= "FAILED\n"
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': 'TODO', 'priority': 10,
'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0c" --- Check that "matchdelete()" returns 0 if successful and otherwise -1.[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet @r .= "*** Test 6: "[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet m = matchadd("MyGroup1", "TODO")[?25l[?1c[1;58H[41mTODO[23;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet r1 = matchdelete(m)[?25l[?1c[1;58HTODO[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet r2 = matchdelete(42)[?25l[?1c[1m[37m[41mE803: ID not found: 42[0m[25;23H[K[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif r1 == 0 && r2 == -1[?25l[?1c
:  [?25h[?0c:  let @r .= "OK\n"
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c:  let @r .= "FAILED\n"
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': 'TODO', 'priority': 10,
'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0cunlet m[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet r1[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet r2[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- Check that "clearmatches()" clears all matches defined by ":match" and[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- "matchadd()".[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet @r .= "*** Test 7: "[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet m1 = matchadd("MyGroup1", "TODO")[?25l[?1c[1;58H[41mTODO[23;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet m2 = matchadd("MyGroup2", "FIXME", 42)[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet m3 = matchadd("MyGroup3", "XXX", 60, 17)[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmatch MyGroup1 /COFFEE/[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c2match MyGroup2 /HUMPPA/[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c3match MyGroup3 /VIM/[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall clearmatches()[?25l[?1c[1;58HTODO[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif getmatches() == [][?25l[?1c
:  [?25h[?0c:  let @r .= "OK\n"
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c:  let @r .= "FAILED\n"
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': 'TODO', 'priority': 10,
'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0cunlet m1[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet m2[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet m3[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- Check that "setmatches()" restores a list of matches saved by[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- "getmatches()" without changes. (Matches with equal priority must also[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- remain in the same order.)[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet @r .= "*** Test 8: "[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet m1 = matchadd("MyGroup1", "TODO")[?25l[?1c[1;58H[41mTODO[23;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet m2 = matchadd("MyGroup2", "FIXME", 42)[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet m3 = matchadd("MyGroup3", "XXX", 60, 17)[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmatch MyGroup1 /COFFEE/[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c2match MyGroup2 /HUMPPA/[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c3match MyGroup3 /VIM/[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet ml = getmatches()[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall clearmatches()[?25l[?1c[1;58HTODO[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall setmatches(ml)[?25l[?1c[1;58H[41mTODO[23;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cif getmatches() == ml[?25l[?1c
:  [?25h[?0c:  let @r .= "OK\n"
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c:  let @r .= "FAILED\n"
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': '[41mTODO[0m', 'priority': 10,
'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0ccall clearmatches()[?25l[?1c[1;58HTODO[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet m1[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet m2[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet m3[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet ml[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- Check that "setmatches()" will not add two matches with the same ID. The[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- expected behaviour (for now) is to add the first match but not the[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- second and to return 0 (even though it is a matter of debate whether[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- this can be considered successful behaviour).[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet @r .= "*** Test 9: "[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet r1 = setmatches([{'group': 'MyGroup1', 'pattern': 'TODO', 'priority': 10, 
[24;80H'[25;1Hid': 1}, {'group': 'MyGroup2', 'pattern': 'FIXME', 'priority': 10, 'id': 1}])[?25l[?1c[24;1H[1m[37m[41mE801: ID already taken: 1[0m[24;26H[K[25;1H[K[25;1H[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cif getmatches() == [{'group': 'MyGroup1', 'pattern': 'TODO', 'priority': 10, '
[24;80Hi[25;1Hd': 1}] && r1 == 0[?25l[?1c[25;1H[K[25;1H:  [?25h[?0c:  let @r .= "OK\n"
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c:  let @r .= "FAILED\n"
[?25l[?1c:  [?25h[?0c:endif[1;1H[5L[?25l[?1c[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': '[41mTODO[0m', 'priority': 10,
'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)
:let rf2 = setmatches([0])[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0ccall clearmatches()[?25l[?1c[1;58HTODO[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet r1[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- Check that "setmatches()" returns 0 if successful and otherwise -1.[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- (A range of valid and invalid input values are tried out to generate the[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" --- return values.)[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet @r .= "*** Test 10: "[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet rs1 = setmatches([])[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet rs2 = setmatches([{'group': 'MyGroup1', 'pattern': 'TODO', 'priority': 10,
'id': 1}])[?25l[?1c[1;1H[L[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': '[41mTODO[0m', 'priority': 10,[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0ccall clearmatches()[?25l[?1c[1;58HTODO[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet rf1 = setmatches(0)[?25l[?1c[1m[37m[41mE714: List required[0m[25;20H[K[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet rf2 = setmatches([0])[?25l[?1c[1m[37m[41mE474: Invalid argument[0m[25;23H[K[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet rf3 = setmatches([{'wrong key': 'wrong value'}])[?25l[?1c[1m[37m[41mE474: Invalid argument[0m[25;23H[K[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif rs1 == 0 && rs2 == 0 && rf1 == -1 && rf2 == -1 && rf3 == -1[?25l[?1c
:  [?25h[?0c:  let @r .= "OK\n"
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c:  let @r .= "FAILED\n"
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[1;1H:let rs2 = setmatches([{'group': 'MyGroup1', 'pattern': 'TODO', 'priority': 10,
'id': 1}])
:call clearmatches()
:let rf1 = setmatches(0)[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0cunlet rs1[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet rs2[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet rf1[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet rf2[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet rf3[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0chighlight clear MyGroup1[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0chighlight clear MyGroup2[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0chighlight clear MyGroup3[?25l[?1c[23;1H[?25h[?0c
[?25l[?1c
10 more lines[25;14H[K[1;24r[1;1H[2M[1;25r[23;1H*** Test 1: OK
*** Test 2: OK[25;1H[K[25;1H10 more lines[23;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^Results/,$wq! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 11 lines, 170 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test64.failed test.ok test.out X* viminfo
cp test64.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test64.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test64.in" 638 lines, 26459 characters[1;1HTest for regexp patterns without multi-byte support.
See test95 for multi-byte tests.

A pattern that gives the expected result produces OK, so that we know it was
actually tried.

STARTTEST
:so small.vim
:" tl is a List of Lists with:
:"    regexp pattern
:"    text to test the pattern on
:"    expected match (optional)
:"    expected submatch 1 (optional)
:"    expected submatch 2 (optional)
:"    etc.
:"  When there is no match use only the first two items.
:let tl = []
:"
:""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
:"""" Previously written tests """"""""""""""""""""""""""""""""
:""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
:"
:call add(tl, [2, 'ab', 'aab', 'ab'])
:call add(tl, [2, 'b', 'abcdef', 'b'])[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for regexp patterns without multi-byte support.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[7;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[8;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 605 lines, 25984 characters written[8;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[8;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:" start and end of buffer
/\%^
yeGo[1m[34m^[[0mp:"
50%/\%^..
yeGo[1m[34m^[[0mpA END[1m[34m^[[0m:"
50%/\%$
"ayb20gg/..\%$
"bybGo[1m[34m^[[0m"apo[1m[34m^[[0m"bp:"
:"
:""""" Write the results """""""""""""
:/\%#=1^Results/,$wq! test.out
ENDTEST

Substitute here:
<T="">Ta 5</Title>
<T="">Ac 7</Title>

Behind:
asdfasd<yyy
xxstart1
asdfasd<yy
xxxstart2
asdfasd<yy
xxstart3[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" tl is a List of Lists with:[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    regexp pattern[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    text to test the pattern on[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    expected match (optional)[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    expected submatch 1 (optional)[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    expected submatch 2 (optional)[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    etc.[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"  When there is no match use only the first two items.[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet tl = [][?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" Previously written tests """"""""""""""""""""""""""""""""[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'ab', 'aab', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'b', 'abcdef', 'b'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'bc*', 'abccccdef', 'bcccc'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'bc\{-}', 'abccccdef', 'b'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'bc\{-}\(d\)', 'abccccdef', 'bccccd', 'd'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'bc*', 'abbdef', 'b'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'c*', 'ccc', 'ccc'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'bc*', 'abdef', 'b'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'c*', 'abdef', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'bc\+', 'abccccdef', 'bcccc'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'bc\+', 'abdef']) "no match[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"operator \|[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\|ab', 'cabd', 'a']) "alternation is ordered[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'c\?', 'ccb', 'c'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'bc\?', 'abd', 'b'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'bc\?', 'abccd', 'bc'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\va{1}', 'ab', 'a'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\va{2}', 'aa', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\va{2}', 'caad', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\va{2}', 'aba'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\va{2}', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\va{2}', 'abaa', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\va{2}', 'aaa', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\vb{1}', 'abca', 'b'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\vba{2}', 'abaa', 'baa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\vba{3}', 'aabaac'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(ab){1}', 'ab', 'ab', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(ab){1}', 'dabc', 'ab', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(ab){1}', 'acb'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(ab){0,2}', 'acb', "", ""])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(ab){0,2}', 'ab', 'ab', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(ab){1,2}', 'ab', 'ab', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(ab){1,2}', 'ababc', 'abab', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(ab){2,4}', 'ababcab', 'abab', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(ab){2,4}', 'abcababa', 'abab', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(ab){2}', 'abab', 'abab', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(ab){2}', 'cdababe', 'abab', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(ab){2}', 'abac'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(ab){2}', 'abacabab', 'abab', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v((ab){2}){2}', 'abababab', 'abababab', 'abab', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v((ab){2}){2}', 'abacabababab', 'abababab', 'abab', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{1}){1}', 'a', 'a', 'a'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{2}){1}', 'aa', 'aa', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{2}){1}', 'aaac', 'aa', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{2}){1}', 'daaac', 'aa', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{1}){2}', 'daaac', 'aa', 'a'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{1}){2}', 'aaa', 'aa', 'a'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{2})+', 'adaac', 'aa', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{2})+', 'aa', 'aa', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{2}){1}', 'aa', 'aa', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{1}){2}', 'aa', 'aa', 'a'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{1}){1}', 'a', 'a', 'a'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{2}){2}', 'aaaa', 'aaaa', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{2}){2}', 'aaabaaaa', 'aaaa', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a+){2}', 'dadaac', 'aa', 'a'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{3}){2}', 'aaaaaaa', 'aaaaaa', 'aaa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{1,2}){2}', 'daaac', 'aaa', 'a'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{1,3}){2}', 'daaaac', 'aaaa', 'a'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{1,3}){2}', 'daaaaac', 'aaaaa', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{1,3}){3}', 'daac'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{1,2}){2}', 'dac'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a+)+', 'daac', 'aa', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a+)+', 'aaa', 'aaa', 'aaa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a+){1,2}', 'aaa', 'aaa', 'aaa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a+)(a+)', 'aaa', 'aaa', 'aa', 'a'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{3})+', 'daaaac', 'aaa', 'aaa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a|b|c)+', 'aacb', 'aacb', 'b'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a|b|c){2}', 'abcb', 'ab', 'b'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(abc){2}', 'abcabd', ])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(abc){2}', 'abdabcabc','abcabc', 'abc'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a*', 'cc', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a*)+', 'cc', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v((ab)+)+', 'ab', 'ab', 'ab', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(((ab)+)+)+', 'ab', 'ab', 'ab', 'ab', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(((ab)+)+)+', 'dababc', 'abab', 'abab', 'abab', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{0,2})+', 'cc', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a*)+', '', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v((a*)+)+', '', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v((ab)*)+', '', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\va{1,3}', 'aab', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\va{2,3}', 'abaa', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v((ab)+|c*)+', 'abcccaba', 'abcccab', '', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{2})|(b{3})', 'bbabbbb', 'bbb', '', 'bbb'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\va{2}|b{2}', 'abab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a)+|(c)+', 'bbacbaacbbb', 'a', 'a'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\vab{2,3}c', 'aabbccccccccccccc', 'abbc'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\vab{2,3}c', 'aabbbccccccccccccc', 'abbbc'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\vab{2,3}cd{2,3}e', 'aabbbcddee', 'abbbcdde'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\va(bc){2}d', 'aabcbfbc' ])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\va*a{2}', 'a', ])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\va*a{2}', 'aa', 'aa' ])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\va*a{2}', 'aaa', 'aaa' ])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\va*a{2}', 'bbbabcc', ])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\va*b*|a*c*', 'a', 'a'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\va{1}b{1}|a{1}b{1}', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"submatches[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a)', 'ab', 'a', 'a'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a)(b)', 'ab', 'ab', 'a', 'b'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(ab)(b)(c)', 'abbc', 'abbc', 'ab', 'b', 'c'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v((a)(b))', 'ab', 'ab', 'ab', 'a', 'b'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a)|(b)', 'ab', 'a', 'a'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a*)+', 'aaaa', 'aaaa', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'x', 'abcdef'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c""""" Simple tests """""""""""""""""""""""""""""""""""""""""""[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Search single groups[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'ab', 'aab', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'ab', 'baced'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'ab', '                    ab           ', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Search multi-modifiers[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'x*', 'xcd', 'x'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'x*', 'xxxxxxxxxxxxxxxxsofijiojgf', 'xxxxxxxxxxxxxxxx'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" empty match is good[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'x*', 'abcdoij', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" no match here[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'x\+', 'abcdoin'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'x\+', 'abcdeoijdfxxiuhfij', 'xx'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'x\+', 'xxxxx', 'xxxxx'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'x\+', 'abc x siufhiush xxxxxxxxx', 'x'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'x\=', 'x sdfoij', 'x'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'x\=', 'abc sfoij', '']) " empty match is good[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'x\=', 'xxxxxxxxx c', 'x'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'x\?', 'x sdfoij', 'x'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" empty match is good[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'x\?', 'abc sfoij', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'x\?', 'xxxxxxxxxx c', 'x'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{0,0}', 'abcdfdoij', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" same thing as 'a?'[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{0,1}', 'asiubid axxxaaa', 'a'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" same thing as 'a\{0,1}'[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{1,0}', 'asiubid axxxaaa', 'a'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{3,6}', 'aa siofuh'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{3,6}', 'aaaaa asfoij afaa', 'aaaaa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{3,6}', 'aaaaaaaa', 'aaaaaa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{0}', 'asoiuj', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{2}', 'aaaa', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{2}', 'iuash fiusahfliusah fiushfilushfi uhsaifuh askfj na
[24;80Hs[25;1Hfvius afg aaaa sfiuhuhiushf', 'aa'])[?25l[?1c[1;1H[L[1;1H:" start and end of buffer[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall add(tl, [2, 'a\{2}', 'abcdefghijklmnopqrestuvwxyz1234567890'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" same thing as 'a*'[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{0,}', 'oij sdigfusnf', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{0,}', 'aaaaa aa', 'aaaaa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{2,}', 'sdfiougjdsafg'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{2,}', 'aaaaasfoij ', 'aaaaa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{5,}', 'xxaaaaxxx '])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{5,}', 'xxaaaaaxxx ', 'aaaaa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{,0}', 'oidfguih iuhi hiu aaaa', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{,5}', 'abcd', 'a'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{,5}', 'aaaaaaaaaa', 'aaaaa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" leading star as normal char when \{} follows[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '^*\{4,}$', '***'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '^*\{4,}$', '****', '****'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '^*\{4,}$', '*****', '*****'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" same thing as 'a*'[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{}', 'bbbcddiuhfcd', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{}', 'aaaaioudfh coisf jda', 'aaaa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{-0,0}', 'abcdfdoij', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" anti-greedy version of 'a?'[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{-0,1}', 'asiubid axxxaaa', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{-3,6}', 'aa siofuh'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{-3,6}', 'aaaaa asfoij afaa', 'aaa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{-3,6}', 'aaaaaaaa', 'aaa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{-0}', 'asoiuj', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{-2}', 'aaaa', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{-2}', 'abcdefghijklmnopqrestuvwxyz1234567890'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{-0,}', 'oij sdigfusnf', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{-0,}', 'aaaaa aa', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{-2,}', 'sdfiougjdsafg'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{-2,}', 'aaaaasfoij ', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{-,0}', 'oidfguih iuhi hiu aaaa', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{-,5}', 'abcd', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{-,5}', 'aaaaaaaaaa', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" anti-greedy version of 'a*'[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{-}', 'bbbcddiuhfcd', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{-}', 'aaaaioudfh coisf jda', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test groups of characters and submatches[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\(abc\)*', 'abcabcabc', 'abcabcabc', 'abc'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\(ab\)\+', 'abababaaaaa', 'ababab', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\(abaaaaa\)*cd', 'cd', 'cd', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\(test1\)\? \(test2\)\?', 'test1 test3', 'test1 ', 'test1', 
[24;80H'[25;1H'])[?25l[?1c[1;1H[L[1;1H:" start and end of buffer[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall add(tl, [2, '\(test1\)\= \(test2\) \(test4443\)\=', ' test2 test4443 yupi
[24;80Hi[25;1Hiiiiiiiii', ' test2 test4443', '', 'test2', 'test4443'])[?25l[?1c[1;1H[L[1;1H:" start and end of buffer[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall add(tl, [2, '\(\(sub1\) hello \(sub 2\)\)', 'asterix sub1 hello sub 2 obe
[24;80Hl[25;1Hix', 'sub1 hello sub 2', 'sub1 hello sub 2', 'sub1', 'sub 2'])[?25l[?1c[1;1H[L[1;1H:" start and end of buffer[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall add(tl, [2, '\(\(\(yyxxzz\)\)\)', 'abcdddsfiusfyyzzxxyyxxzz', 'yyxxzz', '
[24;80Hy[25;1Hyxxzz', 'yyxxzz', 'yyxxzz'])[?25l[?1c[1;1H[L[1;1H:" start and end of buffer[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall add(tl, [2, '\v((ab)+|c+)+', 'abcccaba', 'abcccab', 'ab', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v((ab)|c*)+', 'abcccaba', 'abcccab', '', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a(c*)+b)+', 'acbababaaa', 'acbabab', 'ab', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a|b*)+', 'aaaa', 'aaaa', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\p*', 'aá [1m[34m^I[0m', 'aá '])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test greedy-ness and lazy-ness[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{-2,7}','aaaaaaaaaaaaa', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{-2,7}x','aaaaaaaaax', 'aaaaaaax'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{2,7}','aaaaaaaaaaaaaaaaaaaa', 'aaaaaaa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\{2,7}x','aaaaaaaaax', 'aaaaaaax'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\vx(.{-,8})yz(.*)','xayxayzxayzxayz','xayxayzxayzxayz','ayxa
[24;80H'[25;1H,'xayzxayz'])[?25l[?1c[1;1H[L[1;1H:" start and end of buffer[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall add(tl, [2, '\vx(.*)yz(.*)','xayxayzxayzxayz','xayxayzxayzxayz', 'ayxayzx
[24;80Ha[25;1Hyzxa',''])[?25l[?1c[1;1H[L[1;1H:" start and end of buffer[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{1,2}){-2,3}','aaaaaaa','aaaa','aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a{-1,3})+', 'aa', 'aa', 'a'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '^\s\{-}\zs\( x\|x$\)', ' x', ' x', ' x'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '^\s\{-}\zs\(x\| x$\)', ' x', ' x', ' x'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '^\s\{-}\ze\(x\| x$\)', ' x', '', ' x'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '^\(\s\{-}\)\(x\| x$\)', ' x', ' x', '', ' x'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test Character classes[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\d\+e\d\d','test 10e23 fd','10e23'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test collections and character range [][?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v[a]', 'abcd', 'a'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a[bcd]', 'abcd', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a[b-d]', 'acbd', 'ac'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[a-d][e-f][x-x]d', 'cexdxx', 'cexd'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v[[:alpha:]]+', 'abcdefghijklmnopqrstuvwxyz6','abcdefghijkl
[24;80Hm[25;1Hnopqrstuvwxyz'])[?25l[?1c[1;1H[L[1;1H:" start and end of buffer[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall add(tl, [2, '[[:alpha:]\+]', '6x8','x'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[^abc]\+','abcabcabc'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[^abc]','defghiasijvoinasoiunbvb','d'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[^abc]\+','ddddddda','ddddddd'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[^a-d]\+','aaaAAAZIHFNCddd','AAAZIHFNC'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[a-f]*','iiiiiiii',''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[a-f]*','abcdefgh','abcdef'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[^a-f]\+','abcdefgh','gh'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[a-c]\{-3,6}','abcabc','abc'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[^[:alpha:]]\+','abcccadfoij7787ysf287yrnccdu','7787'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[-a]', '-', '-'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[a-]', '-', '-'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[a-f]*\c','ABCDEFGH','ABCDEF'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[abc][xyz]\c','-af-AF-BY--','BY'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" filename regexp[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[-./[:alnum:]_~]\+', 'log13.file', 'log13.file'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" special chars[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[\]\^\-\\]\+', '\^\\\-\---^', '\^\\\-\---^'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" collation elem[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[[.a.]]\+', 'aa', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" middle of regexp[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'abc[0-9]*ddd', 'siuhabc ii'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'abc[0-9]*ddd', 'adf abc44482ddd oijs', 'abc44482ddd'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\_[0-9]\+', 'asfi9888u', '9888'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[0-9\n]\+', 'asfi9888u', '9888'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\_[0-9]\+', "asfi\n9888u", "\n9888"])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\_f', "  \na ", "\n"])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\_f\+', "  \na ", "\na"])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[0-9A-Za-z-_.]\+', " @0_a.A-{ ", "0_a.A-"])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" Test start/end of line, start/end of file[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '^a.', "a_\nb ", "a_"])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '^a.', "b a \na_"])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '.a$', " a\n "])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '.a$', " a b\n_a", "_a"])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\%^a.', "a a\na", "a "])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\%^a', " a \na "])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '.a\%$', " a\n "])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '.a\%$', " a\n_a", "_a"])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" Test recognition of character classes[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[0-7]\+', 'x0123456789x', '01234567'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[^0-7]\+', '0a;X+% 897', 'a;X+% 89'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[0-9]\+', 'x0123456789x', '0123456789'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[^0-9]\+', '0a;X+% 9', 'a;X+% '])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[0-9a-fA-F]\+', 'x0189abcdefg', '0189abcdef'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[^0-9A-Fa-f]\+', '0189g;X+% ab', 'g;X+% '])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[a-z_A-Z0-9]\+', ';+aso_SfOij ', 'aso_SfOij'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[^a-z_A-Z0-9]\+', 'aSo_;+% sfOij', ';+% '])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[a-z_A-Z]\+', '0abyz_ABYZ;', 'abyz_ABYZ'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[^a-z_A-Z]\+', 'abAB_09;+% yzYZ', '09;+% '])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[a-z]\+', '0abcxyz1', 'abcxyz'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[a-z]\+', 'AabxyzZ', 'abxyz'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[^a-z]\+', 'a;X09+% x', ';X09+% '])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[^a-z]\+', 'abX0;%yz', 'X0;%'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[a-zA-Z]\+', '0abABxzXZ9', 'abABxzXZ'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[^a-zA-Z]\+', 'ab09_;+ XZ', '09_;+ '])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[A-Z]\+', 'aABXYZz', 'ABXYZ'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[^A-Z]\+', 'ABx0;%YZ', 'x0;%'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[a-z]\+\c', '0abxyzABXYZ;', 'abxyzABXYZ'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[A-Z]\+\c', '0abABxzXZ9', 'abABxzXZ'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\c[^a-z]\+', 'ab09_;+ XZ', '09_;+ '])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\c[^A-Z]\+', 'ab09_;+ XZ', '09_;+ '])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\C[^A-Z]\+', 'ABCOIJDEOIFNSD jsfoij sa', ' jsfoij sa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" Tests for \z features[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" match ends at \ze[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'xx \ze test', 'xx '])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'abc\zeend', 'oij abcend', 'abc'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'aa\zebb\|aaxx', ' aabb ', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'aa\zebb\|aaxx', ' aaxx ', 'aaxx'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'aabb\|aa\zebb', ' aabb ', 'aabb'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'aa\zebb\|aaebb', ' aabb ', 'aa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" match starts at \zs[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'abc\zsdd', 'ddabcddxyzt', 'dd'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'aa \zsax', ' ax'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'abc \zsmatch\ze abc', 'abc abc abc match abc abc', 'match'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a \zsif .*){2}', 'a if then a if last', 'if last', 'a if 
[24;80Hl[25;1Hast'])[?25l[?1c[1;1H[L[1;1H:" start and end of buffer[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall add(tl, [2, '\>\zs.', 'aword. ', '.'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\s\+\ze\[/\|\s\zs\s\+', 'is   [a t', '  '])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" Tests for \@= and \& features[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'abc\@=', 'abc', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'abc\@=cd', 'abcd', 'abcd'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'abc\@=', 'ababc', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" will never match, no matter the input text[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'abcd\@=e', 'abcd'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" will never match[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'abcd\@=e', 'any text in here ... '])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(abc)@=..', 'xabcd', 'ab', 'abc'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\(.*John\)\@=.*Bob', 'here is John, and here is B'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\(John.*\)\@=.*Bob', 'John is Bobs friend', 'John is Bob', '
[24;80HJ[25;1Hohn is Bobs friend'])[?25l[?1c[1;1H[L[1;1H:" start and end of buffer[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall add(tl, [2, '\<\S\+\())\)\@=', '$((i=i+1))', 'i=i+1', '))'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '.*John\&.*Bob', 'here is John, and here is B'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '.*John\&.*Bob', 'John is Bobs friend', 'John is Bob'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(test1)@=.*yep', 'this is a test1, yep it is', 'test1, yep
[24;80H'[25;1H, 'test1'])[?25l[?1c[1;1H[L[1;1H:" start and end of buffer[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall add(tl, [2, 'foo\(bar\)\@!', 'foobar'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'foo\(bar\)\@!', 'foo bar', 'foo'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'if \(\(then\)\@!.\)*$', ' if then else'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'if \(\(then\)\@!.\)*$', ' if else ', 'if else ', ' '])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\(foo\)\@!bar', 'foobar', 'bar'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\(foo\)\@!...bar', 'foobar'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '^\%(.*bar\)\@!.*\zsfoo', ' bar foo '])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '^\%(.*bar\)\@!.*\zsfoo', ' foo bar '])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '^\%(.*bar\)\@!.*\zsfoo', ' foo xxx ', 'foo'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[ ]\@!\p\%([ ]\@!\p\)*:', 'implicit mappings:', 'mappings:']
[24;80H)[25;1H[?25l[?1c[1;1H[L[1;1H:" start and end of buffer[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall add(tl, [2, '[ ]\@!\p\([ ]\@!\p\)*:', 'implicit mappings:', 'mappings:', 
[24;80H'[25;1Hs'])[?25l[?1c[1;1H[L[1;1H:" start and end of buffer[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall add(tl, [2, 'm\k\+_\@=\%(_\@!\k\)\@<=\k\+e', 'mx__xe', 'mx__xe'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\%(\U\@<=S\k*\|S\l\)R', 'SuR', 'SuR'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" Combining different tests and features[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[[:alpha:]]\{-2,6}', '787abcdiuhsasiuhb4', 'ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '', 'abcd', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(())', 'any possible text', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v%(ab(xyz)c)', '   abxyzc ', 'abxyzc', 'xyz'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(test|)empty', 'tesempty', 'empty', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v(a|aa)(a|aa)', 'aaa', 'aa', 'a', 'a'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" \%u and friends[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\%d32', 'yes no', ' '])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\%o40', 'yes no', ' '])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\%x20', 'yes no', ' '])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\%u0020', 'yes no', ' '])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\%U00000020', 'yes no', ' '])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\%d0', "yes\x0ano", "\x0a"])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c""""" \%[abc][?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'foo\%[bar]', 'fobar'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'foo\%[bar]', 'foobar', 'foobar'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'foo\%[bar]', 'fooxx', 'foo'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'foo\%[bar]', 'foobxx', 'foob'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'foo\%[bar]', 'foobaxx', 'fooba'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'foo\%[bar]', 'foobarxx', 'foobar'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'foo\%[bar]x', 'foobxx', 'foobx'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'foo\%[bar]x', 'foobarxx', 'foobarx'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\%[bar]x', 'barxx', 'barx'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\%[bar]x', 'bxx', 'bx'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\%[bar]x', 'xxx', 'x'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'b\%[[ao]r]', 'bar bor', 'bar'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'b\%[[]]r]', 'b]r bor', 'b]r'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '@\%[\w\-]*', '<http://john.net/pandoc/>[@pandoc]', '@pandoc'
[24;80H][25;1H)[?25l[?1c[1;1H[L[1;1H:" start and end of buffer[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" Alternatives, must use first longest match[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'goo\|go', 'google', 'goo'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\<goo\|\<go', 'google', 'goo'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\<goo\|go', 'google', 'goo'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" Back references[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\(\i\+\) \1', ' abc abc', 'abc abc', 'abc'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\(\i\+\) \1', 'xgoo goox', 'goo goo', 'goo'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\(a\)\(b\)\(c\)\(dd\)\(e\)\(f\)\(g\)\(h\)\(i\)\1\2\3\4\5\6\7
[24;80H\[25;1H8\9', 'xabcddefghiabcddefghix', 'abcddefghiabcddefghi', 'a', 'b', 'c', 'dd', 'e
[24;80H'[25;1H, 'f', 'g', 'h', 'i'])[?25l[?1c[1;1H[2L[1;1H:" start and end of buffer
/\%^[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall add(tl, [2, '\(\d*\)a \1b', ' a b ', 'a b', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '^.\(.\).\_..\1.', "aaa\naaa\nb", "aaa\naaa", 'a'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '^.*\.\(.*\)/.\+\(\1\)\@<!$', 'foo.bat/foo.com', 'foo.bat/foo
[24;80H.[25;1Hcom', 'bat'])[?25l[?1c[1;1H[L[1;1H:" start and end of buffer[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall add(tl, [2, '^.*\.\(.*\)/.\+\(\1\)\@<!$', 'foo.bat/foo.bat'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '^.*\.\(.*\)/.\+\(\1\)\@<=$', 'foo.bat/foo.bat', 'foo.bat/foo
[24;80H.[25;1Hbat', 'bat', 'bat'])[?25l[?1c[1;1H[L[1;1H:" start and end of buffer[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall add(tl, [2, '\\\@<!\${\(\d\+\%(:.\{-}\)\?\\\@<!\)}', '2013-06-27${0}', '$
[24;80H{[25;1H0}', '0'])[?25l[?1c[1;1H[L[1;1H:" start and end of buffer[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall add(tl, [2, '^\(a*\)\1$', 'aaaaaaaa', 'aaaaaaaa', 'aaaa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '^\(a\{-2,}\)\1\+$', 'aaaaaaaaa', 'aaaaaaaaa', 'aaa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" Look-behind with limit[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '<\@<=span.', 'xxspanxx<spanyyy', 'spany'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '<\@1<=span.', 'xxspanxx<spanyyy', 'spany'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '<\@2<=span.', 'xxspanxx<spanyyy', 'spany'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\(<<\)\@<=span.', 'xxspanxxxx<spanxx<<spanyyy', 'spany', '<<
[24;80H'[25;1H])[?25l[?1c[1;1H[L[1;1H:" start and end of buffer[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall add(tl, [2, '\(<<\)\@1<=span.', 'xxspanxxxx<spanxx<<spanyyy'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\(<<\)\@2<=span.', 'xxspanxxxx<spanxx<<spanyyy', 'spany', '<
[24;80H<[25;1H'])[?25l[?1c[1;1H[L[1;1H:" start and end of buffer[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall add(tl, [2, '\(foo\)\@<!bar.', 'xx foobar1 xbar2 xx', 'bar2'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" look-behind match in front of a zero-width item[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v\C%(<Last Changed:\s+)@<=.*$', '" test header'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v\C%(<Last Changed:\s+)@<=.*$', '" Last Changed: 1970', '19
[24;80H7[25;1H0'])[?25l[?1c[1;1H[L[1;1H:" start and end of buffer[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall add(tl, [2, '\(foo\)\@<=\>', 'foobar'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\(foo\)\@<=\>', 'barfoo', '', 'foo'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\(foo\)\@<=.*', 'foobar', 'bar', 'foo'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" complicated look-behind match[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\(r\@<=\|\w\@<!\)\/', 'x = /word/;', '/'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '^[a-z]\+\ze \&\(asdf\)\@<!', 'foo bar', 'foo'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c""""" \@>[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\(a*\)\@>a', 'aaaa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\(a*\)\@>b', 'aaab', 'aaab', 'aaa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '^\(.\{-}b\)\@>.', '  abcbd', '  abc', '  ab'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\(.\{-}\)\(\)\@>$', 'abc', 'abc', 'abc', ''])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" TODO: BT engine does not restore submatch after failure[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [1, '\(a*\)\@>a\|a\+', 'aaaa', 'aaaa'])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" "\_" prepended negated collection matches EOL[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\_[^8-9]\+', "asfi\n9888", "asfi\n"])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\_[^a]\+', "asfi\n9888", "sfi\n9888"])[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" Requiring lots of states.[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[0-9a-zA-Z]\{8}-\([0-9a-zA-Z]\{4}-\)\{3}[0-9a-zA-Z]\{12}', "
12345678-1234-1234-1234-123456789012 ", "12345678-1234-1234-1234-123456789012",
"1234-"])[?25l[?1c[1;1H[2L[1;1H:" start and end of buffer
/\%^[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" Skip adding state twice[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '^\%(\%(^\s*#\s*if\>\|#\s*if\)\)\(\%>1c.*$\)\@=', "#if FOO", 
[24;80H"[25;1H#if", ' FOO'])[?25l[?1c[1;1H[L[1;1H:" start and end of buffer[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" Run the tests[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfor t in tl[?25l[?1c
:  [?25h[?0c:  let re = t[0]
[?25l[?1c:  [?25h[?0c:  let pat = t[1]
[?25l[?1c:  [?25h[?0c:  let text = t[2]
[?25l[?1c:  [?25h[?0c:  let matchidx = 3
[?25l[?1c:  [?25h[?0c:  for engine in [0, 1, 2]
[?25l[?1c:    [?25h[?0c:    if engine == 2 && re == 0 || engine == 1 && re ==1
[?25l[?1c:      [?25h[?0c:      continue
[?25l[?1c:      [?25h[?0c:    endif
[?25l[?1c:    [?25h[?0c:    let &regexpengine = engine
[?25l[?1c:    [?25h[?0c:    try
[?25l[?1c:      [?25h[?0c:      let l = matchlist(text, pat)
[?25l[?1c:      [?25h[?0c:    catch
[?25l[?1c:      [?25h[?0c:      $put ='ERROR ' . engine . ': pat: \"' . pat . '\", text: \"' . te
[24;80Hx[25;1Ht . '\", caused an exception: \"' . v:exception . '\"'
[?25l[?1c:      [?25h[?0c:    endtry
[?25l[?1c:    [?25h[?0c:" check the match itself
[?25l[?1c:    [?25h[?0c:    if len(l) == 0 && len(t) > matchidx
[?25l[?1c:      [?25h[?0c:      $put ='ERROR ' . engine . ': pat: \"' . pat . '\", text: \"' . te
[24;80Hx[25;1Ht . '\", did not match, expected: \"' . t[matchidx] . '\"'
[?25l[?1c:      [?25h[?0c:    elseif len(l) > 0 && len(t) == matchidx
[?25l[?1c:      [?25h[?0c:      $put ='ERROR ' . engine . ': pat: \"' . pat . '\", text: \"' . te
[24;80Hx[25;1Ht . '\", match: \"' . l[0] . '\", expected no match'
[?25l[?1c:      [?25h[?0c:    elseif len(t) > matchidx && l[0] != t[matchidx]
[?25l[?1c:      [?25h[?0c:      $put ='ERROR ' . engine . ': pat: \"' . pat . '\", text: \"' . tet . '\", match: \"' . l[0] . '\", expected: \"' . t[matchidx] . '\"'
[?25l[?1c:      [?25h[?0c:    else
[?25l[?1c:      [?25h[?0c:      $put ='OK ' . engine . ' - ' . pat
[?25l[?1c:      [?25h[?0c:    endif
[?25l[?1c:    [?25h[?0c:    if len(l) > 0
[?25l[?1c:      [?25h[?0c:"   check all the nine submatches
[?25l[?1c:      [?25h[?0c:      for i in range(1, 9)
[?25l[?1c:[8C[?25h[?0c:        if len(t) <= matchidx + i
[?25l[?1c:[10C[?25h[?0c:          let e = ''
[?25l[?1c:[10C[?25h[?0c:        else
[?25l[?1c:[10C[?25h[?0c:          let e = t[matchidx + i]
[?25l[?1c:[10C[?25h[?0c:        endif
[?25l[?1c:[8C[?25h[?0c:        if l[i] != e
[?25l[?1c:[10C[?25h[?0c:          $put ='ERROR ' . engine . ': pat: \"' . pat . '\", text: "' . text . '\", submatch ' . i . ': \"' . l[i] . '\", expected: \"' . e . '\"'
[?25l[?1c:[10C[?25h[?0c:        endif
[?25l[?1c:[8C[?25h[?0c:      endfor
[?25l[?1c:      [?25h[?0c:      unlet i
[?25l[?1c:      [?25h[?0c:    endif
[?25l[?1c:    [?25h[?0c:  endfor
[?25l[?1c:  [?25h[?0c:endfor[27m[24m[0m[H[J[?25l[?1c[1;1HOK 2 - \(a*\)\@>a
OK 0 - \(a*\)\@>b
OK 1 - \(a*\)\@>b
OK 2 - \(a*\)\@>b
OK 0 - ^\(.\{-}b\)\@>.
OK 1 - ^\(.\{-}b\)\@>.
OK 2 - ^\(.\{-}b\)\@>.
OK 0 - \(.\{-}\)\(\)\@>$
OK 1 - \(.\{-}\)\(\)\@>$
OK 2 - \(.\{-}\)\(\)\@>$
OK 0 - \(a*\)\@>a\|a\+
OK 2 - \(a*\)\@>a\|a\+
OK 0 - \_[^8-9]\+
OK 1 - \_[^8-9]\+
OK 2 - \_[^8-9]\+
OK 0 - \_[^a]\+
OK 1 - \_[^a]\+
OK 2 - \_[^a]\+
OK 0 - [0-9a-zA-Z]\{8}-\([0-9a-zA-Z]\{4}-\)\{3}[0-9a-zA-Z]\{12}
OK 1 - [0-9a-zA-Z]\{8}-\([0-9a-zA-Z]\{4}-\)\{3}[0-9a-zA-Z]\{12}
OK 2 - [0-9a-zA-Z]\{8}-\([0-9a-zA-Z]\{4}-\)\{3}[0-9a-zA-Z]\{12}
OK 0 - ^\%(\%(^\s*#\s*if\>\|#\s*if\)\)\(\%>1c.*$\)\@=
OK 1 - ^\%(\%(^\s*#\s*if\>\|#\s*if\)\)\(\%>1c.*$\)\@=
OK 2 - ^\%(\%(^\s*#\s*if\>\|#\s*if\)\)\(\%>1c.*$\)\@=[?25h[?0c[?25l[?1c
:[?25h[?0cunlet t tl e l[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""""" multi-line tests """"""""""""""""""""[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet tl = [][?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" back references[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '^.\(.\).\_..\1.', ['aaa', 'aaa', 'b'], ['XX', 'b']])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\v.*\/(.*)\n.*\/\1$', ['./Dir1/Dir2/zyxwvuts.txt', './Dir1/D
[24;80Hi[25;1Hr2/abcdefgh.bat', '', './Dir1/Dir2/file1.txt', './OtherDir1/OtherDir2/file1.txt
[24;80H'[25;1H], ['./Dir1/Dir2/zyxwvuts.txt', './Dir1/Dir2/abcdefgh.bat', '', 'XX']])[?25l[?1c[1;1H[2L[1;1HOK 2 - \(a*\)\@>a
OK 0 - \(a*\)\@>b[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" line breaks[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\S.*\nx', ['abc', 'def', 'ghi', 'xjk', 'lmn'], ['abc', 'def'
[24;80H,[25;1H 'XXjk', 'lmn']])[?25l[?1c[1;1H[L[1;1HOK 2 - \(a*\)\@>a[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Check that \_[0-9] matching EOL does not break a following \>[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\<\(\(25\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)
[24;80H\[25;1H.\)\{3\}\(25\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\>', ['', 'loca
[24;80Hl[25;1Hnet/192.168.0.1', ''], ['', 'localnet/XX', '']])[?25l[?1c[1;1H[2L[1;1HOK 2 - \(a*\)\@>a
OK 0 - \(a*\)\@>b[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Check a pattern with a line break and ^ and $[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\n^b$\n^c', ['a', 'b', 'c'], ['XX']])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\(^.\+\n\)\1', [' dog', ' dog', 'asdf'], ['XXasdf']])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" Run the multi-line tests[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put ='multi-line tests'[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hmulti-line tests[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cfor t in tl[?25l[?1c
:  [?25h[?0c:  let re = t[0]
[?25l[?1c:  [?25h[?0c:  let pat = t[1]
[?25l[?1c:  [?25h[?0c:  let before = t[2]
[?25l[?1c:  [?25h[?0c:  let after = t[3]
[?25l[?1c:  [?25h[?0c:  for engine in [0, 1, 2]
[?25l[?1c:    [?25h[?0c:    if engine == 2 && re == 0 || engine == 1 && re ==1
[?25l[?1c:      [?25h[?0c:      continue
[?25l[?1c:      [?25h[?0c:    endif
[?25l[?1c:    [?25h[?0c:    let &regexpengine = engine
[?25l[?1c:    [?25h[?0c:    new
[?25l[?1c:    [?25h[?0c:    call setline(1, before)
[?25l[?1c:    [?25h[?0c:    exe '%s/' . pat . '/XX/'
[?25l[?1c:    [?25h[?0c:    let result = getline(1, '$')
[?25l[?1c:    [?25h[?0c:    q!
[?25l[?1c:    [?25h[?0c:    if result != after
[?25l[?1c:      [?25h[?0c:      $put ='ERROR: pat: \"' . pat . '\", text: \"' . string(before) . 
[24;80H'[25;1H\", expected: \"' . string(after) . '\", got: \"' . string(result) . '\"'
[?25l[?1c:      [?25h[?0c:    else
[?25l[?1c:      [?25h[?0c:      $put ='OK ' . engine . ' - ' . pat
[?25l[?1c:      [?25h[?0c:    endif
[?25l[?1c:    [?25h[?0c:  endfor
[?25l[?1c:  [?25h[?0c:endfor[27m[24m[0m[H[J[?25l[?1c[1;1HOK 1 - ^\%(\%(^\s*#\s*if\>\|#\s*if\)\)\(\%>1c.*$\)\@=
OK 2 - ^\%(\%(^\s*#\s*if\>\|#\s*if\)\)\(\%>1c.*$\)\@=
multi-line tests
OK 0 - ^.\(.\).\_..\1.
OK 1 - ^.\(.\).\_..\1.
OK 2 - ^.\(.\).\_..\1.
OK 0 - \v.*\/(.*)\n.*\/\1$
OK 1 - \v.*\/(.*)\n.*\/\1$
OK 2 - \v.*\/(.*)\n.*\/\1$
OK 0 - \S.*\nx
OK 1 - \S.*\nx
OK 2 - \S.*\nx
OK 0 - \<\(\(25\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\.\)\{3\}\(25[14;1H\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\>
OK 1 - \<\(\(25\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\.\)\{3\}\(25[16;1H\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\>
OK 2 - \<\(\(25\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\.\)\{3\}\(25[18;1H\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\>
OK 0 - a\n^b$\n^c
OK 1 - a\n^b$\n^c
OK 2 - a\n^b$\n^c
OK 0 - \(^.\+\n\)\1
OK 1 - \(^.\+\n\)\1
OK 2 - \(^.\+\n\)\1[?25h[?0c[?25l[?1c
:[?25h[?0cunlet t tl[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Check that using a pattern on two lines doesn't get messed up by using[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" matchstr() with \ze in between.[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset re=0[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^Substitute here[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[1;1HyeGo[1m[34m^[[0mp:"
50%/\%^..
yeGo[1m[34m^[[0mpA END[1m[34m^[[0m:"
50%/\%$
"ayb20gg/..\%$
"bybGo[1m[34m^[[0m"apo[1m[34m^[[0m"bp:"
:"
:""""" Write the results """""""""""""
:/\%#=1^Results/,$wq! test.out
ENDTEST

Substitute here:
<T="">Ta 5</Title>
<T="">Ac 7</Title>

Behind:
asdfasd<yyy
xxstart1
asdfasd<yy
xxxstart2
asdfasd<yy
xxstart3

Visual:
[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c.+1,.+2s/""/\='"'.matchstr(getline("."), '\d\+\ze<').'"'[?25l[?1c[13;5H5">Ta 5</Title>
<T="7">Ac 7</Title>[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^Substitute here[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c.+1,.+2yank[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1HOK 1 - ^\%(\%(^\s*#\s*if\>\|#\s*if\)\)\(\%>1c.*$\)\@=
OK 2 - ^\%(\%(^\s*#\s*if\>\|#\s*if\)\)\(\%>1c.*$\)\@=
multi-line tests
OK 0 - ^.\(.\).\_..\1.
OK 1 - ^.\(.\).\_..\1.
OK 2 - ^.\(.\).\_..\1.
OK 0 - \v.*\/(.*)\n.*\/\1$
OK 1 - \v.*\/(.*)\n.*\/\1$
OK 2 - \v.*\/(.*)\n.*\/\1$
OK 0 - \S.*\nx
OK 1 - \S.*\nx
OK 2 - \S.*\nx
OK 0 - \<\(\(25\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\.\)\{3\}\(25[14;1H\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\>
OK 1 - \<\(\(25\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\.\)\{3\}\(25[16;1H\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\>
OK 2 - \<\(\(25\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\.\)\{3\}\(25[18;1H\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\>
OK 0 - a\n^b$\n^c
OK 1 - a\n^b$\n^c
OK 2 - a\n^b$\n^c
OK 0 - \(^.\+\n\)\1
OK 1 - \(^.\+\n\)\1
OK 2 - \(^.\+\n\)\1[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H<T="5">Ta 5</Title>[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Check a pattern with a look beind crossing a line boundary[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^Behind:[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[1;1H"ayb20gg/..\%$
"bybGo[1m[34m^[[0m"apo[1m[34m^[[0m"bp:"
:"
:""""" Write the results """""""""""""
:/\%#=1^Results/,$wq! test.out
ENDTEST

Substitute here:
<T="5">Ta 5</Title>
<T="7">Ac 7</Title>

Behind:
asdfasd<yyy
xxstart1
asdfasd<yy
xxxstart2
asdfasd<yy
xxstart3

Visual:
thexe the thexethe
andaxand andaxand
oooxofor foroxooo
oooxofor foroxooo
[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H/[?25h[?0c\(<\_[xy]\+\)\@3<=start[?25l[?1c[18;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.yank[?25l[?1c[18;3H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1HOK 0 - ^.\(.\).\_..\1.
OK 1 - ^.\(.\).\_..\1.
OK 2 - ^.\(.\).\_..\1.
OK 0 - \v.*\/(.*)\n.*\/\1$
OK 1 - \v.*\/(.*)\n.*\/\1$
OK 2 - \v.*\/(.*)\n.*\/\1$
OK 0 - \S.*\nx
OK 1 - \S.*\nx
OK 2 - \S.*\nx
OK 0 - \<\(\(25\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\.\)\{3\}\(25[11;1H\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\>
OK 1 - \<\(\(25\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\.\)\{3\}\(25[13;1H\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\>
OK 2 - \<\(\(25\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\.\)\{3\}\(25[15;1H\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\>
OK 0 - a\n^b$\n^c
OK 1 - a\n^b$\n^c
OK 2 - a\n^b$\n^c
OK 0 - \(^.\+\n\)\1
OK 1 - \(^.\+\n\)\1
OK 2 - \(^.\+\n\)\1

<T="5">Ta 5</Title>
<T="7">Ac 7</Title>[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hxxstart3[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Check matching Visual area[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^Visual:[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[1;1H<T="5">Ta 5</Title>
<T="7">Ac 7</Title>

Behind:
asdfasd<yyy
xxstart1
asdfasd<yy
xxxstart2
asdfasd<yy
xxstart3

Visual:
thexe the thexethe
andaxand andaxand
oooxofor foroxooo
oooxofor foroxooo

Marks:
asdfSasdfsadfEasdf
asdfSas
dfsadfEasdf

Results of test64:
OK 0 - ab
[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c
[0mthe[?25l[?1c[?25h[?0c[?25l[?1c[7mxe the the[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:'<,'>[?25h[?0cs/\%Ve/E/g[?25l[?1c3 substitutions on 1 line[13;4HxE thE thE[?25h[?0c
[?25l[?1ca[7mndaxand andaxand [?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:'<,'>[?25h[?0cs/\%Va/A/g[?25l[?1c6 substitutions on 1 line[14;1HAndAxAnd AndAxAnd[14;18H[K[14;1H[?25h[?0c
ooo[?25l[?1c[?25h[?0c[?25l[?1c[7mxofor foro[?25h[?0c[?25l[?1cx
[0mooo[7mxofor foro[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:'<,'>[?25h[?0cs/\%Vo/O/g[?25l[?1c8 substitutions on 2 lines[15;4HxOfOr fOrOx
oooxOfOr fOrO[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^Visual/+1,/^Visual/+4yank[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m4 lines yanked[25;15H[K[16;1H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1HOK 2 - ^.\(.\).\_..\1.
OK 0 - \v.*\/(.*)\n.*\/\1$
OK 1 - \v.*\/(.*)\n.*\/\1$
OK 2 - \v.*\/(.*)\n.*\/\1$
OK 0 - \S.*\nx
OK 1 - \S.*\nx
OK 2 - \S.*\nx
OK 0 - \<\(\(25\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\.\)\{3\}\(25[9;1H\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\>
OK 1 - \<\(\(25\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\.\)\{3\}\(25[11;1H\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\>
OK 2 - \<\(\(25\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\.\)\{3\}\(25[13;1H\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\>
OK 0 - a\n^b$\n^c
OK 1 - a\n^b$\n^c
OK 2 - a\n^b$\n^c
OK 0 - \(^.\+\n\)\1
OK 1 - \(^.\+\n\)\1
OK 2 - \(^.\+\n\)\1

<T="5">Ta 5</Title>
<T="7">Ac 7</Title>

xxstart3[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
4 more lines[1;24r[24;1H
[1;25r[24;1HthexE thE thExethe[25;1H[K[25;1H4 more lines[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Check matching marks[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^Marks:[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[1;1Hasdfasd<yy
xxxstart2
asdfasd<yy
xxstart3

Visual:
thexE thE thExethe
AndAxAnd AndAxAnd
oooxOfOr fOrOxooo
oooxOfOr fOrOxooo

Marks:
asdfSasdfsadfEasdf
asdfSas
dfsadfEasdf

Results of test64:
OK 0 - ab
OK 1 - ab
OK 2 - ab
OK 0 - b
OK 1 - b
OK 2 - b
OK 0 - bc*
[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c
[0masdf[9C[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.-4,.+6s/.\%>'s.*\%<'e../here/[?25l[?1c[13;5Hhereasdf[13;13H[K[13;1H[?25h[?0c
asdf
dfsadfsadf[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.-4,.+6s/.\%>'s\_.*\%<'e../again/[?25l[?1c[14;24r[24;1H
[1;25r[14;1Hasdfagainasdf[24;1HOK 1 - bc*[25;1H[K[14;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c/^Marks:/+1,/^Marks:/+3yank[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m3 lines yanked[25;15H[K[14;1H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1HOK 1 - \S.*\nx
OK 2 - \S.*\nx
OK 0 - \<\(\(25\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\.\)\{3\}\(25[4;1H\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\>
OK 1 - \<\(\(25\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\.\)\{3\}\(25[6;1H\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\>
OK 2 - \<\(\(25\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\.\)\{3\}\(25[8;1H\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\>
OK 0 - a\n^b$\n^c
OK 1 - a\n^b$\n^c
OK 2 - a\n^b$\n^c
OK 0 - \(^.\+\n\)\1
OK 1 - \(^.\+\n\)\1
OK 2 - \(^.\+\n\)\1

<T="5">Ta 5</Title>
<T="7">Ac 7</Title>

xxstart3

thexE thE thExethe
AndAxAnd AndAxAnd
oooxOfOr fOrOxooo
oooxOfOr fOrOxooo[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
3 more lines[1;24r[24;1H
[1;25r[24;1Hasdfhereasdf[25;1H[K[25;1H3 more lines[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Check patterns matching cursor position.[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunc! Postest()[?25l[?1c
:  [?25h[?0c new
[?25l[?1c:  [?25h[?0c call setline(1, ['ffooooo', 'boboooo', 'zoooooo', 'koooooo', 'moooooo', "\t
[24;80H\[25;1Ht\tfoo", 'abababababababfoo', 'bababababababafoo', '********_'])
[?25l[?1c:  [?25h[?0c call setpos('.', [0, 1, 0, 0])
[?25l[?1c:  [?25h[?0c s/\%>3c.//g
[?25l[?1c:  [?25h[?0c call setpos('.', [0, 2, 4, 0])
[?25l[?1c:  [?25h[?0c s/\%#.*$//g
[?25l[?1c:  [?25h[?0c call setpos('.', [0, 3, 0, 0])
[?25l[?1c:  [?25h[?0c s/\%<3c./_/g
[?25l[?1c:  [?25h[?0c %s/\%4l\%>5c./_/g
[?25l[?1c:  [?25h[?0c %s/\%6l\%>25v./_/g
[?25l[?1c:  [?25h[?0c %s/\%>6l\%3c./!/g
[?25l[?1c:  [?25h[?0c %s/\%>7l\%12c./?/g
[?25l[?1c:  [?25h[?0c %s/\%>7l\%<9l\%>5v\%<8v./#/g
[?25l[?1c:  [?25h[?0c 1,$yank
[?25l[?1c:  [?25h[?0c quit!
[?25l[?1c:  [?25h[?0cendfunc[1;1H[17L[?25l[?1c[1;1HOK 0 - \<\(\(25\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\.\)\{3\}\(25[2;1H\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\>
OK 1 - \<\(\(25\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\.\)\{3\}\(25[4;1H\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\>
OK 2 - \<\(\(25\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\.\)\{3\}\(25[6;1H\_[0-5]\|2\_[0-4]\_[0-9]\|\_[01]\?\_[0-9]\_[0-9]\?\)\>
OK 0 - a\n^b$\n^c
OK 1 - a\n^b$\n^c
OK 2 - a\n^b$\n^c
OK 0 - \(^.\+\n\)\1
OK 1 - \(^.\+\n\)\1
OK 2 - \(^.\+\n\)\1

<T="5">Ta 5</Title>
<T="7">Ac 7</Title>

xxstart3[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hasdfagainasdf
[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1H-0-
[1m[34m~                                                                               [23;3H[?25h[?0c[?25l[?1c

[0m:[?25h[?0cset re=0[?25l[?1c[23;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall Postest()[?25l[?1c3 substitutions on 3 lines
9 lines yanked
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cput[?25l[?1c9 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[0m[1;1H[3L[?25l[?1c[2;1H<T="5">Ta 5</Title>
<T="7">Ac 7</Title>[4;1H[K[5;1Hxxstart3[5;9H[K[6;1H[K[7;1HthexE thE thExethe[7;19H[K[8;1HAndAxAnd AndAxAnd[8;18H[K[9;1HoooxOfOr fOrOxooo
oooxOfOr fOrOxooo[10;18H[K[11;1H[K[12;1Hasdfhereasdf
asdfagainasdf

-0-[15;4H[K[16;1Hffo[16;4H[K[17;1Hbob[17;4H[K[18;1H__ooooo[18;8H[K[19;1Hkoooo__
moooooo[20;8H[K[21;1H             [11Cf__
ab!babababababfoo
ba!ab##abab?bafoo
**!*****_[24;10H[K[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H-1-[?25h[?0c[?25l[?1c
:[?25h[?0cset re=1[?25l[?1c[24;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall Postest()[?25l[?1c3 substitutions on 3 lines
9 lines yanked
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cput[?25l[?1c9 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[0m[1;1H[3L[?25l[?1c[2;1Hasdfhereasdf
asdfagainasdf[4;1H[K[5;1H-0-
ffo[6;4H[K[7;1Hbob[7;4H[K[8;1H__ooooo[8;8H[K[9;1Hkoooo__[9;8H[K[10;1Hmoooooo
            [12Cf__
ab!babababababfoo
ba!ab##abab?bafoo
**!*****_
-1-
ffo
bob[17;4H[K[18;1H__ooooo
koooo__
moooooo[20;25H[K[21;1H                 [7Cf__
ab!bababababab
ba!ab##abab?bafoo
**!*****_[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H-2-[?25h[?0c[?25l[?1c
:[?25h[?0cset re=2[?25l[?1c[24;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall Postest()[?25l[?1c3 substitutions on 3 lines
9 lines yanked
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cput[?25l[?1c9 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[3L[1;25Hf__
ab!babababababfoo
ba!ab##abab?bafoo
**!*****_
-1-
ffo
bob[7;4H[K[8;1H__ooooo
koooo__
moooooo[10;25H[K[11;1H                 [7Cf__
ab!bababababab
ba!ab##abab?bafoo
**!*****_
-2-
ffo
bob[17;4H[K[18;1H__ooooo
koooo__
moooooo[20;25H[K[21;1H                 [7Cf__
ab!bababababab
ba!ab##abab?bafoo
**!*****_[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c" start and end of buffer[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c\%^[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[1;1HTest for regexp patterns without multi-byte support.
See test95 for multi-byte tests.

A pattern that gives the expected result produces OK, so that we know it was
actually tried.

STARTTEST
:so small.vim
:" tl is a List of Lists with:
:"    regexp pattern
:"    text to test the pattern on
:"    expected match (optional)
:"    expected submatch 1 (optional)
:"    expected submatch 2 (optional)
:"    etc.
:"  When there is no match use only the first two items.
:let tl = []
:"
:""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
:"""" Previously written tests """"""""""""""""""""""""""""""""
:""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
:"
:call add(tl, [2, 'ab', 'aab', 'ab'])
:call add(tl, [2, 'b', 'abcdef', 'b'])
[1m[31msearch hit BOTTOM, continuing at TOP[1;1H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;25Hf__
ab!babababababfoo
ba!ab##abab?bafoo
**!*****_
-1-
ffo
bob
__ooooo
koooo__
moooooo[11;25Hf__
ab!babababababfoo
ba!ab##abab?bafoo
**!*****_
-2-
ffo
bob
__ooooo
koooo__
moooooo[21;25Hf__
ab!babababababfoo
ba!ab##abab?bafoo
**!*****_[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1cTest[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;4H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1HOK 1 - \v(((ab)+)+)+
OK 2 - \v(((ab)+)+)+
OK 0 - \v(((ab)+)+)+
OK 1 - \v(((ab)+)+)+
OK 2 - \v(((ab)+)+)+
OK 0 - \v(a{0,2})+
OK 1 - \v(a{0,2})+
OK 2 - \v(a{0,2})+
OK 0 - \v(a*)+
OK 1 - \v(a*)+
OK 2 - \v(a*)+
OK 0 - \v((a*)+)+
OK 1 - \v((a*)+)+
OK 2 - \v((a*)+)+
OK 0 - \v((ab)*)+
OK 1 - \v((ab)*)+
OK 2 - \v((ab)*)+
OK 0 - \va{1,3}
OK 1 - \va{1,3}
OK 2 - \va{1,3}
OK 0 - \va{2,3}
OK 1 - \va{2,3}
OK 2 - \va{2,3}
OK 0 - \v((ab)+|c*)+[12;1H[?25h[?0c[?25l[?1c[25;1H/[?25h[?0c\%^..[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[1;1HTest for regexp patterns without multi-byte support.
See test95 for multi-byte tests.

A pattern that gives the expected result produces OK, so that we know it was
actually tried.

STARTTEST
:so small.vim
:" tl is a List of Lists with:
:"    regexp pattern
:"    text to test the pattern on
:"    expected match (optional)
:"    expected submatch 1 (optional)
:"    expected submatch 2 (optional)
:"    etc.
:"  When there is no match use only the first two items.
:let tl = []
:"
:""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
:"""" Previously written tests """"""""""""""""""""""""""""""""
:""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
:"
:call add(tl, [2, 'ab', 'aab', 'ab'])
:call add(tl, [2, 'b', 'abcdef', 'b'])
[1m[31msearch hit BOTTOM, continuing at TOP[1;1H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1Hab!babababababfoo
ba!ab##abab?bafoo
**!*****_
-1-
ffo
bob
__ooooo
koooo__
moooooo[10;25Hf__
ab!babababababfoo
ba!ab##abab?bafoo
**!*****_
-2-
ffo
bob
__ooooo
koooo__
moooooo[20;25Hf__
ab!babababababfoo
ba!ab##abab?bafoo
**!*****_
Test[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1cTest[?25h[?0c[?25l[?1ct END[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;8H[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1HOK 2 - \v(((ab)+)+)+
OK 0 - \v(((ab)+)+)+
OK 1 - \v(((ab)+)+)+
OK 2 - \v(((ab)+)+)+
OK 0 - \v(a{0,2})+
OK 1 - \v(a{0,2})+
OK 2 - \v(a{0,2})+
OK 0 - \v(a*)+
OK 1 - \v(a*)+
OK 2 - \v(a*)+
OK 0 - \v((a*)+)+
OK 1 - \v((a*)+)+
OK 2 - \v((a*)+)+
OK 0 - \v((ab)*)+
OK 1 - \v((ab)*)+
OK 2 - \v((ab)*)+
OK 0 - \va{1,3}
OK 1 - \va{1,3}
OK 2 - \va{1,3}
OK 0 - \va{2,3}
OK 1 - \va{2,3}
OK 2 - \va{2,3}
OK 0 - \v((ab)+|c*)+
OK 1 - \v((ab)+|c*)+[12;1H[?25h[?0c[?25l[?1c[25;1H/[?25h[?0c\%$[?25l[?1c[27m[24m[0m[H[J[1;1Hba!ab##abab?bafoo
**!*****_
-1-
ffo
bob
__ooooo
koooo__
moooooo[9;25Hf__
ab!babababababfoo
ba!ab##abab?bafoo
**!*****_
-2-
ffo
bob
__ooooo
koooo__
moooooo[19;25Hf__
ab!babababababfoo
ba!ab##abab?bafoo
**!*****_
Test
Test END[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1H:" tl is a List of Lists with:
:"    regexp pattern
:"    text to test the pattern on
:"    expected match (optional)
:"    expected submatch 1 (optional)
:"    expected submatch 2 (optional)
:"    etc.
:"  When there is no match use only the first two items.
:let tl = []
:"
:""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
:"""" Previously written tests """"""""""""""""""""""""""""""""
:""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
:"
:call add(tl, [2, 'ab', 'aab', 'ab'])
:call add(tl, [2, 'b', 'abcdef', 'b'])
:call add(tl, [2, 'bc*', 'abccccdef', 'bcccc'])
:call add(tl, [2, 'bc\{-}', 'abccccdef', 'b'])
:call add(tl, [2, 'bc\{-}\(d\)', 'abccccdef', 'bccccd', 'd'])
:call add(tl, [2, 'bc*', 'abbdef', 'b'])
:call add(tl, [2, 'c*', 'ccc', 'ccc'])
:call add(tl, [2, 'bc*', 'abdef', 'b'])
:call add(tl, [2, 'c*', 'abdef', ''])
:call add(tl, [2, 'bc\+', 'abccccdef', 'bcccc'])[12;1H[?25h[?0c[?25l[?1c[25;1H/[?25h[?0c..\%$[?25l[?1c[27m[24m[0m[H[J[1;1Hba!ab##abab?bafoo
**!*****_
-1-
ffo
bob
__ooooo
koooo__
moooooo[9;25Hf__
ab!babababababfoo
ba!ab##abab?bafoo
**!*****_
-2-
ffo
bob
__ooooo
koooo__
moooooo[19;25Hf__
ab!babababababfoo
ba!ab##abab?bafoo
**!*****_
Test
Test END[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1cEN[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1cE[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c""""" Write the results """""""""""""[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/\%#=1^Results/,$wq! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 1099 lines, 20205 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test65.failed test.ok test.out X* viminfo
cp test65.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test65.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test65.in" 95 lines, 2153 characters[1;1HTest for floating point and logical operators.

STARTTEST
:so small.vim
:if !has("float")
:  e! test.ok
:  wq! test.out
:endif
:"
:$put =printf('%f', 123.456)
:$put =printf('%e', 123.456)
:$put =printf('%g', 123.456)
:" check we don't crash on division by zero
:echo 1.0 / 0.0
:$put ='+='
:let v = 1.234
:let v += 6.543
:$put =printf('%g', v)
:let v = 1.234
:let v += 5
:$put =printf('%g', v)
:let a = 5
:let a += 3.333
:$put =string(a)[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for floating point and logical operators.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 89 lines, 2067 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:$put ='float2nr'
:$put =float2nr(123.456)
:$put =float2nr(-123.456)
:$put ='AND'
:$put =and(127, 127)
:$put =and(127, 16)
:$put =and(127, 128)
:$put ='OR'
:$put =or(16, 7)
:$put =or(8, 7)
:$put =or(0, 123)
:$put ='XOR'
:$put =xor(127, 127)
:$put =xor(127, 16)
:$put =xor(127, 128)
:$put ='invert'
:$put =and(invert(127), 65535)
:$put =and(invert(16), 65535)
:$put =and(invert(128), 65535)
:$put =invert(1.0)
:/^Results/,$wq! test.out
ENDTEST

Results of test65:[22;1H[?25h[?0c
[?25l[?1c

:so! Xdotest[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif !has("float")[?25l[?1c
:  [?25h[?0c:  e! test.ok
[?25l[?1c:  [?25h[?0c:  wq! test.out
[?25l[?1c:  [?25h[?0c:endif[1;1H[3L[?25l[?1c[1;1H:$put ='float2nr'
:$put =float2nr(123.456)
:$put =float2nr(-123.456)[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0c"[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =printf('%f', 123.456)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H123.456000[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%e', 123.456)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H1.234560e+02[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', 123.456)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H123.456[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c" check we don't crash on division by zero[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cecho 1.0 / 0.0[?25l[?1cinf[25;4H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put ='+='[?25l[?1c[1;24r[24;1H
[1;25r[24;1H+=[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet v = 1.234[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet v += 6.543[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =printf('%g', v)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H7.777[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet v = 1.234[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet v += 5[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =printf('%g', v)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H6.234[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet a = 5[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet a += 3.333[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =string(a)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H8.333[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='=='[?25l[?1c[1;24r[24;1H
[1;25r[24;1H==[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet v = 1.234[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =v == 1.234[?25l[?1c[1;24r[24;1H
[1;25r[24;1H1[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =v == 1.2341[?25l[?1c[1;24r[24;1H
[1;25r[24;1H0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='add-subtract'[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hadd-subtract[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', 4 + 1.234)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H5.234[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', 1.234 - 8)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H-6.766[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='mult-div'[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hmult-div[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', 4 * 1.234)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H4.936[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', 4.0 / 1234)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H0.003241[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='dict'[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hdict[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string({'x': 1.234, 'y': -2.0e20})[?25l[?1c[1;24r[24;1H
[1;25r[24;1H{'x': 1.234, 'y': -2.0e20}[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='list'[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hlist[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string([-123.4, 2.0e-20])[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[-123.4, 2.0e-20][25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='abs'[?25l[?1c[1;24r[24;1H
[1;25r[24;1Habs[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%d', abs(1456))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H1456[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%d', abs(-4))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H4[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%d', abs([1, 2, 3]))[?25l[?1c[1m[37m[41mE745: Using a List as a Number[0m[25;32H[K[1;24r[24;1H
[1;25r[24;1H-1[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', abs(14.56))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H14.56[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', abs(-54.32))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H54.32[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='ceil'[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hceil[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', ceil(1.456))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H2.0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', ceil(-5.456))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H-5.0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', ceil(-4.000))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H-4.0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='floor'[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hfloor[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', floor(1.856))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H1.0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', floor(-5.456))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H-6.0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', floor(4.0))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H4.0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='log10'[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hlog10[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', log10(1000))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H3.0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', log10(0.01000))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H-2.0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='pow'[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hpow[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', pow(3, 3.0))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H27.0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', pow(2, 16))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H65536.0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='round'[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hround[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', round(0.456))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H0.0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', round(4.5))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H5.0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', round(-4.50))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H-5.0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='sqrt'[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hsqrt[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', sqrt(100))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H10.0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cecho sqrt(-4.01)[?25l[?1c-nan[25;5H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put ='str2float'[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hstr2float[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', str2float('1e40'))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H1.0e40[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='trunc'[?25l[?1c[1;24r[24;1H
[1;25r[24;1Htrunc[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', trunc(1.456))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H1.0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', trunc(-5.456))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H-5.0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =printf('%g', trunc(4.000))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H4.0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='float2nr'[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hfloat2nr[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =float2nr(123.456)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H123[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =float2nr(-123.456)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H-123[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='AND'[?25l[?1c[1;24r[24;1H
[1;25r[24;1HAND[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =and(127, 127)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H127[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =and(127, 16)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H16[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =and(127, 128)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='OR'[?25l[?1c[1;24r[24;1H
[1;25r[24;1HOR[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =or(16, 7)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H23[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =or(8, 7)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H15[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =or(0, 123)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H123[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='XOR'[?25l[?1c[1;24r[24;1H
[1;25r[24;1HXOR[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =xor(127, 127)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =xor(127, 16)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H111[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =xor(127, 128)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H255[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='invert'[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hinvert[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =and(invert(127), 65535)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H65408[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =and(invert(16), 65535)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H65519[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =and(invert(128), 65535)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H65407[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =invert(1.0)[?25l[?1c[1m[37m[41mE805: Using a Float as a Number[1;24r[0m[24;1H
[1;25r[24;1H0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c/^Results/,$wq! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 73 lines, 430 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test66.failed test.ok test.out X* viminfo
cp test66.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test66.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test66.in" 33 lines, 509 characters[2;1HTest for visual block shift and tab characters.

STARTTEST
:so small.vim
/^one
fe[1m[34m^V[0m4jR[1m[34m^[[0mugvr1:'<,'>w! test.out
/^abcdefgh
[1m[34m^V[0m4jI    [1m[34m^[[0mj<<11|D
7|a[13C[1m[34m^[[0m
7|a[16C[1m[34m^[[0m
7|a[13C[1m[34m^[[0m4k13|[1m[34m^V[0m4j<
:$-5,$w >> test.out
:$-4,$s/\s\+//g
[1m[34m^V[0m4kI    [1m[34m^[[0mj<<
7|a[13C[1m[34m^[[0m
7|a[37C[1m[34m^[[0m
7|a[21C[1m[34m^[[0m4k13|[1m[34m^V[0m4j3<
:$-4,$w >> test.out
:qa!
ENDTEST

one two three
one two three[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[4;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 16 lines, 234 characters written[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[21;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^one[?25l[?1c[23;1H[?25h[?0con[?25l[?1c[?25h[?0c[?25l[?1c[1;24r[1;1H[3M[1;25r[20;3H[7me
[0mon[7me[0m
on[7me[0m two three
on[7me[0m two three
one two three[25;1H[K[24;3H[?25h[?0c[?25l[?1c
4 fewer lines[20;1H[K[21;1H[K[22;1Habcdefghijklmnopqrstuvwxyz
abcdefghijklmnopqrstuvwxyz
abcdefghijklmnopqrstuvwxyz[20;1H[?25h[?0c[?25l[?1c[25;3Hmore lines; before #1  0 seconds ago[20;1Hone two three
one two three
one two three[22;14H[K[23;1Hone two three[23;14H[K[24;1Hone two three[24;14H[K[21;1H[?25h[?0c[?25l[?1c[20;3H[7me
[0mon[7me
[0mon[7me
[0mon[7me
[0mon[?25h[?0c[?25l[?1c[20;3H1
on1
on1
on1
on1[20;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c'<,'>w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 5 lines, 70 characters written[20;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^abcdefgh[?25l[?1c[1;24r[1;1H[2M[1;25r[24;1Habcdefghijklmnopqrstuvwxyz[25;1H[K[24;1H[?25h[?0c[?25l[?1c[?25h[?0c[?25l[?1c[1;24r[1;1H[4M[1;25r[20;1H[7ma
a[0mbcdefghijklmnopqrstuvwxyz
[7ma[0mbcdefghijklmnopqrstuvwxyz
[7ma[0mbcdefghijklmnopqrstuvwxyz
abcdefghijklmnopqrstuvwxyz[?25h[?0c[?25l[?1c[20;1Ha
a
a
a[20;1H    abcdefghijklmnopqrstuvwxyz
    abcdefghijklmnopqrstuvwxyz
    abcdefghijklmnopqrstuvwxyz
    abcdefghijklmnopqrstuvwxyz
    abcdefghijklmnopqrstuvwxyz[20;1H[?25h[?0c
[?25l[?1cabcdefghijklmnopqrstuvwxyz[21;27H[K[21;1H[?25h[?0c[10C[?25l[?1c[21;11H[K[21;10H[?25h[?0c[22;10H[?25l[?1cc         defghijklmnopqrstuvwxyz[22;16H[?25h[?0c[23;16H[23;7H[?25l[?1cc            defghijklmnopqrstuvwxyz[23;19H[?25h[?0c[24;19H[24;7H[?25l[?1cc         defghijklmnopqrstuvwxyz[24;16H[?25h[?0c[20;16H[?25l[?1c[?25h[?0c[?25l[?1c[7mi[22;13H [23;13H [24;13H[?25h[?0c[?25l[?1c[0m
5 lines <ed 1 time[20;13Hi[22;13Hdefghijklmnopqrstuvwxyz[22;36H[K[23;13Hdefghijklmnopqrstuvwxyz[23;36H[K[24;13Hdefghijklmnopqrstuvwxyz[24;36H[K[20;13H[?25h[?0c[21;10H[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$-5,$w >> test.out[?25l[?1c"test.out"[25;12H[K[25;12H6 lines, 151 characters appended[21;10H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$-4,$s/\s\+//g[?25l[?1c7 substitutions on 4 lines[20;1Habcdefghijklmnopqrstuvwxyz[20;27H[K[22;1Habcdefghijklmnopqrstuvwxyz[22;27H[K[23;1Habcdefghijklmnopqrstuvwxyz[23;27H[K[24;1Habcdefghijklmnopqrstuvwxyz[24;27H[K[24;1H[?25h[?0c[?25l[?1c[?25h[?0c[?25l[?1c[21;1H[7ma
a
a
a[20;1H[?25h[?0c[?25l[?1c[0m
a
a
a
a[20;1H    abcdefghijklmnopqrstuvwxyz
    abcdefghij
    abcdefghijklmnopqrstuvwxyz
    abcdefghijklmnopqrstuvwxyz
    abcdefghijklmnopqrstuvwxyz[20;1H[?25h[?0c
[?25l[?1cabcdefghij[21;11H[K[21;1H[?25h[?0c
    ab[?25l[?1cc         defghijklmnopqrstuvwxyz[22;16H[?25h[?0c[23;16H[23;7H[?25l[?1cc                       [10Cdefghijklmnopqrstuvwxyz[23;40H[?25h[?0c[24;30H[24;7H[?25l[?1cc                 defghijklmnopqrstuvwxyz[24;24H[?25h[?0c[20;24H[20;13H[?25l[?1c[?25h[?0c[?25l[?1c[7mi[22;13H [23;13H [24;13H[?25h[?0c[?25l[?1c[0m
5 lines <ed 3 times[25;20H[K[20;13Hi[22;13Hdefghijklmnopqrstuvwxyz[22;36H[K[23;13H    defghijklmnopqrstuvwxyz[23;41H[K[24;13Hdefghijklmnopqrstuvwxyz[24;36H[K[20;13H[?25h[?0c[21;10H[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$-4,$w >> test.out[?25l[?1c"test.out"[25;12H[K[25;12H5 lines, 147 characters appended[21;10H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test67.failed test.ok test.out X* viminfo
cp test67.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test67.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test67.in" 33 lines, 1109 characters[1;1HTest that groups and patterns are tested correctly when calling exists() for
autocommands.

STARTTEST
:so small.vim
:let results=[]
:augroup auexists
:augroup END
:call add(results, "##BufEnter: " . exists("##BufEnter"))
:call add(results, "#BufEnter: " . exists("#BufEnter"))
:au BufEnter * let g:entered=1
:call add(results, "#BufEnter: " . exists("#BufEnter"))
:call add(results, "#auexists#BufEnter: " . exists("#auexists#BufEnter"))
:augroup auexists
:au BufEnter * let g:entered=1
:augroup END
:call add(results, "#auexists#BufEnter: " . exists("#auexists#BufEnter"))
:call add(results, "#BufEnter#*.test: " . exists("#BufEnter#*.test"))
:au BufEnter *.test let g:entered=1
:call add(results, "#BufEnter#*.test: " . exists("#BufEnter#*.test"))
:edit testfile.test
:call add(results, "#BufEnter#<buffer>: " . exists("#BufEnter#<buffer>"))
:au BufEnter <buffer> let g:entered=1
:call add(results, "#BufEnter#<buffer>: " . exists("#BufEnter#<buffer>"))[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest that groups and patterns are tested correctly when calling exists() for[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[4;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 27 lines, 998 characters written[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[8M[1;25r[17;1H:edit testfile2.test
:call add(results, "#BufEnter#<buffer>: " . exists("#BufEnter#<buffer>"))
:e test.out
:call append(0, results)
:$d
:w
:qa!
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet results=[][?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0caugroup auexists[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0caugroup END[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(results, "##BufEnter: " . exists("##BufEnter"))[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(results, "#BufEnter: " . exists("#BufEnter"))[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau BufEnter * let g:entered=1[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(results, "#BufEnter: " . exists("#BufEnter"))[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(results, "#auexists#BufEnter: " . exists("#auexists#BufEnter"))[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0caugroup auexists[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau BufEnter * let g:entered=1[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0caugroup END[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(results, "#auexists#BufEnter: " . exists("#auexists#BufEnter"))[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(results, "#BufEnter#*.test: " . exists("#BufEnter#*.test"))[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau BufEnter *.test let g:entered=1[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(results, "#BufEnter#*.test: " . exists("#BufEnter#*.test"))[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cedit testfile.test[?25l[?1c"testfile.test" [New File][1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall add(results, "#BufEnter#<buffer>: " . exists("#BufEnter#<buffer>"))[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cau BufEnter <buffer> let g:entered=1[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(results, "#BufEnter#<buffer>: " . exists("#BufEnter#<buffer>"))[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cedit testfile2.test[?25l[?1c"testfile2.test" [New File][1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(results, "#BufEnter#<buffer>: " . exists("#BufEnter#<buffer>"))[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce test.out[?25l[?1c"test.out" [New File][1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append(0, results)[?25l[?1c[1;24r[1;1H[10L[1;25r[1;1H##BufEnter: 1
#BufEnter: 0
#BufEnter: 1
#auexists#BufEnter: 0
#auexists#BufEnter: 1
#BufEnter#*.test: 0
#BufEnter#*.test: 1
#BufEnter#<buffer>: 0
#BufEnter#<buffer>: 1
#BufEnter#<buffer>: 0[25;1H[K[11;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c$d[?25l[?1c[11;1H[1m[34m~                                                                               [10;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"test.out" [New File] 10 lines, 190 characters written[10;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test68.failed test.ok test.out X* viminfo
cp test68.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test68.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test68.in" 131 lines, 1004 characters[1;1HTest for text formatting.

Results of test68:

STARTTEST
:so small.vim
/^{/+1
:set noai tw=2 fo=t
gRa b[1m[34m^[[0m
ENDTEST

{


}

STARTTEST
/^{/+1
:set ai tw=2 fo=tw
gqgqjjllab[1m[34m^[[0m
ENDTEST

{
a  b[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for text formatting.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[5;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 4 lines, 48 characters written[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[6;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[10;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[11;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[11;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^{/+1[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset noai tw=2 fo=t[?25l[?1c[13;1H[?25h[?0c[?25l[?1ca
b[?25h[?0c
[?25l[?1c[25;1H[K[25;1H/^STARTTEST[17;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[18;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3 lines, 38 characters written[18;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[18;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[21;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^{/+1[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ai tw=2 fo=tw[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;4H[K[24;1Hb[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Ha[?25h[?0ca [?25l[?1c[1;24r[24;1H
[1;25r[24;1Hb[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H}[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H/^{/+1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H4 lines, 34 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[4M[1;25r[21;1H:set tw=3 fo=t
gqgqo
a [1m[34m^V^A^[[0m
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^{/+1[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1H{
a [1m[34m^A[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset tw=3 fo=t[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;3H[K[24;1H[1m[34m^A[0m[25;1H[K[24;1H[?25h[?0c[2C[?25l[?1c[1;24r[1;1H[3M[1;25r[23;1Ha
[1m[34m^A[?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[24;1H}[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H/^{/+1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H5 lines, 58 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[5M[1;25r[20;1H:set tw=2 fo=tcq1 comments=:#
gqgqjgqgqo
a b
#a b[1m[34m^[[0m
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^{/+1[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1H{
a b[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset tw=2 fo=tcq1 comments=:#[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H#a b[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[3M[1;25r[23;1Ha b
#a b[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H}[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H/^{/+1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3 lines, 46 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[3M[1;25r[22;1H:set tw=5 fo=tcn comments=:#
A b[1m[34m^[[0mjA b[1m[34m^[[0m
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^{/+1[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1H{
  1 a[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset tw=5 fo=tcn comments=:#[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Hb[25;1H[K[24;5H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H# 1 a[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H#   b[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H}[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H/^{/+3[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3 lines, 35 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[3M[1;25r[22;1H:set tw=5 fo=t2a si
i  [1m[34m^[[0mA_[1m[34m^[[0m
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^{/+3[?25l[?1c[1;24r[1;1H[4M[1;25r[21;1H{

  x a
  b[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset tw=5 fo=t2a si[?25l[?1c[24;1H[?25h[?0c[?25l[?1c    b[?25h[?0c[?25l[?1c b_[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;5Hc[25;1H[K[24;5H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[4M[1;25r[22;1H}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H/^{/+1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3 lines, 40 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[3M[1;25r[22;1H:set tw=5 fo=qn comments=:#
gwap
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^{/+1[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1H{
# 1 a b[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset tw=5 fo=qn comments=:#[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[24;7H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H#   b[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[3M[1;25r[22;1H}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H/^{/+1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3 lines, 40 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[3M[1;25r[22;1H:set tw=5 fo=q2 comments=:#
gwap
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^{/+1[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1H{
# x[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset tw=5 fo=q2 comments=:#[?25l[?1c[24;1H[?25h[?0c[?25l[?1c# x a[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H#   b[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[3M[1;25r[22;1H}

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H/^{/+2[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3 lines, 26 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[3M[1;25r[22;1H:set tw& fo=a
I^^[1m[34m^[[0m
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^{/+2[?25l[?1c[1;24r[1;1H[3M[1;25r[22;1H{
   1aa
   2bb[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset tw& fo=a[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[22;3H1aa ^^2bb }[23;4H[K[24;1HSTARTTEST[22;8H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H/^STARTTEST[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H/mno pqr/[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3 lines, 69 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[3M[1;25r[22;1H:setl tw=20 fo=an12wcq comments=s1:/*,mb:*,ex:*/
A vwx yz[1m[34m^[[0m
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cmno pqr/[?25l[?1c[25;9H[K[25;1H[1;24r[1;1H[2M[1;25r[23;1H/* abc def ghi jkl
 *    mno pqr stu[25;1H[K[24;7H[?25h[?0c[?25l[?1c
:[?25h[?0csetl tw=20 fo=an12wcq comments=s1:/*,mb:*,ex:*/[?25l[?1c[24;7H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;2H*    vwx yz[25;1H[K[24;12H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;2H*/[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H/^#/[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3 lines, 47 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[3M[1;25r[22;1H:setl tw=12 fo=tqnc comments=:#
A foobar[1m[34m^[[0m
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^#/[?25l[?1c[25;4H[K[25;1H[1;24r[24;1H
[1;25r[24;1H# 1 xxxxx[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0csetl tw=12 fo=tqnc comments=:#[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H#   foobar[25;1H[K[24;10H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[24;1H
[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:g/^STARTTEST/.,/^ENDTEST/d[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2 lines, 56 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[24;19H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:1;/^Results/,$wq! test.out[25;1H[K[24;19H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cg/^STARTTEST/.,/^ENDTEST/d[?25l[?1c63 fewer lines[25;15H[K[1;1H{
# 1 a[2;6H[K[3;1H#   b[3;6H[K[4;1H}[4;2H[K[5;1H[K[6;1H[K[7;1H{
# x a[8;6H[K[9;1H#   b[9;7H[K[10;1H}[10;2H[K[11;2H[K[13;1H{ 1aa ^^2bb }[14;1H[K[15;1H[K[16;1H/* abc def ghi jkl
 *    mno pqr stu
 *    vwx yz
 */[19;5H[K[20;1H[K[22;1H# 1 xxxxx
#   foobar[23;11H[K[24;1H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c1;/^Results/,$wq! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 77 lines, 281 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test69.failed test.ok test.out X* viminfo
cp test69.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test69.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test69.in" 185 lines, 2079 characters[1;1HTest for multi-byte text formatting.
Also test, that 'mps' with multibyte chars works.
And test "ra" on multi-byte characters.
Also test byteidx() and byteidxcomp()

STARTTEST
:so mbyte.vim
:set encoding=utf-8
ENDTEST

Results of test69:

STARTTEST
/^{/+1
:set tw=2 fo=t
gqgqjgqgqo
ＸＹＺ
abc ＸＹＺ[1m[34m^[[0m
ENDTEST

{
ＸＹＺ
abc ＸＹＺ
}[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for multi-byte text formatting.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[6;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 2 lines, 34 characters written[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[7;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[9;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[10;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso mbyte.vim[?25l[?1c[10;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset encoding=utf-8[?25l[?1c[27m[24m[0m[H[J[1;1HTest for multi-byte text formatting.
Also test, that 'mps' with multibyte chars works.
And test "ra" on multi-byte characters.
Also test byteidx() and byteidxcomp()

STARTTEST
:so mbyte.vim
:set encoding=utf-8
ENDTEST

Results of test69:

STARTTEST
/^{/+1
:set tw=2 fo=t
gqgqjgqgqo
ＸＹＺ
abc ＸＹＺ[1m[34m^[[0m
ENDTEST

{
ＸＹＺ
abc ＸＹＺ
}[10;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[13;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H5 lines, 58 characters written[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[14;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[19;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^{/+1[?25l[?1c[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset tw=2 fo=t[?25l[?1c[22;1H[?25h[?0c
[?25l[?1c[23;5H[K[24;1HＸＹＺ[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[25;1H[K[24;1H[?25h[?0c[?25l[?1cＸ[?25h[?0c[?25l[?1cＹ[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;5HＺ
abc [?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HＸ[?25h[?0c[?25l[?1cＹ[?25h[?0c[?25l[?1cＺ[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H}[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H/^{/+1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H8 lines, 80 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[8M[1;25r[17;1H:set tw=1 fo=tm
gqgqjgqgqjgqgqjgqgqjgqgqo
Ｘ
Ｘa
Ｘ a
ＸＹ
Ｘ Ｙ[1m[34m^[[0m
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^{/+1[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1H{
Ｘ[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset tw=1 fo=tm[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HＸa[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;3H[K[24;1Ha[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HＸ a[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;4H[K[24;1Ha[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HＸＹ[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;3H[K[24;1HＹ[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HＸ Ｙ[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;4H[K[24;1HＹ[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;1HＸ
[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[22;1HＸ
a
[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[22;1HＸ
a
[?25h[?0c[?25l[?1cＸ[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1HＹ
[?25h[?0c[?25l[?1cＸ [?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HＹ[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H}[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H/^{/+1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H13 lines, 140 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1Hgqgqjgqgqjgqgqjgqgqjgqgqjgqgqjgqgqjgqgqjgqgqjgqgqo
Ｘ
Ｘa
Ｘ a
ＸＹ
Ｘ Ｙ
aＸ
abＸ
abcＸ
abＸ c
abＸＹ[1m[34m^[[0m
ENDTEST

{
Ｘ
Ｘa
Ｘ a
ＸＹ
Ｘ Ｙ
aＸ
abＸ
abcＸ
abＸ c
abＸＹ[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^{/+1[?25l[?1c[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset tw=2 fo=tm[?25l[?1c[15;1H[?25h[?0c
[?25l[?1c[17;24r[17;1H[L[1;25r[16;3H[K[17;1Ha[25;1H[K[17;1H[?25h[?0c
[?25l[?1c[19;24r[19;1H[L[1;25r[18;4H[K[19;1Ha[?25h[?0c
[?25l[?1c[21;24r[21;1H[L[1;25r[20;3H[K[21;1HＹ[?25h[?0c
[?25l[?1c[22;4H[K[23;1HＹ 
aＸ [23;1H[?25h[?0c
[?25l[?1c[1;24r[24;1H
[1;25r[23;2H[K[24;1HＸ[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HabＸ[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;3H[K[24;1HＸ[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HabcＸ[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;4H[K[24;1HＸ[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HabＸ c[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[22;3H[K[23;1HＸ
c[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HabＸＹ[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[22;3H[K[23;1HＸ
Ｙ[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;1HＸ
[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[22;1HＸ
a
[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[22;1HＸ
a
[?25h[?0c[?25l[?1cＸ[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1HＹ
[?25h[?0c[?25l[?1cＸ [?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1HＹ
a[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1HＸ
ab[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1HＸ
abc[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1HＸ
ab[?25h[?0c[?25l[?1c[1;24r[1;1H[3M[1;25r[22;1HＸ
c
ab[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HＸ[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HＹ[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H}[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H/^{/+1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H5 lines, 47 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[5M[1;25r[20;1H:set ai tw=2 fo=tm
gqgqjgqgqo
Ｘ
Ｘa[1m[34m^[[0m
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^{/+1[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1H{
  Ｘ[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset ai tw=2 fo=tm[?25l[?1c[24;1H[?25h[?0c  [?25l[?1c[1;24r[24;1H
[1;25r[24;3HＸa[25;1H[K[24;3H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;5H[K[24;3Ha[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[24;3H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;3HＸ
  [?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;3HＸ
  a[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H}[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H/^{/+1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H5 lines, 53 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[5M[1;25r[20;1H:set noai tw=2 fo=tm
gqgqjgqgqo
  Ｘ
  Ｘa[1m[34m^[[0m
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^{/+1[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1H{
  Ｘ[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset noai tw=2 fo=tm[?25l[?1c[24;1H[?25h[?0c  [?25l[?1c[1;24r[24;1H
[1;25r[24;3HＸa[25;1H[K[24;3H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;5H[K[24;1Ha[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[24;3H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;3HＸ
  [?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;3HＸ
a[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H}[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H/^{/+1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H13 lines, 169 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1Hgqgqjgqgqjgqgqjgqgqjgqgqjgqgqjgqgqjgqgqjgqgqjgqgqo
Ｘ
Ｘa
ＸaＹ
ＸＹ
ＸＹＺ
Ｘ Ｙ
Ｘ ＹＺ
ＸＸ
ＸＸa
ＸＸＹ[1m[34m^[[0m
ENDTEST

{
Ｘ
Ｘa
ＸaＹ
ＸＹ
ＸＹＺ
Ｘ Ｙ
Ｘ ＹＺ
ＸＸ
ＸＸa
ＸＸＹ[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^{/+1[?25l[?1c[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset tw=2 fo=cqm comments=n:Ｘ[?25l[?1c[15;1H[?25h[?0c

[?25l[?1c[18;24r[18;1H[L[1;25r[17;4H[K[18;1HＸＹ[25;1H[K[18;1H[?25h[?0c

[?25l[?1c[21;24r[21;1H[L[1;25r[20;5H[K[21;1HＸＺ[?25h[?0c

[?25l[?1c[23;6H[K[24;3H Ｚ[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HＸＸ[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HＸＸa[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HＸＸＹ[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;1HＸ
[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;1HＸa
[?25h[?0c[?25l[?1cＸa[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1HＸＹ
[?25h[?0c[?25l[?1cＸ[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;3HＹ
[?25h[?0c[?25l[?1cＸ[?25h[?0c[?25l[?1cＹ[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1HＸＺ
[?25h[?0c[?25l[?1cＸ [?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;4HＹ
[?25h[?0c[?25l[?1cＸ [?25h[?0c[?25l[?1cＹ[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1HＸ Ｚ
[?25h[?0c[?25l[?1cＸ[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;3HＸ
[?25h[?0c[?25l[?1cＸ[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;3HＸa
[?25h[?0c[?25l[?1cＸ[?25h[?0c[?25l[?1cＸ[?25h[?0c[?25l[?1cＹ[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H}[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H/^{/+1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3 lines, 30 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[3M[1;25r[22;1H:set tw=2 fo=tm
RＸa[1m[34m^[[0m
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^{/+1[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1H{[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset tw=2 fo=tm[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[23;1HＸ
a[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H}[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H/^{/+1[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3 lines, 34 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[3M[1;25r[22;1H:set mps+=[1m[34m^V[0mu2018:[1m[34m^V[0mu2019
d%
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^{/+1[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1H{
‘ two three ’ four[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset mps+=^‘:^’[?25l[?1c[24;1H[?25h[?0c[?25l[?1c four[24;7H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H}[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[24;1H
[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H/^ra test[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2 lines, 16 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[2M[1;25r[23;1HjVjra
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^ra test[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hra test[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hａbbａ[?25h[?0c[?25l[?1c[2C[7mbbａ [?25h[?0c[?25l[?1c[1;24r[0m[24;1H
[1;25r[23;1H[7mａ[0m
ａ[7mａb [?25h[?0c[?25l[?1c[0m[23;1Haaaa[23;5H[K[24;1Haaa[7m [0m[24;4H[K[23;1H[?25h[?0c
[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set whichwrap+=h[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H4 lines, 43 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[4M[1;25r[21;1H/^x
dh
:set whichwrap-=h
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset whichwrap+=h[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^x[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Há
x[25;1H[K[24;1H[?25h[?0c[?25l[?1c[23;2Hx[24;1H[K[23;2H[?25h[?0c
[?25l[?1c
:[?25h[?0cset whichwrap-=h[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[1;24r[24;1H
[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:let a = '.é.' " one char of two bytes[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H9 lines, 548 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[13M[1;25r[12;1H:let b = '.é.' " normal e with composing char
/^byteidx
:put =string([byteidx(a, 0), byteidx(a, 1), byteidx(a, 2), byteidx(a, 3), byteid[15;1Hx(a, 4)])
:put =string([byteidx(b, 0), byteidx(b, 1), byteidx(b, 2), byteidx(b, 3), byteid[17;1Hx(b, 4)])
/^byteidxcomp
:put =string([byteidxcomp(a, 0), byteidxcomp(a, 1), byteidxcomp(a, 2), byteidxco[20;1Hmp(a, 3), byteidxcomp(a, 4)])
:let b = '.é.'
:put =string([byteidxcomp(b, 0), byteidxcomp(b, 1), byteidxcomp(b, 2), byteidxco[23;1Hmp(b, 3), byteidxcomp(b, 4), byteidxcomp(b, 5)])
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet a = '.é.' " one char of two bytes[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet b = '.eé.' " normal e with composing char[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^byteidx[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hbyteidx[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =string([byteidx(a, 0), byteidx(a, 1), byteidx(a, 2), byteidx(a, 3), bytei
[24;80Hd[25;1Hx(a, 4)])[?25l[?1c[1;1H[L[1;1Hdh
:set whichwrap-=h
ENDTEST[3;8H[K[4;1H[K[5;1Háx[6;1H[K[7;1HSTARTTEST
:let a = '.é.' " one char of two bytes[9;6Hb = '.é.' " normal e with composing char
/^byteidx[10;10H[K[11;1H:put =string([byteidx(a, 0), byteidx(a, 1), byteidx(a, 2), byteidx(a, 3), byteid[12;1Hx(a, 4)])[12;10H[K[13;1H:put =string([byteidx(b, 0), byteidx(b, 1), byteidx(b, 2), byteidx(b, 3), byteid[14;1Hx(b, 4)])[14;10H[K[15;1H/^byteidxcomp
:put =string([byteidxcomp(a, 0), byteidxcomp(a, 1), byteidxcomp(a, 2), byteidxco[17;1Hmp(a, 3), byteidxcomp(a, 4)])[17;30H[K[18;1H:let b = '.é.'[18;15H[K[19;2Hput =string([byteidxcomp(b, 0), byteidxcomp(b, 1), byteidxcomp(b, 2), byteidxco[20;1Hmp(b, 3), byteidxcomp(b, 4), byteidxcomp(b, 5)])[20;49H[K[21;1HENDTEST[21;8H[K[22;1H[K[23;1Hbyteidx
[0, 1, 3, 4, -1][25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =string([byteidx(b, 0), byteidx(b, 1), byteidx(b, 2), byteidx(b, 3), bytei
[24;80Hd[25;1Hx(b, 4)])[?25l[?1c[1;1H[L[1;1H:set whichwrap-=h
ENDTEST[2;8H[K[3;1H[K[4;1Háx[5;1H[K[6;1HSTARTTEST
:let a = '.é.' " one char of two bytes[8;6Hb = '.é.' " normal e with composing char
/^byteidx[9;10H[K[10;1H:put =string([byteidx(a, 0), byteidx(a, 1), byteidx(a, 2), byteidx(a, 3), byteid[11;1Hx(a, 4)])[11;10H[K[12;1H:put =string([byteidx(b, 0), byteidx(b, 1), byteidx(b, 2), byteidx(b, 3), byteid[13;1Hx(b, 4)])[13;10H[K[14;1H/^byteidxcomp
:put =string([byteidxcomp(a, 0), byteidxcomp(a, 1), byteidxcomp(a, 2), byteidxco[16;1Hmp(a, 3), byteidxcomp(a, 4)])[16;30H[K[17;1H:let b = '.é.'[17;15H[K[18;2Hput =string([byteidxcomp(b, 0), byteidxcomp(b, 1), byteidxcomp(b, 2), byteidxco[19;1Hmp(b, 3), byteidxcomp(b, 4), byteidxcomp(b, 5)])[19;49H[K[20;1HENDTEST[20;8H[K[21;1H[K[22;1Hbyteidx
[0, 1, 3, 4, -1][24;8H4, 5[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0c^byteidxcomp[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hbyteidxcomp[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =string([byteidxcomp(a, 0), byteidxcomp(a, 1), byteidxcomp(a, 2), byteidxc
[24;80Ho[25;1Hmp(a, 3), byteidxcomp(a, 4)])[?25l[?1c[1;1H[L[2;1Háx[3;1H[K[4;1HSTARTTEST
:let a = '.é.' " one char of two bytes[6;6Hb = '.é.' " normal e with composing char
/^byteidx[7;10H[K[8;1H:put =string([byteidx(a, 0), byteidx(a, 1), byteidx(a, 2), byteidx(a, 3), byteid[9;1Hx(a, 4)])[9;10H[K[10;1H:put =string([byteidx(b, 0), byteidx(b, 1), byteidx(b, 2), byteidx(b, 3), byteid[11;1Hx(b, 4)])[11;10H[K[12;1H/^byteidxcomp
:put =string([byteidxcomp(a, 0), byteidxcomp(a, 1), byteidxcomp(a, 2), byteidxco[14;1Hmp(a, 3), byteidxcomp(a, 4)])[14;30H[K[15;1H:let b = '.é.'[15;15H[K[16;2Hput =string([byteidxcomp(b, 0), byteidxcomp(b, 1), byteidxcomp(b, 2), byteidxco[17;1Hmp(b, 3), byteidxcomp(b, 4), byteidxcomp(b, 5)])[17;49H[K[18;1HENDTEST[18;8H[K[19;1H[K[20;1Hbyteidx
[0, 1, 3, 4, -1][22;8H4, 5
byteidxcomp[23;12H[K[24;1H[0, 1, 3, 4, -1][25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet b = '.eé.'[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cput =string([byteidxcomp(b, 0), byteidxcomp(b, 1), byteidxcomp(b, 2), byteidxc
[24;80Ho[25;1Hmp(b, 3), byteidxcomp(b, 4), byteidxcomp(b, 5)])[?25l[?1c[1;1H[L[1;1Háx[2;1H[K[3;1HSTARTTEST
:let a = '.é.' " one char of two bytes[5;6Hb = '.é.' " normal e with composing char
/^byteidx[6;10H[K[7;1H:put =string([byteidx(a, 0), byteidx(a, 1), byteidx(a, 2), byteidx(a, 3), byteid[8;1Hx(a, 4)])[8;10H[K[9;1H:put =string([byteidx(b, 0), byteidx(b, 1), byteidx(b, 2), byteidx(b, 3), byteid[10;1Hx(b, 4)])[10;10H[K[11;1H/^byteidxcomp
:put =string([byteidxcomp(a, 0), byteidxcomp(a, 1), byteidxcomp(a, 2), byteidxco[13;1Hmp(a, 3), byteidxcomp(a, 4)])[13;30H[K[14;1H:let b = '.é.'[14;15H[K[15;2Hput =string([byteidxcomp(b, 0), byteidxcomp(b, 1), byteidxcomp(b, 2), byteidxco[16;1Hmp(b, 3), byteidxcomp(b, 4), byteidxcomp(b, 5)])[16;49H[K[17;1HENDTEST[17;8H[K[18;1H[K[19;1Hbyteidx
[0, 1, 3, 4, -1][21;8H4, 5
byteidxcomp[22;12H[K[23;1H[0, 1, 3, 4, -1][24;8H2, 4, 5, -1][25;1H[K[24;1H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:g/^STARTTEST/.,/^ENDTEST/d[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H2 lines, 56 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[24;19H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:1;/^Results/,$wq! test.out[25;1H[K[24;19H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cg/^STARTTEST/.,/^ENDTEST/d[?25l[?1c100 fewer lines[25;16H[K[1;1HＸ[1;3H[K[2;1Ha[2;2H[K[3;1H}[3;2H[K[4;1H[K[5;1H[K[6;1H{[6;2H[K[7;1H four[7;6H[K[8;1H}[8;2H[K[9;1H[K[10;1Hra test[10;8H[K[11;1Haaaa[11;6H[K[12;1Haaa[12;4H[K[13;1H[K[15;1Háx[15;3H[K[16;1H[K[17;1H[K[18;8H[K[20;8H4, 5, -1][20;17H[K[21;1Hbyteidxcomp
[0, 1, 3, 4, -1]
[0, 1, 2, 4, 5, -1][23;20H[K[24;1H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c1;/^Results/,$wq! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 162 lines, 703 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test70.failed test.ok test.out X* viminfo
cp test70.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test70.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test70.in" 63 lines, 1501 characters[1;1HSmoke test for MzScheme interface and mzeval() function

STARTTEST
:so mzscheme.vim
:set nocompatible viminfo+=nviminfo
:function! MzRequire()
:redir => l:mzversion
:mz (version)
:redir END
:if strpart(l:mzversion, 1, 1) < "4"
:" MzScheme versions < 4.x:
:mz (require (prefix vim- vimext))
:else
:" newer versions:
:mz (require (prefix-in vim- 'vimext))
:mz (require r5rs)
:endif
:endfunction
:silent call MzRequire()
:mz (define l '("item0" "dictionary with list OK" "item2"))
:mz (define h (make-hash))
:mz (hash-set! h "list" l)
/^1
:" change buffer contents[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HSmoke test for MzScheme interface and mzeval() function[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 55 lines, 1398 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:let l2 = mzeval("h")["list"]
:if l2[2] == l2
:let res = "OK"
:else
:let res = "FAILED: " . l2[2]
:endif
:call setline(search("^3"), "circular test " . res)
:" funcrefs
:mz (define vim:max (vim-eval "function('max')"))
:mz (define m (vim:max '(1 100 8)))
:let m = mzeval('m')
:if m == 100
:let fref_res = "OK"
:else
:let fref_res = "FAILED: " . m
:end
:call append(line('$'), 'funcrefs '. fref_res)
:?^1?,$w! test.out
:qa!
ENDTEST

1 line 1
2 line 2
3 line 3[20;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[21;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso mzscheme.vim[?25l[?1c"test.ok" [25;11H[K[25;11H6 lines, 94 characters
"test.out" [New File] 6 lines, 94 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test71.failed test.ok test.out X* viminfo
cp test71.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test71.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test71.in" 67 lines, 1209 characters[1;1HTest for encryption.
The test data is in another file to avoid problems with 'encoding', especially
cp932.

STARTTEST
:so small.vim
:set enc=latin1
:bwipe!
:r test71a.in
:/^start of text/+1
:let text_lines = getline('.', line('.') + 2)
:/^start of cm=zip bytes/+1
:let cm0_bytes = getline('.', '.')
:/^start of cm=blowfish bytes/+1
:let cm1_bytes = getline('.', '.')
:bwipe!
:call append(0, text_lines)
:$d
:X
foobar
foobar
:w! Xtestfile
:bwipe!
:e Xtestfile[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for encryption.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[5;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 60 lines, 1082 characters written[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[6;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:w! Xtestfile
:bwipe!
:set nobin
:e Xtestfile
foofoo
:let cm0_read_bin = getline('.', '$')
:bwipe!
:set bin noeol key=
:call append(0, cm1_bytes)
:$d
:set fenc=latin1
:w! Xtestfile
:bwipe!
:set nobin
:e Xtestfile
barbar
:call append(0, cm0_read_bin)
:call append(0, cm1_read_back)
:call append(0, cm0_read_back)
:set key= fenc=latin1
:w! test.out
:qa!
ENDTEST[?25h[?0c
[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset enc=latin1[?25l[?1c[27m[24m[0m[H[J[1;1H:w! Xtestfile
:bwipe!
:set nobin
:e Xtestfile
foofoo
:let cm0_read_bin = getline('.', '$')
:bwipe!
:set bin noeol key=
:call append(0, cm1_bytes)
:$d
:set fenc=latin1
:w! Xtestfile
:bwipe!
:set nobin
:e Xtestfile
barbar
:call append(0, cm0_read_bin)
:call append(0, cm1_read_back)
:call append(0, cm0_read_back)
:set key= fenc=latin1
:w! test.out
:qa!
ENDTEST
[?25h[?0c[?25l[?1c
:[?25h[?0cbwipe![?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cr test71a.in[?25l[?1c"test71a.in" 14 lines, 314 characters[2;1H[K[3;1Hstart of text[3;14H[K[4;1H01234567890123456789012345678901234567[4;39H[K[5;1Hline 2  foo bar blah[5;21H[K[6;1Hline 3 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[6;38H[K[7;1Hend of text[7;12H[K[8;1H[K[9;1Hstart of cm=zip bytes[9;22H[K[10;1HVimCrypt~01![1m[34m^F^\[0mlV'}Mg[1m[34m|[0m[1CV[1m[34m^G[0mE#3[1m[34m~N[0m2U[1m[34m~W[0m[10;43H[K[11;1Hend of cm=zip bytes[11;20H[K[12;1H[K[13;1Hstart of cm=blowfish bytes[13;27H[K[14;1HVimCrypt~02!k)[1m[34m^W~W[0m#[1m[34m^V[0mS[1m[34m~\[0m=#M[1m[34m~F[0mJAͥM[1m[34m~F[0m![1m[34m~@^U~[[0m[1m[34m^O[0m[1m[34m^Y~B^V~X[0m[1m[34m^M[0m[14;71H[K[15;1Hend of cm=blowfish bytes[15;25H[K[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^start of text/+1[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet text_lines = getline('.', line('.') + 2)[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^start of cm=zip bytes/+1[?25l[?1c[10;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet cm0_bytes = getline('.', '.')[?25l[?1c[10;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^start of cm=blowfish bytes/+1[?25l[?1c[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet cm1_bytes = getline('.', '.')[?25l[?1c[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe![?25l[?1c[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall append(0, text_lines)[?25l[?1c[1;24r[1;1H[3L[1;25r[1;1H01234567890123456789012345678901234567
line 2  foo bar blah
line 3 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[25;1H[K[4;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c$d[?25l[?1c[4;1H[1m[34m~                                                                               [3;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cX[?25l[?1c[25;1H[K[25;1HEnter encryption key: [?25h[?0c******
[?25l[?1cEnter same key again: [?25h[?0c******
[1;1H[2L[?25l[?1c[1;1H01234567890123456789012345678901234567
line 2  foo bar blah[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cw! Xtestfile[?25l[?1c"Xtestfile" [25;13H[K[25;13H[New File][crypted] 3 lines, 98 characters written[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe![?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ce Xtestfile[?25l[?1c"Xtestfile" Need encryption key for "Xtestfile"
Enter encryption key: [?25h[?0c******
[?25l[?1c"Xtestfile" [crypted] 3 lines, 98 characters[1;1H[2L[1;1H01234567890123456789012345678901234567
line 2  foo bar blah
line 3 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[3;38H[K[25;1H[K[25;1H"Xtestfile" [crypted] 3 lines, 98 characters[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet cm0_read_back = getline('.', '$')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset key=[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cryptmethod=blowfish[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" If the blowfish test fails 'cryptmethod' will be 'zip' now.[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c%s/^/\=&cryptmethod == 'blowfish' ? "OK " : "blowfish test failed "/[?25l[?1c3 substitutions on 3 lines[25;27H[K[1;1HOK 01234567890123456789012345678901234567
OK line 2  foo bar blah
OK line 3 [27Cxxx[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cX[?25l[?1c[25;1H[K[25;1HEnter encryption key: [?25h[?0c******
[?25l[?1cEnter same key again: [?25h[?0c******
[1;1H[2L[?25l[?1c[1;1HOK 01234567890123456789012345678901234567
OK line 2  foo bar blah[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cw! Xtestfile[?25l[?1c"Xtestfile" [25;13H[K[25;13H[blowfish] 3 lines, 107 characters written[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe![?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ce Xtestfile[?25l[?1c"Xtestfile" Need encryption key for "Xtestfile"
Enter encryption key: [?25h[?0c******
[?25l[?1c"Xtestfile" [blowfish] 3 lines, 107 characters[1;1H[2L[1;1HOK 01234567890123456789012345678901234567
OK line 2  foo bar blah
OK line 3 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[3;41H[K[25;1H[K[25;1H"Xtestfile" [blowfish] 3 lines, 107 characters[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet cm1_read_back = getline('.', '$')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe![?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset bin noeol key=[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append(0, cm0_bytes)[?25l[?1c[1;24r[1;1H[L[1;25r[1;1HVimCrypt~01![1m[34m^F^\[0mlV'}Mg[1m[34m| [0mV[1m[34m^G[0mE#3[1m[34m~N[0m2U[1m[34m~W[0m[25;1H[K[2;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c$d[?25l[?1c[2;1H[1m[34m~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset fenc=latin1[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! Xtestfile[?25l[?1c"Xtestfile" [25;13H[K[25;13H[Incomplete last line] 1 line, 36 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe![?25l[?1c[1;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nobin[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xtestfile[?25l[?1c"Xtestfile" Need encryption key for "Xtestfile"
Enter encryption key: [?25h[?0c******
[?25l[?1c"Xtestfile" [crypted] 2 lines, 24 characters[1;1H[2L[1;1H1234567890
abbccddeff[25;1H[K[25;1H"Xtestfile" [crypted] 2 lines, 24 characters[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet cm0_read_bin = getline('.', '$')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe![?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset bin noeol key=[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append(0, cm1_bytes)[?25l[?1c[1;24r[1;1H[L[1;25r[1;1HVimCrypt~02!k)[1m[34m^W~W[0m#[1m[34m^V[0mS[1m[34m~\[0m=#M[1m[34m~F[0mJAͥM[1m[34m~F[0m![1m[34m~@^U~[[0m[1m[34m^O[0m[1m[34m^Y~B^V~X[0m[1m[34m^M[0m[25;1H[K[2;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c$d[?25l[?1c[2;1H[1m[34m~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset fenc=latin1[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! Xtestfile[?25l[?1c"Xtestfile" [25;13H[K[25;13H[Incomplete last line] 1 line, 55 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe![?25l[?1c[1;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nobin[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xtestfile[?25l[?1c"Xtestfile" Need encryption key for "Xtestfile"
Enter encryption key: [?25h[?0c******
[?25l[?1c"Xtestfile" [blowfish] 2 lines, 27 characters[1;1H[2L[1;1Hasdfasdfasdf
0001112223333[25;1H[K[25;1H"Xtestfile" [blowfish] 2 lines, 27 characters[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append(0, cm0_read_bin)[?25l[?1c[1;24r[1;1H[2L[1;25r[1;1H1234567890
abbccddeff[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall append(0, cm1_read_back)[?25l[?1c[1;24r[1;1H[3L[1;25r[1;1HOK 01234567890123456789012345678901234567
OK line 2  foo bar blah
OK line 3 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[25;1H[K[6;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall append(0, cm0_read_back)[?25l[?1c[1;24r[1;1H[3L[1;25r[1;1H01234567890123456789012345678901234567
line 2  foo bar blah
line 3 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx[25;1H[K[9;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset key= fenc=latin1[?25l[?1c[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 10 lines, 256 characters written[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test72.failed test.ok test.out X* viminfo
cp test72.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test72.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test72.in" 119 lines, 1780 characters[1;1HTests for undo file.
Since this script is sourced we need to explicitly break changes up in
undo-able pieces.  Do that by setting 'undolevels'.

STARTTEST
:so small.vim
:"
:" Test 'undofile': first a simple one-line change.
:set nocompatible viminfo+=nviminfo visualbell
:set ul=100 undofile nomore
:e! Xtestfile
ggdGithis is one line[1m[34m^[[0m:set ul=100
:s/one/ONE/
:set ul=100
:w
:bwipe!
:e Xtestfile
u:.w! test.out
:"
:" Test 'undofile', change in original file fails check
:set noundofile
:e! Xtestfile
:s/line/Line/
:w[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for undo file.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[5;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 108 lines, 1583 characters written[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[6;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:w!
:bwipe!
:e Xtestfile
foobar
:set key=
/bar
:.w >>test.out
u:.w >>test.out
u:.w >>test.out
u:.w >>test.out
:"
:" Rename the undo file so that it gets cleaned up.
:if has("vms")
: call rename("_un_Xtestfile", "Xtestundo")
:else
: call rename(".Xtestfile.un~", "Xtestundo")
:endif
:qa!
ENDTEST

1111 -----
2222 -----

123456789[19;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test 'undofile': first a simple one-line change.[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nocompatible viminfo+=nviminfo visualbell[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ul=100 undofile nomore[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! Xtestfile[?25l[?1c"Xtestfile" [New File][1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[1m-- INSERT --[0m[25;13H[K[25;1H[K[1;1Hthis is one line[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset ul=100[?25l[?1c[1;16H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/one/ONE/[?25l[?1c[1;9HONE[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset ul=100[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"Xtestfile" [New] 1L, 17C written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe![?25l[?1c"test72.in" 119L, 1780C[1;1H:w![1;4H[K[2;1H:bwipe![2;8H[K[3;1H:e Xtestfile[3;13H[K[4;1Hfoobar[4;7H[K[5;1H:set key=[5;10H[K[6;1H/bar[6;5H[K[7;1H:.w >>test.out[7;15H[K[8;1Hu:.w >>test.out[8;16H[K[9;1Hu:.w >>test.out[9;16H[K[10;1Hu:.w >>test.out[10;16H[K[11;1H:"[11;3H[K[12;1H:" Rename the undo file so that it gets cleaned up.[12;52H[K[13;1H:if has("vms")[13;15H[K[14;1H: call rename("_un_Xtestfile", "Xtestundo")[14;44H[K[15;1H:else[15;6H[K[16;1H: call rename(".Xtestfile.un~", "Xtestundo")[16;45H[K[17;1H:endif[17;7H[K[18;1H:qa![18;5H[K[19;1HENDTEST[19;8H[K[20;1H[K[21;1H1111 -----[21;11H[K[22;1H2222 -----[22;11H[K[23;1H[K[24;1H123456789[24;10H[K[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xtestfile[?25l[?1c"Xtestfile" 1L, 17C[1;1Hthis is ONE line
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H1 change; before #2  0 seconds ago[1;9Hone[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New] 1L, 17C written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test 'undofile', change in original file fails check[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset noundofile[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! Xtestfile[?25l[?1c"Xtestfile" [25;13H[K[25;13H1L, 17C[1;9HONE[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/line/Line/[?25l[?1c[1;13HL[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"Xtestfile" 1L, 17C written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset undofile[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe![?25l[?1c"test72.in" 119L, 1780C[1;1H:w![1;4H[K[2;1H:bwipe![2;8H[K[3;1H:e Xtestfile[3;13H[K[4;1Hfoobar[4;7H[K[5;1H:set key=[5;10H[K[6;1H/bar[6;5H[K[7;1H:.w >>test.out[7;15H[K[8;1Hu:.w >>test.out[8;16H[K[9;1Hu:.w >>test.out[9;16H[K[10;1Hu:.w >>test.out[10;16H[K[11;1H:"[11;3H[K[12;1H:" Rename the undo file so that it gets cleaned up.[12;52H[K[13;1H:if has("vms")[13;15H[K[14;1H: call rename("_un_Xtestfile", "Xtestundo")[14;44H[K[15;1H:else[15;6H[K[16;1H: call rename(".Xtestfile.un~", "Xtestundo")[16;45H[K[17;1H:endif[17;7H[K[18;1H:qa![18;5H[K[19;1HENDTEST[19;8H[K[20;1H[K[21;1H1111 -----[21;11H[K[22;1H2222 -----[22;11H[K[23;1H[K[24;1H123456789[24;10H[K[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xtestfile[?25l[?1c"Xtestfile" 1L, 17C[1;1Hthis is ONE Line
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c" TODO: this beeps[?25l[?1c[1;1H[?25h[?0c[?5h[?5l[?25l[?1c[25;1HAlready at oldest change[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1L, 17C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test 'undofile', add 10 lines, delete 6 lines, undo 3[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset undofile[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[1;1H[K[25;1H--No lines in buffer--[1;1H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT --[0m[25;13H[K[25;1H[K[1;1Hone
two[2;4H[K[3;1Hthree[3;6H[K[4;1Hfour[4;5H[K[5;1Hfive[5;5H[K[6;1Hsix[6;4H[K[7;1Hseven[7;6H[K[8;1Height[8;6H[K[9;1Hnine[9;5H[K[10;1Hten[10;4H[K[10;3H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset ul=100[?25l[?1c[10;3H[?25h[?0c[3;1H[?25l[?1c[3;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [0m[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset ul=100[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[3;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [0m[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset ul=100[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[3;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [0m[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset ul=100[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[3;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [0m[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset ul=100[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[3;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [0m[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset ul=100[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[3;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [0m[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset ul=100[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"Xtestfile" 4L, 17C written[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe![?25l[?1c"test72.in" 119L, 1780C[1;1H:w!
:bwipe!
:e Xtestfile
foobar
:set key=[5;10H[K[6;1H/bar[6;5H[K[7;1H:.w >>test.out[7;15H[K[8;1Hu:.w >>test.out[8;16H[K[9;1Hu:.w >>test.out[9;16H[K[10;1Hu:.w >>test.out[10;16H[K[11;1H:"[11;3H[K[12;1H:" Rename the undo file so that it gets cleaned up.[12;52H[K[13;1H:if has("vms")[13;15H[K[14;1H: call rename("_un_Xtestfile", "Xtestundo")[14;44H[K[15;1H:else[15;6H[K[16;1H: call rename(".Xtestfile.un~", "Xtestundo")[16;45H[K[17;1H:endif[17;7H[K[18;1H:qa![18;5H[K[19;1HENDTEST[19;8H[K[20;1H[K[21;1H1111 -----[21;11H[K[22;1H2222 -----[22;11H[K[23;1H[K[24;1H123456789[24;10H[K[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xtestfile[?25l[?1c"Xtestfile" 4L, 17C[1;1Hone
two[2;4H[K[3;1Hnine[3;5H[K[4;1Hten[4;4H[K[5;1H[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H1 more line; before #7  0 seconds ago[3;24r[3;1H[L[1;25r[3;1Height[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H1 more line; before #6  0 seconds ago[3;24r[3;1H[L[1;25r[3;1Hseven[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H1 more line; before #5  0 seconds ago[3;24r[3;1H[L[1;25r[3;1Hsix[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H7L, 33C appended[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test that reading the undofiles when setting undofile works[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset noundofile ul=0[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT --[0m[25;13H[K[4;24r[4;1H[L[1;25r[3;1H[K[4;1Hsixu[?25h[?0cs[25;1H[K[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H1 line less; before #8  0 seconds ago[3;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [0m[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ce! Xtestfile[?25l[?1c"Xtestfile" [25;13H[K[25;13H4L, 17C[3;1Hnine
ten[4;4H[K[5;1H[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [3;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset undofile ul=100[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H1 more line; before #7  0 seconds ago[3;24r[3;1H[L[1;25r[3;1Height[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H1 more line; before #6  0 seconds ago[3;24r[3;1H[L[1;25r[3;1Hseven[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H1 more line; before #5  0 seconds ago[3;24r[3;1H[L[1;25r[3;1Hsix[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H1 more line; before #4  0 seconds ago[3;24r[3;1H[L[1;25r[3;1Hfive[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H1 more line; before #3  0 seconds ago[3;24r[3;1H[L[1;25r[3;1Hfour[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H1 more line; before #2  0 seconds ago[3;24r[3;1H[L[1;25r[3;1Hthree[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H10L, 49C appended[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" And now with encryption, cryptmethod=zip[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! Xtestfile[?25l[?1c"Xtestfile" [25;13H[K[25;13H4L, 17C[3;1Hnin[3;5H[K[4;1Hten[4;4H[K[5;1H[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [3;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset undofile cm=zip[?25l[?1c[3;1H[?25h[?0c[1;1H[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [0m[25;1H--No lines in buffer--[1;1H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT --[0m[25;13H[K[25;1H[K[1;1Hmonday
tuesday[2;8H[K[3;1Hwednesday[3;10H[K[4;1Hthursday[4;9H[K[5;1Hfriday[5;7H[K[5;6H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset ul=100[?25l[?1c[5;6H[?25h[?0c[4;6H[3;6H[2;6H[?25l[?1c[2;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [0m[25;1H[K[2;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset ul=100[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[2;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [0m[25;1H[K[2;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset ul=100[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[2;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [0m[25;1H[K[2;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset ul=100[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cX[?25l[?1c[25;1H[K[25;1HEnter encryption key: [?25h[?0c******
[?25l[?1cEnter same key again: [?25h[?0c******
[1;1H[2L[?25l[?1c[1;1Hmonday
friday[25;1H[K[2;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cw![?25l[?1c"Xtestfile" [crypted] 2L, 14C written[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe![?25l[?1c"test72.in" 119L, 1780C[1;1H:w![1;4H[K[2;1H:bwipe!
:e Xtestfile[3;13H[K[4;1Hfoobar[4;7H[K[5;1H:set key=[5;10H[K[6;1H/bar[6;5H[K[7;1H:.w >>test.out[7;15H[K[8;1Hu:.w >>test.out[8;16H[K[9;1Hu:.w >>test.out[9;16H[K[10;1Hu:.w >>test.out[10;16H[K[11;1H:"[11;3H[K[12;1H:" Rename the undo file so that it gets cleaned up.[12;52H[K[13;1H:if has("vms")[13;15H[K[14;1H: call rename("_un_Xtestfile", "Xtestundo")[14;44H[K[15;1H:else[15;6H[K[16;1H: call rename(".Xtestfile.un~", "Xtestundo")[16;45H[K[17;1H:endif[17;7H[K[18;1H:qa![18;5H[K[19;1HENDTEST[19;8H[K[20;1H[K[21;1H1111 -----[21;11H[K[22;1H2222 -----[22;11H[K[23;1H[K[24;1H123456789[24;10H[K[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xtestfile[?25l[?1c"Xtestfile" Need encryption key for "Xtestfile"
Enter encryption key: [?25h[?0c******
[?25l[?1c"Xtestfile" [crypted] 2L, 14C[1;1H[2L[1;1Hmonday
friday
[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [0m[25;1H[K[25;1H"Xtestfile" [crypted] 2L, 14C[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset key=[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H1 more line; before #11  0 seconds ago[2;24r[2;1H[L[1;25r[2;1Hthursday[25;1H[K[2;1H[?25h[?0c[?25l[?1c[25;1H1 more line; before #10  0 seconds ago[2;24r[2;1H[L[1;25r[2;1Hwednesday[25;1H[K[2;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cw >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H4L, 33C appended[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" With encryption, cryptmethod=blowfish[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! Xtestfile[?25l[?1c"Xtestfile" [25;13H[K[25;1HNeed encryption key for "Xtestfile"
Enter encryption key: [?25h[?0c*************************
[?25l[?1c"Xtestfile" [noeol][crypted] 1L, 14C[1;1H[2L[1;1H;[1m[34m~H[0m6[1m[34m^][0mQ[1m[34m^C[0m4[1m[34m~][0m[1m[34m~E[0m
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [0m[25;1H[K[25;1H"Xtestfile" [noeol][crypted] 1L, 14C[1;1H[?25h[?0c[?25l[?1c[1;1H[K[25;1H--No lines in buffer--[25;23H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT --[0m[25;13H[K[25;1H[K[1;1Hjan
feb[2;4H[K[3;1Hmar[3;4H[K[4;1Hapr[4;4H[K[5;1Hjun[5;4H[K[5;3H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset ul=100[?25l[?1c[5;3H[?25h[?0c[4;3H[3;3H[?25l[?1c[25;1H[1m-- INSERT --[0m[25;1H[K[3;1Hfoo mar[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset ul=100[?25l[?1c[3;4H[?25h[?0c[?25l[?1c[3;24r[24;1H
[1;25r[24;1H[1m[34m~                                                                               [0m[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset ul=100[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[1m-- INSERT --[0m[25;1H[K[3;1Hbar apr[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset ul=100[?25l[?1c[3;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cX[?25l[?1c[25;1H[K[25;1HEnter encryption key: [?25h[?0c******
[?25l[?1cEnter same key again: [?25h[?0c******
[1;1H[2L[?25l[?1c[1;1Hjan
feb[25;1H[K[3;4H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cw![?25l[?1c"Xtestfile" [crypted] 4L, 20C written[3;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipe![?25l[?1c"test72.in" 119L, 1780C[1;1H:w!
:bwipe!
:e Xtestfile
foobar
:set key=[5;10H[K[6;1H/bar[6;5H[K[7;1H:.w >>test.out[7;15H[K[8;1Hu:.w >>test.out[8;16H[K[9;1Hu:.w >>test.out[9;16H[K[10;1Hu:.w >>test.out[10;16H[K[11;1H:"[11;3H[K[12;1H:" Rename the undo file so that it gets cleaned up.[12;52H[K[13;1H:if has("vms")[13;15H[K[14;1H: call rename("_un_Xtestfile", "Xtestundo")[14;44H[K[15;1H:else[15;6H[K[16;1H: call rename(".Xtestfile.un~", "Xtestundo")[16;45H[K[17;1H:endif[17;7H[K[18;1H:qa![18;5H[K[19;1HENDTEST[19;8H[K[20;1H[K[21;1H1111 -----[21;11H[K[22;1H2222 -----[22;11H[K[23;1H[K[24;1H123456789[24;10H[K[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce Xtestfile[?25l[?1c"Xtestfile" Need encryption key for "Xtestfile"
Enter encryption key: [?25h[?0c******
[?25l[?1c"Xtestfile" [crypted] 4L, 20C[1;1H[2L[1;1Hjan
feb
bar apr[3;8H[K[4;1Hjun[4;4H[K[5;1H[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [0m[25;1H[K[25;1H"Xtestfile" [crypted] 4L, 20C[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset key=[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cbar[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1L, 8C appended[3;1H[?25h[?0c[?25l[?1c[25;1H1 change; before #15  0 seconds ago[3;1Hap[3;5H[K[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1L, 4C appended[3;1H[?25h[?0c[?25l[?1c[25;1H1 more line; before #14  0 seconds ago[3;24r[3;1H[L[1;25r[3;1Hfoo mar[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1L, 8C appended[3;1H[?25h[?0c[?25l[?1c[25;1H1 change; before #13  0 seconds ago[3;1Hmar[3;5H[K[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w >>test.out[?25l[?1c"test.out" [25;12H[K[25;12H1L, 4C appended[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Rename the undo file so that it gets cleaned up.[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif has("vms")[?25l[?1c
:  [?25h[?0c: call rename("_un_Xtestfile", "Xtestundo")
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c: call rename(".Xtestfile.un~", "Xtestundo")
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[1;1Hjan
feb
mar
apr[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test73.failed test.ok test.out X* viminfo
cp test73.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test73.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test73.in" 176 lines, 3863 characters[1;1HTests for find completion.

STARTTEST
:so small.vim
:" Do all test in a separate window to avoid E211 when we recursively
:" delete the Xfind directory during cleanup
:"
:" This will cause a few errors, do it silently.
:set visualbell
:set nocp viminfo+=nviminfo
:"
:function! DeleteDirectory(dir)
: if has("win16") || has("win32") || has("win64") || has("dos16") || has("dos32"[14;1H)
:  exec "silent !rmdir /Q /S " . a:dir
: else
:  exec "silent !rm -rf " . a:dir
: endif
:endfun
:" On windows a stale "Xfind" directory may exist, remove it so that
:" we start from a clean state.
:call DeleteDirectory("Xfind")
:new
:let cwd=getcwd()[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for find completion.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 171 lines, 3816 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:" Test for relative to current buffer 'path' item
:exec "cd " . cwd . "/Xfind/"
:set path=./path
:" Open the file where Jimmy Hoffa is found
:e in/file.txt
:" Find the file containing 'E.T.' in the Xfind/in/path directory
:find file
:exec "w >>" . test_out
:"
:" Test that completion works when path=.,,
:"
:set path=.,,
:" Open Jimmy Hoffa file
:e in/file.txt
:exec "w >>" . test_out
:" Search for the file containing Holy Grail in same directory as in/path.txt
:find stu
:exec "w >>" . test_out
:q
:exec "cd " . cwd
:call DeleteDirectory("Xfind")
:qa!
ENDTEST[?25h[?0c
[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Do all test in a separate window to avoid E211 when we recursively[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" delete the Xfind directory during cleanup[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" This will cause a few errors, do it silently.[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset visualbell[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nocp viminfo+=nviminfo[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunction! DeleteDirectory(dir)[?25l[?1c
:  [?25h[?0c: if has("win16") || has("win32") || has("win64") || has("dos16") || has("do
[24;80Hs[25;1H32")
[?25l[?1c:    [?25h[?0c:  exec "silent !rmdir /Q /S " . a:dir
[?25l[?1c:    [?25h[?0c: else
[?25l[?1c:    [?25h[?0c:  exec "silent !rm -rf " . a:dir
[?25l[?1c:    [?25h[?0c: endif
[?25l[?1c:  [?25h[?0c:endfun[1;1H[7L[?25l[?1c[1;1H:" Test for relative to current buffer 'path' item
:exec "cd " . cwd . "/Xfind/"
:set path=./path
:" Open the file where Jimmy Hoffa is found
:e in/file.txt
:" Find the file containing 'E.T.' in the Xfind/in/path directory
:find file[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c" On windows a stale "Xfind" directory may exist, remove it so that[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" we start from a clean state.[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall DeleteDirectory("Xfind")[?25l[?1c[?25h[?0c[25;1H[24;1H[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnew[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7m[No Name]                                                                       [0m[13;2He in/file.txt[13;15H[K[14;3Hxec "w >>" . test_out
:" Search for the file containing Holy Grail in same directory as in/path.txt
:find stu       [16;17H[K[17;2Hexec "w >>" . test_out
:q[18;3H[K[19;2Hexec "cd " . cwd
:call DeleteDirectory("Xfind")
:qa![21;5H[K[22;1HENDTEST[23;1H[K[24;1H[7mtest73.in                                                                       [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet cwd=getcwd()[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet test_out = cwd . '/test.out'[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall mkdir('Xfind')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccd Xfind[?25l[?1c/sources/vim74/src/testdir/Xfind[24;1H[7m/sources/vim74/src/testdir/test73.in[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset path=[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind ...[?25l[?1c[25;7H[K[25;7H[?5h[?5l[?25h[?0c[?25l[?1c[1m[37m[41mE345: Can't find file "" in path[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w! " . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" [New] 0L, 0C written[12;1H[1m[7m/sources/vim74/src/testdir/test.out[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cclose[?25l[?1c[1;1H:" Test for relative to current buffer 'path' item
:exec "cd " . cwd . "/Xfind/"[2;30H[K[3;1H:set path=./path[3;17H[K[4;1H:" Open the file where Jimmy Hoffa is found[4;44H[K[5;1H:e in/file.txt[5;15H[K[6;1H:" Find the file containing 'E.T.' in the Xfind/in/path directory[6;66H[K[7;1H:find file      [7;17H[K[8;1H:exec "w >>" . test_out[8;24H[K[9;1H:"[9;3H[K[10;1H:" Test that completion works when path=.,,[10;44H[K[11;1H:"[11;3H[K[12;1H:set path=.,,[12;14H[K[13;2H" Open Jimmy Hoffa file
:e in/file.txt[14;16H[K[15;2Hexec "w >>" . test_out[15;24H[K[16;2H" Search for the file containing Holy Grail in same directory as in/path.txt
:find stu       [17;17H[K[18;2Hexec "w >>" . test_out
:q[19;3H[K[20;2Hexec "cd " . cwd[20;18H[K[21;2Hcall DeleteDirectory("Xfind")
:qa![22;5H[K[23;1HENDTEST[24;1H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnew[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7m[No Name]                                                                       [0m[13;2He in/file.txt[13;15H[K[14;3Hxec "w >>" . test_out
:" Search for the file containing Holy Grail in same directory as in/path.txt
:find stu       [16;17H[K[17;2Hexec "w >>" . test_out
:q[18;3H[K[19;2Hexec "cd " . cwd
:call DeleteDirectory("Xfind")
:qa![21;5H[K[22;1HENDTEST[23;1H[K[24;1H[7m/sources/vim74/src/testdir/test73.in                                            [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset path=.[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind ...[?25l[?1c[25;7H[K[25;7H[?5h[?5l[?25h[?0c[?25l[?1c[1m[37m[41mE32: No file name[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >>" . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 0L, 0C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cclose[?25l[?1c[1;1H:" Test for relative to current buffer 'path' item
:exec "cd " . cwd . "/Xfind/"[2;30H[K[3;1H:set path=./path[3;17H[K[4;1H:" Open the file where Jimmy Hoffa is found[4;44H[K[5;1H:e in/file.txt[5;15H[K[6;1H:" Find the file containing 'E.T.' in the Xfind/in/path directory[6;66H[K[7;1H:find file      [7;17H[K[8;1H:exec "w >>" . test_out[8;24H[K[9;1H:"[9;3H[K[10;1H:" Test that completion works when path=.,,[10;44H[K[11;1H:"[11;3H[K[12;1H:set path=.,,[12;14H[K[13;2H" Open Jimmy Hoffa file
:e in/file.txt[14;16H[K[15;2Hexec "w >>" . test_out[15;24H[K[16;2H" Search for the file containing Holy Grail in same directory as in/path.txt
:find stu       [17;17H[K[18;2Hexec "w >>" . test_out
:q[19;3H[K[20;2Hexec "cd " . cwd[20;18H[K[21;2Hcall DeleteDirectory("Xfind")
:qa![22;5H[K[23;1HENDTEST[24;1H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnew[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7m[No Name]                                                                       [0m[13;2He in/file.txt[13;15H[K[14;3Hxec "w >>" . test_out
:" Search for the file containing Holy Grail in same directory as in/path.txt
:find stu       [16;17H[K[17;2Hexec "w >>" . test_out
:q[18;3H[K[19;2Hexec "cd " . cwd
:call DeleteDirectory("Xfind")
:qa![21;5H[K[22;1HENDTEST[23;1H[K[24;1H[7m/sources/vim74/src/testdir/test73.in                                            [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset path=.,,[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind ...[?25l[?1c[25;7H[K[25;7H[?5h[?5l[?25h[?0c[?25l[?1c[1m[37m[41mE32: No file name[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >>" . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 0L, 0C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cclose[?25l[?1c[1;1H:" Test for relative to current buffer 'path' item
:exec "cd " . cwd . "/Xfind/"[2;30H[K[3;1H:set path=./path[3;17H[K[4;1H:" Open the file where Jimmy Hoffa is found[4;44H[K[5;1H:e in/file.txt[5;15H[K[6;1H:" Find the file containing 'E.T.' in the Xfind/in/path directory[6;66H[K[7;1H:find file      [7;17H[K[8;1H:exec "w >>" . test_out[8;24H[K[9;1H:"[9;3H[K[10;1H:" Test that completion works when path=.,,[10;44H[K[11;1H:"[11;3H[K[12;1H:set path=.,,[12;14H[K[13;2H" Open Jimmy Hoffa file
:e in/file.txt[14;16H[K[15;2Hexec "w >>" . test_out[15;24H[K[16;2H" Search for the file containing Holy Grail in same directory as in/path.txt
:find stu       [17;17H[K[18;2Hexec "w >>" . test_out
:q[19;3H[K[20;2Hexec "cd " . cwd[20;18H[K[21;2Hcall DeleteDirectory("Xfind")
:qa![22;5H[K[23;1HENDTEST[24;1H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnew[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7m[No Name]                                                                       [0m[13;2He in/file.txt[13;15H[K[14;3Hxec "w >>" . test_out
:" Search for the file containing Holy Grail in same directory as in/path.txt
:find stu       [16;17H[K[17;2Hexec "w >>" . test_out
:q[18;3H[K[19;2Hexec "cd " . cwd
:call DeleteDirectory("Xfind")
:qa![21;5H[K[22;1HENDTEST[23;1H[K[24;1H[7m/sources/vim74/src/testdir/test73.in                                            [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset path=./**[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind ...[?25l[?1c[25;7H[K[25;7H[?5h[?5l[?25h[?0c[?25l[?1c[1m[37m[41mE32: No file name[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >>" . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 0L, 0C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cclose[?25l[?1c[1;1H:" Test for relative to current buffer 'path' item
:exec "cd " . cwd . "/Xfind/"[2;30H[K[3;1H:set path=./path[3;17H[K[4;1H:" Open the file where Jimmy Hoffa is found[4;44H[K[5;1H:e in/file.txt[5;15H[K[6;1H:" Find the file containing 'E.T.' in the Xfind/in/path directory[6;66H[K[7;1H:find file      [7;17H[K[8;1H:exec "w >>" . test_out[8;24H[K[9;1H:"[9;3H[K[10;1H:" Test that completion works when path=.,,[10;44H[K[11;1H:"[11;3H[K[12;1H:set path=.,,[12;14H[K[13;2H" Open Jimmy Hoffa file
:e in/file.txt[14;16H[K[15;2Hexec "w >>" . test_out[15;24H[K[16;2H" Search for the file containing Holy Grail in same directory as in/path.txt
:find stu       [17;17H[K[18;2Hexec "w >>" . test_out
:q[19;3H[K[20;2Hexec "cd " . cwd[20;18H[K[21;2Hcall DeleteDirectory("Xfind")
:qa![22;5H[K[23;1HENDTEST[24;1H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnew[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7m[No Name]                                                                       [0m[13;2He in/file.txt[13;15H[K[14;3Hxec "w >>" . test_out
:" Search for the file containing Holy Grail in same directory as in/path.txt
:find stu       [16;17H[K[17;2Hexec "w >>" . test_out
:q[18;3H[K[19;2Hexec "cd " . cwd
:call DeleteDirectory("Xfind")
:qa![21;5H[K[22;1HENDTEST[23;1H[K[24;1H[7m/sources/vim74/src/testdir/test73.in                                            [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c" We shouldn't find any file at this point, test.out must be empty.[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall mkdir('in')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccd in[?25l[?1c/sources/vim74/src/testdir/Xfind/in[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall mkdir('path')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexec "cd " . cwd[?25l[?1c/sources/vim74/src/testdir[24;1H[7mtest73.in                           [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ce Xfind/file.txt[?25l[?1c"Xfind/file.txt" [New File][12;1H[1m[7mXfind/file.txt[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[1m-- INSERT --[0m[25;13H[K[25;1H[K[1;1HHoly Grail[12;16H[1m[7m[+][1;10H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0cw[?25l[?1c"Xfind/file.txt" [New] 1L, 11C written[12;16H[1m[7m   [1;10H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ce Xfind/in/file.txt[?25l[?1c"Xfind/in/file.txt" [New File][1;1H[K[12;7H[1m[7min/file.txt[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[1m-- INSERT --[0m[25;13H[K[25;1H[K[1;1HJimmy Hoffa[12;19H[1m[7m[+][1;11H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0cw[?25l[?1c"Xfind/in/file.txt" [New] 1L, 12C written[12;19H[1m[7m   [1;11H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ce Xfind/in/stuff.txt[?25l[?1c"Xfind/in/stuff.txt" [New File][1;1H[K[12;10H[1m[7mstuff.txt[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[1m-- INSERT --[0m[25;13H[K[25;1H[K[1;1HAnother Holy Grail[12;20H[1m[7m[+][1;18H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0cw[?25l[?1c"Xfind/in/stuff.txt" [New] 1L, 19C written[12;20H[1m[7m   [1;18H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ce Xfind/in/path/file.txt[?25l[?1c"Xfind/in/path/file.txt" [New File][1;1H[K[12;10H[1m[7mpath/file.txt[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[1m-- INSERT --[0m[25;13H[K[25;1H[K[1;1HE.T.[12;24H[1m[7m[+][1;4H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0cw[?25l[?1c"Xfind/in/path/file.txt" [New] 1L, 5C written[12;24H[1m[7m   [1;4H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset path=Xfind/**[?25l[?1c[1;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind file...[?25l[?1c[25;7H./Xfind/file.txt[?5h[?5l[?25h[?0c[?25l[?1c"Xfind/file.txt" [25;18H[K[25;18H1L, 11C[1;1HHoly Grail[12;7H[1m[7mfile.txt        [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >>" . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 1L, 11C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind file...[?25l[?1c[25;7H./Xfind/file.txt[?5h[?5l[?25h[?0c...[?25l[?1c[25;7Hin/file.txt[25;18H[K[25;18H[?25h[?0c[?25l[?1c"Xfind/in/file.txt" 1L, 12C[1;1HJimmy Hoffa[12;7H[1m[7min/file.txt[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >>" . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 1L, 12C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind file...[?25l[?1c[25;7H./Xfind/file.txt[?5h[?5l[?25h[?0c...[?25l[?1c[25;7Hin/file.txt[25;18H[K[25;18H[?25h[?0c...[?25l[?1c[25;7Hpath/file.txt[25;20H[K[25;20H[?25h[?0c[?25l[?1c"Xfind/in/path/file.txt" 1L, 5C[1;1HE.T.[1;5H[K[12;10H[1m[7mpath/file.txt[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >>" . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 1L, 5C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Rerun the previous three find completions, using fullpath in 'path'[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexec "set path=" . cwd . "/Xfind/**"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind file...[?25l[?1c[25;7H./Xfind/file.txt[?5h[?5l[?25h[?0c[?25l[?1c"Xfind/file.txt" [25;18H[K[25;18H1L, 11C[1;1HHoly Grail[12;7H[1m[7mfile.txt        [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >>" .  test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 1L, 11C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind file...[?25l[?1c[25;7H./Xfind/file.txt[?5h[?5l[?25h[?0c...[?25l[?1c[25;7Hin/file.txt[25;18H[K[25;18H[?25h[?0c[?25l[?1c"Xfind/in/file.txt" 1L, 12C[1;1HJimmy Hoffa[12;7H[1m[7min/file.txt[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >>" . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 1L, 12C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind file...[?25l[?1c[25;7H./Xfind/file.txt[?5h[?5l[?25h[?0c...[?25l[?1c[25;7Hin/file.txt[25;18H[K[25;18H[?25h[?0c...[?25l[?1c[25;7Hpath/file.txt[25;20H[K[25;20H[?25h[?0c[?25l[?1c"Xfind/in/path/file.txt" 1L, 5C[1;1HE.T.[1;5H[K[12;10H[1m[7mpath/file.txt[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >>" . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 1L, 5C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Same steps again, using relative and fullpath items that point to the same[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" recursive location.[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" This is to test that there are no duplicates in the completion list.[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexec "set path+=Xfind/**"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind file...[?25l[?1c[25;7H./Xfind/file.txt[?5h[?5l[?25h[?0c[?25l[?1c"Xfind/file.txt" [25;18H[K[25;18H1L, 11C[1;1HHoly Grail[12;7H[1m[7mfile.txt        [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >>" .  test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 1L, 11C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind file...[?25l[?1c[25;7H./Xfind/file.txt[?5h[?5l[?25h[?0c...[?25l[?1c[25;7Hin/file.txt[25;18H[K[25;18H[?25h[?0c[?25l[?1c"Xfind/in/file.txt" 1L, 12C[1;1HJimmy Hoffa[12;7H[1m[7min/file.txt[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >>" . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 1L, 12C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind file...[?25l[?1c[25;7H./Xfind/file.txt[?5h[?5l[?25h[?0c...[?25l[?1c[25;7Hin/file.txt[25;18H[K[25;18H[?25h[?0c...[?25l[?1c[25;7Hpath/file.txt[25;20H[K[25;20H[?25h[?0c[?25l[?1c"Xfind/in/path/file.txt" 1L, 5C[1;1HE.T.[1;5H[K[12;10H[1m[7mpath/file.txt[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >>" . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 1L, 5C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind file...[?25l[?1c[25;7H./Xfind/file.txt[?5h[?5l[?25h[?0c...[?25l[?1c[25;7Hin/file.txt[25;18H[K[25;18H[?25h[?0c[?25l[?1c"Xfind/in/file.txt" 1L, 12C[1;1HJimmy Hoffa[12;10H[1m[7mfile.txt     [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c" Test find completion for directory of current buffer, which at this point[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" is Xfind/in/file.txt.[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset path=.[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind st...[?25l[?1cuff.txt[?25h[?0c[?25l[?1c"Xfind/in/stuff.txt" 1L, 19C[1;1HAnother Holy Grail[12;10H[1m[7mstuff.txt[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >>" .  test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 1L, 19C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test find completion for empty path item ",," which is the current directory[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccd Xfind[?25l[?1c/sources/vim74/src/testdir/Xfind[12;1H[1m[7min/stuff.txt      [0m[24;1H[7m/sources/vim74/src/testdir/test73.in[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset path=,,[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind f...[?25l[?1cile.txt[?25h[?0c...[?25l[?1c[25;15H[K[25;15H[?25h[?0c[?25l[?1c"file.txt" [25;12H[K[25;12H1L, 11C[1;1HHoly Grail[1;11H[K[12;1H[1m[7mfile.txt    [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >>" . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 1L, 11C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test shortening of[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    foo/x/bar/voyager.txt[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    foo/y/bar/voyager.txt[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" When current directory is above foo/ they should be shortened to (in order[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" of appearance):[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    x/bar/voyager.txt[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    y/bar/voyager.txt[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall mkdir('foo')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccd foo[?25l[?1c/sources/vim74/src/testdir/Xfind/foo[12;1H[1m[7m/sources/vim74/src/testdir/Xfind/file.txt[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall mkdir('x')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall mkdir('y')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccd x[?25l[?1c/sources/vim74/src/testdir/Xfind/foo/x[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall mkdir('bar')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccd ..[?25l[?1c/sources/vim74/src/testdir/Xfind/foo[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccd y[?25l[?1c/sources/vim74/src/testdir/Xfind/foo/y[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall mkdir('bar')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccd ..[?25l[?1c/sources/vim74/src/testdir/Xfind/foo[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccd ..[?25l[?1c/sources/vim74/src/testdir/Xfind[12;1H[1m[7mfile.txt                                 [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c" We should now be in the Xfind directory[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce foo/x/bar/voyager.txt[?25l[?1c"foo/x/bar/voyager.txt" [New File][1;1H[K[12;2H[1m[7moo/x/bar/voyager.txt[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[1m-- INSERT --[0m[25;13H[K[25;1H[K[1;1HVoyager 1[12;23H[1m[7m[+][1;9H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0cw[?25l[?1c"foo/x/bar/voyager.txt" [New] 1L, 10C written[12;23H[1m[7m   [1;9H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ce foo/y/bar/voyager.txt[?25l[?1c"foo/y/bar/voyager.txt" [New File][1;1H[K[12;5H[1m[7my[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[1m-- INSERT --[0m[25;13H[K[25;1H[K[1;1HVoyager 2[12;23H[1m[7m[+][1;9H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0cw[?25l[?1c"foo/y/bar/voyager.txt" [New] 1L, 10C written[12;23H[1m[7m   [1;9H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "set path=" . cwd . "/Xfind/**"[?25l[?1c[1;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind voyager...[?25l[?1c[25;7Hx/bar/voyager.txt[?5h[?5l[?25h[?0c[?25l[?1c"foo/x/bar/voyager.txt" 1L, 10C[1;9H1[12;5H[1m[7mx[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >>" . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 1L, 10C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind voyager...[?25l[?1c[25;7Hx/bar/voyager.txt[?5h[?5l[?25h[?0c...[?25l[?1c[25;7Hy[25;24H[K[25;24H[?25h[?0c[?25l[?1c"foo/y/bar/voyager.txt" 1L, 10C[1;9H2[12;5H[1m[7my[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >>" . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 1L, 10C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" When current directory is .../foo/y/bar they should be shortened to (in[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" order of appearance):[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    ./voyager.txt[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    x/bar/voyager.txt[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccd foo[?25l[?1c/sources/vim74/src/testdir/Xfind/foo[12;1H[1m[7my/bar/voyager.txt    [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccd y[?25l[?1c/sources/vim74/src/testdir/Xfind/foo/y[12;1H[1m[7mbar/voyager.txt  [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccd bar[?25l[?1c/sources/vim74/src/testdir/Xfind/foo/y/bar[12;1H[1m[7mvoyager.txt    [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cfind voyager...[?25l[?1c[25;7H./voyager.txt[?5h[?5l[?25h[?0c[?25l[?1c"voyager.txt" [25;15H[K[25;15H1L, 10C[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexec "w >> " . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 1L, 10C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind voyager...[?25l[?1c[25;7H./voyager.txt[?5h[?5l[?25h[?0c...[?25l[?1c[25;7Hx/bar/voyager.txt[?25h[?0c[?25l[?1c"/sources/vim74/src/testdir/Xfind/foo/x/bar/voyager.txt" 1L, 10C[1;9H1[12;1H[1m[7m/sources/vim74/src/testdir/Xfind/foo/x/bar/voyager.txt[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >> " . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 1L, 10C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Check the opposite too:[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccd ..[?25l[?1c/sources/vim74/src/testdir/Xfind/foo/y[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccd ..[?25l[?1c/sources/vim74/src/testdir/Xfind/foo[12;1H[1m[7mx/bar/voyager.txt                                     [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccd x[?25l[?1c/sources/vim74/src/testdir/Xfind/foo/x[12;1H[1m[7mbar/voyager.txt  [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccd bar[?25l[?1c/sources/vim74/src/testdir/Xfind/foo/x/bar[12;1H[1m[7mvoyager.txt    [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cfind voyager...[?25l[?1c[25;7H./voyager.txt[?5h[?5l[?25h[?0c[?25l[?1c"voyager.txt" [25;15H[K[25;15H1L, 10C[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexec "w >> " . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 1L, 10C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind voyager...[?25l[?1c[25;7H./voyager.txt[?5h[?5l[?25h[?0c...[?25l[?1c[25;7Hy/bar/voyager.txt[?25h[?0c[?25l[?1c"/sources/vim74/src/testdir/Xfind/foo/y/bar/voyager.txt" 1L, 10C[1;9H2[12;1H[1m[7m/sources/vim74/src/testdir/Xfind/foo/y/bar/voyager.txt[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >> " . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 1L, 10C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Check for correct handling of shorten_fname()'s behavior on windows[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexec "cd " . cwd . "/Xfind/in"[?25l[?1c/sources/vim74/src/testdir/Xfind/in[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind file...[?25l[?1c[25;7H./file.txt[?5h[?5l[?25h[?0c[?25l[?1c"file.txt" [25;12H[K[25;12H1L, 12C[1;1HJimmy Hoffa[12;1H[1m[7mfile.txt                                              [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >>" . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 1L, 12C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test for relative to current buffer 'path' item[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexec "cd " . cwd . "/Xfind/"[?25l[?1c/sources/vim74/src/testdir/Xfind[12;1H[1m[7min/file.txt[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset path=./path[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Open the file where Jimmy Hoffa is found[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce in/file.txt[?25l[?1c"in/file.txt" 1L, 12C[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Find the file containing 'E.T.' in the Xfind/in/path directory[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind file...[?25l[?1ctxt[?25h[?0c[?25l[?1c"in/path/file.txt" 1L, 5C[1;1HE.T.[1;5H[K[12;4H[1m[7mpath/file.txt[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >>" . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 1L, 5C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test that completion works when path=.,,[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset path=.,,[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Open Jimmy Hoffa file[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce in/file.txt[?25l[?1c"in/file.txt" 1L, 12C[1;1HJimmy Hoffa[12;4H[1m[7mfile.txt     [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >>" . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 1L, 12C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Search for the file containing Holy Grail in same directory as in/path.txt[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfind stu...[?25l[?1cff.txt[?25h[?0c[?25l[?1c"in/stuff.txt" 1L, 19C[1;1HAnother Holy Grail[12;4H[1m[7mstuff.txt[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cexec "w >>" . test_out[?25l[?1c"/sources/vim74/src/testdir/test.out" 1L, 19C appended[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cq[?25l[?1c[1;1H:" Test for relative to current buffer 'path' item
:exec "cd " . cwd . "/Xfind/"[2;30H[K[3;1H:set path=./path[3;17H[K[4;1H:" Open the file where Jimmy Hoffa is found[4;44H[K[5;1H:e in/file.txt[5;15H[K[6;1H:" Find the file containing 'E.T.' in the Xfind/in/path directory[6;66H[K[7;1H:find file      [7;17H[K[8;1H:exec "w >>" . test_out[8;24H[K[9;1H:"[9;3H[K[10;1H:" Test that completion works when path=.,,[10;44H[K[11;1H:"[11;3H[K[12;1H:set path=.,,[12;14H[K[13;2H" Open Jimmy Hoffa file
:e in/file.txt[14;16H[K[15;2Hexec "w >>" . test_out[15;24H[K[16;2H" Search for the file containing Holy Grail in same directory as in/path.txt
:find stu       [17;17H[K[18;2Hexec "w >>" . test_out
:q[19;3H[K[20;2Hexec "cd " . cwd[20;18H[K[21;2Hcall DeleteDirectory("Xfind")
:qa![22;5H[K[23;1HENDTEST[24;1H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexec "cd " . cwd[?25l[?1c/sources/vim74/src/testdir[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall DeleteDirectory("Xfind")[?25l[?1c[?25h[?0c[25;1H[24;1H[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test74.failed test.ok test.out X* viminfo
cp test74.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test74.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test74.in" 36 lines, 822 characters[1;1H" Tests for storing global variables in the .viminfo file vim: set ft=vim:

STARTTEST
:so small.vim
:" Do all test in a separate window to avoid E211 when we recursively
:" delete the Xfind directory during cleanup
:"
:" This will cause a few errors, do it silently.
:set visualbell
:set nocp viminfo+=!,nviminfo
:let MY_GLOBAL_DICT={'foo': 1, 'bar': 0, 'longvarible': 1000}
:" store a really long list, so line wrapping will occur in viminfo file
:let MY_GLOBAL_LIST=range(1,100)
:wv! Xviminfo
:unlet MY_GLOBAL_DICT
:unlet MY_GLOBAL_LIST
:rv! Xviminfo
:call delete('Xviminfo')
:if exists("MY_GLOBAL_DICT")
:redir >> test.out
:echo MY_GLOBAL_DICT
:redir end
:endif
:if exists("MY_GLOBAL_LIST")[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1H" Tests for storing global variables in the .viminfo file vim: set ft=vim:[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 30 lines, 723 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[10M[1;25r[15;1H:redir >> test.out
:echo MY_GLOBAL_LIST
:redir end
:endif
:redir >> test.out
:echo "foobar"
:redir end
:endif
:qa!
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Do all test in a separate window to avoid E211 when we recursively[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" delete the Xfind directory during cleanup[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" This will cause a few errors, do it silently.[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset visualbell[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nocp viminfo+=!,nviminfo[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet MY_GLOBAL_DICT={'foo': 1, 'bar': 0, 'longvarible': 1000}[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" store a really long list, so line wrapping will occur in viminfo file[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet MY_GLOBAL_LIST=range(1,100)[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwv! Xviminfo[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet MY_GLOBAL_DICT[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cunlet MY_GLOBAL_LIST[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0crv! Xviminfo[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall delete('Xviminfo')[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif exists("MY_GLOBAL_DICT")[?25l[?1c
:  [?25h[?0c:redir >> test.out
[?25l[?1c:  [?25h[?0c:echo MY_GLOBAL_DICT
[?25l[?1c{'foo': 1, 'longvarible': 1000, 'bar': 0}
:  [?25h[?0c:redir end
[?25l[?1c:  [?25h[?0c:endif[1;1H[5L[?25l[?1c[1;1H:" store a really long list, so line wrapping will occur in viminfo file
:let MY_GLOBAL_LIST=range(1,100)
:wv! Xviminfo
:unlet MY_GLOBAL_DICT
:unlet MY_GLOBAL_LIST[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cif exists("MY_GLOBAL_LIST")[?25l[?1c
:  [?25h[?0c:redir >> test.out
[?25l[?1c:  [?25h[?0c:echo MY_GLOBAL_LIST
[?25l[?1c[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42,
43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62,
63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82,
83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100]
:  [?25h[?0c:redir end
[?25l[?1c:  [?25h[?0c:endif[1;1H[9L[?25l[?1c[1;1H:" store a really long list, so line wrapping will occur in viminfo file
:let MY_GLOBAL_LIST=range(1,100)
:wv! Xviminfo
:unlet MY_GLOBAL_DICT
:unlet MY_GLOBAL_LIST
:rv! Xviminfo
:call delete('Xviminfo')
:if exists("MY_GLOBAL_DICT")
:redir >> test.out[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0credir >> test.out[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cecho "foobar"[?25l[?1cfoobar[25;7H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir end[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cendif[?25l[?1c[1m[37m[41mE580: :endif without :if[24;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test75.failed test.ok test.out X* viminfo
cp test75.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test75.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test75.in" 41 lines, 1000 characters[1;1HTests for maparg().
Also test utf8 map with a 0x80 byte.

STARTTEST
:so small.vim
:so mbyte.vim
:set cpo-=<
:set encoding=utf8
:" Test maparg() with a string result
:map foo<C-V> is<F4>foo
:vnoremap <script> <buffer> <expr> <silent> bar isbar
:call append('$', maparg('foo<C-V>'))
:call append('$', string(maparg('foo<C-V>', '', 0, 1)))
:call append('$', string(maparg('bar', '', 0, 1)))
:map <buffer> <nowait> foo bar
:call append('$', string(maparg('foo', '', 0, 1)))
:"
:map abc x<char-114>x
:call append('$', maparg('abc'))
:map abc y<S-char-114>y
:call append('$', maparg('abc'))
:"
Go[1m[34m^[[0m:"
:" Outside of the range, minimum[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for maparg().[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[4;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 34 lines, 919 characters written[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[15M[1;25r[10;1H:inoremap <Char-0x1040> a
:call feedkeys("a\u1040\<Esc>")
:" Inside of the range, minimum
:inoremap <Char-0x103f> b
:call feedkeys("a\u103f\<Esc>")
:" Inside of the range, maximum
:inoremap <Char-0xf03f> c
:call feedkeys("a\uf03f\<Esc>")
:" Outside of the range, maximum
:inoremap <Char-0xf040> d
:call feedkeys("a\uf040\<Esc>")
:"
:/^eof/+1,$w! test.out
:qa!
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso mbyte.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpo-=<[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset encoding=utf8[?25l[?1c[27m[24m[0m[H[J[1;1H:"
:map abc x<char-114>x
:call append('$', maparg('abc'))
:map abc y<S-char-114>y
:call append('$', maparg('abc'))
:"
Go[1m[34m^[[0m:"
:" Outside of the range, minimum
:inoremap <Char-0x1040> a
:call feedkeys("a\u1040\<Esc>")
:" Inside of the range, minimum
:inoremap <Char-0x103f> b
:call feedkeys("a\u103f\<Esc>")
:" Inside of the range, maximum
:inoremap <Char-0xf03f> c
:call feedkeys("a\uf03f\<Esc>")
:" Outside of the range, maximum
:inoremap <Char-0xf040> d
:call feedkeys("a\uf040\<Esc>")
:"
:/^eof/+1,$w! test.out
:qa!
ENDTEST
[?25h[?0c[?25l[?1c
:[?25h[?0c" Test maparg() with a string result[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap foo<C-V> is<F4>foo[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cvnoremap <script> <buffer> <expr> <silent> bar isbar[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append('$', maparg('foo<C-V>'))[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append('$', string(maparg('foo<C-V>', '', 0, 1)))[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append('$', string(maparg('bar', '', 0, 1)))[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap <buffer> <nowait> foo bar[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append('$', string(maparg('foo', '', 0, 1)))[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap abc x<char-114>x[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append('$', maparg('abc'))[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap abc y<S-char-114>y[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append('$', maparg('abc'))[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[10M[1;25r[15;1Heof
is<F4>foo
{'silent': 0, 'noremap': 0, 'lhs': 'foo<C-V>', 'mode': ' ', 'nowait': 0, 'expr':[18;2H0, 'sid': 0, 'rhs': 'is<F4>foo', 'buffer': 0}
{'silent': 1, 'noremap': 1, 'lhs': 'bar', 'mode': 'v', 'nowait': 0, 'expr': 1, '[20;1Hsid': 0, 'rhs': 'isbar', 'buffer': 1}
{'silent': 0, 'noremap': 0, 'lhs': 'foo', 'mode': ' ', 'nowait': 1, 'expr': 0, '[22;1Hsid': 0, 'rhs': 'bar', 'buffer': 1}
xrx
yRy[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Outside of the range, minimum[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cinoremap <Char-0x1040> a[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall feedkeys("a\u1040\<Esc>")[?25l[?1c[24;1H[?25h[?0c[?25l[?1ca[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Inside of the range, minimum[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cinoremap <Char-0x103f> b[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall feedkeys("a\u103f\<Esc>")[?25l[?1c[24;1H[?25h[?0c[?25l[?1cab[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Inside of the range, maximum[?25l[?1c[24;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cinoremap <Char-0xf03f> c[?25l[?1c[24;2H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall feedkeys("a\uf03f\<Esc>")[?25l[?1c[24;2H[?25h[?0c[?25l[?1cbc[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Outside of the range, maximum[?25l[?1c[24;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cinoremap <Char-0xf040> d[?25l[?1c[24;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall feedkeys("a\uf040\<Esc>")[?25l[?1c[24;3H[?25h[?0c[?25l[?1ccd[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^eof/+1,$w! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 7 lines, 384 characters written[24;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test76.failed test.ok test.out X* viminfo
cp test76.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test76.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test76.in" 46 lines, 899 characters[1;1HTests for completefunc/omnifunc. vim: set ft=vim :

STARTTEST
:"Test that nothing happens if the 'completefunc' opens
:"a new window (no completion, no crash)
:so small.vim
:function! DummyCompleteOne(findstart, base)
:  if a:findstart
:    return 0
:  else
:    wincmd n
:    return ['onedef', 'oneDEF']
:  endif
:endfunction
:setlocal completefunc=DummyCompleteOne
/^one
A[1m[34m^X^U^N^[[0m:q!
:function! DummyCompleteTwo(findstart, base)
:  if a:findstart
:    wincmd n
:    return 0
:  else
:    return ['twodef', 'twoDEF']
:  endif[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for completefunc/omnifunc. vim: set ft=vim :[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 37 lines, 810 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[17M[1;25r[8;1H:endfunction
:setlocal completefunc=DummyCompleteTwo
/^two
A[1m[34m^X^U^N^[[0m:q!
:"Test that 'completefunc' works when it's OK.
:function! DummyCompleteThree(findstart, base)
:  if a:findstart
:    return 0
:  else
:    return ['threedef', 'threeDEF']
:  endif
:endfunction
:setlocal completefunc=DummyCompleteThree
/^three
A[1m[34m^X^U^N^[[0m:/^+++/,/^three/w! test.out
:qa!
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"Test that nothing happens if the 'completefunc' opens[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"a new window (no completion, no crash)[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunction! DummyCompleteOne(findstart, base)[?25l[?1c
:  [?25h[?0c:  if a:findstart
[?25l[?1c:    [?25h[?0c:    return 0
[?25l[?1c:    [?25h[?0c:  else
[?25l[?1c:    [?25h[?0c:    wincmd n
[?25l[?1c:    [?25h[?0c:    return ['onedef', 'oneDEF']
[?25l[?1c:    [?25h[?0c:  endif
[?25l[?1c:  [?25h[?0c:endfunction[1;1H[7L[?25l[?1c[1;1H:  if a:findstart
:    wincmd n
:    return 0
:  else
:    return ['twodef', 'twoDEF']
:  endif
:endfunction[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0csetlocal completefunc=DummyCompleteOne[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^one[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1H+++
one[25;1H[K[24;1H[?25h[?0c[?25l[?1c
[1m[37m[41mE839: Completion function changed window[0m
[1m[37m[41mPattern not found[0m
[1m[32mPress ENTER or type command to continue[?25h[?0c[1;4H[?25l[?1c[0m[25;1H[K[25;1H[1m[32mPress ENTER or type command to continue[?25h[?0c[1;4H[0m[24;1H[K[25;1H[K[1;1H[2L[?25l[?1c[1;1Hone
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7m[No Name] [+]                                                                   [0m[13;4H  return ['threedef', 'threeDEF']
:  endif[14;9H[K[15;2Hendfunction
:setlocal completefunc=DummyCompleteThree
/^three[17;8H[K[18;1HA[1m[34m^X^U^N^[[0m:/^+++/,/^three/w! test.out
:qa![19;5H[K[20;1HENDTEST[21;1H[K[22;1H+++[23;1H[K[24;1H[7mtest76.in [+]                                                                   [0m[25;1H[K[1;3H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cq![?25l[?1c[1;1H:    return 0
:  else[2;8H[K[3;1H:    return ['twodef', 'twoDEF'][3;33H[K[4;1H:  endif[4;9H[K[5;1H:endfunction[5;13H[K[6;1H:setlocal completefunc=DummyCompleteTwo[6;40H[K[7;1H/^two[7;6H[K[8;1HA[1m[34m^X^U^N^[[0m:q![8;13H[K[9;1H:"Test that 'completefunc' works when it's OK.[9;47H[K[10;1H:function! DummyCompleteThree(findstart, base)[10;47H[K[11;1H:  if a:findstart[11;18H[K[12;1H:    return 0[12;14H[K[13;4Hels[13;8H[K[14;4H  return ['threedef', 'threeDEF']
:  endif[15;9H[K[16;2Hendfunction[16;13H[K[17;1H:setlocal completefunc=DummyCompleteThree
/^three[18;8H[K[19;1HA[1m[34m^X^U^N^[[0m:/^+++/,/^three/w! test.out
:qa![20;5H[K[21;1HENDTEST[22;1H[K[23;1H+++[24;1H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunction! DummyCompleteTwo(findstart, base)[?25l[?1c
:  [?25h[?0c:  if a:findstart
[?25l[?1c:    [?25h[?0c:    wincmd n
[?25l[?1c:    [?25h[?0c:    return 0
[?25l[?1c:    [?25h[?0c:  else
[?25l[?1c:    [?25h[?0c:    return ['twodef', 'twoDEF']
[?25l[?1c:    [?25h[?0c:  endif
[?25l[?1c:  [?25h[?0c:endfunction[1;1H[7L[?25l[?1c[1;1H:    return 0
:  else
:    return ['twodef', 'twoDEF']
:  endif
:endfunction
:setlocal completefunc=DummyCompleteTwo
/^two[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0csetlocal completefunc=DummyCompleteTwo[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^two[?25l[?1c[1;24r[24;1H
[1;25r[24;1Htwo[25;1H[K[24;1H[?25h[?0c[?25l[?1c
[1m[37m[41mE839: Completion function changed window[0m
[1m[37m[41mE764: Option 'completefunc' is not set[0m
[1m[32mPress ENTER or type command to continue[?25h[?0c[0m[24;1H[K[25;1H[K[1;1H[2L[?25l[?1c[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7m[No Name]                                                                       [0m[13;4Hendif[13;9H[K[14;2Hendfunction
:setlocal completefunc=DummyCompleteThree
/^three[16;8H[K[17;1HA[1m[34m^X^U^N^[[0m:/^+++/,/^three/w! test.out
:qa![18;5H[K[19;1HENDTEST[20;1H[K[21;1H+++[22;1H[K[23;1Htwo
[7mtest76.in [+]                                                                   [0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cq![?25l[?1c[1;1H:  else
:    return ['twodef', 'twoDEF'][2;33H[K[3;1H:  endif[3;9H[K[4;1H:endfunction[4;13H[K[5;1H:setlocal completefunc=DummyCompleteTwo[5;40H[K[6;1H/^two[6;6H[K[7;1HA[1m[34m^X^U^N^[[0m:q![7;13H[K[8;1H:"Test that 'completefunc' works when it's OK.[8;47H[K[9;1H:function! DummyCompleteThree(findstart, base)[9;47H[K[10;1H:  if a:findstart[10;18H[K[11;1H:    return 0[11;14H[K[12;1H:  else[12;8H[K[13;4H  return ['threedef', 'threeDEF']
:  endif[14;9H[K[15;2Hendfunction[15;13H[K[16;1H:setlocal completefunc=DummyCompleteThree
/^three[17;8H[K[18;1HA[1m[34m^X^U^N^[[0m:/^+++/,/^three/w! test.out
:qa![19;5H[K[20;1HENDTEST[21;1H[K[22;1H+++[23;1H[K[24;1Htwo[24;4H[K[24;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"Test that 'completefunc' works when it's OK.[?25l[?1c[24;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunction! DummyCompleteThree(findstart, base)[?25l[?1c
:  [?25h[?0c:  if a:findstart
[?25l[?1c:    [?25h[?0c:    return 0
[?25l[?1c:    [?25h[?0c:  else
[?25l[?1c:    [?25h[?0c:    return ['threedef', 'threeDEF']
[?25l[?1c:    [?25h[?0c:  endif
[?25l[?1c:  [?25h[?0c:endfunction[1;1H[6L[?25l[?1c[1;1H:  else
:    return ['twodef', 'twoDEF']
:  endif
:endfunction
:setlocal completefunc=DummyCompleteTwo
/^two[25;1H[K[24;3H[?25h[?0c[?25l[?1c
:[?25h[?0csetlocal completefunc=DummyCompleteThree[?25l[?1c[24;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^three[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hthree[25;1H[K[24;1H[?25h[?0c[?25l[?1c
[1m[32mmatch 1 of 2[24;9H[0mdef[22;1H[1m[30m[40mthreedef       [0m
[30m[45mthreeDEF       [24;9H[0mDEF[25;7H[1m[32m2[24;9H[0m[22;1H[30m[45mthreedef       [0m
[1m[30m[40mthreeDEF       [24;9H[0m[25;1H[K[22;1H[K[23;1Htwo[23;4H[K[24;8H[?25h[?0c[?25l[?1c
:[?25h[?0c/^+++/,/^three/w! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 4 lines, 18 characters written[24;8H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test77.failed test.ok test.out X* viminfo
cp test77.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test77.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test77.in" 30 lines, 719 characters[1;1HInserts 2 million lines with consecutive integers starting from 1
(essentially, the output of GNU's seq 1 2000000), writes them to Xtest
and writes its cksum to test.out.

We need 2 million lines to trigger a call to mf_hash_grow().  If it would mess
up the lines the checksum would differ.

cksum is part of POSIX and so should be available on most Unixes.
If it isn't available then the test will be skipped.

STARTTEST
:so small.vim
:if !executable("cksum")
: e! test.ok
: w! test.out
: qa!
:endif
:set fileformat=unix undolevels=-1
ggdG
:let i = 1
:while i <= 2000000 | call append(i, range(i, i + 99)) | let i += 100 | endwhile[22;1Hggdd
:w! Xtest
:r !cksum Xtest[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HInserts 2 million lines with consecutive integers starting from 1[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[11;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 17 lines, 288 characters written[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[12;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[5M[1;25r[20;1H:s/\s/ /g
:set fileformat&
:.w! test.out
:qa!
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif !executable("cksum")[?25l[?1c
:  [?25h[?0c: e! test.ok
[?25l[?1c:  [?25h[?0c: w! test.out
[?25l[?1c:  [?25h[?0c: qa!
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[2;1Hcksum is part of POSIX and so should be available on most Unixes.
If it isn't available then the test will be skipped.[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset fileformat=unix undolevels=-1[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[6L[1;25r[1;1HInserts 2 million lines with consecutive integers starting from 1
(essentially, the output of GNU's seq 1 2000000), writes them to Xtest
and writes its cksum to test.out.

We need 2 million lines to trigger a call to mf_hash_grow().  If it would mess
up the lines the checksum would differ.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [0m[25;1H--No lines in buffer--[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet i = 1[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwhile i <= 2000000 | call append(i, range(i, i + 99)) | let i += 100 | endwhil
[24;80He[25;1H[?25l[?1c[1;1H[L[2;1H1[2;2H[K[3;1H2[3;2H[K[4;1H3[4;2H[K[5;1H4[5;2H[K[6;1H5[6;2H[K[7;1H6[7;2H[K[8;1H7[8;2H[K[9;1H8[9;2H[K[10;1H9[10;2H[K[11;1H10[11;3H[K[12;1H11[12;3H[K[13;1H12[13;3H[K[14;1H13[14;3H[K[15;1H14[15;3H[K[16;1H15[16;3H[K[17;1H16[17;3H[K[18;1H17[18;3H[K[19;1H18[19;3H[K[20;1H19[20;3H[K[21;1H20[21;3H[K[22;1H21[22;3H[K[23;1H22[23;3H[K[24;1H23[24;3H[K[25;1H[K[1;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H24[1;1H[?25h[?0c
[?25l[?1c[25;1H:[?25h[?0cw! Xtest[?25l[?1c"Xtest" [25;9H[K[25;9H[New File] 2000000 lines, 14888896 characters written[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cr !cksum Xtest[?25l[?1c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[1;1H1
2
3678979763 14888896 Xtest
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23[3;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cs/\s/ /g[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileformat&[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c.w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 1 line, 26 characters written[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test78.failed test.ok test.out X* viminfo
cp test78.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test78.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test78.in" 46 lines, 1464 characters[1;1HInserts 10000 lines with text to fill the swap file with two levels of pointer
blocks.  Then recovers from the swap file and checks all text is restored.

We need about 10000 lines of 100 characters to get two levels of pointer
blocks.

STARTTEST
:so small.vim
:set nocp fileformat=unix undolevels=-1 viminfo+=nviminfo
:e! Xtest
ggdG
:let text = "\tabcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ012[13;1H3456789abcdefghijklmnoparstuvwxyz0123456789"
:let i = 1
:let linecount = 10000
:while i <= linecount | call append(i - 1, i . text) | let i += 1 | endwhile
:preserve
:" get the name of the swap file
:redir => swapname
:swapname
:redir END
:let swapname = substitute(swapname, '[[:blank:][:cntrl:]]*\(.\{-}\)[[:blank:][:[23;1Hcntrl:]]*$', '\1', '')
:" make a copy of the swap file in Xswap[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HInserts 10000 lines with text to fill the swap file with two levels of pointer[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[7;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[8;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 37 lines, 1208 characters written[8;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[8;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:echo swapname
:set nobin
:new
:only!
:bwipe! Xtest
:call rename('Xswap', swapname)
:recover Xtest
:call delete(swapname)
:new
:call append(0, 'recovery start')
:wincmd w
:let linedollar = line('$')
:if linedollar < linecount | exe 'wincmd w' | call append(line('$'), "expected "[14;2H. linecount . " lines but found only " . linedollar) | exe 'wincmd w' | let lin[15;1Hecount = linedollar | endif
:let i = 1
:while i <= linecount | if getline(i) != i . text | exe 'wincmd w' | call append[18;1H(line('$'), i . ' differs') | exe 'wincmd w' | endif | let i += 1 | endwhile
:q!
:call append(line('$'), 'recovery end')
:w! test.out
:qa!
ENDTEST[?25h[?0c
[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nocp fileformat=unix undolevels=-1 viminfo+=nviminfo[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! Xtest[?25l[?1c"Xtest" [New File][1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet text = "\tabcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ01
[24;80H2[25;1H3456789abcdefghijklmnoparstuvwxyz0123456789"[?25l[?1c[1;1H[L[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0clet i = 1[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet linecount = 10000[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwhile i <= linecount | call append(i - 1, i . text) | let i += 1 | endwhile[?25l[?1c[1;1H9990    abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[2;1Habcdefghijklmnoparstuvwxyz0123456789[2;37H[K[3;1H9991    abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[4;1Habcdefghijklmnoparstuvwxyz0123456789[4;37H[K[5;1H9992    abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[6;1Habcdefghijklmnoparstuvwxyz0123456789[6;37H[K[7;1H9993    abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[8;1Habcdefghijklmnoparstuvwxyz0123456789[8;37H[K[9;1H9994    abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[10;1Habcdefghijklmnoparstuvwxyz0123456789[10;37H[K[11;1H9995    abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[12;1Habcdefghijklmnoparstuvwxyz0123456789[12;37H[K[13;1H9996    abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[14;1Habcdefghijklmnoparstuvwxyz0123456789[14;37H[K[15;1H9997    abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[16;1Habcdefghijklmnoparstuvwxyz0123456789[16;37H[K[17;1H9998    abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[18;1Habcdefghijklmnoparstuvwxyz0123456789[18;37H[K[19;1H9999    abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[20;1Habcdefghijklmnoparstuvwxyz0123456789[20;37H[K[21;1H10000   abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[22;1Habcdefghijklmnoparstuvwxyz0123456789[22;37H[K[23;1H[K[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cpreserve[?25l[?1cFile preserved[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" get the name of the swap file[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir => swapname[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cswapname[?25l[?1c.Xtest.swp[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir END[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet swapname = substitute(swapname, '[[:blank:][:cntrl:]]*\(.\{-}\)[[:blank:][
[24;80H:[25;1Hcntrl:]]*$', '\1', '')[?25l[?1c[1;1H[L[1;1H9990    abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0c" make a copy of the swap file in Xswap[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset bin[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexe 'sp ' . swapname[?25l[?1c".Xtest.swp"[25;14H[K[25;14H[noeol] 609L, 1228800C[1;1Hb0VIM 7.4[1m[34m^@^@^@^@^P^@^@^@^@^@^@^@^@^@^@[0m:<[1m[34m^@^@[0mroot[1m[34m^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^[2;1H@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@[0mclfs[1m[34m^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^[3;1H@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@[0m/sources/vim74/src/testdir/Xtest[1m[34m^@^@^@^@^@^[4;1H@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^[5;1H@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^[6;1H@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^[7;1H@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^[8;1H@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^[9;1H@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^[10;1H@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^[11;1H@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^[0m[12;1H[1m[7m.Xtest.swp                                                                      [0m[24;1H[7mXtest [+]                                                                       [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! Xswap[?25l[?1c"Xswap" [25;9H[K[25;9H[New][noeol] 609L, 1228800C written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cecho swapname[?25l[?1c.Xtest.sw[25;11H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nobin[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnew[?25l[?1c[27m[24m[0m[H[J[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [0m[8;1H[1m[7m[No Name]                                                                       [0m[9;1Hb0VIM 7.4[1m[34m^@^@^@^@^P^@^@^@^@^@^@^@^@^@^@[0m:<[1m[34m^@^@[0mroot[1m[34m^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^[10;1H@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@[0mclfs[1m[34m^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^[11;1H@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@[0m/sources/vim74/src/testdir/Xtest[1m[34m^@^@^@^@^@^[12;1H@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^[13;1H@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^[14;1H@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^[15;1H@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^[0m[16;1H[7m.Xtest.swp                                                                      [0m[17;1H9998    abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[18;1Habcdefghijklmnoparstuvwxyz0123456789
9999    abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[20;1Habcdefghijklmnoparstuvwxyz0123456789
10000   abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[22;1Habcdefghijklmnoparstuvwxyz0123456789

[7mXtest [+]                                                                       [1;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0conly![?25l[?1c[27m[24m[0m[H[J[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0cbwipe! Xtest[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall rename('Xswap', swapname)[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0crecover Xtest[?25l[?1cUsing swap file ".Xtest.swp"
Original file "/sources/vim74/src/testdir/Xtest"
[24;1H"/sources/vim74/src/testdir/Xtest" [New File][24;46H[K[25;1HRecovery completed. You should check if everything is OK.
(You might want to write out this file under another name
and run diff with the original file to check for changes)
You may want to delete the .swp file now.


[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall delete(swapname)[?25l[?1c[1;1H[8L[1;1H1[7Cabcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[2;1Habcdefghijklmnoparstuvwxyz0123456789
2[7Cabcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[4;1Habcdefghijklmnoparstuvwxyz0123456789
3[7Cabcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[6;1Habcdefghijklmnoparstuvwxyz0123456789
4[7Cabcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[8;1Habcdefghijklmnoparstuvwxyz0123456789
5       abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[10;1Habcdefghijklmnoparstuvwxyz0123456789[10;37H[K[11;1H6       abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[12;1Habcdefghijklmnoparstuvwxyz0123456789[12;37H[K[13;1H7       abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[14;1Habcdefghijklmnoparstuvwxyz0123456789[14;37H[K[15;1H8       abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[16;1Habcdefghijklmnoparstuvwxyz0123456789[16;37H[K[17;1H9       abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[18;1Habcdefghijklmnoparstuvwxyz0123456789[18;37H[K[19;1H10      abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[20;1Habcdefghijklmnoparstuvwxyz0123456789[20;37H[K[21;1H11      abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[22;1Habcdefghijklmnoparstuvwxyz0123456789[22;37H[K[23;1H12      abcdefghijklmnoparstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789[24;1Habcdefghijklmnoparstuvwxyz0123456789[24;37H[K[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cnew[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7m[No Name]                                                                       [0m[13;1H1

2

3

4 

5 

6 [1m[34m@                                                                               [0m[24;1H[7mXtest [+]                                                                       [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall append(0, 'recovery start')[?25l[?1c[1;11r[1;1H[L[1;25r[1;1Hrecovery start[12;11H[1m[7m[+][0m[25;1H[K[2;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cwincmd w[?25l[?1c[12;1H[7m[No Name] [+]                                                                   [0m[24;1H[1m[7mXtest [+]                                                                       [13;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet linedollar = line('$')[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif linedollar < linecount | exe 'wincmd w' | call append(line('$'), "expected 
[24;80H"[25;1H . linecount . " lines but found only " . linedollar) | exe 'wincmd w' | let li
[24;80Hn[25;1Hecount = linedollar | endif[?25l[?1c[1;1H[2L[1;1Hrecovery start[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0clet i = 1[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwhile i <= linecount | if getline(i) != i . text | exe 'wincmd w' | call appen
[24;80Hd[25;1H(line('$'), i . ' differs') | exe 'wincmd w' | endif | let i += 1 | endwhile[?25l[?1c[1;1H[L[1;1Hrecovery start[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cq![?25l[?1c[12;1H[1m[34m~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~
~                                                                               [2;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall append(line('$'), 'recovery end')[?25l[?1c[3;1Hrecovery end[3;13H[K[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New] 3L, 29C written[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test79.failed test.ok test.out X* viminfo
cp test79.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test79.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test79.in" 255 lines, 3381 characters[1;1HTest for *sub-replace-special* and *sub-replace-expression* on :substitute.
Test for submatch() on :substitue.
Test for *:s%* on :substitute.
Test for :s replacing \n with  line break.

STARTTEST
:so small.vim
ENDTEST

Results of test71:

STARTTEST
:set magic
:set cpo&
/^TEST/
j:s/A/&&/
j:s/B/\&/
j:s/C\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)/\0\9\8\7\6\5\4\3\2\1/
j:s/D/d/
j:s/E/~/
j:s/F/\~/
j:s/G/\ugg/
j:s/H/\Uh\Eh/
j:s/I/\lII/[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for *sub-replace-special* and *sub-replace-expression* on :substitute.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[6;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 1 line, 14 characters written[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[7;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[8;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[12;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H25 lines, 347 characters written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1Hj:s/L/[1m[34m^V^M[0m/
j:s/M/\r/
j:s/N/\[1m[34m^V^M[0m/
j:s/O/\n/
j:s/P/\b/
j:s/Q/\t/
j:s/R/\\/
j:s/S/\c/
j:s/T/[1m[34m^V^@[0m/
j:s/U/\L\uuUu\l\EU/
j:s/V/\U\lVvV\u\Ev/
ENDTEST

TEST_1:
A
B
C123456789
D
E
F
G
H
I
J[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset magic[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpo&[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^TEST/[?25l[?1c[25;7H[K[25;1H[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/A/&&/[?25l[?1c[15;2HA[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/B/\&/[?25l[?1c[16;1H&[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/C\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)/\0\9\8\7\6\5\4\3\2\1/[?25l[?1c[17;11H987654321[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/D/d/[?25l[?1c[18;1Hd[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/E/~/[?25l[?1c[19;1Hd[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/F/\~/[?25l[?1c[20;1H~[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/G/\ugg/[?25l[?1c[21;2Hg[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/H/\Uh\Eh/[?25l[?1c[22;2Hh[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/I/\lII/[?25l[?1c[23;1HiI[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/J/\LJ\EJ/[?25l[?1c[24;1HjJ[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HK[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/K/\Uk\ek/[?25l[?1c[24;2Hk[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HlLl[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/L/^[1m[34m^M[0m/[?25l[?1c[1;24r[24;1H
[1;25r[23;2H[K[24;1Hl[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HmMm[?25h[?0c[?25l[?1c
:[?25h[?0cs/M/\r/[?25l[?1c[1;24r[24;1H
[1;25r[23;2H[K[24;1Hm[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HnNn[?25h[?0c[?25l[?1c
:[?25h[?0cs/N/\^[1m[34m^M[0m/[?25l[?1c[24;2H[1m[34m^M[0mn[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HoOo[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/O/\n/[?25l[?1c[24;2H[1m[34m^@[0mo[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HpPp[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/P/\b/[?25l[?1c[24;2H[1m[34m^H[0mp[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HqQq[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/Q/\t/[?25l[?1c[24;2H       q[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HrRr[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/R/\\/[?25l[?1c[24;2H\[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HsSs[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/S/\c/[?25l[?1c[24;2Hc[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HtTt[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/T/^[1m[34m^@[0m/[?25l[?1c[24;2H[1m[34m^@[0mt[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HU[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/U/\L\uuUu\l\EU/[?25l[?1c[24;2HuuU[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HV[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/V/\U\lVvV\u\Ev/[?25l[?1c[24;1HvVVv[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set nomagic[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H25 lines, 351 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1Hj:s/L/[1m[34m^V^M[0m/
j:s/M/\r/
j:s/N/\[1m[34m^V^M[0m/
j:s/O/\n/
j:s/P/\b/
j:s/Q/\t/
j:s/R/\\/
j:s/S/\c/
j:s/T/[1m[34m^V^@[0m/
j:s/U/\L\uuUu\l\EU/
j:s/V/\U\lVvV\u\Ev/
ENDTEST

TEST_2:
A
B
C123456789
D
E
F
G
H
I
J[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nomagic[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpo&[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^TEST/[?25l[?1c[25;7H[K[25;1H[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/A/&&/[?25l[?1c[15;1H&&[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/B/\&/[?25l[?1c[16;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/\mC\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)/\0\9\8\7\6\5\4\3\2\1/[?25l[?1c[17;11H987654321[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/D/d/[?25l[?1c[18;1Hd[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/E/~/[?25l[?1c[19;1H~[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/F/\~/[?25l[?1c[20;1H~[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/G/\ugg/[?25l[?1c[21;2Hg[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/H/\Uh\Eh/[?25l[?1c[22;2Hh[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/I/\lII/[?25l[?1c[23;1HiI[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/J/\LJ\EJ/[?25l[?1c[24;1HjJ[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HK[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/K/\Uk\ek/[?25l[?1c[24;2Hk[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HlLl[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/L/^[1m[34m^M[0m/[?25l[?1c[1;24r[24;1H
[1;25r[23;2H[K[24;1Hl[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HmMm[?25h[?0c[?25l[?1c
:[?25h[?0cs/M/\r/[?25l[?1c[1;24r[24;1H
[1;25r[23;2H[K[24;1Hm[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HnNn[?25h[?0c[?25l[?1c
:[?25h[?0cs/N/\^[1m[34m^M[0m/[?25l[?1c[24;2H[1m[34m^M[0mn[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HoOo[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/O/\n/[?25l[?1c[24;2H[1m[34m^@[0mo[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HpPp[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/P/\b/[?25l[?1c[24;2H[1m[34m^H[0mp[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HqQq[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/Q/\t/[?25l[?1c[24;2H       q[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HrRr[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/R/\\/[?25l[?1c[24;2H\[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HsSs[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/S/\c/[?25l[?1c[24;2Hc[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HtTt[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/T/^[1m[34m^@[0m/[?25l[?1c[24;2H[1m[34m^@[0mt[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HU[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/U/\L\uuUu\l\EU/[?25l[?1c[24;2HuuU[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HV[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/V/\U\lVvV\u\Ev/[?25l[?1c[24;1HvVVv[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set magic&[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H15 lines, 203 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1Hj:s/B/\='\\'/
j:s/C/\='[1m[34m^V^M[0m'/
j:s/D/\='\[1m[34m^V^M[0m'/
j:s/E/\='\\[1m[34m^V^M[0m'/
j:s/F/\='\r'/
j:s/G/\='[1m[34m^V^@[0m'/
j:s/H/\='\[1m[34m^V^@[0m'/
j:s/I/\='\\[1m[34m^V^@[0m'/
j:s/J/\='\n'/
j:s/K/\="\r"/
j:s/L/\="\n"/
ENDTEST

TEST_3:
aAa
bBb
cCc
dDd
eEe
fFf
gGg
hHh
iIi
jJj[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset magic&[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpo&[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^TEST/[?25l[?1c[25;7H[K[25;1H[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/A/\='\'/[?25l[?1c[15;2H\[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/B/\='\\'/[?25l[?1c[16;2H\\b[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/C/\='^[1m[34m^M[0m'/[?25l[?1c[18;24r[18;1H[L[1;25r[17;2H[K[18;1Hc[25;1H[K[18;1H[?25h[?0c
[?25l[?1c[25;1H:[?25h[?0cs/D/\='\^[1m[34m^M[0m'/[?25l[?1c[20;24r[20;1H[L[1;25r[19;2H\[19;3H[K[20;1Hd[25;1H[K[20;1H[?25h[?0c
[?25l[?1c[25;1H:[?25h[?0cs/E/\='\\^[1m[34m^M[0m'/[?25l[?1c[22;24r[22;1H[L[1;25r[21;2H\\
e[25;1H[K[22;1H[?25h[?0c
[?25l[?1c

:[?25h[?0cs/F/\='\r'/[?25l[?1c[23;2H\rf[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/G/\='^[1m[34m^@[0m'/[?25l[?1c[1;24r[24;1H
[1;25r[23;2H[K[24;1Hg[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HhHh[?25h[?0c[?25l[?1c
:[?25h[?0cs/H/\='\^[1m[34m^@[0m'/[?25l[?1c[1;24r[24;1H
[1;25r[23;2H\[23;3H[K[24;1Hh[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HiIi[?25h[?0c[?25l[?1c
:[?25h[?0cs/I/\='\\^[1m[34m^@[0m'/[?25l[?1c[1;24r[24;1H
[1;25r[23;2H\\
i[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HjJj[?25h[?0c[?25l[?1c
:[?25h[?0cs/J/\='\n'/[?25l[?1c[24;2H\nj[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HkKk[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/K/\="\r"/[?25l[?1c[1;24r[24;1H
[1;25r[23;2H[K[24;1Hk[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HlLl[?25h[?0c[?25l[?1c
:[?25h[?0cs/L/\="\n"/[?25l[?1c[1;24r[24;1H
[1;25r[23;2H[K[24;1Hl[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set magic&[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H15 lines, 611 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1Hj:s/B/\=substitute(submatch(0), '.', '\\', '')/
j:s/C/\=substitute(submatch(0), '.', '[1m[34m^V^M[0m', '')/
j:s/D/\=substitute(submatch(0), '.', '\[1m[34m^V^M[0m', '')/
j:s/E/\=substitute(submatch(0), '.', '\\[1m[34m^V^M[0m', '')/
j:s/F/\=substitute(submatch(0), '.', '\r', '')/
j:s/G/\=substitute(submatch(0), '.', '[1m[34m^V^@[0m', '')/
j:s/H/\=substitute(submatch(0), '.', '\[1m[34m^V^@[0m', '')/
j:s/I/\=substitute(submatch(0), '.', '\\[1m[34m^V^@[0m', '')/
j:s/J/\=substitute(submatch(0), '.', '\n', '')/
j:s/K/\=substitute(submatch(0), '.', "\r", '')/
j:s/L/\=substitute(submatch(0), '.', "\n", '')/
ENDTEST

TEST_4:
aAa
bBb
cCc
dDd
eEe
fFf
gGg
hHh
iIi
jJj[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset magic&[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpo&[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^TEST/[?25l[?1c[25;7H[K[25;1H[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/A/\=substitute(submatch(0), '.', '\', '')/[?25l[?1c[15;2H\[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/B/\=substitute(submatch(0), '.', '\\', '')/[?25l[?1c[16;2H\[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/C/\=substitute(submatch(0), '.', '^[1m[34m^M[0m', '')/[?25l[?1c[18;24r[18;1H[L[1;25r[17;2H[K[18;1Hc[25;1H[K[18;1H[?25h[?0c
[?25l[?1c[25;1H:[?25h[?0cs/D/\=substitute(submatch(0), '.', '\^[1m[34m^M[0m', '')/[?25l[?1c[20;24r[20;1H[L[1;25r[19;2H[K[20;1Hd[25;1H[K[20;1H[?25h[?0c
[?25l[?1c[25;1H:[?25h[?0cs/E/\=substitute(submatch(0), '.', '\\^[1m[34m^M[0m', '')/[?25l[?1c[22;24r[22;1H[L[1;25r[21;2H\[21;3H[K[22;1He[25;1H[K[22;1H[?25h[?0c
[?25l[?1c

:[?25h[?0cs/F/\=substitute(submatch(0), '.', '\r', '')/[?25l[?1c[23;2H[K[24;1Hf[24;2H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HgGg[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/G/\=substitute(submatch(0), '.', '^[1m[34m^@[0m', '')/[?25l[?1c[1;24r[24;1H
[1;25r[23;2H[K[24;1Hg[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HhHh[?25h[?0c[?25l[?1c
:[?25h[?0cs/H/\=substitute(submatch(0), '.', '\^[1m[34m^@[0m', '')/[?25l[?1c[1;24r[24;1H
[1;25r[23;2H[K[24;1Hh[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HiIi[?25h[?0c[?25l[?1c
:[?25h[?0cs/I/\=substitute(submatch(0), '.', '\\^[1m[34m^@[0m', '')/[?25l[?1c[1;24r[24;1H
[1;25r[23;2H\[23;3H[K[24;1Hi[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HjJj[?25h[?0c[?25l[?1c
:[?25h[?0cs/J/\=substitute(submatch(0), '.', '\n', '')/[?25l[?1c[1;24r[24;1H
[1;25r[23;2H[K[24;1Hj[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HkKk[?25h[?0c[?25l[?1c
:[?25h[?0cs/K/\=substitute(submatch(0), '.', "\r", '')/[?25l[?1c[1;24r[24;1H
[1;25r[23;2H[K[24;1Hk[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HlLl[?25h[?0c[?25l[?1c
:[?25h[?0cs/L/\=substitute(submatch(0), '.', "\n", '')/[?25l[?1c[1;24r[24;1H
[1;25r[23;2H[K[24;1Hl[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set magic&[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H5 lines, 445 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[9M[1;25r[16;1H:set cpo&
/^TEST/
j:s/A\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)/\=submatch(0) . submatch(9) .[19;2Hsubmatch(8) . submatch(7) . submatch(6) . submatch(5) . submatch(4) . submatch([20;1H3) . submatch(2) . submatch(1)/
j:s/B\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)/\=string([submatch(0, 1), sub[22;1Hmatch(9, 1), submatch(8, 1), submatch(7, 1), submatch(6, 1), submatch(5, 1), sub[23;1Hmatch(4, 1), submatch(3, 1), submatch(2, 1), submatch(1, 1)])/
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset magic&[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpo&[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^TEST/[?25l[?1c[25;7H[K[25;1H[1;24r[24;1H
[1;25r[24;1HTEST_5:[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HA123456789[?25h[?0c[?25l[?1c
:[?25h[?0cs/A\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)/\=submatch(0) . submatch(9) .
submatch(8) . submatch(7) . submatch(6) . submatch(5) . submatch(4) . submatch(
[24;80H3[25;1H) . submatch(2) . submatch(1)/[?25l[?1c[1;1H[2L[1;1Hh
i\[24;11H987654321[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HB123456789[?25h[?0c[?25l[?1c
:[?25h[?0cs/B\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)/\=string([submatch(0, 1), sub
[24;80Hm[25;1Hatch(9, 1), submatch(8, 1), submatch(7, 1), submatch(6, 1), submatch(5, 1), sub
[24;80Hm[25;1Hatch(4, 1), submatch(3, 1), submatch(2, 1), submatch(1, 1)])/[?25l[?1c[1;1H[2L[1;1Hi\
i[24;1H[['B123456789'], ['9'], ['8'], ['7'], ['6'], ['5'], ['4'], ['3'], ['2'], ['1']][25;1H[K[24;1H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[1;1H[2M[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set magic&[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H8 lines, 80 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[8M[1;25r[17;1H/^TEST/
:set cpo+=/
j:s/A/a/
j:s/B/%/
:set cpo-=/
j:s/C/c/
j:s/D/%/
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset magic&[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^TEST/[?25l[?1c[25;7H[K[25;1H[1;24r[24;1H
[1;25r[24;1HTEST_6:[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset cpo+=/[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[3M[1;25r[22;1HA
B
C[25;1H[K[22;1H[?25h[?0c[?25l[?1c


:[?25h[?0cs/A/a/[?25l[?1c[22;1Ha[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/B/%/[?25l[?1c[23;1Ha[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpo-=/[?25l[?1c[23;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0cs/C/c/[?25l[?1c[24;1Hc[?25h[?0c[?25l[?1c[1;24r[1;1H[3M[1;25r[22;1HD

STARTTEST[25;1H[K[22;1H[?25h[?0c[?25l[?1c


:[?25h[?0cs/D/%/[?25l[?1c[22;1H%[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:set magic&[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H11 lines, 303 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[11M[1;25r[14;1H:set cpo&
/^TEST_7/
j:s/A./\=submatch(0)/
j:s/B./\=submatch(0)/
j:s/C./\=strtrans(string(submatch(0, 1)))/
j:s/D.\nD/\=strtrans(string(submatch(0, 1)))/
j:s/E\_.\{-}E/\=strtrans(string(submatch(0, 1)))/
/^Q$
:s/Q[^\n]Q/\=submatch(0)."foobar"/
:" Avoid :s error breaks dotest map on Windows.
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset magic&[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpo&[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^TEST_7/[?25l[?1c[25;9H[K[25;1H[1;24r[24;1H
[1;25r[24;1HTEST_7:[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HA[1m[34m^M[0mA[?25h[?0c[?25l[?1c
:[?25h[?0cs/A./\=submatch(0)/[?25l[?1c[1;24r[24;1H
[1;25r[23;2H[K[24;1HA[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HB[1m[34m^@[0mB[?25h[?0c[?25l[?1c
:[?25h[?0cs/B./\=submatch(0)/[?25l[?1c[1;24r[24;1H
[1;25r[23;2H[K[24;1HB[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HC[1m[34m^@[0mC[?25h[?0c[?25l[?1c
:[?25h[?0cs/C./\=strtrans(string(submatch(0, 1)))/[?25l[?1c[24;1H['C^@']C[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HD[1m[34m^@[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/D.\nD/\=strtrans(string(submatch(0, 1)))/[?25l[?1c[24;1H['D^@', 'D'][?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1HE[1m[34m^@[0m[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/E\_.\{-}E/\=strtrans(string(submatch(0, 1)))/[?25l[?1c[24;1H['E^@', '^@', '^@', '^@', '^@E'][?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^Q$[?25l[?1c[1;24r[24;1H
[1;25r[24;1HQ[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/Q[^\n]Q/\=submatch(0)."foobar"/[?25l[?1c[1m[37m[41mE486: Pattern not found: Q[^\n]Q[0m[25;33H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Avoid :s error breaks dotest map on Windows.[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[1;24r[1;1H[3M[1;25r[22;1HQ

STARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:function! TitleString()[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H8 lines, 177 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[8M[1;25r[17;3Hlet check = 'foo' =~ 'bar'
  return ""
endfunction
:set titlestring=%{TitleString()}
:/^test_one/s/.*/\="foo\nbar"/
:/^test_two/s/.*/\="foo\nbar"/c
y
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunction! TitleString()[?25l[?1c
:  [?25h[?0c  let check = 'foo' =~ 'bar'
[?25l[?1c:  [?25h[?0c  return ""
[?25l[?1c:  [?25h[?0cendfunction[1;1H[3L[?25l[?1c[1;1HENDTEST

TEST_7:[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset titlestring=%{TitleString()}[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^test_one/s/.*/\="foo\nbar"/[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hfoo
bar[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c/^test_two/s/.*/\="foo\nbar"/c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[7mtest_two[0m[25;1H[K[25;1H[1m[32mreplace with \="foo\nbar" (y/n/a/q/l/^E/^Y)?[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H[1;24r[24;1H
[1;25r[23;1Hfoo[23;4H[K[24;1Hbar[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
/^STARTTEST[1;24r[24;1H
[1;25r[24;1HSTARTTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:g/^STARTTEST/.,/^ENDTEST/d[?25h[?0c[?25l[?1c
:set ff=unix cpo-=A[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H3 lines, 72 characters written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H[?25h[?0c[?25l[?1c
/ENDTEST[25;10H[K[25;1H[24;19H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:1;/^Results/,$wq! test.out[25;1H[K[24;19H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cg/^STARTTEST/.,/^ENDTEST/d[?25l[?1c136 fewer lines[25;16H[K[1;1HTEST_6:[1;9H[K[2;1Ha[2;2H[K[3;1Ha
c
%[6;1H[K[7;1H[K[8;1HTEST_7:[8;8H[K[9;1HA[9;3H[K[10;1HA[10;2H[K[11;1HB[11;2H[K[12;1HB[12;2H[K[13;1H['C^@']C[13;9H[K[14;1H['D^@', 'D']
['E^@', '^@', '^@', '^@', '^@E']
Q
Q[17;2H[K[18;1H[K[19;1H[K[20;1Hfoo
bar
foo[22;4H[K[23;1Hbar[23;4H[K[24;1H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c1;/^Results/,$wq! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 134 lines, 574 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test80.failed test.ok test.out X* viminfo
cp test80.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test80.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test80.in" 201 lines, 6296 characters[1;1HTest for *sub-replace-special* and *sub-replace-expression* on substitue().
Test for submatch() on substitue().
Test for *:s%* on :substitute.

STARTTEST
:so small.vim
ENDTEST

TEST_1:

STARTTEST
:set magic
:set cpo&
:$put =\"\n\nTEST_1:\"
:$put =substitute('A', 'A', '&&', '')
:$put =substitute('B', 'B', '\&', '')
:$put =substitute('C123456789', 'C\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)'[18;1H, '\0\9\8\7\6\5\4\3\2\1', '')
:$put =substitute('D', 'D', 'd', '')
:$put =substitute('E', 'E', '~', '')
:$put =substitute('F', 'F', '\~', '')
:$put =substitute('G', 'G', '\ugg', '')
:$put =substitute('H', 'H', '\Uh\Eh', '')
:$put =substitute('I', 'I', '\lII', '')[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for *sub-replace-special* and *sub-replace-expression* on substitue().[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[5;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 1 line, 14 characters written[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[6;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[7;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[8;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[8;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[11;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H29 lines, 1142 characters written[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[12;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:$put =substitute('pPp', 'P', '\b', '')
:$put =substitute('qQq', 'Q', '\t', '')
:$put =substitute('rRr', 'R', '\\', '')
:$put =substitute('sSs', 'S', '\c', '')
:$put =substitute('uUu', 'U', \"\n\", '')
:$put =substitute('vVv', 'V', \"\b\", '')
:$put =substitute('wWw', 'W', \"\\\", '')
:$put =substitute('xXx', 'X', \"\r\", '')
:$put =substitute('Y', 'Y', '\L\uyYy\l\EY', '')
:$put =substitute('Z', 'Z', '\U\lZzZ\u\Ez', '')
/^TEST_2
ENDTEST

TEST_2:

STARTTEST
:set nomagic
:set cpo&
:$put =\"\n\nTEST_2:\"
:$put =substitute('A', 'A', '&&', '')
:$put =substitute('B', 'B', '\&', '')
:$put =substitute('C123456789', 'C\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)'[23;1H, '\0\9\8\7\6\5\4\3\2\1', '')
:$put =substitute('D', 'D', 'd', '')[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset magic[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpo&[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =\"\n\nTEST_1:\"[?25l[?1c3 more lines[25;13H[K[27m[24m[0m[H[J[1;1H:set magic&
:set cpo&
:$put =\"\n\nTEST_10:\"
:let y = substitute('123', '\zs', 'a', 'g')[13C| $put =y
:let y = substitute('123', '\zs.', 'a', 'g')[12C| $put =y
:let y = substitute('123', '.\zs', 'a', 'g')[12C| $put =y
:let y = substitute('123', '\ze', 'a', 'g')[13C| $put =y
:let y = substitute('123', '\ze.', 'a', 'g')[12C| $put =y
:let y = substitute('123', '.\ze', 'a', 'g')[12C| $put =y
:let y = substitute('123', '1\|\ze', 'a', 'g')[10C| $put =y
:let y = substitute('123', '1\zs\|[23]', 'a', 'g')      | $put =y
/^TEST_11
ENDTEST

TEST_11:

STARTTEST
:/^Results/,$wq! test.out
ENDTEST

Results of test72:


TEST_1:
3 more lines[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =substitute('A', 'A', '&&', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1HAA[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('B', 'B', '\&', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1H&[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('C123456789', 'C\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)
[24;80H'[25;1H, '\0\9\8\7\6\5\4\3\2\1', '')[?25l[?1c[1;1H[L[1;1H:let y = substitute('123', '\zs', 'a', 'g')[13C| $put =y[2;32H.', 'a', 'g')[3;29H.\zs[4;29H\ze', 'a', 'g') [5;32H.', 'a', 'g')[6;29H.\ze[7;29H1\|\ze', 'a', 'g')[8;31Hzs\|[23]', 'a', 'g')
/^TEST_11[9;10H[K[10;1HENDTEST[10;8H[K[11;1H[K[12;1HTEST_11:[13;1H[K[14;1HSTARTTEST
:/^Results/,$wq! test.out
ENDTEST[16;8H[K[17;1H[K[18;1HResults of test72:[19;1H[K[21;1HTEST_1:
AA[22;3H[K[23;1H&[23;2H[K[24;1HC123456789987654321[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('D', 'D', 'd', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hd[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('E', 'E', '~', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1H~[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('F', 'F', '\~', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1H~[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('G', 'G', '\ugg', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1HGg[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('H', 'H', '\Uh\Eh', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1HHh[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('I', 'I', '\lII', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1HiI[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('J', 'J', '\LJ\EJ', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1HjJ[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('K', 'K', '\Uk\ek', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1HKk[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('lLl', 'L', '^[1m[34m^M[0m', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hl[1m[34m^M[0ml[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('mMm', 'M', '\r', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hm[1m[34m^M[0mm[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('nNn', 'N', '\^[1m[34m^M[0m', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hn[1m[34m^M[0mn[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('oOo', 'O', '\n', '')[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Ho
o[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('pPp', 'P', '\b', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hp[1m[34m^H[0mp[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('qQq', 'Q', '\t', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hq[7Cq[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('rRr', 'R', '\\', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hr\r[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('sSs', 'S', '\c', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hscs[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('uUu', 'U', \"\n\", '')[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hu
u[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('vVv', 'V', \"\b\", '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hv[1m[34m^H[0mv[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('wWw', 'W', \"\\\", '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hw\w[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('xXx', 'X', \"\r\", '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hx[1m[34m^M[0mx[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('Y', 'Y', '\L\uyYy\l\EY', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1HYyyY[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('Z', 'Z', '\U\lZzZ\u\Ez', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1HzZZz[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0c^TEST_2[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[1;1H:$put =substitute('rRr', 'R', '\\', '')
:$put =substitute('sSs', 'S', '\c', '')
:$put =substitute('uUu', 'U', \"\n\", '')
:$put =substitute('vVv', 'V', \"\b\", '')
:$put =substitute('wWw', 'W', \"\\\", '')
:$put =substitute('xXx', 'X', \"\r\", '')
:$put =substitute('Y', 'Y', '\L\uyYy\l\EY', '')
:$put =substitute('Z', 'Z', '\U\lZzZ\u\Ez', '')
/^TEST_2
ENDTEST

TEST_2:

STARTTEST
:set nomagic
:set cpo&
:$put =\"\n\nTEST_2:\"
:$put =substitute('A', 'A', '&&', '')
:$put =substitute('B', 'B', '\&', '')
:$put =substitute('C123456789', 'C\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)'[21;1H, '\0\9\8\7\6\5\4\3\2\1', '')
:$put =substitute('D', 'D', 'd', '')
:$put =substitute('E', 'E', '~', '')
:$put =substitute('F', 'F', '\~', '')
[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H/^STARTTEST[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H29 lines, 1144 characters written[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[15;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:$put =substitute('pPp', 'P', '\b', '')
:$put =substitute('qQq', 'Q', '\t', '')
:$put =substitute('rRr', 'R', '\\', '')
:$put =substitute('sSs', 'S', '\c', '')
:$put =substitute('tTt', 'T', \"\r\", '')
:$put =substitute('uUu', 'U', \"\n\", '')
:$put =substitute('vVv', 'V', \"\b\", '')
:$put =substitute('wWw', 'W', \"\\\", '')
:$put =substitute('X', 'X', '\L\uxXx\l\EX', '')
:$put =substitute('Y', 'Y', '\U\lYyY\u\Ey', '')
/^TEST_3
ENDTEST

TEST_3:

STARTTEST
:set magic&
:set cpo&
:$put =\"\n\nTEST_3:\"
:let y = substitute('aAa', 'A', '\="\\"', '')[11C| $put =y
:let y = substitute('bBb', 'B', '\="\\\\"', '')[9C| $put =y
:let y = substitute('cCc', 'C', '\="[1m[34m^V^M[0m"', '')[9C| $put =y
:let y = substitute('dDd', 'D', '\="\\[1m[34m^V^M[0m"', '')[7C| $put =y
:let y = substitute('eEe', 'E', '\="\\\\[1m[34m^V^M[0m"', '')     | $put =y[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nomagic[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpo&[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =\"\n\nTEST_2:\"[?25l[?1c3 more lines[25;13H[K[27m[24m[0m[H[J[1;1HGg
Hh
iI
jJ
Kk
l[1m[34m^M[0ml
m[1m[34m^M[0mm
n[1m[34m^M[0mn
o
o
p[1m[34m^H[0mp
q[7Cq
r\r
scs
u
u
v[1m[34m^H[0mv
w\w
x[1m[34m^M[0mx
YyyY
zZZz


TEST_2:
3 more lines[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =substitute('A', 'A', '&&', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1HAA[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('B', 'B', '\&', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1H&[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('C123456789', 'C\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)
[24;80H'[25;1H, '\0\9\8\7\6\5\4\3\2\1', '')[?25l[?1c[1;1H[L[1;1HjJ
Kk
l[1m[34m^M[0ml
m[2Cm
n[2Cn
o[6;2H[K[8;1Hp[1m[34m^H[0mp
q       q
r\r[10;9H[K[11;1Hscs
u[12;2H[K[14;1Hv[1m[34m^H[0mv
w\w[15;4H[K[16;1Hx[1m[34m^M[0mx
YyyY
zZZz[19;1H[K[21;1HTEST_2:
AA[22;3H[K[23;1H&[23;2H[K[24;1HC123456789987654321[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('D', 'D', 'd', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hd[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('E', 'E', '~', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1H~[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('F', 'F', '\~', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1H~[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('G', 'G', '\ugg', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1HGg[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('H', 'H', '\Uh\Eh', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1HHh[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('I', 'I', '\lII', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1HiI[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('J', 'J', '\LJ\EJ', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1HjJ[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('K', 'K', '\Uk\ek', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1HKk[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('lLl', 'L', '^[1m[34m^M[0m', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hl[1m[34m^M[0ml[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('mMm', 'M', '\r', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hm[1m[34m^M[0mm[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('nNn', 'N', '\^[1m[34m^M[0m', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hn[1m[34m^M[0mn[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('oOo', 'O', '\n', '')[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Ho
o[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('pPp', 'P', '\b', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hp[1m[34m^H[0mp[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('qQq', 'Q', '\t', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hq[7Cq[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('rRr', 'R', '\\', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hr\r[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('sSs', 'S', '\c', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hscs[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('tTt', 'T', \"\r\", '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Ht[1m[34m^M[0mt[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('uUu', 'U', \"\n\", '')[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hu
u[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('vVv', 'V', \"\b\", '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hv[1m[34m^H[0mv[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('wWw', 'W', \"\\\", '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hw\w[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('X', 'X', '\L\uxXx\l\EX', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1HXxxX[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('Y', 'Y', '\U\lYyY\u\Ey', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1HyYYy[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0c^TEST_3[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[1;1H:$put =substitute('rRr', 'R', '\\', '')
:$put =substitute('sSs', 'S', '\c', '')
:$put =substitute('tTt', 'T', \"\r\", '')
:$put =substitute('uUu', 'U', \"\n\", '')
:$put =substitute('vVv', 'V', \"\b\", '')
:$put =substitute('wWw', 'W', \"\\\", '')
:$put =substitute('X', 'X', '\L\uxXx\l\EX', '')
:$put =substitute('Y', 'Y', '\U\lYyY\u\Ey', '')
/^TEST_3
ENDTEST

TEST_3:

STARTTEST
:set magic&
:set cpo&
:$put =\"\n\nTEST_3:\"
:let y = substitute('aAa', 'A', '\="\\"', '')[11C| $put =y
:let y = substitute('bBb', 'B', '\="\\\\"', '')[9C| $put =y
:let y = substitute('cCc', 'C', '\="[1m[34m^V^M[0m"', '')[9C| $put =y
:let y = substitute('dDd', 'D', '\="\\[1m[34m^V^M[0m"', '')[7C| $put =y
:let y = substitute('eEe', 'E', '\="\\\\[1m[34m^V^M[0m"', '')     | $put =y
:let y = substitute('fFf', 'F', '\="\\r"', '')[10C| $put =y
:let y = substitute('jJj', 'J', '\="\\n"', '')[10C| $put =y
[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H/^STARTTEST[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H13 lines, 642 characters written[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[15;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[4M[1;25r[21;1H:let y = substitute('kKk', 'K', '\="\r"', '')[11C| $put =y
:let y = substitute('lLl', 'L', '\="\n"', '')[11C| $put =y
/^TEST_4
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset magic&[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpo&[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =\"\n\nTEST_3:\"[?25l[?1c3 more lines[25;13H[K[27m[24m[0m[H[J[1;1HGg
Hh
iI
jJ
Kk
l[1m[34m^M[0ml
m[1m[34m^M[0mm
n[1m[34m^M[0mn
o
o
p[1m[34m^H[0mp
q[7Cq
r\r
scs
t[1m[34m^M[0mt
u
u
v[1m[34m^H[0mv
w\w
XxxX
yYYy


TEST_3:
3 more lines[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet y = substitute('aAa', 'A', '\="\\"', '')           | $put =y[?25l[?1c[1;24r[24;1H
[1;25r[24;1Ha\a[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('bBb', 'B', '\="\\\\"', '')         | $put =y[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hb\\b[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('cCc', 'C', '\="^[1m[34m^M[0m"', '')         | $put =y[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hc[1m[34m^M[0mc[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('dDd', 'D', '\="\\^[1m[34m^M[0m"', '')       | $put =y[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hd\[1m[34m^M[0md[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('eEe', 'E', '\="\\\\^[1m[34m^M[0m"', '')     | $put =y[?25l[?1c[1;24r[24;1H
[1;25r[24;1He\\[1m[34m^M[0me[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('fFf', 'F', '\="\\r"', '')          | $put =y[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hf\rf[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('jJj', 'J', '\="\\n"', '')          | $put =y[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hj\nj[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('kKk', 'K', '\="\r"', '')           | $put =y[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hk[1m[34m^M[0mk[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('lLl', 'L', '\="\n"', '')           | $put =y[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Hl
l[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0c^TEST_4[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[1;1H:let y = substitute('bBb', 'B', '\="\\\\"', '')[9C| $put =y
:let y = substitute('cCc', 'C', '\="[1m[34m^V^M[0m"', '')[9C| $put =y
:let y = substitute('dDd', 'D', '\="\\[1m[34m^V^M[0m"', '')[7C| $put =y
:let y = substitute('eEe', 'E', '\="\\\\[1m[34m^V^M[0m"', '')     | $put =y
:let y = substitute('fFf', 'F', '\="\\r"', '')[10C| $put =y
:let y = substitute('jJj', 'J', '\="\\n"', '')[10C| $put =y
:let y = substitute('kKk', 'K', '\="\r"', '')[11C| $put =y
:let y = substitute('lLl', 'L', '\="\n"', '')[11C| $put =y
/^TEST_4
ENDTEST

TEST_4:

STARTTEST
:set magic&
:set cpo&
:$put =\"\n\nTEST_4:\"
:let y = substitute('aAa', 'A', '\=substitute(submatch(0), ".", "\\", "")', '')[19;7H| $put =y
:let y = substitute('bBb', 'B', '\=substitute(submatch(0), ".", "\\\\", "")', ''[21;1H)     | $put =y
:let y = substitute('cCc', 'C', '\=substitute(submatch(0), ".", "[1m[34m^V^M[0m", "")', ''[23;1H)     | $put =y
:let y = substitute('dDd', 'D', '\=substitute(submatch(0), ".", "\\[1m[34m^V^M[0m", "")',[1m[34m@                                                                               [0m[25;1H[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H/^STARTTEST[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[24;1H:let y = substitute('dDd', 'D', '\=substitute(submatch(0), ".", "\\[1m[34m^V^M[0m", "")', [24;1H[1m[34m@                                                                               [15;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H13 lines, 912 characters written[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H:let y = substitute('dDd', 'D', '\=substitute(submatch(0), ".", "\\[1m[34m^V^M[0m", "")', [24;1H[1m[34m@                                                                               [15;1H[?25h[?0c[?25l[?1c[0m[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[13M[1;25r[11;1H:let y = substitute('dDd', 'D', '\=substitute(submatch(0), ".", "\\[1m[34m^V^M[0m", "")', [12;1H'')   | $put =y
:let y = substitute('eEe', 'E', '\=substitute(submatch(0), ".", "\\\\[1m[34m^V^M[0m", "")'[14;1H, '') | $put =y
:let y = substitute('fFf', 'F', '\=substitute(submatch(0), ".", "\\r", "")', '')[16;7H| $put =y
:let y = substitute('jJj', 'J', '\=substitute(submatch(0), ".", "\\n", "")', '')[18;7H| $put =y
:let y = substitute('kKk', 'K', '\=substitute(submatch(0), ".", "\r", "")', '')[20;7H| $put =y
:let y = substitute('lLl', 'L', '\=substitute(submatch(0), ".", "\n", "")', '')[22;7H| $put =y
/^TEST_5
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset magic&[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpo&[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =\"\n\nTEST_4:\"[?25l[?1c3 more lines[25;13H[K[27m[24m[0m[H[J[1;1Hscs
t[1m[34m^M[0mt
u
u
v[1m[34m^H[0mv
w\w
XxxX
yYYy


TEST_3:
a\a
b\\b
c[1m[34m^M[0mc
d\[1m[34m^M[0md
e\\[1m[34m^M[0me
f\rf
j\nj
k[1m[34m^M[0mk
l
l


TEST_4:
3 more lines[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet y = substitute('aAa', 'A', '\=substitute(submatch(0), ".", "\\", "")', '')
      | $put =y[?25l[?1c[1;1H[L[1;1Ht[1m[34m^M[0mt
u[2;2H[K[4;1Hv[1m[34m^H[0mv
w\w[5;4H[K[6;1HXxxX
yYYy[8;1H[K[10;1HTEST_3:
a\a[11;4H[K[12;1Hb\\b
c[1m[34m^M[0mc
d\[1m[34m^M[0md
e\\[1m[34m^M[0me
f\rf[16;5H[K[17;1Hj\nj
k[1m[34m^M[0mk
l[19;2H[K[21;1H[K[23;1HTEST_4:
a\a[24;4H[K[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('bBb', 'B', '\=substitute(submatch(0), ".", "\\\\", "")', '
[24;80H'[25;1H)     | $put =y[?25l[?1c[1;1H[L[1;1Hu

v[1m[34m^H[0mv
w\w[4;4H[K[5;1HXxxX
yYYy[7;1H[K[9;1HTEST_3:
a\a[10;4H[K[11;1Hb\\b
c[1m[34m^M[0mc
d\[1m[34m^M[0md
e\\[1m[34m^M[0me
f\rf[15;5H[K[16;1Hj\nj
k[1m[34m^M[0mk
l[18;2H[K[20;1H[K[22;1HTEST_4:
a\a[23;4H[K[24;1Hb\b[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('cCc', 'C', '\=substitute(submatch(0), ".", "^[1m[34m^M[0m", "")', '')
    | $put =y[?25l[?1c[1;1H[L[1;1Hu
v[1m[34m^H[0mv
w\w[3;4H[K[4;1HXxxX
yYYy[6;1H[K[8;1HTEST_3:
a\a[9;4H[K[10;1Hb\\b
c[1m[34m^M[0mc
d\[1m[34m^M[0md
e\\[1m[34m^M[0me
f\rf[14;5H[K[15;1Hj\nj
k[1m[34m^M[0mk
l[17;2H[K[19;1H[K[21;1HTEST_4:
a\a[22;4H[K[23;1Hb\b
c[1m[34m^M[0mc[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('dDd', 'D', '\=substitute(submatch(0), ".", "\\^[1m[34m^M[0m", "")', '
[24;80H'[25;1H)   | $put =y[?25l[?1c[1;1H[L[1;1Hv[1m[34m^H[0mv
w\w[2;4H[K[3;1HXxxX
yYYy[5;1H[K[7;1HTEST_3:
a\a[8;4H[K[9;1Hb\\b
c[1m[34m^M[0mc
d\[1m[34m^M[0md
e\\[1m[34m^M[0me
f\rf[13;5H[K[14;1Hj\nj
k[1m[34m^M[0mk
l[16;2H[K[18;1H[K[20;1HTEST_4:
a\a[21;4H[K[22;1Hb\b
c[1m[34m^M[0mc
d[2Cd[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('eEe', 'E', '\=substitute(submatch(0), ".", "\\\\^[1m[34m^M[0m", "")',
'') | $put =y[?25l[?1c[1;1H[L[1;1Hw\w
XxxX
yYYy[4;1H[K[6;1HTEST_3:
a\a[7;4H[K[8;1Hb\\b
c[1m[34m^M[0mc
d\[1m[34m^M[0md
e\\[1m[34m^M[0me
f\rf[12;5H[K[13;1Hj\nj
k[1m[34m^M[0mk
l[15;2H[K[17;1H[K[19;1HTEST_4:
a\a[20;4H[K[21;1Hb\b
c[1m[34m^M[0mc
d[2Cd
e\[1m[34m^M[0me[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('fFf', 'F', '\=substitute(submatch(0), ".", "\\r", "")', ''
[24;80H)[25;1H      | $put =y[?25l[?1c[1;1H[L[1;1HXxxX
yYYy[3;1H[K[5;1HTEST_3:
a\a[6;4H[K[7;1Hb\\b
c[1m[34m^M[0mc
d\[1m[34m^M[0md
e\\[1m[34m^M[0me
f\rf[11;5H[K[12;1Hj\nj
k[1m[34m^M[0mk
l[14;2H[K[16;1H[K[18;1HTEST_4:
a\a[19;4H[K[20;1Hb\b
c[1m[34m^M[0mc
d[2Cd
e\[1m[34m^M[0me
f[1m[34m^M[0mf[24;5H[K[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('jJj', 'J', '\=substitute(submatch(0), ".", "\\n", "")', ''
[24;80H)[25;1H      | $put =y[?25l[?1c[1;1H[L[2;1H[K[3;1HTEST_3:
a\a
b\\b[5;5H[K[6;1Hc[1m[34m^M[0mc
d\[1m[34m^M[0md
e\\[1m[34m^M[0me
f\rf[9;5H[K[10;1Hj\nj[10;5H[K[11;1Hk[1m[34m^M[0mk
l[12;2H[K[13;1Hl[13;2H[K[14;1H[K[15;1H[K[16;1HTEST_4:
a\a
b\b[18;4H[K[19;1Hc[1m[34m^M[0mc
d[1m[34m^M[0md
e\[1m[34m^M[0me
f[2Cf
j[23;2H[K[24;1Hj[24;2H[K[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('kKk', 'K', '\=substitute(submatch(0), ".", "\r", "")', '')
      | $put =y[?25l[?1c[1;1H[L[2;1HTEST_3:
a\a[3;4H[K[4;1Hb\\b
c[1m[34m^M[0mc
d\[1m[34m^M[0md
e\\[1m[34m^M[0me
f\rf[8;5H[K[9;1Hj\nj
k[1m[34m^M[0mk
l[11;2H[K[13;1H[K[15;1HTEST_4:
a\a[16;4H[K[17;1Hb\b
c[1m[34m^M[0mc
d[2Cd
e\[1m[34m^M[0me
f[1m[34m^M[0mf[21;5H[K[22;1Hj[22;2H[K[24;1Hk[1m[34m^M[0mk[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('lLl', 'L', '\=substitute(submatch(0), ".", "\n", "")', '')
      | $put =y[?25l[?1c[1;1H[L[1;1Ha\a
b\\b[2;5H[K[3;1Hc[1m[34m^M[0mc
d\[1m[34m^M[0md
e\\[1m[34m^M[0me
f\rf[6;5H[K[7;1Hj\nj[7;5H[K[8;1Hk[1m[34m^M[0mk
l[9;2H[K[10;1Hl[10;2H[K[11;1H[K[12;1H[K[13;1HTEST_4:
a\a
b\b[15;4H[K[16;1Hc[1m[34m^M[0mc
d[1m[34m^M[0md
e\[1m[34m^M[0me
f[2Cf
j[20;2H[K[21;1Hj[21;2H[K[22;1Hk[1m[34m^M[0mk
l
l[24;2H[K[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0c^TEST_5[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[1;1H:let y = substitute('fFf', 'F', '\=substitute(submatch(0), ".", "\\r", "")', '')[2;7H| $put =y
:let y = substitute('jJj', 'J', '\=substitute(submatch(0), ".", "\\n", "")', '')[4;7H| $put =y
:let y = substitute('kKk', 'K', '\=substitute(submatch(0), ".", "\r", "")', '')[6;7H| $put =y
:let y = substitute('lLl', 'L', '\=substitute(submatch(0), ".", "\n", "")', '')[8;7H| $put =y
/^TEST_5
ENDTEST

TEST_5:

STARTTEST
:set magic&
:set cpo&
:$put =\"\n\nTEST_5:\"
:$put =substitute('A123456789', 'A\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)'[19;1H, '\=submatch(0) . submatch(9) . submatch(8) . submatch(7) . submatch(6) . subma[20;1Htch(5) . submatch(4) . submatch(3) . submatch(2) . submatch(1)', '')
:$put =substitute('A123456789', 'A\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)'[22;1H, '\=string([submatch(0, 1), submatch(9, 1), submatch(8, 1), submatch(7, 1), sub[23;1Hmatch(6, 1), submatch(5, 1), submatch(4, 1), submatch(3, 1), submatch(2, 1), sub[24;1Hmatch(1, 1)])', '')
[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H/^STARTTEST[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H6 lines, 543 characters written[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[15;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[2M[1;25r[23;1H/^TEST_6
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[1;1H[2M[1;25r[24;1HTEST_6:[23;1H[?25h[?0c[?25l[?1c

:so! Xdotest[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset magic&[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpo&[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =\"\n\nTEST_5:\"[?25l[?1c3 more lines[25;13H[K[27m[24m[0m[H[J[1;1Hd\[1m[34m^M[0md
e\\[1m[34m^M[0me
f\rf
j\nj
k[1m[34m^M[0mk
l
l


TEST_4:
a\a
b\b
c[1m[34m^M[0mc
d[1m[34m^M[0md
e\[1m[34m^M[0me
f[1m[34m^M[0mf
j
j
k[1m[34m^M[0mk
l
l


TEST_5:
3 more lines[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =substitute('A123456789', 'A\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)
[24;80H'[25;1H, '\=submatch(0) . submatch(9) . submatch(8) . submatch(7) . submatch(6) . subm
[24;80Ha[25;1Htch(5) . submatch(4) . submatch(3) . submatch(2) . submatch(1)', '')[?25l[?1c[1;1H[2L[1;1He\\[1m[34m^M[0me
f\rf
j\nj
k[1m[34m^M[0mk
l[5;2H[K[7;1H[K[9;1HTEST_4:
a\a[10;4H[K[11;1Hb\b
c[1m[34m^M[0mc
d[2Cd
e\[1m[34m^M[0me
f[1m[34m^M[0mf[15;5H[K[16;1Hj[16;2H[K[18;1Hk[1m[34m^M[0mk
l[19;2H[K[21;1H[K[23;1HTEST_5:
A123456789987654321[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('A123456789', 'A\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)
[24;80H'[25;1H, '\=string([submatch(0, 1), submatch(9, 1), submatch(8, 1), submatch(7, 1), su
[24;80Hb[25;1Hmatch(6, 1), submatch(5, 1), submatch(4, 1), submatch(3, 1), submatch(2, 1), su
[24;80Hb[25;1Hmatch(1, 1)])', '')[?25l[?1c[1;1H[3L[1;1Hf\rf
j\nj
k[1m[34m^M[0mk
l[4;2H[K[6;1H[K[8;1HTEST_4:
a\a[9;4H[K[10;1Hb\b
c[1m[34m^M[0mc
d[2Cd
e\[1m[34m^M[0me
f[1m[34m^M[0mf[14;5H[K[15;1Hj[15;2H[K[17;1Hk[1m[34m^M[0mk
l[18;2H[K[20;1H[K[22;1HTEST_5:
A123456789987654321
[['A123456789'], ['9'], ['8'], ['7'], ['6'], ['5'], ['4'], ['3'], ['2'], ['1']][25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0c^TEST_6[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[1;1H:$put =\"\n\nTEST_5:\"
:$put =substitute('A123456789', 'A\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)'[3;1H, '\=submatch(0) . submatch(9) . submatch(8) . submatch(7) . submatch(6) . subma[4;1Htch(5) . submatch(4) . submatch(3) . submatch(2) . submatch(1)', '')
:$put =substitute('A123456789', 'A\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)\(.\)'[6;1H, '\=string([submatch(0, 1), submatch(9, 1), submatch(8, 1), submatch(7, 1), sub[7;1Hmatch(6, 1), submatch(5, 1), submatch(4, 1), submatch(3, 1), submatch(2, 1), sub[8;1Hmatch(1, 1)])', '')
/^TEST_6
ENDTEST

TEST_6:

STARTTEST
:set magic&
:$put =\"\n\nTEST_6:\"
:set cpo+=/
:$put =substitute('A', 'A', 'a', '')
:$put =substitute('B', 'B', '%', '')
:set cpo-=/
:$put =substitute('C', 'C', 'c', '')
:$put =substitute('D', 'D', '%', '')
/^TEST_7
ENDTEST
[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H/^STARTTEST[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H9 lines, 216 characters written[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[15;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset magic&[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =\"\n\nTEST_6:\"[?25l[?1c3 more lines[25;13H[K[27m[24m[0m[H[J[1;1Hl
l


TEST_4:
a\a
b\b
c[1m[34m^M[0mc
d[1m[34m^M[0md
e\[1m[34m^M[0me
f[1m[34m^M[0mf
j
j
k[1m[34m^M[0mk
l
l


TEST_5:
A123456789987654321
[['A123456789'], ['9'], ['8'], ['7'], ['6'], ['5'], ['4'], ['3'], ['2'], ['1']]


TEST_6:
3 more lines[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpo+=/[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =substitute('A', 'A', 'a', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Ha[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('B', 'B', '%', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1H%[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset cpo-=/[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =substitute('C', 'C', 'c', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hc[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('D', 'D', '%', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1H%[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0c^TEST_7[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[1;1H:set magic&
:$put =\"\n\nTEST_6:\"
:set cpo+=/
:$put =substitute('A', 'A', 'a', '')
:$put =substitute('B', 'B', '%', '')
:set cpo-=/
:$put =substitute('C', 'C', 'c', '')
:$put =substitute('D', 'D', '%', '')
/^TEST_7
ENDTEST

TEST_7:

STARTTEST
:set magic&
:set cpo&
:$put =\"\n\nTEST_7:\"
:$put =substitute('A[1m[34m^V^M[0mA', 'A.', '\=submatch(0)', '')
:$put =substitute(\"B\nB\", 'B.', '\=submatch(0)', '')
:$put =substitute(\"B\nB\", 'B.', '\=string(submatch(0, 1))', '')
:$put =substitute('-bb', '\zeb', 'a', 'g')
:$put =substitute('-bb', '\ze', 'c', 'g')
/^TEST_8
ENDTEST
[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H/^STARTTEST[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H9 lines, 313 characters written[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[15;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset magic&[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpo&[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =\"\n\nTEST_7:\"[?25l[?1c3 more lines[25;13H[K[27m[24m[0m[H[J[1;1Hc[1m[34m^M[0mc
d[1m[34m^M[0md
e\[1m[34m^M[0me
f[1m[34m^M[0mf
j
j
k[1m[34m^M[0mk
l
l


TEST_5:
A123456789987654321
[['A123456789'], ['9'], ['8'], ['7'], ['6'], ['5'], ['4'], ['3'], ['2'], ['1']]


TEST_6:
a
%
c
%


TEST_7:
3 more lines[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =substitute('A^[1m[34m^M[0mA', 'A.', '\=submatch(0)', '')[?25l[?1c[1;24r[24;1H
[1;25r[24;1HA[1m[34m^M[0mA[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute(\"B\nB\", 'B.', '\=submatch(0)', '')[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1HB
B[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute(\"B\nB\", 'B.', '\=string(submatch(0, 1))', '')[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1H['B
']B[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('-bb', '\zeb', 'a', 'g')[?25l[?1c[1;24r[24;1H
[1;25r[24;1H-abab[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =substitute('-bb', '\ze', 'c', 'g')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hc-cbcbc[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0c^TEST_8[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[1;1H:set magic&
:set cpo&
:$put =\"\n\nTEST_7:\"
:$put =substitute('A[1m[34m^V^M[0mA', 'A.', '\=submatch(0)', '')
:$put =substitute(\"B\nB\", 'B.', '\=submatch(0)', '')
:$put =substitute(\"B\nB\", 'B.', '\=string(submatch(0, 1))', '')
:$put =substitute('-bb', '\zeb', 'a', 'g')
:$put =substitute('-bb', '\ze', 'c', 'g')
/^TEST_8
ENDTEST

TEST_8:

STARTTEST
:set magic&
:set cpo&
:$put =\"\n\nTEST_8:\"
:$put =',,X'
:s/\(^\|,\)\ze\(,\|X\)/\1N/g
:$put =',,Y'
:s/\(^\|,\)\ze\(,\|Y\)/\1N/gc
a:$put =',,Z'
:s/\(^\|,\)\ze\(,\|Z\)/\1N/gc
yy/^TEST_9:
[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H/^STARTTEST[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H10 lines, 186 characters written[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[15;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[24;1H
[1;25r[24;1HENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset magic&[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpo&[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =\"\n\nTEST_8:\"[?25l[?1c3 more lines[25;13H[K[27m[24m[0m[H[J[2;1HTEST_5:
A123456789987654321
[['A123456789'], ['9'], ['8'], ['7'], ['6'], ['5'], ['4'], ['3'], ['2'], ['1']]


TEST_6:
a
%
c
%


TEST_7:
A[1m[34m^M[0mA
B
B
['B
']B
-abab
c-cbcbc


TEST_8:
3 more lines[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =',,X'[?25l[?1c[1;24r[24;1H
[1;25r[24;1H,,X[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/\(^\|,\)\ze\(,\|X\)/\1N/g[?25l[?1c[24;1HN,,NX[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =',,Y'[?25l[?1c[1;24r[24;1H
[1;25r[24;1H,,Y[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/\(^\|,\)\ze\(,\|Y\)/\1N/gc[?25l[?1c[24;1H[7m,[0m
[1m[32mreplace with \1N (y/n/a/q/l/^E/^Y)?[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H[24;1HN,,NY[?25h[?0c[?25l[?1c
:[?25h[?0c$put =',,Z'[?25l[?1c[1;24r[24;1H
[1;25r[24;1H,,Z[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/\(^\|,\)\ze\(,\|Z\)/\1N/gc[?25l[?1c[24;1H[7m,[0m
[1m[32mreplace with \1N (y/n/a/q/l/^E/^Y)?[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H[24;1HN,[7m,[0mZ
[1m[32mreplace with \1N (y/n/a/q/l/^E/^Y)?[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H[24;3H,NZ[?25h[?0c[?25l[?1c
/[?25h[?0c^TEST_9:[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[1;1H:set cpo&
:$put =\"\n\nTEST_8:\"
:$put =',,X'
:s/\(^\|,\)\ze\(,\|X\)/\1N/g
:$put =',,Y'
:s/\(^\|,\)\ze\(,\|Y\)/\1N/gc
a:$put =',,Z'
:s/\(^\|,\)\ze\(,\|Z\)/\1N/gc
yy/^TEST_9:
ENDTEST

TEST_9:

STARTTEST
:set magic&
:set cpo&
:$put =\"\n\nTEST_9:\"
:$put ='xxx'
:s/x/X/gc
yyq/^TEST_10:
ENDTEST

TEST_10:

[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H/^STARTTEST[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H6 lines, 82 characters written[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[15;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[21;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset magic&[?25l[?1c[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpo&[?25l[?1c[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =\"\n\nTEST_9:\"[?25l[?1c3 more lines[25;13H[K[27m[24m[0m[H[J[1;1HTEST_6:
a
%
c
%


TEST_7:
A[1m[34m^M[0mA
B
B
['B
']B
-abab
c-cbcbc


TEST_8:
N,,NX
N,,NY
N,,NZ


TEST_9:
3 more lines[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put ='xxx'[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hxxx[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cs/x/X/gc[?25l[?1c[24;1H[7mx[0m
[1m[32mreplace with X (y/n/a/q/l/^E/^Y)?[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H[24;1HX[7mx[0m
[1m[32mreplace with X (y/n/a/q/l/^E/^Y)?[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H[24;2HX[7mx[0m
[1m[32mreplace with X (y/n/a/q/l/^E/^Y)?[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H[24;3Hx[?25h[?0c[?25l[?1c
/[?25h[?0c^TEST_10:[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[1;1HTEST_9:

STARTTEST
:set magic&
:set cpo&
:$put =\"\n\nTEST_9:\"
:$put ='xxx'
:s/x/X/gc
yyq/^TEST_10:
ENDTEST

TEST_10:

STARTTEST
:set magic&
:set cpo&
:$put =\"\n\nTEST_10:\"
:let y = substitute('123', '\zs', 'a', 'g')[13C| $put =y
:let y = substitute('123', '\zs.', 'a', 'g')[12C| $put =y
:let y = substitute('123', '.\zs', 'a', 'g')[12C| $put =y
:let y = substitute('123', '\ze', 'a', 'g')[13C| $put =y
:let y = substitute('123', '\ze.', 'a', 'g')[12C| $put =y
:let y = substitute('123', '.\ze', 'a', 'g')[12C| $put =y
:let y = substitute('123', '1\|\ze', 'a', 'g')[10C| $put =y
[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H/^STARTTEST[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H12 lines, 584 characters written[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[15;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[3M[1;25r[22;1H:let y = substitute('123', '1\zs\|[23]', 'a', 'g')      | $put =y
/^TEST_11
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset magic&[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpo&[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =\"\n\nTEST_10:\"[?25l[?1c3 more lines[25;13H[K[27m[24m[0m[H[J[1;1H%


TEST_7:
A[1m[34m^M[0mA
B
B
['B
']B
-abab
c-cbcbc


TEST_8:
N,,NX
N,,NY
N,,NZ


TEST_9:
XXx


TEST_10:
3 more lines[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet y = substitute('123', '\zs', 'a', 'g')             | $put =y[?25l[?1c[1;24r[24;1H
[1;25r[24;1Ha1a2a3a[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('123', '\zs.', 'a', 'g')            | $put =y[?25l[?1c[1;24r[24;1H
[1;25r[24;1Haaa[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('123', '.\zs', 'a', 'g')            | $put =y[?25l[?1c[1;24r[24;1H
[1;25r[24;1H1a2a3a[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('123', '\ze', 'a', 'g')             | $put =y[?25l[?1c[1;24r[24;1H
[1;25r[24;1Ha1a2a3a[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('123', '\ze.', 'a', 'g')            | $put =y[?25l[?1c[1;24r[24;1H
[1;25r[24;1Ha1a2a3[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('123', '.\ze', 'a', 'g')            | $put =y[?25l[?1c[1;24r[24;1H
[1;25r[24;1Haaa[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('123', '1\|\ze', 'a', 'g')          | $put =y[?25l[?1c[1;24r[24;1H
[1;25r[24;1Haa2a3a[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet y = substitute('123', '1\zs\|[23]', 'a', 'g')      | $put =y[?25l[?1c[1;24r[24;1H
[1;25r[24;1H1aaa[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0c^TEST_11[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[1;1H:let y = substitute('123', '\zs', 'a', 'g')[13C| $put =y
:let y = substitute('123', '\zs.', 'a', 'g')[12C| $put =y
:let y = substitute('123', '.\zs', 'a', 'g')[12C| $put =y
:let y = substitute('123', '\ze', 'a', 'g')[13C| $put =y
:let y = substitute('123', '\ze.', 'a', 'g')[12C| $put =y
:let y = substitute('123', '.\ze', 'a', 'g')[12C| $put =y
:let y = substitute('123', '1\|\ze', 'a', 'g')[10C| $put =y
:let y = substitute('123', '1\zs\|[23]', 'a', 'g')      | $put =y
/^TEST_11
ENDTEST

TEST_11:

STARTTEST
:/^Results/,$wq! test.out
ENDTEST

Results of test72:


TEST_1:
AA
&
C123456789987654321
[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H/^STARTTEST[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H1 line, 26 characters written[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[15;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[16;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^Results/,$wq! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 131 lines, 617 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test81.failed test.ok test.out X* viminfo
cp test81.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test81.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test81.in" 22 lines, 308 characters[1;1HTest for t movement command and 'cpo-;' setting

STARTTEST
:set nocompatible viminfo+=nviminfo
:set cpo-=;
/firstline/
j0tt;D
0fz;D
$Fy;D
$Ty;D:set cpo+=;
j0tt;;D
$Ty;;D:?firstline?+1,$w! test.out
:qa!
ENDTEST

firstline
aaa two three four
    zzz
yyy
bbb yee yoo four
ccc two three four
ddd yee yoo four
[1m[34m~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for t movement command and 'cpo-;' setting[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 10 lines, 143 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nocompatible viminfo+=nviminfo[?25l[?1c[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpo-=;[?25l[?1c[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cfirstline/[?25l[?1c[25;11H[K[25;1H[16;1H[?25h[?0c
aaa two[?25l[?1c[17;9H[K[17;7H[?25h[?0c[18;7H    z[?25l[?1c[18;6H[K[18;5H[?25h[?0c
yyy  [?25l[?1c[19;2H[K[19;1H[?25h[?0c
[15C[?25l[?1c[20;6H[K[20;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cpo+=;[?25l[?1c[20;5H[?25h[?0c
ccc ccc[?25l[?1c[21;5H[K[21;3H[?25h[?0c
dd[13C[?25l[?1c[22;10H[K[22;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c?firstline?+1,$w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New] 6L, 36C written[22;9H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test82.failed test.ok test.out X* viminfo
cp test82.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test82.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test82.in" 103 lines, 3165 characters[1;1HTests for case-insensitive UTF-8 comparisons (utf_strnicmp() in mbyte.c)
Also test "g~ap".

STARTTEST
:so small.vim
:if !has("multi_byte")
: e! test.ok
: w! test.out
: qa!
:endif
:set enc=utf8
ggdG
:
:function! Ch(a, op, b, expected)
:  if eval(printf('"%s" %s "%s"', a:a, a:op, a:b)) != a:expected
:    call append(line('$'), printf('"%s" %s "%s" should return %d', a:a, a:op, a[17;1H:b, a:expected))
:  else
:    let b:passed += 1
:  endif
:endfunction
:
:function! Chk(a, b, result)
:  if a:result == 0[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for case-insensitive UTF-8 comparisons (utf_strnicmp() in mbyte.c)[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[4;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 97 lines, 3054 characters written[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:call GT('\xef\xbc\xba', '\xef\xbc\xff')  " first string is ok and equals \xef\x[2;1Hbd\x9a after folding, second string is illegal and was left unchanged, then the
strings were bytewise compared
:call LT('\xc3', '\xc3\x83')
:call EQ('\xc3\xa3xYz', '\xc3\x83XyZ')
:for n in range(0x60, 0xFF) | call LT(printf('xYz\x%.2X', n-1), printf('XyZ\x%.2[7;1HX', n)) | endfor
:for n in range(0x80, 0xBF) | call EQ(printf('xYz\xc2\x%.2XUvW', n), printf('XyZ[9;1H\xc2\x%.2XuVw', n)) | endfor
:for n in range(0xC0, 0xFF) | call LT(printf('xYz\xc2\x%.2XUvW', n), printf('XyZ[11;1H\xc2\x%.2XuVw', n)) | endfor
:call append(0, printf('%d checks passed', b:passed))
:"
:" test that g~ap changes one paragraph only.
:new
iabcd

defg[1m[34m^[[0mgg0g~ap:let lns = getline(1,3)
:q!
:call append(line('$'), lns)
:"
:wq! test.out
ENDTEST[?25h[?0c
[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif !has("multi_byte")[?25l[?1c
:  [?25h[?0c: e! test.ok
[?25l[?1c:  [?25h[?0c: w! test.out
[?25l[?1c:  [?25h[?0c: qa!
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[1;1H:call GT('\xef\xbc\xba', '\xef\xbc\xff')  " first string is ok and equals \xef\x[2;1Hbd\x9a after folding, second string is illegal and was left unchanged, then the
strings were bytewise compared
:call LT('\xc3', '\xc3\x83')[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset enc=utf8[?25l[?1c[27m[24m[0m[H[J[1;1H:call GT('\xef\xbc\xba', '\xef\xbc\xff')  " first string is ok and equals \xef\x[2;1Hbd\x9a after folding, second string is illegal and was left unchanged, then the
strings were bytewise compared
:call LT('\xc3', '\xc3\x83')
:call EQ('\xc3\xa3xYz', '\xc3\x83XyZ')
:for n in range(0x60, 0xFF) | call LT(printf('xYz\x%.2X', n-1), printf('XyZ\x%.2[7;1HX', n)) | endfor
:for n in range(0x80, 0xBF) | call EQ(printf('xYz\xc2\x%.2XUvW', n), printf('XyZ[9;1H\xc2\x%.2XuVw', n)) | endfor
:for n in range(0xC0, 0xFF) | call LT(printf('xYz\xc2\x%.2XUvW', n), printf('XyZ[11;1H\xc2\x%.2XuVw', n)) | endfor
:call append(0, printf('%d checks passed', b:passed))
:"
:" test that g~ap changes one paragraph only.
:new
iabcd

defg[1m[34m^[[0mgg0g~ap:let lns = getline(1,3)
:q!
:call append(line('$'), lns)
:"
:wq! test.out
ENDTEST
[?25h[?0c[?25l[?1c[27m[24m[0m[H[J[1;1HTests for case-insensitive UTF-8 comparisons (utf_strnicmp() in mbyte.c)
Also test "g~ap".

STARTTEST
:so small.vim
:if !has("multi_byte")
: e! test.ok
: w! test.out
: qa!
:endif
:set enc=utf8
ggdG
:
:function! Ch(a, op, b, expected)
:  if eval(printf('"%s" %s "%s"', a:a, a:op, a:b)) != a:expected
:    call append(line('$'), printf('"%s" %s "%s" should return %d', a:a, a:op, a[17;1H:b, a:expected))
:  else
:    let b:passed += 1
:  endif
:endfunction
:
:function! Chk(a, b, result)
:  if a:result == 0[1;1H[?25h[?0c[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [0m[25;1H--No lines in buffer--[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunction! Ch(a, op, b, expected)[?25l[?1c
:  [?25h[?0c:  if eval(printf('"%s" %s "%s"', a:a, a:op, a:b)) != a:expected
[?25l[?1c:    [?25h[?0c:    call append(line('$'), printf('"%s" %s "%s" should return %d', a:a, a
[24;80H:[25;1Hop, a:b, a:expected))
[?25l[?1c:    [?25h[?0c:  else
[?25l[?1c:    [?25h[?0c:    let b:passed += 1
[?25l[?1c:    [?25h[?0c:  endif
[?25l[?1c:  [?25h[?0c:endfunction[1;1H[7L[?25l[?1c[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunction! Chk(a, b, result)[?25l[?1c
:  [?25h[?0c:  if a:result == 0
[?25l[?1c:    [?25h[?0c:    call Ch(a:a, '==?', a:b, 1)
[?25l[?1c:    [?25h[?0c:    call Ch(a:a, '!=?', a:b, 0)
[?25l[?1c:    [?25h[?0c:    call Ch(a:a, '<=?', a:b, 1)
[?25l[?1c:    [?25h[?0c:    call Ch(a:a, '>=?', a:b, 1)
[?25l[?1c:    [?25h[?0c:    call Ch(a:a, '<?', a:b, 0)
[?25l[?1c:    [?25h[?0c:    call Ch(a:a, '>?', a:b, 0)
[?25l[?1c:    [?25h[?0c:  elseif a:result > 0
[?25l[?1c:    [?25h[?0c:    call Ch(a:a, '==?', a:b, 0)
[?25l[?1c:    [?25h[?0c:    call Ch(a:a, '!=?', a:b, 1)
[?25l[?1c:    [?25h[?0c:    call Ch(a:a, '<=?', a:b, 0)
[?25l[?1c:    [?25h[?0c:    call Ch(a:a, '>=?', a:b, 1)
[?25l[?1c:    [?25h[?0c:    call Ch(a:a, '<?', a:b, 0)
[?25l[?1c:    [?25h[?0c:    call Ch(a:a, '>?', a:b, 1)
[?25l[?1c:    [?25h[?0c:  else
[?25l[?1c:    [?25h[?0c:    call Ch(a:a, '==?', a:b, 0)
[?25l[?1c:    [?25h[?0c:    call Ch(a:a, '!=?', a:b, 1)
[?25l[?1c:    [?25h[?0c:    call Ch(a:a, '<=?', a:b, 1)
[?25l[?1c:    [?25h[?0c:    call Ch(a:a, '>=?', a:b, 0)
[?25l[?1c:    [?25h[?0c:    call Ch(a:a, '<?', a:b, 1)
[?25l[?1c:    [?25h[?0c:    call Ch(a:a, '>?', a:b, 0)
[?25l[?1c:    [?25h[?0c:  endif
[?25l[?1c:  [?25h[?0c:endfunction[27m[24m[0m[H[J[?25l[?1c[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0c[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunction! Check(a, b, result)[?25l[?1c
:  [?25h[?0c:  call Chk(a:a, a:b, a:result)
[?25l[?1c:  [?25h[?0c:  call Chk(a:b, a:a, -a:result)
[?25l[?1c:  [?25h[?0c:endfunction[1;1H[3L[?25l[?1c[2;1H[1m[34m~                                                                               [3;1H~                                                                               [0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunction! LT(a, b)[?25l[?1c
:  [?25h[?0c:  call Check(a:a, a:b, -1)
[?25l[?1c:  [?25h[?0c:endfunction[1;1H[2L[?25l[?1c[2;1H[1m[34m~                                                                               [0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunction! GT(a, b)[?25l[?1c
:  [?25h[?0c:  call Check(a:a, a:b, 1)
[?25l[?1c:  [?25h[?0c:endfunction[1;1H[2L[?25l[?1c[2;1H[1m[34m~                                                                               [0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunction! EQ(a, b)[?25l[?1c
:  [?25h[?0c:  call Check(a:a, a:b, 0)
[?25l[?1c:  [?25h[?0c:endfunction[1;1H[2L[?25l[?1c[2;1H[1m[34m~                                                                               [0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet b:passed=0[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall EQ('', '')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall LT('', 'a')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall EQ('abc', 'abc')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall EQ('Abc', 'abC')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall LT('ab', 'abc')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall LT('AB', 'abc')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall LT('ab', 'aBc')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall EQ('\xd0\xb9\xd1\x86\xd1\x83\xd0\xba\xd0\xb5\xd0\xbd', '\xd0\xb9\xd0\xa6\
[24;80Hx[25;1Hd0\xa3\xd0\xba\xd0\x95\xd0\xbd')[?25l[?1c[1;1H[L[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall LT('\xd0\xb9\xd1\x86\xd1\x83\xd0\xba\xd0\xb5\xd0\xbd', '\xd0\xaf\xd1\x86\
[24;80Hx[25;1Hd1\x83\xd0\xba\xd0\xb5\xd0\xbd')[?25l[?1c[1;1H[L[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall EQ('\xe2\x84\xaa', 'k')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall LT('\xe2\x84\xaa', 'kkkkkk')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall EQ('\xe2\x84\xaa\xe2\x84\xaa\xe2\x84\xaa', 'kkk')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall LT('kk', '\xe2\x84\xaa\xe2\x84\xaa\xe2\x84\xaa')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall EQ('\xe2\x84\xaa\xe2\x84\xa6k\xe2\x84\xaak\xcf\x89', 'k\xcf\x89\xe2\x84\x
[24;80Ha[25;1Hakk\xe2\x84\xa6')[?25l[?1c[1;1H[L[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall EQ('Abc\x80', 'AbC\x80')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall LT('Abc\x80', 'AbC\x81')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall LT('Abc', 'AbC\x80')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall LT('abc\x80DEF', 'abc\x80def')  " case folding stops at the first bad cha
[24;80Hr[25;1Hacter[?25l[?1c[1;1H[L[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall LT('\xc3XYZ', '\xc3xyz')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall EQ('\xef\xbc\xba', '\xef\xbd\x9a')  " FF3A (upper), FF5A (lower)[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall GT('\xef\xbc\xba', '\xef\xbc\xff')  " first string is ok and equals \xef\
[24;80Hx[25;1Hbd\x9a after folding, second string is illegal and was left unchanged, then the
strings were bytewise compared[?25l[?1c[1;1H[2L[2;1H[1m[34m~                                                                               [0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall LT('\xc3', '\xc3\x83')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall EQ('\xc3\xa3xYz', '\xc3\x83XyZ')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfor n in range(0x60, 0xFF) | call LT(printf('xYz\x%.2X', n-1), printf('XyZ\x%.
[24;80H2[25;1HX', n)) | endfor[?25l[?1c[1;1H[L[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cfor n in range(0x80, 0xBF) | call EQ(printf('xYz\xc2\x%.2XUvW', n), printf('Xy
[24;80HZ[25;1H\xc2\x%.2XuVw', n)) | endfor[?25l[?1c[1;1H[L[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cfor n in range(0xC0, 0xFF) | call LT(printf('xYz\xc2\x%.2XUvW', n), printf('Xy
[24;80HZ[25;1H\xc2\x%.2XuVw', n)) | endfor[?25l[?1c[1;1H[L[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall append(0, printf('%d checks passed', b:passed))[?25l[?1c[1;24r[1;1H[L[1;25r[1;1H3732 checks passed[25;1H[K[2;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c"[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test that g~ap changes one paragraph only.[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnew[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [0m[12;1H[1m[7m[No Name]                                                                       [0m[13;1H3732 checks passed[13;19H[K[14;1H[K[24;1H[7mtest82.in [+]                                                                   [1;1H[?25h[?0c[?25l[?1c[0mabcd[2;1H[K[3;1Hdefg[3;5H[K[12;11H[1m[7m[+][3;4H[?25h[?0c[1;1H[?25l[?1c[0mABCD[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet lns = getline(1,3)[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cq![?25l[?1c[1;1H3732 checks passed

[1m[34m~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [24;1H~                                                                               [2;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall append(line('$'), lns)[?25l[?1c[3;1HABCD[3;5H[K[4;1H[K[5;1Hdefg[5;5H[K[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwq! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 5 lines, 31 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test83.failed test.ok test.out X* viminfo
cp test83.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test83.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test83.in" 76 lines, 1265 characters[1;1HTests for tag search with !_TAG_FILE_ENCODING.

STARTTEST
:so mbyte.vim
:set enc=utf8
:if !has('iconv') || iconv("\x82\x60", "cp932", "utf-8") != "\uff21"
: e! test.ok
: w! test.out
: qa!
:endif

:/^text for tags1$/,/^text for tags1$/+1w! Xtags1.txt
:/^text for tags2$/,/^text for tags2$/+1w! Xtags2.txt
:/^text for tags3$/,/^text for tags3$/+1w! Xtags3.txt
:/^tags1$/+1,/^tags1-end$/-1w! Xtags1

ggdG

:call setline('.', 'Results of test83')

:" case1:
:new
:set tags=Xtags1
:let v:errmsg = ''[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for tag search with !_TAG_FILE_ENCODING.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 58 lines, 1013 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:tag abc50
:if v:errmsg =~ 'E426:' || getline('.') != 'ＡＢＣ'
: close
: put ='case3: failed'
:else
: close
: put ='case3: ok'
:endif
:close

:wq! test.out
ENDTEST

text for tags1
abcdefghijklmnopqrs

text for tags2
ＡＢＣ

text for tags3
ＡＢＣ

tags1
!_TAG_FILE_ENCODING     utf-8   //[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso mbyte.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset enc=utf8[?25l[?1c[27m[24m[0m[H[J[1;1H:tag abc50
:if v:errmsg =~ 'E426:' || getline('.') != 'ＡＢＣ'
: close
: put ='case3: failed'
:else
: close
: put ='case3: ok'
:endif
:close

:wq! test.out
ENDTEST

text for tags1
abcdefghijklmnopqrs

text for tags2
ＡＢＣ

text for tags3
ＡＢＣ

tags1
!_TAG_FILE_ENCODING     utf-8   //[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cif !has('iconv') || iconv("\x82\x60", "cp932", "utf-8") != "\uff21"[?25l[?1c
:  [?25h[?0c: e! test.ok
[?25l[?1c:  [?25h[?0c: w! test.out
[?25l[?1c:  [?25h[?0c: qa!
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[1;1H:tag abc50
:if v:errmsg =~ 'E426:' || getline('.') != 'ＡＢＣ'
: close
: put ='case3: failed'[25;1H[K[13;1H[?25h[?0c
[?25l[?1c[25;1H:[?25h[?0c/^text for tags1$/,/^text for tags1$/+1w! Xtags1.txt[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m[25;37H[K[25;1H"Xtags1.txt" [25;14H[K[25;14H[New File] 2 lines, 35 characters written[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^text for tags2$/,/^text for tags2$/+1w! Xtags2.txt[?25l[?1c"Xtags2.txt" [25;14H[K[25;14H[New File] 2 lines, 25 characters written[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^text for tags3$/,/^text for tags3$/+1w! Xtags3.txt[?25l[?1c"Xtags3.txt" [25;14H[K[25;14H[New File] 2 lines, 25 characters written[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^tags1$/+1,/^tags1-end$/-1w! Xtags1[?25l[?1c"Xtags1" [25;10H[K[25;10H[New File] 2 lines, 81 characters written[14;1H[?25h[?0c
[?25l[?1c[27m[24m[0m[H[J[1;1HTests for tag search with !_TAG_FILE_ENCODING.

STARTTEST
:so mbyte.vim
:set enc=utf8
:if !has('iconv') || iconv("\x82\x60", "cp932", "utf-8") != "\uff21"
: e! test.ok
: w! test.out
: qa!
:endif

:/^text for tags1$/,/^text for tags1$/+1w! Xtags1.txt
:/^text for tags2$/,/^text for tags2$/+1w! Xtags2.txt
:/^text for tags3$/,/^text for tags3$/+1w! Xtags3.txt
:/^tags1$/+1,/^tags1-end$/-1w! Xtags1

ggdG

:call setline('.', 'Results of test83')

:" case1:
:new
:set tags=Xtags1
:let v:errmsg = ''[1;1H[?25h[?0c[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [0m[25;1H--No lines in buffer--[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall setline('.', 'Results of test83')[?25l[?1c[1;1HResults of test83[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" case1:[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnew[?25l[?1c[1;1H[K[12;1H[1m[7m[No Name]                                                                       [0m[13;1HResults of test83[13;18H[K[24;1H[7mtest83.in [+]                                                                   [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset tags=Xtags1[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet v:errmsg = ''[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctag abcdefghijklmnopqrs[?25l[?1c"Xtags1.txt" [25;14H[K[25;14H2 lines, 35 characters[1;1Htext for tags1
abcdefghijklmnopqrs[2;20H[K[12;1H[1m[7mXtags1.txt[2;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cif v:errmsg =~ 'E426:' || getline('.') != 'abcdefghijklmnopqrs'[?25l[?1c
:  [?25h[?0c: close
[?25l[?1c:  [?25h[?0c: put ='case1: failed'
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c: close
[?25l[?1c:  [?25h[?0c: put ='case1: ok'
[?25l[?1c:  [?25h[?0c:endif[1;1H[6L[?25l[?1c[1;1HResults of test83
case1: ok
[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [24;1H~                                                                               [0m[25;1H[K[2;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c" case2:[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnew[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [0m[12;1H[1m[7m[No Name]                                                                       [0m[13;1HResults of test83[13;18H[K[14;1Hcase1: ok[14;10H[K[24;1H[7mtest83.in [+]                                                                   [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset tags=test83-tags2[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet v:errmsg = ''[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctag /.ＢＣ[?25l[?1c"Xtags2.txt" 2 lines, 25 characters[1;1Htext for tags2
ＡＢＣ[2;7H[K[12;1H[1m[7mXtags2.txt[2;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cif v:errmsg =~ 'E426:' || getline('.') != 'ＡＢＣ'[?25l[?1c
:  [?25h[?0c: close
[?25l[?1c:  [?25h[?0c: put ='case2: failed'
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c: close
[?25l[?1c:  [?25h[?0c: put ='case2: ok'
[?25l[?1c:  [?25h[?0c:endif[1;1H[6L[?25l[?1c[1;1HResults of test83
case1: ok
case2: ok
[1m[34m~                                                                               [5;1H~                                                                               [6;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [24;1H~                                                                               [0m[25;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c" case3:[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnew[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [0m[12;1H[1m[7m[No Name]                                                                       [0m[13;1Hcase1: ok[13;10H[K[14;1Hcase2: ok[14;10H[K[24;1H[7mtest83.in [+]                                                                   [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset tags=test83-tags3[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet v:errmsg = ''[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctag abc50[?25l[?1c"Xtags3.txt" 2 lines, 25 characters[1;1Htext for tags3
ＡＢＣ[2;7H[K[12;1H[1m[7mXtags3.txt[2;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cif v:errmsg =~ 'E426:' || getline('.') != 'ＡＢＣ'[?25l[?1c
:  [?25h[?0c: close
[?25l[?1c:  [?25h[?0c: put ='case3: failed'
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c: close
[?25l[?1c:  [?25h[?0c: put ='case3: ok'
[?25l[?1c:  [?25h[?0c:endif[1;1H[6L[?25l[?1c[1;1HResults of test83
case1: ok
case2: ok
case3: ok
[1m[34m~                                                                               [6;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [24;1H~                                                                               [0m[25;1H[K[4;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cclose[?25l[?1c[1m[37m[41mE37: No write since last change (add ! to override)[4;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cwq! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 4 lines, 48 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test84.failed test.ok test.out X* viminfo
cp test84.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test84.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test84.in" 35 lines, 786 characters[1;1HTests for curswant not changing when setting an option

STARTTEST
:so small.vim
:/^start target options$/+1,/^end target options$/-1 yank
:let target_option_names = split(@0)
:function TestCurswant(option_name)
:  normal! ggf8j
:  let curswant_before = winsaveview().curswant
:  execute 'let' '&'.a:option_name '=' '&'.a:option_name
:  let curswant_after = winsaveview().curswant
:  return [a:option_name, curswant_before, curswant_after]
:endfunction
:
:new
:put =['1234567890', '12345']
:1 delete _
:let result = []
:for option_name in target_option_names
:  call add(result, TestCurswant(option_name))
:endfor
:
:new
:put =map(copy(result), 'join(v:val, '' '')')[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for curswant not changing when setting an option[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 25 lines, 637 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[5M[1;25r[20;1H:1 delete _
:write test.out
:
:qall!
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^start target options$/+1,/^end target options$/-1 yank[?25l[?1c3 lines yanked[25;15H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet target_option_names = split(@0)[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunction TestCurswant(option_name)[?25l[?1c
:  [?25h[?0c:  normal! ggf8j
[?25l[?1c:  [?25h[?0c:  let curswant_before = winsaveview().curswant
[?25l[?1c:  [?25h[?0c:  execute 'let' '&'.a:option_name '=' '&'.a:option_name
[?25l[?1c:  [?25h[?0c:  let curswant_after = winsaveview().curswant
[?25l[?1c:  [?25h[?0c:  return [a:option_name, curswant_before, curswant_after]
[?25l[?1c:  [?25h[?0c:endfunction[1;1H[6L[?25l[?1c[1;1H:function TestCurswant(option_name)
:  normal! ggf8j
:  let curswant_before = winsaveview().curswant
:  execute 'let' '&'.a:option_name '=' '&'.a:option_name
:  let curswant_after = winsaveview().curswant
:  return [a:option_name, curswant_before, curswant_after][25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnew[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7m[No Name]                                                                       [0m[13;2H  call add(result, TestCurswant(option_name))
:endfor[14;9H[K[15;2H[K[16;2Hnew
:put =map(copy(result), 'join(v:val, '' '')')
:1 delete _[18;12H[K[19;2Hwrite test.out[20;2H[K[21;2Hqall!
ENDTEST[23;1H[K[24;1H[7mtest84.in                                                                       [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cput =['1234567890', '12345'][?25l[?1c[2;1H1234567890[2;11H[K[3;1H12345[3;6H[K[12;11H[1m[7m[+][3;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c1 delete _[?25l[?1c[1;11r[11;1H
[1;25r[11;1H[1m[34m~                                                                               [0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0clet result = [][?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfor option_name in target_option_names[?25l[?1c
:  [?25h[?0c:  call add(result, TestCurswant(option_name))
[?25l[?1c:  [?25h[?0c:endfor[1;1H[2L[?25l[?1c[1;1H1234567890
12345[25;1H[K[2;5H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c[?25l[?1c[2;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnew[?25l[?1c[27m[24m[0m[H[J[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [0m[8;1H[1m[7m[No Name]                                                                       [0m[9;1H1234567890
12345
[1m[34m~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [0m[16;1H[7m[No Name] [+]                                                                   [0m[17;1H:put =map(copy(result), 'join(v:val, '' '')')
:1 delete _
:write test.out
:
:qall!
ENDTEST

[7mtest84.in                                                                       [1;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0cput =map(copy(result), 'join(v:val, '' '')')[?25l[?1c3 more lines[25;13H[K[2;1Htabstop 7 4[2;12H[K[3;1Htimeoutlen 7 7[3;15H[K[4;1Httimeoutlen 7 7[4;16H[K[8;11H[1m[7m[+][4;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c1 delete _[?25l[?1c[1;7r[7;1H
[1;25r[7;1H[1m[34m~                                                                               [0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cwrite test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 3 lines, 43 characters written[8;1H[1m[7mtest.out     [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqall![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test85.failed test.ok test.out X* viminfo
cp test85.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test85.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test85.in" 85 lines, 1868 characters[1;1HTest for Lua interface and luaeval() function

STARTTEST
:so small.vim
:so lua.vim
:set nocompatible viminfo+=nviminfo
:lua l = vim.list():add"item0":add"dictionary with list OK":add"item2"
:lua h = vim.dict(); h.list = l
:call garbagecollect()
/^1
:" change buffer contents
:lua curbuf = vim.buffer()
:lua curline = vim.eval"line('.')"
:lua curbuf[curline] = "1 changed line 1"
:" scalar test
:let tmp_string = luaeval('"string"')
:let tmp_1000 = luaeval('1000')
:if printf("%s%.0f", tmp_string, tmp_1000) == "string1000"
:let scalar_res = "OK"
:else
:let scalar_res = "FAILED"
:endif
:call append(search("^1"), "scalar test " . scalar_res)
:" dictionary containing a list[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for Lua interface and luaeval() function[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 77 lines, 1775 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:let d = {}
:lua d = vim.eval("d")
:lua d[0] = 123
:lua d[1] = "abc"
:lua d[2] = vim.eval("[1, 2, 3]")
:lua d[3] = vim.eval("{'a':1, 'b':2, 'c':3}")
:lua d[4] = d[0]
:lua d[5] = d[1]
:lua d[6] = d[2]
:lua d[7] = d[3]
:lua d[3] = nil
:lua d[2] = nil
:lua d[1] = nil
:lua d[0] = nil
:lua d = nil
:$put =string(d)

:?^1?,$w! test.out
:qa!
ENDTEST

1 line 1
2 line 2
3 line 3[20;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[21;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[21;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso lua.vim[?25l[?1c"test.ok" [25;11H[K[25;11H7 lines, 206 characters
"test.out" [New File] 7 lines, 206 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test86.failed test.ok test.out X* viminfo
cp test86.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test86.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test86.in" 1430 lines, 37971 characters[1;1HTests for various python features.     vim: set ft=vim :

NOTE: This will cause errors when run under valgrind.
This would require recompiling Python with:
  ./configure --without-pymalloc
See http://svn.python.org/view/python/trunk/Misc/README.valgrind?view=markup

STARTTEST
:so small.vim
:set encoding=latin1
:set noswapfile
:if !has('python') | e! test.ok | wq! test.out | endif
:lang C
:fun Test()
:py import vim
:let l = []
:py l=vim.bindeval('l')
:py f=vim.bindeval('function("strlen")')
:" Extending List directly with different types
:py l.extend([1, "as'd", [1, 2, f, {'a': 1}]])
:$put =string(l)
:$put =string(l[-1])
:try
:  $put =string(l[-4])[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for various python features.     vim: set ft=vim :[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[8;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 1419 lines, 37678 characters written[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[9;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:[7Ccall setline(1, start)
:   endif
:   call Test()
:   if i == 0
:[7Clet result = getline(1, '$')
:   endif
:endfor
:if checkrefs
:   %d _
:   call setline(1, result)
:endif
:endfun
:"
:call RunTest()
:delfunction RunTest
:delfunction Test
:call garbagecollect(1)
:"
:/^start:/,$wq! test.out
:" vim: et ts=4 isk-=\:
:call getchar()
ENDTEST

start:[22;1H[?25h[?0c
[?25l[?1c

:so! Xdotest[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset encoding=latin1[?25l[?1c[27m[24m[0m[H[J[1;1H:[7Ccall setline(1, start)
:   endif
:   call Test()
:   if i == 0
:[7Clet result = getline(1, '$')
:   endif
:endfor
:if checkrefs
:   %d _
:   call setline(1, result)
:endif
:endfun
:"
:call RunTest()
:delfunction RunTest
:delfunction Test
:call garbagecollect(1)
:"
:/^start:/,$wq! test.out
:" vim: et ts=4 isk-=\:
:call getchar()
ENDTEST

start:[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0cset noswapfile[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif !has('python') | e! test.ok | wq! test.out | endif[?25l[?1c"test.ok" [25;11H[K[25;11H1266 lines, 58913 characters
"test.out" [New File] 1266 lines, 58913 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test87.failed test.ok test.out X* viminfo
cp test87.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test87.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test87.in" 1407 lines, 37468 characters[1;1HTests for various python features.     vim: set ft=vim :

STARTTEST
:so small.vim
:set noswapfile
:if !has('python3') | e! test.ok | wq! test.out | endif
:lang C
:fun Test()
:py3 import vim
:let l = []
:py3 l=vim.bindeval('l')
:py3 f=vim.bindeval('function("strlen")')
:" Extending List directly with different types
:py3 l+=[1, "as'd", [1, 2, f, {'a': 1}]]
:$put =string(l)
:$put =string(l[-1])
:try
:  $put =string(l[-4])
:catch
:  $put =v:exception[:13]
:endtry
:" List assignment
:py3 l[0]=0
:$put =string(l)[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for various python features.     vim: set ft=vim :[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 1401 lines, 37384 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:[7Ccall setline(1, start)
:   endif
:   call Test()
:   if i == 0
:[7Clet result = getline(1, '$')
:   endif
:endfor
:if checkrefs
:   %d _
:   call setline(1, result)
:endif
:endfun
:"
:call RunTest()
:delfunction RunTest
:delfunction Test
:call garbagecollect(1)
:"
:/^start:/,$wq! test.out
:" vim: et ts=4 isk-=\:
:call getchar()
ENDTEST

start:[22;1H[?25h[?0c
[?25l[?1c

:so! Xdotest[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset noswapfile[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif !has('python3') | e! test.ok | wq! test.out | endif[?25l[?1c"test.ok" [25;11H[K[25;11H1266 lines, 69116 characters
"test.out" [New File] 1266 lines, 69116 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test88.failed test.ok test.out X* viminfo
cp test88.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test88.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test88.in" 88 lines, 1352 characters[1;1Hvim: set ft=vim

Tests for correct display (cursor column position) with +conceal and
tabulators.

STARTTEST
:so small.vim
:if !has('conceal')
   e! test.ok
   wq! test.out
:endif
:" Conceal settings.
:set conceallevel=2
:set concealcursor=nc
:syntax match test /|/ conceal
:" Save current cursor position. Only works in <expr> mode, can't be used
:" with :normal because it moves the cursor to the command line. Thanks to ZyX
:" <zyx.vim@gmail.com> for the idea to use an <expr> mapping.
:let positions = []
:nnoremap <expr> GG ":let positions += ['".screenrow().":".screencol()."']\n"
:" Start test.
/^start:
:normal ztj
GGk[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1Hvim: set ft=vim[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[6;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 71 lines, 1119 characters written[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[7;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:normal W
GGk
:normal W
GGk
:normal $
GGk
:set lbr
:normal $
GGk
:" Display result.
:call append('$', 'end:')
:call append('$', positions)
:/^end/,$wq! test.out
ENDTEST

start:
.concealed.     text
|concealed|     text[20;9H.concealed.     text[21;9H|concealed|     text

.a.     .b.     .c.     .d.
|a|     |b|     |c|     |d|[14;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif !has('conceal')[?25l[?1c
:  [?25h[?0c   e! test.ok
[?25l[?1c"test.ok" 24 lines, 112 characters
:  [?25h[?0c   wq! test.out
[?25l[?1c"test.out" [New File] 24 lines, 112 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test89.failed test.ok test.out X* viminfo
cp test89.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test89.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test89.in" 71 lines, 1514 characters[1;1H- Some tests for setting 'number' and 'relativenumber'
  This is not all that useful now that the options are no longer reset when
  setting the other.
- Some tests for findfile() function

STARTTEST
:so small.vim
:set hidden nocp nu rnu viminfo+=nviminfo
:redir @a | set nu? rnu? | redir END
:e! xx
:redir @b | set nu? rnu? | redir END
:e! #
:$put ='results:'
:$put a
:$put b
:"
:set nonu nornu
:setglobal nu
:setlocal rnu
:redir @c | setglobal nu? | redir END
:set nonu nornu
:setglobal rnu
:setlocal nu
:redir @d | setglobal rnu? | redir END[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1H- Some tests for setting 'number' and 'relativenumber'[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[6;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 63 lines, 1305 characters written[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[7;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:redir @h | setglobal rnu? | redir END
:$put =':set MUST reset the other global value'
:$put g
:$put h
:"
:let cwd=getcwd()
:cd ..
:" Tests may be run from a shadow directory, so an extra cd needs to be done to
:" get above src/
:if fnamemodify(getcwd(), ':t') != 'src' | cd ../.. | else | cd .. | endif
:$put =''
:$put ='Testing findfile'
:$put =''
:set ssl
:$put =findfile('test19.in','src/test*')
:exe "cd" cwd
:cd ..
:$put =findfile('test19.in','test*')
:$put =findfile('test19.in','testdir')
:exe "cd" cwd
:/^results/,$w! test.out
:q!
ENDTEST[?25h[?0c
[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset hidden nocp nu rnu viminfo+=nviminfo[?25l[?1c[1;1H[1m[33m 22 [0m:$put =':set MUST reset the other global value'
[1m[33m 21 [0m:$put g[2;12H[K[3;1H[1m[33m 20 [0m:$put h
[1m[33m 19 [0m:"[4;7H[K[5;1H[1m[33m 18 [0m:let cwd=getcwd()
[1m[33m 17 [0m:cd ..[6;11H[K[7;1H[1m[33m 16 [0m:" Tests may be run from a shadow directory, so an extra cd needs to be done[8;1H[1m[33m    [0m to[8;8H[K[9;1H[1m[33m 15 [0m:" get above src/
[1m[33m 14 [0m:if fnamemodify(getcwd(), ':t') != 'src' | cd ../.. | else | cd .. | endif
[1m[33m 13 [0m:$put =''
[1m[33m 12 [0m:$put ='Testing findfile'
[1m[33m 11 [0m:$put =''
[1m[33m 10 [0m:set ssl
[1m[33m  9 [0m:$put =findfile('test19.in','src/test*')
[1m[33m  8 [0m:exe "cd" cwd
[1m[33m  7 [0m:cd ..
[1m[33m  6 [0m:$put =findfile('test19.in','test*')
[1m[33m  5 [0m:$put =findfile('test19.in','testdir')
[1m[33m  4 [0m:exe "cd" cwd
[1m[33m  3 [0m:/^results/,$w! test.out
[1m[33m  2 [0m:q!
[1m[33m  1 [0mENDTEST
[1m[33m71  [?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0credir @a | set nu? rnu? | redir END[?25l[?1c[25;1H[K[25;1H  number
  relativenumber
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ce! xx[?25l[?1c"xx" [New File][1;1H[2L[1;1H[1m[33m1   [0m
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [0m[25;3H[K[1;5H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0credir @b | set nu? rnu? | redir END[?25l[?1c[25;1H[K[25;1H  number
  relativenumber
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ce! #[?25l[?1c"test89.in" line 71 of 71 --100%-- col 1[1;1H[2L[1;1H[1m[33m 22 [0m:$put =':set MUST reset the other global value'
[1m[33m 21 [0m:$put g
[1m[33m 20 [0m:$put h[3;12H[K[4;1H[1m[33m 19 [0m:"[4;7H[K[5;1H[1m[33m 18 [0m:let cwd=getcwd()[5;22H[K[6;1H[1m[33m 17 [0m:cd ..[6;11H[K[7;1H[1m[33m 16 [0m:" Tests may be run from a shadow directory, so an extra cd needs to be done[8;1H[1m[33m    [0m to[8;8H[K[9;1H[1m[33m 15 [0m:" get above src/[9;22H[K[10;1H[1m[33m 14 [0m:if fnamemodify(getcwd(), ':t') != 'src' | cd ../.. | else | cd .. | endif[10;79H[K[11;1H[1m[33m 13 [0m:$put =''[11;14H[K[12;1H[1m[33m 12 [0m:$put ='Testing findfile'[12;30H[K[13;1H[1m[33m 11 [0m:$put =''[13;14H[K[14;1H[1m[33m 10 [0m:set ssl[14;13H[K[15;1H[1m[33m  9 [0m:$put =findfile('test19.in','src/test*')[15;45H[K[16;1H[1m[33m  8 [0m:exe "cd" cwd[16;18H[K[17;1H[1m[33m  7 [0m:cd ..[17;11H[K[18;1H[1m[33m  6 [0m:$put =findfile('test19.in','test*')[18;41H[K[19;1H[1m[33m  5 [0m:$put =findfile('test19.in','testdir')[19;43H[K[20;1H[1m[33m  4 [0m:exe "cd" cwd[20;18H[K[21;1H[1m[33m  3 [0m:/^results/,$w! test.out[21;29H[K[22;1H[1m[33m  2 [0m:q![22;8H[K[23;1H[1m[33m  1 [0mENDTEST[23;12H[K[24;1H[1m[33m71  [0m[24;5H[K[25;3H[K[25;1H"test89.in" line 71 of 71 --100%-- col 1[24;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put ='results:'[?25l[?1c[1;24r[24;1H
[1;25r[1;3H[1m[33m2
 21
 20
 19
 18
 17

 16
 15
 14
 13
 12
 11
 10
  9
  8
  7
  6
  5
  4
  3
  2
  1
72  [0mresults:[25;1H[K[24;5H[?25h[?0c[?25l[?1c
:[?25h[?0c$put a[?25l[?1c3 more lines[1;24r[1;1H[3M[1;25r[1;2H[1m[33m22
 21
 20

 19
 18
 17
 16
 15
 14
 13
 12
 11
 10
  9
  8
  7
  6
  5
  4
  3
  2 
  1 [0m  number
[1m[33m75  [0m  relativenumber[25;1H[K[25;1H3 more lines[24;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put b[?25l[?1c3 more lines[1;24r[1;1H[4M[1;25r[1;2H[1m[33m22
 21
 20
 19
 18
 17
 16
 15
 14
 13
 12
 11
 10
  9
  8
  7
  6
  5
  4
  3
  2 
  1 [0m  number
[1m[33m78  [0m  relativenumber
[1m[34m~                                                                               [0m[25;1H[K[25;1H3 more lines[23;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[23;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nonu nornu[?25l[?1c[1;1H:" get above src/[1;18H[K[2;1H:if fnamemodify(getcwd(), ':t') != 'src' | cd ../.. | else | cd .. | endif[2;75H[K[3;1H:$put =''[3;11H[K[4;1H:$put ='Testing findfile'[4;26H[K[5;1H:$put =''[5;11H[K[6;1H:set ssl[6;10H[K[7;1H:$put =findfile('test19.in','src/test*')[7;41H[K[8;1H:exe "cd" cwd[8;15H[K[9;1H:cd ..[9;7H[K[10;1H:$put =findfile('test19.in','test*')[10;37H[K[11;1H:$put =findfile('test19.in','testdir')[11;39H[K[12;1H:exe "cd" cwd[12;15H[K[13;1H:/^results/,$w! test.ou[13;25H[K[14;1H:q![14;4H[K[15;1HENDTEST[15;8H[K[16;1H[K[17;1Hresults:[17;9H[K[18;1H[K[19;1H  number[19;9H[K[20;1H  relativenumber[20;17H[K[21;1H[K[22;1H  number[22;9H[K[23;1H  relativenumber[23;17H[K[23;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csetglobal nu[?25l[?1c[23;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csetlocal rnu[?25l[?1c[1;1H[1m[33m 22 [0m:" get above src/
[1m[33m 21 [0m:if fnamemodify(getcwd(), ':t') != 'src' | cd ../.. | else | cd .. | endif
[1m[33m 20 [0m:$put =''
[1m[33m 19 [0m:$put ='Testing findfile'
[1m[33m 18 [0m:$put =''
[1m[33m 17 [0m:set ssl
[1m[33m 16 [0m:$put =findfile('test19.in','src/test*')
[1m[33m 15 [0m:exe "cd" cwd
[1m[33m 14 [0m:cd ..
[1m[33m 13 [0m:$put =findfile('test19.in','test*')
[1m[33m 12 [0m:$put =findfile('test19.in','testdir')
[1m[33m 11 [0m:exe "cd" cwd
[1m[33m 10 [0m:/^results/,$w! test.out
[1m[33m  9 [0m:q!
[1m[33m  8 [0mENDTEST
[1m[33m  7 
  6 [0mresults:
[1m[33m  5 
  4 [0m  number
[1m[33m  3 [0m  relativenumber
[1m[33m  2 
  1 [0m  number
[1m[33m  0 [0m  relativenumber[23;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir @c | setglobal nu? | redir END[?25l[?1c[25;1H[K[25;1H  number[23;7H[?25h[?0c[?25l[?1c[25;3H[K[25;1H:[?25h[?0cset nonu nornu[?25l[?1c[1;1H:" get above src/[1;18H[K[2;1H:if fnamemodify(getcwd(), ':t') != 'src' | cd ../.. | else | cd .. | endif[2;75H[K[3;1H:$put =''[3;11H[K[4;1H:$put ='Testing findfile'[4;26H[K[5;1H:$put =''[5;11H[K[6;1H:set ssl[6;10H[K[7;1H:$put =findfile('test19.in','src/test*')[7;41H[K[8;1H:exe "cd" cwd[8;15H[K[9;1H:cd ..[9;7H[K[10;1H:$put =findfile('test19.in','test*')[10;37H[K[11;1H:$put =findfile('test19.in','testdir')[11;39H[K[12;1H:exe "cd" cwd[12;15H[K[13;1H:/^results/,$w! test.ou[13;25H[K[14;1H:q![14;4H[K[15;1HENDTEST[15;8H[K[16;1H[K[17;1Hresults:[17;9H[K[18;1H[K[19;1H  number[19;9H[K[20;1H  relativenumber[20;17H[K[21;1H[K[22;1H  number[22;9H[K[23;1H  relativenumber[23;17H[K[23;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csetglobal rnu[?25l[?1c[23;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csetlocal nu[?25l[?1c[1;1H[1m[33m 56 [0m:" get above src/
[1m[33m 57 [0m:if fnamemodify(getcwd(), ':t') != 'src' | cd ../.. | else | cd .. | endif
[1m[33m 58 [0m:$put =''
[1m[33m 59 [0m:$put ='Testing findfile'
[1m[33m 60 [0m:$put =''
[1m[33m 61 [0m:set ssl
[1m[33m 62 [0m:$put =findfile('test19.in','src/test*')
[1m[33m 63 [0m:exe "cd" cwd
[1m[33m 64 [0m:cd ..
[1m[33m 65 [0m:$put =findfile('test19.in','test*')
[1m[33m 66 [0m:$put =findfile('test19.in','testdir')
[1m[33m 67 [0m:exe "cd" cwd
[1m[33m 68 [0m:/^results/,$w! test.out
[1m[33m 69 [0m:q!
[1m[33m 70 [0mENDTEST
[1m[33m 71 
 72 [0mresults:
[1m[33m 73 
 74 [0m  number
[1m[33m 75 [0m  relativenumber
[1m[33m 76 
 77 [0m  number
[1m[33m 78 [0m  relativenumber[23;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir @d | setglobal rnu? | redir END[?25l[?1c[25;1H[K[25;1H  relativenumber[23;7H[?25h[?0c[?25l[?1c[25;3H[K[25;1H:[?25h[?0c$put =':setlocal must NOT reset the other global value'[?25l[?1c[24;1H[1m[33m 79 [0m:setlocal must NOT reset the other global value[24;52H[K[24;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put c[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1H[1m[33m 80 
 81 [0m  number[25;1H[K[24;7H[?25h[?0c[?25l[?1c
:[?25h[?0c$put d[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1H[1m[33m 82 
 83 [0m  relativenumber[25;1H[K[24;7H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nonu nornu[?25l[?1c[1;1H:$put =''[1;11H[K[2;1H:set ssl[2;10H[K[3;1H:$put =findfile('test19.in','src/test*')[3;41H[K[4;1H:exe "cd" cwd[4;15H[K[5;1H:cd ..[5;7H[K[6;1H:$put =findfile('test19.in','test*')[6;37H[K[7;1H:$put =findfile('test19.in','testdir')[7;39H[K[8;1H:exe "cd" cwd[8;15H[K[9;1H:/^results/,$w! test.ou[9;25H[K[10;1H:q![10;4H[K[11;1HENDTEST[11;8H[K[12;1H[K[13;1Hresults:[13;9H[K[14;1H[K[15;1H  number[15;9H[K[16;1H  relativenumber[16;17H[K[17;1H[K[18;1H  number[18;9H[K[19;1H  relativenumber[19;17H[K[20;1H:setlocal must NOT reset the other global value[20;48H[K[21;1H[K[22;1H  number[22;9H[K[23;1H[K[24;1H  relativenumber[24;17H[K[24;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csetglobal nu[?25l[?1c[24;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csetglobal rnu[?25l[?1c[24;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir @e | setglobal nu? | redir END[?25l[?1c[25;1H[K[25;1H  number[24;3H[?25h[?0c[?25l[?1c[25;3H[K[25;1H:[?25h[?0cset nonu nornu[?25l[?1c[24;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csetglobal rnu[?25l[?1c[24;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csetglobal nu[?25l[?1c[24;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir @f | setglobal rnu? | redir END[?25l[?1c[25;1H[K[25;1H  relativenumber[24;3H[?25h[?0c[?25l[?1c[25;3H[K[25;1H:[?25h[?0c$put =':setglobal MUST reset the other global value'[?25l[?1c[1;24r[24;1H
[1;25r[24;1H:setglobal MUST reset the other global value[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put e[?25l[?1c[1;24r[1;1H[2M[1;25r[24;3Hnumber[25;1H[K[24;3H[?25h[?0c[?25l[?1c
:[?25h[?0c$put f[?25l[?1c[1;24r[1;1H[2M[1;25r[24;3Hrelativenumber[25;1H[K[24;3H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nonu nornu[?25l[?1c[24;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nu[?25l[?1c[1;1H[1m[33m 65 [0m:$put =findfile('test19.in','test*')
[1m[33m 66 [0m:$put =findfile('test19.in','testdir')
[1m[33m 67 [0m:exe "cd" cwd
[1m[33m 68 [0m:/^results/,$w! test.out
[1m[33m 69 [0m:q!
[1m[33m 70 [0mENDTEST
[1m[33m 71 
 72 [0mresults:
[1m[33m 73 
 74 [0m  number
[1m[33m 75 [0m  relativenumber
[1m[33m 76 
 77 [0m  number
[1m[33m 78 [0m  relativenumber
[1m[33m 79 [0m:setlocal must NOT reset the other global value
[1m[33m 80 
 81 [0m  number
[1m[33m 82 
 83 [0m  relativenumber
[1m[33m 84 [0m:setglobal MUST reset the other global value
[1m[33m 85 
 86 [0m  number
[1m[33m 87 
 88 [0m  relativenumber[24;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset rnu[?25l[?1c[1;2H[1m[33m23
 22
 21
 20
 1
 18
 17
 16
 15
 1
 13
 12
 11
 10
  
  8
  7
  6
  5
  
  3
  2
  1
88  [0m  [?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir @g | setglobal nu? | redir END[?25l[?1c[25;1H[K[25;1H  number[24;7H[?25h[?0c[?25l[?1c[25;3H[K[25;1H:[?25h[?0cset nonu nornu[?25l[?1c[1;1H:$put =findfile('test19.in','test*')[1;37H[K[2;1H:$put =findfile('test19.in','testdir')[2;39H[K[3;1H:exe "cd" cwd[3;15H[K[4;1H:/^results/,$w! test.ou[4;25H[K[5;1H:q![5;4H[K[6;1HENDTEST[6;8H[K[7;1H[K[8;1Hresults:[8;9H[K[9;1H[K[10;1H  number[10;9H[K[11;1H  relativenumber[11;17H[K[12;1H[K[13;1H  number[13;9H[K[14;1H  relativenumber[14;17H[K[15;1H:setlocal must NOT reset the other global value[15;48H[K[16;1H[K[17;1H  number[17;9H[K[18;1H[K[19;1H  relativenumber[19;17H[K[20;1H:setglobal MUST reset the other global value[20;45H[K[21;1H[K[22;1H  number[22;9H[K[23;1H[K[24;1H  relativenumber[24;17H[K[24;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset rnu[?25l[?1c[1;1H[1m[33m 23 [0m:$put =findfile('test19.in','test*')
[1m[33m 22 [0m:$put =findfile('test19.in','testdir')
[1m[33m 21 [0m:exe "cd" cwd
[1m[33m 20 [0m:/^results/,$w! test.out
[1m[33m 19 [0m:q!
[1m[33m 18 [0mENDTEST
[1m[33m 17 
 16 [0mresults:
[1m[33m 15 
 14 [0m  number
[1m[33m 13 [0m  relativenumber
[1m[33m 12 
 11 [0m  number
[1m[33m 10 [0m  relativenumber
[1m[33m  9 [0m:setlocal must NOT reset the other global value
[1m[33m  8 
  7 [0m  number
[1m[33m  6 
  5 [0m  relativenumber
[1m[33m  4 [0m:setglobal MUST reset the other global value
[1m[33m  3 
  2 [0m  number
[1m[33m  1 
  0 [0m  relativenumber[24;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nu[?25l[?1c[24;1H[1m[33m88  [0m  [?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir @h | setglobal rnu? | redir END[?25l[?1c[25;1H[K[25;1H  relativenumber[24;7H[?25h[?0c[?25l[?1c[25;3H[K[25;1H:[?25h[?0c$put =':set MUST reset the other global value'[?25l[?1c[1;24r[24;1H
[1;25r[1;3H[1m[33m3
 22
 21
 20
 19
 18
 17
 16
 15
 14
 13
 12
 11
 10
  9
  8
  7
  6
  5
  4
  3
  2
  1
89  [0m:set MUST reset the other global value[25;1H[K[24;5H[?25h[?0c[?25l[?1c
:[?25h[?0c$put g[?25l[?1c[1;24r[1;1H[2M[1;25r[1;3H[1m[33m3
 22
 21
 20
 19
 18
 17
 16
 15
 14
 13
 12
 11
 10
  9
  8
  7
  6
  5
  4
  3
  2
  1 
91  [0m  number[25;1H[K[24;7H[?25h[?0c[?25l[?1c
:[?25h[?0c$put h[?25l[?1c[1;24r[1;1H[2M[1;25r[1;3H[1m[33m3
 22
 21
 20
 19
 18
 17
 16
 15
 14
 13
 12
 11
 10
  9
  8
  7
  6
  5
  4
  3
  2
  1 
93  [0m  relativenumber[25;1H[K[24;7H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet cwd=getcwd()[?25l[?1c[24;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccd ..[?25l[?1c/sources/vim74/src[24;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Tests may be run from a shadow directory, so an extra cd needs to be done to[?25l[?1c[24;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" get above src/[?25l[?1c[24;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif fnamemodify(getcwd(), ':t') != 'src' | cd ../.. | else | cd .. | endif[?25l[?1c/sources/vim74[25;15H[K[24;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =''[?25l[?1c[1;24r[24;1H
[1;25r[1;3H[1m[33m3
 22
 21
 20
 19
 18
 17
 16
 15
 14
 13
 12
 11
 10
  9
  8
  7
  6
  5
  4
  3
  2
  1
94  [0m[25;1H[K[24;5H[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='Testing findfile'[?25l[?1c[1;24r[24;1H
[1;25r[1;3H[1m[33m3
 22
 21
 20
 19
 18
 17
 16
 15
 14
 13
 12
 11
 10
  9
  8
  7
  6
  5
  4
  3
  2
  1
95  [0mTesting findfile[25;1H[K[24;5H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =''[?25l[?1c[1;24r[24;1H
[1;25r[1;3H[1m[33m3
 22
 21
 20
 19
 18
 17
 16
 15
 14
 13
 12
 11
 10
  9
  8
  7
  6
  5
  4
  3
  2
  1
96  [0m[25;1H[K[24;5H[?25h[?0c[?25l[?1c
:[?25h[?0cset ssl[?25l[?1c[24;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =findfile('test19.in','src/test*')[?25l[?1c[1;24r[24;1H
[1;25r[1;3H[1m[33m3
 22
 21
 20
 19
 18
 17
 16
 15
 14
 13
 12
 11
 10
  9
  8
  7
  6
  5
  4
  3
  2
  1
97  [0msrc/testdir/test19.in[25;1H[K[24;5H[?25h[?0c[?25l[?1c
:[?25h[?0cexe "cd" cwd[?25l[?1c/sources/vim74/src/testdir[24;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccd ..[?25l[?1c/sources/vim74/src[24;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =findfile('test19.in','test*')[?25l[?1c[1;24r[24;1H
[1;25r[1;3H[1m[33m3
 22
 21
 20
 19
 18
 17
 16
 15
 14
 13
 12
 11
 10
  9
  8
  7
  6
  5
  4
  3
  2
  1
98  [0mtestdir/test19.in[25;1H[K[24;5H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =findfile('test19.in','testdir')[?25l[?1c[1;24r[24;1H
[1;25r[1;3H[1m[33m3
 22
 21
 20
 19
 18
 17
 16
 15
 14
 13
 12
 11
 10
  9
  8
  7
  6
  5
  4
  3
  2
  1
99  [0mtestdir/test19.in[25;1H[K[24;5H[?25h[?0c[?25l[?1c
:[?25h[?0cexe "cd" cwd[?25l[?1c/sources/vim74/src/testdir[24;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^results/,$w! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New] 28L, 356C written[24;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cq![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test90.failed test.ok test.out X* viminfo
cp test90.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test90.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test90.in" 53 lines, 1203 characters[1;1HTests for sha256() function.    vim: set ft=vim et ts=2 sw=2 :

STARTTEST
:so small.vim
:if !has('cryptv') || !exists('*sha256')
   e! test.ok
   wq! test.out
:endif
:"
:let testcase='test for empty string: '
:if sha256("") ==# 'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852[12;1Hb855'
: let res='ok'
:else
: let res='ng'
:endif
:$put =testcase.res
:"
:let testcase='test for 1 char: '
:if sha256("a") ==# 'ca978112ca1bbdcafac231b39a23dc4da786eff8147c4e72b9807785afe[21;1He48bb'
: let res='ok'
:else
: let res='ng'[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for sha256() function.    vim: set ft=vim et ts=2 sw=2 :[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 47 lines, 1113 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:$put =testcase.res
:"
:let testcase='test for contains meta char: '
:if sha256("foo\nbar") ==# '807eff6267f3f926a21d234f7b0cf867a86f47e07a532f15e8cc[5;1H39ed110ca776'
: let res='ok'
:else
: let res='ng'
:endif
:$put =testcase.res
:"
:let testcase='test for contains non-ascii char: '
:if sha256("\xde\xad\xbe\xef") ==# '5f78c33274e43fa9de5659265c1d917e25c03722dcb0[14;1Hb8d27db8d5feaa813953'
: let res='ok'
:else
: let res='ng'
:endif
:$put =testcase.res
"
:/^start:/,$wq! test.out
ENDTEST

start:[22;1H[?25h[?0c
[?25l[?1c

:so! Xdotest[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif !has('cryptv') || !exists('*sha256')[?25l[?1c
:  [?25h[?0c   e! test.ok
[?25l[?1c:  [?25h[?0c   wq! test.out
[?25l[?1c:  [?25h[?0c:endif[1;1H[3L[?25l[?1c[1;1H:$put =testcase.res
:"
:let testcase='test for contains meta char: '[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0c"[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet testcase='test for empty string: '[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif sha256("") ==# 'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b785
[24;80H2[25;1Hb855'[?25l[?1c[25;1H[K[25;1H:  [?25h[?0c: let res='ok'
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c: let res='ng'
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[1;1H:$put =testcase.res
:"
:let testcase='test for contains meta char: '
:if sha256("foo\nbar") ==# '807eff6267f3f926a21d234f7b0cf867a86f47e07a532f15e8cc[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0c$put =testcase.res[?25l[?1c[1;24r[24;1H
[1;25r[24;1Htest for empty string: ok[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet testcase='test for 1 char: '[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif sha256("a") ==# 'ca978112ca1bbdcafac231b39a23dc4da786eff8147c4e72b9807785af
[24;80He[25;1He48bb'[?25l[?1c[25;1H[K[25;1H:  [?25h[?0c: let res='ok'
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c: let res='ng'
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[1;1H:"
:let testcase='test for contains meta char: '
:if sha256("foo\nbar") ==# '807eff6267f3f926a21d234f7b0cf867a86f47e07a532f15e8cc[4;1H39ed110ca776'[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =testcase.res[?25l[?1c[1;24r[24;1H
[1;25r[24;1Htest for 1 char: ok[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet testcase='test for 3 chars: '[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif sha256("abc") ==# 'ba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61
[24;80Hf[25;1H20015ad'[?25l[?1c[25;1H[K[25;1H:  [?25h[?0c: let res='ok'
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c: let res='ng'
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[1;1H:let testcase='test for contains meta char: '
:if sha256("foo\nbar") ==# '807eff6267f3f926a21d234f7b0cf867a86f47e07a532f15e8cc[3;1H39ed110ca776'
: let res='ok'[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =testcase.res[?25l[?1c[1;24r[24;1H
[1;25r[24;1Htest for 3 chars: ok[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet testcase='test for contains meta char: '[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif sha256("foo\nbar") ==# '807eff6267f3f926a21d234f7b0cf867a86f47e07a532f15e8c
[24;80Hc[25;1H39ed110ca776'[?25l[?1c[25;1H[K[25;1H:  [?25h[?0c: let res='ok'
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c: let res='ng'
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[1;1H:if sha256("foo\nbar") ==# '807eff6267f3f926a21d234f7b0cf867a86f47e07a532f15e8cc[2;1H39ed110ca776'
: let res='ok'
:else[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =testcase.res[?25l[?1c[1;24r[1;1H[2M[1;25r[23;1Htest for contains meta char: ok
[1m[34m~                                                                               [0m[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0c"[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet testcase='test for contains non-ascii char: '[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif sha256("\xde\xad\xbe\xef") ==# '5f78c33274e43fa9de5659265c1d917e25c03722dcb
[24;80H0[25;1Hb8d27db8d5feaa813953'[?25l[?1c[25;1H[K[25;1H:  [?25h[?0c: let res='ok'
[?25l[?1c:  [?25h[?0c:else
[?25l[?1c:  [?25h[?0c: let res='ng'
[?25l[?1c:  [?25h[?0c:endif[1;1H[4L[?25l[?1c[1;1H: let res='ok'
:else
: let res='ng'
:endif[25;1H[K[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0c$put =testcase.res[?25l[?1c[24;1Htest for contains non-ascii char: ok[24;37H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^start:/,$wq! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 6 lines, 143 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test91.failed test.ok test.out X* viminfo
cp test91.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test91.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test91.in" 111 lines, 3044 characters[1;1HTests for getbufvar(), getwinvar(), gettabvar() and gettabwinvar().
vim: set ft=vim :

STARTTEST
:so small.vim
:so mbyte.vim
:"
:" Test for getbufvar()
:" Use strings to test for memory leaks.
:let b:var_num = '1234'
:let def_num = '5678'
:$put =string(getbufvar(1, 'var_num'))
:$put =string(getbufvar(1, 'var_num', def_num))
:$put =string(getbufvar(1, ''))
:$put =string(getbufvar(1, '', def_num))
:unlet b:var_num
:$put =string(getbufvar(1, 'var_num', def_num))
:$put =string(getbufvar(1, ''))
:$put =string(getbufvar(1, '', def_num))
:$put =string(getbufvar(9, ''))
:$put =string(getbufvar(9, '', def_num))
:unlet def_num
:$put =string(getbufvar(1, '&autoindent'))
:$put =string(getbufvar(1, '&autoindent', 1))[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for getbufvar(), getwinvar(), gettabvar() and gettabwinvar().[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[4;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 104 lines, 2931 characters written[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:$put =string(gettabwinvar(2, 3, 'var_dict'))
:$put =string(gettabwinvar(2, 3, 'var_dict', def_dict))
:$put =string(gettabwinvar(2, 3, ''))
:$put =string(gettabwinvar(2, 3, '', def_dict))
:tabnext
:3wincmd w
:unlet w:var_dict
:tabrewind
:$put =string(gettabwinvar(2, 3, 'var_dict', def_dict))
:$put =string(gettabwinvar(2, 3, ''))
:$put =string(gettabwinvar(2, 3, '', def_dict))
:$put =string(gettabwinvar(2, 9, ''))
:$put =string(gettabwinvar(2, 9, '', def_dict))
:$put =string(gettabwinvar(9, 3, ''))
:$put =string(gettabwinvar(9, 3, '', def_dict))
:unlet def_dict
:$put =string(gettabwinvar(2, 3, '&nux'))
:$put =string(gettabwinvar(2, 3, '&nux', 1))
:tabonly
:"
:/^start/,$wq! test.out
ENDTEST

start:[22;1H[?25h[?0c
[?25l[?1c

:so! Xdotest[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso mbyte.vim[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test for getbufvar()[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Use strings to test for memory leaks.[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet b:var_num = '1234'[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet def_num = '5678'[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =string(getbufvar(1, 'var_num'))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H'1234'[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(getbufvar(1, 'var_num', def_num))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H'1234'[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(getbufvar(1, ''))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H{'var_num': '1234'}[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(getbufvar(1, '', def_num))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H{'var_num': '1234'}[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cunlet b:var_num[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =string(getbufvar(1, 'var_num', def_num))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H'5678'[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(getbufvar(1, ''))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H{}[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(getbufvar(1, '', def_num))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H{}[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(getbufvar(9, ''))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H''[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(getbufvar(9, '', def_num))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H'5678'[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cunlet def_num[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =string(getbufvar(1, '&autoindent'))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(getbufvar(1, '&autoindent', 1))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Open new window with forced option values[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset fileformats=unix,dos[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnew ++ff=dos ++bin ++enc=iso-8859-2[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7m[No Name]                                                                       [0m[13;1H'1234'

{'var_num': '1234'}

'5678'[17;7H[K[18;1H{}[18;3H[K[20;1H''
'5678'
0[22;2H[K[24;1H[7mtest91.in [+]                                                                   [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet otherff = getbufvar(bufnr('%'), '&fileformat')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet otherbin = getbufvar(bufnr('%'), '&bin')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet otherfenc = getbufvar(bufnr('%'), '&fenc')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cclose[?25l[?1c[1;1H:$put =string(gettabwinvar(2, 9, ''))
:$put =string(gettabwinvar(2, 9, '', def_dict))[2;48H[K[3;1H:$put =string(gettabwinvar(9, 3, ''))[3;38H[K[4;1H:$put =string(gettabwinvar(9, 3, '', def_dict))[4;48H[K[5;1H:unlet def_dict[5;16H[K[6;1H:$put =string(gettabwinvar(2, 3, '&nux'))[6;42H[K[7;1H:$put =string(gettabwinvar(2, 3, '&nux', 1))[7;45H[K[8;1H:tabonly[8;9H[K[9;1H:"[9;3H[K[10;1H:/^start/,$wq! test.out[10;24H[K[11;1HENDTEST[11;8H[K[12;1H[K[13;1Hstart:

'1234'[15;7H[K[17;1H{'var_num': '1234'}
'5678'

{}
''[21;3H[K[22;1H'5678'

0[24;2H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =otherff[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hdos[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(otherbin)[?25l[?1c[1;24r[24;1H
[1;25r[24;1H1[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =otherfenc[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hiso-8859-2[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cunlet otherff otherbin otherfenc[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test for getwinvar()[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet w:var_str = "Dance"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet def_str = "Chance"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =string(getwinvar(1, 'var_str'))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H'Dance'[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(getwinvar(1, 'var_str', def_str))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H'Dance'[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(getwinvar(1, ''))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H{'var_str': 'Dance'}[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(getwinvar(1, '', def_str))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H{'var_str': 'Dance'}[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cunlet w:var_str[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =string(getwinvar(1, 'var_str', def_str))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H'Chance'[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(getwinvar(1, ''))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H{}[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(getwinvar(1, '', def_str))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H{}[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(getwinvar(9, ''))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H''[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(getwinvar(9, '', def_str))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H'Chance'[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(getwinvar(1, '&nu'))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(getwinvar(1, '&nu',  1))[?25l[?1c[1;24r[24;1H
[1;25r[24;1H0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cunlet def_str[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test for gettabvar()[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctabnew[?25l[?1c[27m[24m[0m[H[J[1;1H[1m[4m[37m[40m + test91.in [24m[0m[1m [No Name] [0m[7m                                                        [0m[1;80H[1m[4m[37m[40mX[24m[0m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0ctabnew[?25l[?1c[27m[24m[0m[H[J[1;1H[1m[4m[37m[40m + test91.in  [No Name] [24m[0m[1m [No Name] [0m[7m                                             [0m[1;80H[1m[4m[37m[40mX[24m[0m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0clet t:var_list = [1, 2, 3][?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet def_list = [4, 5, 6, 7][?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctabrewind[?25l[?1c[27m[24m[0m[H[J[1;1H[1m + test91.in [0m[1m[4m[37m[40m [No Name]  [No Name] [24m[0m[7m                                             [0m[1;80H[1m[4m[37m[40mX[24m[0m[2;1H{'var_num': '1234'}
{'var_num': '1234'}
'5678'
{}
{}
''
'5678'
0
0
dos
1
iso-8859-2
'Dance'
'Dance'
{'var_str': 'Dance'}
{'var_str': 'Dance'}
'Chance'
{}
{}
''
'Chance'
0
0[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(gettabvar(3, 'var_list'))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H[1, 2, 3][25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(gettabvar(3, 'var_list', def_list))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H[1, 2, 3][25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(gettabvar(3, ''))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H''[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(gettabvar(3, '', def_list))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H[4, 5, 6, 7][25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0ctablast[?25l[?1c[27m[24m[0m[H[J[1;1H[1m[4m[37m[40m + test91.in  [No Name] [24m[0m[1m [No Name] [0m[7m                                             [0m[1;80H[1m[4m[37m[40mX[24m[0m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0cunlet t:var_list[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctabrewind[?25l[?1c[27m[24m[0m[H[J[1;1H[1m + test91.in [0m[1m[4m[37m[40m [No Name]  [No Name] [24m[0m[7m                                             [0m[1;80H[1m[4m[37m[40mX[24m[0m[2;1H{}
''
'5678'
0
0
dos
1
iso-8859-2
'Dance'
'Dance'
{'var_str': 'Dance'}
{'var_str': 'Dance'}
'Chance'
{}
{}
''
'Chance'
0
0
[1, 2, 3]
[1, 2, 3]
''
[4, 5, 6, 7][?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(gettabvar(3, 'var_list', def_list))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H[4, 5, 6, 7][25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(gettabvar(9, ''))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H''[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(gettabvar(9, '', def_list))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H[4, 5, 6, 7][25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(gettabvar(3, '&nu'))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H''[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(gettabvar(3, '&nu', def_list))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H[4, 5, 6, 7][25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cunlet def_list[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctabonly[?25l[?1c[1;1H0[1;2H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" test for gettabwinvar()[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctabnew[?25l[?1c[27m[24m[0m[H[J[1;1H[1m[4m[37m[40m + test91.in [24m[0m[1m [No Name] [0m[7m                                                        [0m[1;80H[1m[4m[37m[40mX[24m[0m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0ctabnew[?25l[?1c[27m[24m[0m[H[J[1;1H[1m[4m[37m[40m + test91.in  [No Name] [24m[0m[1m [No Name] [0m[7m                                             [0m[1;80H[1m[4m[37m[40mX[24m[0m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0ctabprev[?25l[?1c[27m[24m[0m[H[J[1;1H[1m[4m[37m[40m + test91.in [24m[0m[1m [No Name] [0m[1m[4m[37m[40m [No Name] [24m[0m[7m                                             [0m[1;80H[1m[4m[37m[40mX[24m[0m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [2;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0csplit[?25l[?1c[1;15H[1m[35m2[0m[1m [No Name] [0m[1m[4m[37m[40m [No Name] [24m[0m[42C[7m [0m[1;80H[1m[4m[37m[40mX[24m[0m[13;1H[1m[7m[No Name]                                                                       [0m[14;1H[K[24;1H[7m[No Name]                                                                       [2;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1H[1m[4m[37m[40m + test91.in [24m[0m[1m [0m[1m[35m3[0m[1m [No Name] [0m[1m[4m[37m[40m [No Name] [24m[0m[7m                                           [0m[1;80H[1m[4m[37m[40mX[24m[0m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [0m[9;1H[1m[7m[No Name]                                                                       [0m[11;1H[1m[34m~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [0m[17;1H[7m[No Name]                                                                       [0m[19;1H[1m[34m~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [0m[24;1H[7m[No Name]                                                                       [2;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0cwincmd w[?25l[?1c[9;1H[7m[No Name]                                                                       [0m[17;1H[1m[7m[No Name]                                                                       [0m[1;80H[7m [0m[1;80H[1m[4m[37m[40mX[10;1H[?25h[?0c[?25l[?1c[24m[0m[25;1H[K[25;1H:[?25h[?0cvert split[?25l[?1c[1;15H[1m[35m4[0m[64C[7m [0m[1;80H[1m[4m[37m[40mX[24m[0m[10;41H[7m|[11;41H|[12;41H|[13;41H|[14;41H|[15;41H|[16;41H|[0m[11;42H[1m[34m~[12;42H~[13;42H~[14;42H~[15;42H~[16;42H~[0m[17;42H[7m[No Name]                              [10;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cwincmd w[?25l[?1c[17;1H[7m[No Name]                                [0m[1m[7m[No Name]                              [0m[1;80H[7m [0m[1;80H[1m[4m[37m[40mX[10;42H[?25h[?0c[?25l[?1c[24m[0m[25;1H[K[25;1H:[?25h[?0clet w:var_dict = {'dict': 'tabwin'}[?25l[?1c[10;42H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet def_dict = {'dict2': 'newval'}[?25l[?1c[10;42H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwincmd b[?25l[?1c[17;42H[7m[No Name]                              [0m[24;1H[1m[7m[No Name]                                                                       [0m[1;80H[7m [0m[1;80H[1m[4m[37m[40mX[18;1H[?25h[?0c[?25l[?1c[24m[0m[25;1H[K[25;1H:[?25h[?0ctabrewind[?25l[?1c[27m[24m[0m[H[J[1;1H[1m + test91.in [0m[1m[4m[37m[40m [24m[0m[1m[4m[35m[40m4[24m[0m[1m[4m[37m[40m [No Name]  [No Name] [24m[0m[7m                                           [0m[1;80H[1m[4m[37m[40mX[24m[0m[2;1Hdos
1
iso-8859-2
'Dance'
'Dance'
{'var_str': 'Dance'}
{'var_str': 'Dance'}
'Chance'
{}
{}
''
'Chance'
0
0
[1, 2, 3]
[1, 2, 3]
''
[4, 5, 6, 7]
[4, 5, 6, 7]
''
[4, 5, 6, 7]
''
[4, 5, 6, 7][?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(gettabwinvar(2, 3, 'var_dict'))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H{'dict': 'tabwin'}[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(gettabwinvar(2, 3, 'var_dict', def_dict))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H{'dict': 'tabwin'}[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(gettabwinvar(2, 3, ''))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H{'var_dict': {'dict': 'tabwin'}}[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(gettabwinvar(2, 3, '', def_dict))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H{'var_dict': {'dict': 'tabwin'}}[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0ctabnext[?25l[?1c[27m[24m[0m[H[J[1;1H[1m[4m[37m[40m + test91.in [24m[0m[1m [0m[1m[35m4[0m[1m [No Name] [0m[1m[4m[37m[40m [No Name] [24m[0m[7m                                           [0m[1;80H[1m[4m[37m[40mX[24m[0m[3;1H[1m[34m~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [0m[9;1H[7m[No Name]                                                                       [10;41H|[11;41H|[12;41H|[13;41H|[14;41H|[15;41H|[16;41H|[0m[11;1H[1m[34m~                                       
~                                       
~                                       
~                                       
~                                       
~                                       [0m
[7m[No Name]                                [0m[11;42H[1m[34m~                                      [12;42H~                                      [13;42H~                                      [14;42H~                                      [15;42H~                                      [16;42H~                                      [0m[17;42H[7m[No Name]                              [0m[19;1H[1m[34m~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [0m[24;1H[1m[7m[No Name]                                                                       [18;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0c3wincmd w[?25l[?1c[17;42H[1m[7m[No Name]                              [0m[24;1H[7m[No Name]                                                                       [1;80H [0m[1;80H[1m[4m[37m[40mX[10;42H[?25h[?0c[?25l[?1c[24m[0m[25;1H[K[25;1H:[?25h[?0cunlet w:var_dict[?25l[?1c[10;42H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctabrewind[?25l[?1c[27m[24m[0m[H[J[1;1H[1m + test91.in [0m[1m[4m[37m[40m [24m[0m[1m[4m[35m[40m4[24m[0m[1m[4m[37m[40m [No Name]  [No Name] [24m[0m[7m                                           [0m[1;80H[1m[4m[37m[40mX[24m[0m[2;1H'Dance'
{'var_str': 'Dance'}
{'var_str': 'Dance'}
'Chance'
{}
{}
''
'Chance'
0
0
[1, 2, 3]
[1, 2, 3]
''
[4, 5, 6, 7]
[4, 5, 6, 7]
''
[4, 5, 6, 7]
''
[4, 5, 6, 7]
{'dict': 'tabwin'}
{'dict': 'tabwin'}
{'var_dict': {'dict': 'tabwin'}}
{'var_dict': {'dict': 'tabwin'}}[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(gettabwinvar(2, 3, 'var_dict', def_dict))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H{'dict2': 'newval'}[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(gettabwinvar(2, 3, ''))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H{}[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(gettabwinvar(2, 3, '', def_dict))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H{}[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(gettabwinvar(2, 9, ''))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H''[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(gettabwinvar(2, 9, '', def_dict))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H{'dict2': 'newval'}[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(gettabwinvar(9, 3, ''))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H''[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(gettabwinvar(9, 3, '', def_dict))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H{'dict2': 'newval'}[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cunlet def_dict[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =string(gettabwinvar(2, 3, '&nux'))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H''[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put =string(gettabwinvar(2, 3, '&nux', 1))[?25l[?1c[2;24r[24;1H
[1;25r[24;1H1[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0ctabonly[?25l[?1c[1;1H0[1;2H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^start/,$wq! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 48 lines, 456 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test92.failed test.ok test.out X* viminfo
cp test92.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test92.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test92.in" 48 lines, 852 characters[1;1Hvim: set ft=vim fenc=utf-8:

Tests if :mksession saves cursor columns correctly in presence of tab and
multibyte characters when fileencoding=utf-8.

STARTTEST
:so mbyte.vim
:if !has('mksession')
:  e! test.ok
:  wq! test.out
:endif
:set sessionoptions=buffers splitbelow fileencoding=utf-8
/^start:
:vsplit
j16|:split
j16|:split
j16|:split
j8|:split
j8|:split
j16|:split
j16|:split
j16|:wincmd l
/^start:
:set nowrap[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1Hvim: set ft=vim fenc=utf-8:[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[6;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 31 lines, 467 characters written[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[7;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[14M[1;25r[11;1Hj16|3zl:split
j016|3zl:split
j016|3zl:split
j08|3zl:split
j08|3zl:split
j016|3zl:split
j016|3zl:split
j016|3zl:split
:mksession! test.out
:new test.out
:v/\(^ *normal! 0\|^ *exe 'normal!\)/d
:w! test.out
:qa!
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso mbyte.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif !has('mksession')[?25l[?1c
:  [?25h[?0c:  e! test.ok
[?25l[?1c:  [?25h[?0c:  wq! test.out
[?25l[?1c:  [?25h[?0c:endif[1;1H[3L[?25l[?1c[1;1Hj16|:split
j16|:split
j8|:split[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset sessionoptions=buffers splitbelow fileencoding=utf-8[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^start:[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hstart:[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cvsplit[?25l[?1c[1;2H8|:split [30C[7m|[2;41H|[0m
j16|:split[30C[7m|[4;41H|[0m[5;6Hwincmd l[27C[7m|[0m
/^start:     [27C[7m|[0m
:set nowrap[29C[7m|[0m
j16|3zl:split[27C[7m|[0m
j016|3zl:split[26C[7m|[10;41H|[0m
j08|3zl:split [26C[7m|[12;41H|[0m
j016|3zl:split[26C[7m|[14;41H|[15;41H|[0m
:mksession! test.out[20C[7m|[0m
:new test.out       [20C[7m|[0m
:v/\(^ *normal! 0\|^ *exe 'normal!\)/d  [7m|[0m
:w! test.out                            [7m|[0m
:qa!        [28C[7m|[0m
ENDTEST[33C[7m|[0m
       [33C[7m|[0m
start:[34C[7m|[0m
[1m[7mtest92.in [+]                            [0m[1;42Hj8|:split[2;42Hj8|:split[3;42Hj16|:split[4;42Hj16|:split[5;42Hj16|:wincmd l[6;42H/^start:[7;42H:set nowrap[8;42Hj16|3zl:split[9;42Hj016|3zl:split[10;42Hj016|3zl:split[11;42Hj08|3zl:split[12;42Hj08|3zl:split[13;42Hj016|3zl:split[14;42Hj016|3zl:split[15;42Hj016|3zl:split[16;42H:mksession! test.out[17;42H:new test.out[18;42H:v/\(^ *normal! 0\|^ *exe 'normal!\)/d[19;42H:w! test.out[20;42H:qa![21;42HENDTEST[23;42Hstart:[24;42H[7mtest92.in [+]                          [23;1H[?25h[?0c[?25l[?1c[0m[1;1Hj8|:split                               
j16|:split                              
j16|:split                              
j16|:wincmd l                           
/^start:                                
:set nowrap                             
j16|3zl:split                           
j016|3zl:split                          
j016|3zl:split                          
j08|3zl:split                           
j08|3zl:split                           
j016|3zl:split                          
j016|3zl:split                          
j016|3zl:split                          
:mksession! test.out                    
:new test.out                           
:v/\(^ *normal! 0\|^ *exe 'normal!\)/d  
:w! test.out                            
:qa!                                    
ENDTEST                                 
                                        
start:                                  
                                        no multibyte chAracter[25;1H[K[23;1H[?25h[?0c[15C[?25l[?1c

:[?25h[?0csplit[?25l[?1c[1;2H016|3zl:split
j016|3zl:split
:mksession! test.out
:new test.out
:v/\(^ *normal! 0\|^ *exe 'normal!\)/d
:w! test.out
:qa!         
ENDTEST       
              
start:       
no multibyte chAracter
[7mtest92.in [+]                           [23;16H[?25h[?0c[?25l[?1c[0m[13;1Hj016|3zl:split                          
:mksession! test.out                    
:new test.out                           
:v/\(^ *normal! 0\|^ *exe 'normal!\)/d  
:w! test.out                            
:qa!                                    
ENDTEST                                 
                                        
start:                                  
no multibyte chAracter                  
                                        [23;9Hone leaDing tab[25;1H[K[23;16H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1H:v/\(^ *normal! 0\|^ *exe 'normal!\)/d  [7m|[0m
:w! test.out[28C[7m|[0m
:qa![36C[7m|[0m
ENDTEST[33C[7m|[5;41H|[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test92.in [+]                           |[0m
:w! test.out[28C[7m|[0m
:qa![36C[7m|[0m
ENDTEST[33C[7m|[12;41H|[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|[0m[15;9Hone leaDing tab[17C[7m|
test92.in [+]                           |[0m
:w! test.out[28C[7m|[0m
:qa![36C[7m|[0m
ENDTEST[33C[7m|[20;41H|[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|[0m[23;9Hone leaDing tab[17C[7m|[0m
[1m[7mtest92.in [+]                            [0m[1;42Hj8|:split[2;42Hj8|:split[3;42Hj16|:split[4;42Hj16|:split[5;42Hj16|:wincmd l[6;42H/^start:[7;42H:set nowrap[8;42Hj16|3zl:split[9;42Hj016|3zl:split[10;42Hj016|3zl:split[11;42Hj08|3zl:split[12;42Hj08|3zl:split[13;42Hj016|3zl:split[14;42Hj016|3zl:split[15;42Hj016|3zl:split[16;42H:mksession! test.out[17;42H:new test.out[18;42H:v/\(^ *normal! 0\|^ *exe 'normal!\)/d[19;42H:w! test.out[20;42H:qa![21;42HENDTEST[23;42Hstart:[24;42H[7mtest92.in [+]                          [23;16H[?25h[?0c[?25l[?1c[0m[17;1H:qa!                                    
ENDTEST                                 
                                        
start:                                  
no multibyte chAracter                  
        one leaDing tab                 
                                            four leadinG spaces[23;16H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1H:qa![36C[7m|[0m
ENDTEST[33C[7m|[3;41H|[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test92.in [+]                           |[0m
ENDTEST[33C[7m|[8;41H|[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|[0m[11;9Hone leaDing tab[17C[7m|
test92.in [+]                           |[13;41H|[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|[0m[16;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test92.in [+]                           |[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|[0m[21;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|[0m
[1m[7mtest92.in [+]                            [0m[1;42Hj8|:split[2;42Hj8|:split[3;42Hj16|:split[4;42Hj16|:split[5;42Hj16|:wincmd l[6;42H/^start:[7;42H:set nowrap[8;42Hj16|3zl:split[9;42Hj016|3zl:split[10;42Hj016|3zl:split[11;42Hj08|3zl:split[12;42Hj08|3zl:split[13;42Hj016|3zl:split[14;42Hj016|3zl:split[15;42Hj016|3zl:split[16;42H:mksession! test.out[17;42H:new test.out[18;42H:v/\(^ *normal! 0\|^ *exe 'normal!\)/d[19;42H:w! test.out[20;42H:qa![21;42HENDTEST[23;42Hstart:[24;42H[7mtest92.in [+]                          [22;16H[?25h[?0c[23;16H[23;8H[?25l[?1c

[0m:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1HENDTEST[33C[7m|[2;41H|[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test92.in [+]                           |[6;41H|[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|[0m[9;9Hone leaDing tab[17C[7m|
test92.in [+]                           |[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|[0m[13;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test92.in [+]                           |[0m[16;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test92.in [+]                           |[0m[20;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|[0m
[1m[7mtest92.in [+]                            [0m[1;42Hj8|:split[2;42Hj8|:split[3;42Hj16|:split[4;42Hj16|:split[5;42Hj16|:wincmd l[6;42H/^start:[7;42H:set nowrap[8;42Hj16|3zl:split[9;42Hj016|3zl:split[10;42Hj016|3zl:split[11;42Hj08|3zl:split[12;42Hj08|3zl:split[13;42Hj016|3zl:split[14;42Hj016|3zl:split[15;42Hj016|3zl:split[16;42H:mksession! test.out[17;42H:new test.out[18;42H:v/\(^ *normal! 0\|^ *exe 'normal!\)/d[19;42H:w! test.out[20;42H:qa![21;42HENDTEST[23;42Hstart:[24;42H[7mtest92.in [+]                          [22;8H[?25h[?0c[23;8H[?25l[?1c

[0m:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;41H[7m|[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test92.in [+]                           |[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|[0m[7;9Hone leaDing tab[17C[7m|
test92.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[10;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test92.in [+]                           |[0m[13;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test92.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test92.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|[0m
[1m[7mtest92.in [+]                            [0m[1;42Hj8|:split[2;42Hj8|:split[3;42Hj16|:split[4;42Hj16|:split[5;42Hj16|:wincmd l[6;42H/^start:[7;42H:set nowrap[8;42Hj16|3zl:split[9;42Hj016|3zl:split[10;42Hj016|3zl:split[11;42Hj08|3zl:split[12;42Hj08|3zl:split[13;42Hj016|3zl:split[14;42Hj016|3zl:split[15;42Hj016|3zl:split[16;42H:mksession! test.out[17;42H:new test.out[18;42H:v/\(^ *normal! 0\|^ *exe 'normal!\)/d[19;42H:w! test.out[20;42H:qa![21;42HENDTEST[23;42Hstart:[24;42H[7mtest92.in [+]                          [22;8H[?25h[?0c[23;8H[8C[?25l[?1c

[0m:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1Hstart:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test92.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[5;9Hone leaDing tab[17C[7m|
test92.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[8;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test92.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test92.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test92.in [+]                           |[0m
two     tabs    in one line[13C[7m|[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|
test92.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|[0m
[1m[7mtest92.in [+]                            [0m[1;42Hj8|:split[2;42Hj8|:split[3;42Hj16|:split[4;42Hj16|:split[5;42Hj16|:wincmd l[6;42H/^start:[7;42H:set nowrap[8;42Hj16|3zl:split[9;42Hj016|3zl:split[10;42Hj016|3zl:split[11;42Hj08|3zl:split[12;42Hj08|3zl:split[13;42Hj016|3zl:split[14;42Hj016|3zl:split[15;42Hj016|3zl:split[16;42H:mksession! test.out[17;42H:new test.out[18;42H:v/\(^ *normal! 0\|^ *exe 'normal!\)/d[19;42H:w! test.out[20;42H:qa![21;42HENDTEST[23;42Hstart:[24;42H[7mtest92.in [+]                          [23;16H[?25h[?0c[?25l[?1c[0m[21;1Htwo     tabs    in one line             
one [1m[34m~@[0m multibyteCharacter             
                                        a [1m[34m~@~\[0mb[1m[34m~@~][0m two multiByte characters[23;16H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1Hstart:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test92.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[5;9Hone leaDing tab[17C[7m|
test92.in [+]                           |[0m[7;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test92.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test92.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test92.in [+]                           |[0m
two     tabs    in one line[13C[7m|[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|
test92.in [+]                           |[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|[0m
a [1m[34m~@~\[0mb[1m[34m~@~][0m two multiByte characters  [7m|
test92.in [+]                           |[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|[0m
a [1m[34m~@~\[0mb[1m[34m~@~][0m two multiByte characters  [7m|[0m
[1m[7mtest92.in [+]                            [0m[1;42Hj8|:split[2;42Hj8|:split[3;42Hj16|:split[4;42Hj16|:split[5;42Hj16|:wincmd l[6;42H/^start:[7;42H:set nowrap[8;42Hj16|3zl:split[9;42Hj016|3zl:split[10;42Hj016|3zl:split[11;42Hj08|3zl:split[12;42Hj08|3zl:split[13;42Hj016|3zl:split[14;42Hj016|3zl:split[15;42Hj016|3zl:split[16;42H:mksession! test.out[17;42H:new test.out[18;42H:v/\(^ *normal! 0\|^ *exe 'normal!\)/d[19;42H:w! test.out[20;42H:qa![21;42HENDTEST[23;42Hstart:[24;42H[7mtest92.in [+]                          [23;16H[?25h[?0c[?25l[?1c[0m[22;1H[1m[34m~@~\[0mc[1m[34m~@~][0m1[1m[34m~B[0m three mulTibyte charact
ers                                   [22;16H[?25h[?0c[?25l[?1c


:[?25h[?0cwincmd l[?25l[?1c[24;1H[7mtest92.in [+]                            [0m[1m[7mtest92.in [+]                          [23;42H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H/[?25h[?0c^start:[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[23;42H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset nowrap[?25l[?1c[23;42H[?25h[?0c[?25l[?1c[1;42Hj8|:split                              [2;42Hj16|:split                             [3;42Hj16|:split                             [4;42Hj16|:wincmd l                          [5;42H/^start:                               [6;42H:set nowrap                            [7;42Hj16|3zl:split                          [8;42Hj016|3zl:split                         [9;42Hj016|3zl:split                         [10;42Hj08|3zl:split                          [11;42Hj08|3zl:split                          [12;42Hj016|3zl:split                         [13;42Hj016|3zl:split                         [14;42Hj016|3zl:split                         [15;42H:mksession! test.out                   [16;42H:new test.out                          [17;42H:v/\(^ *normal! 0\|^ *exe 'normal!\)/d [18;42H:w! test.out                           [19;42H:qa!                                   [20;42HENDTEST                                [21;42H                                       [22;42Hstart:                                 [23;42H                                       [23;42Hno multibyte chAracter[25;1H[K[23;42H[?25h[?0c[15C[?25l[?1c[1;42H:split[1;48H[K[2;42H|:split[2;49H[K[3;42H|:split[3;49H[K[4;42H|:wincmd l[4;52H[K[5;42Htart:[5;47H[K[6;42Ht nowrap[6;50H[K[7;42H|3zl:split[7;52H[K[8;42H6|3zl:split[8;53H[K[9;42H6|3zl:split[9;53H[K[10;42H|3zl:split[10;52H[K[11;42H|3zl:split[11;52H[K[12;42H6|3zl:split[12;53H[K[13;42H6|3zl:split[13;53H[K[14;42H6|3zl:split[14;53H[K[15;42Hsession! test.out[15;59H[K[16;42Hw test.out[16;52H[K[17;42H\(^ *normal! 0\|^ *exe 'normal!\)/d[17;77H[K[18;42H test.out[18;51H[K[19;42H![19;43H[K[20;42HTES[20;46H[K[22;42Hrt:[22;45H[K[23;42Hmultibyte chAracter[23;61H[K[23;54H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[1;42H6|3zl:split[2;42H6|3zl:split[3;42Hsession! test.out[4;42Hw test.out[5;42H\(^ *normal! 0\|^ *exe 'normal!\)/d[6;42H test.out[7;42H![7;43H[K[8;42HTEST[8;46H[K[9;42H[K[10;42Hrt:[10;45H[K[11;42Hmultibyte chAracter[12;42H[7mtest92.in [+]                          [23;54H[?25h[?0c[?25l[?1c[0m[13;42H6|3zl:split                            [14;42Hsession! test.out                      [15;42Hw test.out                             [16;42H\(^ *normal! 0\|^ *exe 'normal!\)/d    [17;42H test.out                              [18;42H!                                      [19;42HTEST                                   [20;42H                                       [21;42Hrt:                                    [22;42Hmultibyte chAracter                    [23;42H                                       [23;47Hone leaDing tab[25;1H[K[23;54H[?25h[?0c[?25l[?1c[13;42Hj016|3zl:split[14;42H:mksession! test.out[15;42H:new test.out[16;42H:v/\(^ *normal! 0\|^ *exe 'normal!\)/d[17;42H:w! test.out[18;42H:qa![19;42HENDTEST[21;42Hstart:[22;42Hno multibyte chAracter[23;47H   one leaDing tab[23;49H[?25h[?0c[8C[?25l[?1c[13;42H6|3zl:split[13;53H[K[14;42Hsession! test.out[14;59H[K[15;42Hw test.out[15;52H[K[16;42H\(^ *normal! 0\|^ *exe 'normal!\)/d[16;77H[K[17;42H test.out[17;51H[K[18;42H![18;43H[K[19;42HTES[19;46H[K[21;42Hrt:[21;45H[K[22;42Hmultibyte chAracter[22;61H[K[23;47Hone leaDing tab[23;62H[K[23;54H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1Hstart:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test92.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[5;9Hone leaDing tab[17C[7m|
test92.in [+]                           |[0m[7;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test92.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test92.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test92.in [+]                           |[0m
two     tabs    in one line[13C[7m|[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|
test92.in [+]                           |[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|[0m
a [1m[34m~@~\[0mb[1m[34m~@~][0m two multiByte characters  [7m|
test92.in [+]                           |[0m
[1m[34m~@~\[0mc[1m[34m~@~][0m1[1m[34m~B[0m three mulTibyte charact[7m|[0m
ers[37C[7m|
test92.in [+]                            [0m[1;42H\(^ *normal! 0\|^ *exe 'normal!\)/d[2;43Htest.out[3;42H![4;42HTEST[6;42Hrt:[7;42Hmultibyte chAracter[8;42H[7mtest92.in [+]                          [0m[9;43Htest.out[10;42H![11;42HTEST[13;42Hrt:[14;42Hmultibyte chAracter[15;47Hone leaDing tab[16;42H[7mtest92.in [+]                          [0m[17;43Htest.out[18;42H![19;42HTEST[21;42Hrt:[22;42Hmultibyte chAracter[23;47Hone leaDing tab[24;42H[1m[7mtest92.in [+]                          [23;54H[?25h[?0c[?25l[?1c[0m[17;42H!                                      [18;42HTEST                                   [19;42H                                       [20;42Hrt:                                    [21;42Hmultibyte chAracter                    [22;42H     one leaDing tab                   [23;42H                                       [23;43Hfour leadinG spaces[23;54H[?25h[?0c[?25l[?1c[17;42H:qa![18;42HENDTEST[20;42Hstart:[21;42Hno multibyte chAracter[22;47H   one leaDing tab[23;43H   four leadinG spaces[23;42H[?25h[?0c[15C[?25l[?1c[17;42H![17;43H[K[18;42HTES[18;46H[K[20;42Hrt:[20;45H[K[21;42Hmultibyte chAracter[21;61H[K[22;47Hone leaDing tab[22;62H[K[23;43Hfour leadinG spaces[23;62H[K[23;54H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1Hstart:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test92.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[5;9Hone leaDing tab[17C[7m|
test92.in [+]                           |[0m[7;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test92.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test92.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test92.in [+]                           |[0m
two     tabs    in one line[13C[7m|[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|
test92.in [+]                           |[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|[0m
a [1m[34m~@~\[0mb[1m[34m~@~][0m two multiByte characters  [7m|
test92.in [+]                           |[0m
[1m[34m~@~\[0mc[1m[34m~@~][0m1[1m[34m~B[0m three mulTibyte charact[7m|[0m
ers[37C[7m|
test92.in [+]                            [0m[1;42H![2;42HTEST[4;42Hrt:[5;42Hmultibyte chAracter[6;42H[7mtest92.in [+]                          [0m[7;42HTEST[9;42Hrt:[10;42Hmultibyte chAracter[11;47Hone leaDing tab[12;42H[7mtest92.in [+]                          [0m[14;42Hrt:[15;42Hmultibyte chAracter[16;47Hone leaDing tab[17;43Hfour leadinG spaces[18;42H[7mtest92.in [+]                          [0m[19;42Hrt:[20;42Hmultibyte chAracter[21;47Hone leaDing tab[22;43Hfour leadinG spaces[23;55Hconsecutive tabs[24;42H[1m[7mtest92.in [+]                          [22;54H[?25h[?0c[23;54H[?25l[?1c[0m[19;42Hstart:[20;42Hno multibyte chAracter[21;47H   one leaDing tab[22;43H   four leadinG spaces[23;42Htwo[10C   consecutive tabs[23;42H[?25h[?0c[7C[?25l[?1c[19;42Hrt:[19;45H[K[20;42Hmultibyte chAracter[20;61H[K[21;47Hone leaDing tab[21;62H[K[22;43Hfour leadinG spaces[22;62H[K[23;42H   [10Cconsecutive tabs[23;71H[K[23;46H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1Hstart:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test92.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[5;9Hone leaDing tab[17C[7m|
test92.in [+]                           |[0m[7;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test92.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test92.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test92.in [+]                           |[0m
two     tabs    in one line[13C[7m|[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|
test92.in [+]                           |[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|[0m
a [1m[34m~@~\[0mb[1m[34m~@~][0m two multiByte characters  [7m|
test92.in [+]                           |[0m
[1m[34m~@~\[0mc[1m[34m~@~][0m1[1m[34m~B[0m three mulTibyte charact[7m|[0m
ers[37C[7m|
test92.in [+]                            [0m[1;42HTEST[3;42Hrt:[4;42Hmultibyte chAracter[5;42H[7mtest92.in [+]                          [0m[7;42Hrt:[8;42Hmultibyte chAracter[9;47Hone leaDing tab[10;42H[7mtest92.in [+]                          [0m[11;42Hrt:[12;42Hmultibyte chAracter[13;47Hone leaDing tab[14;43Hfour leadinG spaces[15;42H[7mtest92.in [+]                          [0m[16;47Hone leaDing tab[17;43Hfour leadinG spaces[18;55Hconsecutive tabs[19;42H[7mtest92.in [+]                          [0m[20;47Hone leaDing tab[21;43Hfour leadinG spaces[22;55Hconsecutive tabs[23;47Htabs    in one line[24;42H[1m[7mtest92.in [+]                          [22;46H[?25h[?0c[23;46H[?25l[?1c[0m[20;47H   one leaDing tab[21;43H   four leadinG spaces[22;42Htwo[10C   consecutive tabs[23;42Htwo     tabs    in one line[23;42H[?25h[?0c[7C[?25l[?1c[20;47Hone leaDing tab[20;62H[K[21;43Hfour leadinG spaces[21;62H[K[22;42H   [10Cconsecutive tabs[22;71H[K[23;42H     tabs    in one line[23;66H[K[23;46H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1Hstart:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test92.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[5;9Hone leaDing tab[17C[7m|
test92.in [+]                           |[0m[7;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test92.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test92.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test92.in [+]                           |[0m
two     tabs    in one line[13C[7m|[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|
test92.in [+]                           |[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|[0m
a [1m[34m~@~\[0mb[1m[34m~@~][0m two multiByte characters  [7m|
test92.in [+]                           |[0m
[1m[34m~@~\[0mc[1m[34m~@~][0m1[1m[34m~B[0m three mulTibyte charact[7m|[0m
ers[37C[7m|
test92.in [+]                            [0m[2;42Hrt:[3;42Hmultibyte chAracter[4;42H[7mtest92.in [+]                          [0m[5;42Hrt:[6;42Hmultibyte chAracter[7;47Hone leaDing tab[8;42H[7mtest92.in [+]                          [0m[9;42Hmultibyte chAracter[10;47Hone leaDing tab[11;43Hfour leadinG spaces[12;42H[7mtest92.in [+]                          [0m[13;47Hone leaDing tab[14;43Hfour leadinG spaces[15;55Hconsecutive tabs[16;42H[7mtest92.in [+]                          [0m[17;43Hfour leadinG spaces[18;55Hconsecutive tabs[19;47Htabs    in one line[20;42H[7mtest92.in [+]                          [0m[21;55Hconsecutive tabs[22;47Htabs    in one line[23;43H[1m[34m~@[0m multibyteCharacter[24;42H[1m[7mtest92.in [+]                          [22;46H[?25h[?0c[23;46H[?25l[?1c[0m[21;42Htwo[10C   consecutive tabs[22;42Htwo     tabs    in one line[23;42Hone [1m[34m~@[0m multibyteCharacter[23;42H[?25h[?0c[15C[?25l[?1c[21;42H   [10Cconsecutive tabs[21;71H[K[22;42H     tabs    in one line[22;66H[K[23;42H [1m[34m~@[0m multibyteCharacter[23;66H[K[23;54H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1Hstart:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test92.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[5;9Hone leaDing tab[17C[7m|
test92.in [+]                           |[0m[7;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test92.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test92.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test92.in [+]                           |[0m
two     tabs    in one line[13C[7m|[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|
test92.in [+]                           |[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|[0m
a [1m[34m~@~\[0mb[1m[34m~@~][0m two multiByte characters  [7m|
test92.in [+]                           |[0m
[1m[34m~@~\[0mc[1m[34m~@~][0m1[1m[34m~B[0m three mulTibyte charact[7m|[0m
ers[37C[7m|
test92.in [+]                            [0m[1;42Hrt:[2;42Hmultibyte chAracter[3;42H[7mtest92.in [+]                          [0m[4;42Hmultibyte chAracter[5;47Hone leaDing tab[6;42H[7mtest92.in [+]                          [0m[7;42Hmultibyte chAracter[8;47Hone leaDing tab[9;43Hfour leadinG spaces[10;42H[7mtest92.in [+]                          [0m[11;43Hfour leadinG spaces[12;55Hconsecutive tabs[13;42H[7mtest92.in [+]                          [0m[14;43Hfour leadinG spaces[15;55Hconsecutive tabs[16;47Htabs    in one line[17;42H[7mtest92.in [+]                          [0m[18;47Htabs    in one line[19;43H[1m[34m~@[0m multibyteCharacter[20;42H[7mtest92.in [+]                          [0m[21;55Hconsecutive tabs[22;47Htabs    in one line[23;43H[1m[34m~@[0m multibyteCharacter[24;42H[1m[7mtest92.in [+]                          [23;54H[?25h[?0c[?25l[?1c[0m[21;42H     tabs    in one line               [22;42H [1m[34m~@[0m multibyteCharacter               [23;42H                                       [23;42H[1m[34m~@~\[0mb[1m[34m~@~][0m two multiByte characters[23;54H[?25h[?0c[?25l[?1c[21;42Htwo     tabs    in one line[22;42Hone [1m[34m~@[0m multibyteCharacter[23;42Ha [1m[34m~@~\[0mb[1m[34m~@~][0m two multiByte characters[23;42H[?25h[?0c[15C[?25l[?1c[21;42H     tabs    in one line[21;66H[K[22;42H [1m[34m~@[0m multibyteCharacter[22;66H[K[23;42H[1m[34m~@~\[0mb[1m[34m~@~][0m two multiByte characters[23;77H[K[23;54H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1Hstart:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test92.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[5;9Hone leaDing tab[17C[7m|
test92.in [+]                           |[0m[7;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test92.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test92.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test92.in [+]                           |[0m
two     tabs    in one line[13C[7m|[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|
test92.in [+]                           |[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|[0m
a [1m[34m~@~\[0mb[1m[34m~@~][0m two multiByte characters  [7m|
test92.in [+]                           |[0m
[1m[34m~@~\[0mc[1m[34m~@~][0m1[1m[34m~B[0m three mulTibyte charact[7m|[0m
ers[37C[7m|
test92.in [+]                            [0m[1;42Hrt:[2;42Hmultibyte chAracter[3;42H[7mtest92.in [+]                          [0m[4;42Hmultibyte chAracter[5;47Hone leaDing tab[6;42H[7mtest92.in [+]                          [0m[7;47Hone leaDing tab[8;43Hfour leadinG spaces[9;42H[7mtest92.in [+]                          [0m[10;43Hfour leadinG spaces[11;55Hconsecutive tabs[12;42H[7mtest92.in [+]                          [0m[13;55Hconsecutive tabs[14;47Htabs    in one line[15;42H[7mtest92.in [+]                          [0m[16;47Htabs    in one line[17;43H[1m[34m~@[0m multibyteCharacter[18;42H[7mtest92.in [+]                          [0m[19;43H[1m[34m~@[0m multibyteCharacter[20;42H[1m[34m~@~\[0mb[1m[34m~@~][0m two multiByte characters[21;42H[7mtest92.in [+]                          [0m[22;43H[1m[34m~@[0m multibyteCharacter[23;42H[1m[34m~@~\[0mb[1m[34m~@~][0m two multiByte characters[24;42H[1m[7mtest92.in [+]                          [23;54H[?25h[?0c[?25l[?1c[0m[22;42H[1m[34m~@~\[0mb[1m[34m~@~][0m two multiByte characters    [23;42H                                       [23;42H[1m[34m~\[0mc[1m[34m~@~][0m1[1m[34m~B[0m three mulTibyte character[23;54H[?25h[?0c[?25l[?1c[22;42Ha [1m[34m~@~\[0mb[1m[34m~@~][0m two multiByte characters[23;42H[1m[34m~@~\[0mc[1m[34m~@~][0m1[1m[34m~B[0m three mulTibyte charac[23;42H[?25h[?0c[15C[?25l[?1c[22;42H[1m[34m~@~\[0mb[1m[34m~@~][0m two multiByte characters[22;77H[K[23;42H[1m[34m~\[0mc[1m[34m~@~][0m1[1m[34m~B[0m three mulTibyte character[23;54H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1Hstart:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test92.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[5;9Hone leaDing tab[17C[7m|
test92.in [+]                           |[0m[7;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test92.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test92.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test92.in [+]                           |[0m
two     tabs    in one line[13C[7m|[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|
test92.in [+]                           |[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|[0m
a [1m[34m~@~\[0mb[1m[34m~@~][0m two multiByte characters  [7m|
test92.in [+]                           |[0m
[1m[34m~@~\[0mc[1m[34m~@~][0m1[1m[34m~B[0m three mulTibyte charact[7m|[0m
ers[37C[7m|
test92.in [+]                            [0m[1;42Hrt:[2;42Hmultibyte chAracter[3;42H[7mtest92.in [+]                          [0m[4;42Hmultibyte chAracter[5;47Hone leaDing tab[6;42H[7mtest92.in [+]                          [0m[7;47Hone leaDing tab[8;43Hfour leadinG spaces[9;42H[7mtest92.in [+]                          [0m[10;43Hfour leadinG spaces[11;55Hconsecutive tabs[12;42H[7mtest92.in [+]                          [0m[13;55Hconsecutive tabs[14;47Htabs    in one line[15;42H[7mtest92.in [+]                          [0m[16;47Htabs    in one line[17;42H[7mtest92.in [+]                          [0m[18;43H[1m[34m~@[0m multibyteCharacter[19;42H[1m[34m~@~\[0mb[1m[34m~@~][0m two multiByte characters[20;42H[7mtest92.in [+]                          [0m[21;42H[1m[34m~\[0mc[1m[34m~@~][0m1[1m[34m~B[0m three mulTibyte character[22;42H[7mtest92.in [+]                          [0m[23;42H[1m[34m~\[0mc[1m[34m~@~][0m1[1m[34m~B[0m three mulTibyte character[24;42H[1m[7mtest92.in [+]                          [23;54H[?25h[?0c[?25l[?1c

[0m:[?25h[?0cmksession! test.out[?25l[?1c[23;54H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnew test.out[?25l[?1c"test.out" [25;12H[K[25;12H282 lines, 5375 characters[27m[24m[0m[H[J[1;1Hstart:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test92.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[5;9Hone leaDing tab[17C[7m|
test92.in [+]                           |[0m[7;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test92.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test92.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test92.in [+]                           |[0m
two     tabs    in one line[13C[7m|[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|
test92.in [+]                           |[0m
one [1m[34m~@[0m multibyteCharacter[13C[7m|[0m
a [1m[34m~@~\[0mb[1m[34m~@~][0m two multiByte characters  [7m|
test92.in [+]                           |[0m
[1m[34m~@~\[0mc[1m[34m~@~][0m1[1m[34m~B[0m three mulTibyte charact[7m|[0m
ers[37C[7m|
test92.in [+]                            [0m[1;42Hrt:[2;42H[7mtest92.in [+]                          [0m[3;42Hmultibyte chAracter[4;47Hone leaDing tab[5;42H[7mtest92.in [+]                          [0m[6;47Hone leaDing tab[7;42H[7mtest92.in [+]                          [0m[8;43Hfour leadinG spaces[9;55Hconsecutive tabs[10;42H[7mtest92.in [+]                          [0m[11;55Hconsecutive tabs[12;42H[7mtest92.in [+]                          [0m[13;47Htabs    in one line[14;43H[1m[34m~@[0m multibyteCharacter[15;42H[7mtest92.in [+]                          [0m[16;43H[1m[34m~@[0m multibyteCharacter[17;42H[7mtest92.in [+]                          [0m[18;42H[1m[34m~\[0mc[1m[34m~@~][0m1[1m[34m~B[0m three mulTibyte character[19;42H[1m[34m~                                      [0m[20;42H[7mtest92.in [+]                          [0m[21;42H[1m[34m~\[0mc[1m[34m~@~][0m1[1m[34m~B[0m three mulTibyte character[22;42H[7mtest92.in [+]                          [0m[23;42Hlet SessionLoad = 1[24;42H[1m[7mtest.out                               [23;42H[?25h[?0c[?25l[?1c

[0m:[?25h[?0cv/\(^ *normal! 0\|^ *exe 'normal!\)/d[?25l[?1c256 fewer lines[25;17H[K[23;42H  normal! 016|[23;56H[K[24;51H[1m[7m[+][23;44H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! test.out[?25l[?1c"test.out" [25;12H[K[25;12H26 lines, 611 characters written[24;51H[1m[7m   [23;44H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test93.failed test.ok test.out X* viminfo
cp test93.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test93.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test93.in" 48 lines, 843 characters[1;1Hvim: set ft=vim fenc=latin1:

Tests if :mksession saves cursor columns correctly in presence of tab and
multibyte characters when fileencoding=latin1.

STARTTEST
:so mbyte.vim
:if !has('mksession')
:  e! test.ok
:  wq! test.out
:endif
:set sessionoptions=buffers splitbelow fileencoding=latin1
/^start:
:vsplit
j16|:split
j16|:split
j16|:split
j8|:split
j8|:split
j16|:split
j16|:split
j16|:wincmd l
/^start:
:set nowrap[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1Hvim: set ft=vim fenc=latin1:[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[6;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 31 lines, 468 characters written[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[7;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[14M[1;25r[11;1Hj16|3zl:split
j016|3zl:split
j016|3zl:split
j08|3zl:split
j08|3zl:split
j016|3zl:split
j016|3zl:split
j016|3zl:split
:mksession! test.out
:new test.out
:v/\(^ *normal! 0\|^ *exe 'normal!\)/d
:w! test.out
:qa!
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso mbyte.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif !has('mksession')[?25l[?1c
:  [?25h[?0c:  e! test.ok
[?25l[?1c:  [?25h[?0c:  wq! test.out
[?25l[?1c:  [?25h[?0c:endif[1;1H[3L[?25l[?1c[1;1Hj16|:split
j16|:split
j8|:split[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset sessionoptions=buffers splitbelow fileencoding=latin1[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^start:[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hstart:[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cvsplit[?25l[?1c[1;2H8|:split [30C[7m|[2;41H|[0m
j16|:split[30C[7m|[4;41H|[0m[5;6Hwincmd l[27C[7m|[0m
/^start:     [27C[7m|[0m
:set nowrap[29C[7m|[0m
j16|3zl:split[27C[7m|[0m
j016|3zl:split[26C[7m|[10;41H|[0m
j08|3zl:split [26C[7m|[12;41H|[0m
j016|3zl:split[26C[7m|[14;41H|[15;41H|[0m
:mksession! test.out[20C[7m|[0m
:new test.out       [20C[7m|[0m
:v/\(^ *normal! 0\|^ *exe 'normal!\)/d  [7m|[0m
:w! test.out                            [7m|[0m
:qa!        [28C[7m|[0m
ENDTEST[33C[7m|[0m
       [33C[7m|[0m
start:[34C[7m|[0m
[1m[7mtest93.in [+]                            [0m[1;42Hj8|:split[2;42Hj8|:split[3;42Hj16|:split[4;42Hj16|:split[5;42Hj16|:wincmd l[6;42H/^start:[7;42H:set nowrap[8;42Hj16|3zl:split[9;42Hj016|3zl:split[10;42Hj016|3zl:split[11;42Hj08|3zl:split[12;42Hj08|3zl:split[13;42Hj016|3zl:split[14;42Hj016|3zl:split[15;42Hj016|3zl:split[16;42H:mksession! test.out[17;42H:new test.out[18;42H:v/\(^ *normal! 0\|^ *exe 'normal!\)/d[19;42H:w! test.out[20;42H:qa![21;42HENDTEST[23;42Hstart:[24;42H[7mtest93.in [+]                          [23;1H[?25h[?0c[?25l[?1c[0m[1;1Hj8|:split                               
j16|:split                              
j16|:split                              
j16|:wincmd l                           
/^start:                                
:set nowrap                             
j16|3zl:split                           
j016|3zl:split                          
j016|3zl:split                          
j08|3zl:split                           
j08|3zl:split                           
j016|3zl:split                          
j016|3zl:split                          
j016|3zl:split                          
:mksession! test.out                    
:new test.out                           
:v/\(^ *normal! 0\|^ *exe 'normal!\)/d  
:w! test.out                            
:qa!                                    
ENDTEST                                 
                                        
start:                                  
                                        no multibyte chAracter[25;1H[K[23;1H[?25h[?0c[15C[?25l[?1c

:[?25h[?0csplit[?25l[?1c[1;2H016|3zl:split
j016|3zl:split
:mksession! test.out
:new test.out
:v/\(^ *normal! 0\|^ *exe 'normal!\)/d
:w! test.out
:qa!         
ENDTEST       
              
start:       
no multibyte chAracter
[7mtest93.in [+]                           [23;16H[?25h[?0c[?25l[?1c[0m[13;1Hj016|3zl:split                          
:mksession! test.out                    
:new test.out                           
:v/\(^ *normal! 0\|^ *exe 'normal!\)/d  
:w! test.out                            
:qa!                                    
ENDTEST                                 
                                        
start:                                  
no multibyte chAracter                  
                                        [23;9Hone leaDing tab[25;1H[K[23;16H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1H:v/\(^ *normal! 0\|^ *exe 'normal!\)/d  [7m|[0m
:w! test.out[28C[7m|[0m
:qa![36C[7m|[0m
ENDTEST[33C[7m|[5;41H|[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test93.in [+]                           |[0m
:w! test.out[28C[7m|[0m
:qa![36C[7m|[0m
ENDTEST[33C[7m|[12;41H|[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|[0m[15;9Hone leaDing tab[17C[7m|
test93.in [+]                           |[0m
:w! test.out[28C[7m|[0m
:qa![36C[7m|[0m
ENDTEST[33C[7m|[20;41H|[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|[0m[23;9Hone leaDing tab[17C[7m|[0m
[1m[7mtest93.in [+]                            [0m[1;42Hj8|:split[2;42Hj8|:split[3;42Hj16|:split[4;42Hj16|:split[5;42Hj16|:wincmd l[6;42H/^start:[7;42H:set nowrap[8;42Hj16|3zl:split[9;42Hj016|3zl:split[10;42Hj016|3zl:split[11;42Hj08|3zl:split[12;42Hj08|3zl:split[13;42Hj016|3zl:split[14;42Hj016|3zl:split[15;42Hj016|3zl:split[16;42H:mksession! test.out[17;42H:new test.out[18;42H:v/\(^ *normal! 0\|^ *exe 'normal!\)/d[19;42H:w! test.out[20;42H:qa![21;42HENDTEST[23;42Hstart:[24;42H[7mtest93.in [+]                          [23;16H[?25h[?0c[?25l[?1c[0m[17;1H:qa!                                    
ENDTEST                                 
                                        
start:                                  
no multibyte chAracter                  
        one leaDing tab                 
                                            four leadinG spaces[23;16H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1H:qa![36C[7m|[0m
ENDTEST[33C[7m|[3;41H|[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test93.in [+]                           |[0m
ENDTEST[33C[7m|[8;41H|[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|[0m[11;9Hone leaDing tab[17C[7m|
test93.in [+]                           |[13;41H|[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|[0m[16;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test93.in [+]                           |[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|[0m[21;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|[0m
[1m[7mtest93.in [+]                            [0m[1;42Hj8|:split[2;42Hj8|:split[3;42Hj16|:split[4;42Hj16|:split[5;42Hj16|:wincmd l[6;42H/^start:[7;42H:set nowrap[8;42Hj16|3zl:split[9;42Hj016|3zl:split[10;42Hj016|3zl:split[11;42Hj08|3zl:split[12;42Hj08|3zl:split[13;42Hj016|3zl:split[14;42Hj016|3zl:split[15;42Hj016|3zl:split[16;42H:mksession! test.out[17;42H:new test.out[18;42H:v/\(^ *normal! 0\|^ *exe 'normal!\)/d[19;42H:w! test.out[20;42H:qa![21;42HENDTEST[23;42Hstart:[24;42H[7mtest93.in [+]                          [22;16H[?25h[?0c[23;16H[23;8H[?25l[?1c

[0m:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1HENDTEST[33C[7m|[2;41H|[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test93.in [+]                           |[6;41H|[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|[0m[9;9Hone leaDing tab[17C[7m|
test93.in [+]                           |[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|[0m[13;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test93.in [+]                           |[0m[16;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test93.in [+]                           |[0m[20;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|[0m
[1m[7mtest93.in [+]                            [0m[1;42Hj8|:split[2;42Hj8|:split[3;42Hj16|:split[4;42Hj16|:split[5;42Hj16|:wincmd l[6;42H/^start:[7;42H:set nowrap[8;42Hj16|3zl:split[9;42Hj016|3zl:split[10;42Hj016|3zl:split[11;42Hj08|3zl:split[12;42Hj08|3zl:split[13;42Hj016|3zl:split[14;42Hj016|3zl:split[15;42Hj016|3zl:split[16;42H:mksession! test.out[17;42H:new test.out[18;42H:v/\(^ *normal! 0\|^ *exe 'normal!\)/d[19;42H:w! test.out[20;42H:qa![21;42HENDTEST[23;42Hstart:[24;42H[7mtest93.in [+]                          [22;8H[?25h[?0c[23;8H[?25l[?1c

[0m:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;41H[7m|[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test93.in [+]                           |[0m
start:[34C[7m|[0m
no multibyte chAracter[18C[7m|[0m[7;9Hone leaDing tab[17C[7m|
test93.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[10;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test93.in [+]                           |[0m[13;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test93.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test93.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|[0m
one  multibyteCharacter[16C[7m|[0m
[1m[7mtest93.in [+]                            [0m[1;42Hj8|:split[2;42Hj8|:split[3;42Hj16|:split[4;42Hj16|:split[5;42Hj16|:wincmd l[6;42H/^start:[7;42H:set nowrap[8;42Hj16|3zl:split[9;42Hj016|3zl:split[10;42Hj016|3zl:split[11;42Hj08|3zl:split[12;42Hj08|3zl:split[13;42Hj016|3zl:split[14;42Hj016|3zl:split[15;42Hj016|3zl:split[16;42H:mksession! test.out[17;42H:new test.out[18;42H:v/\(^ *normal! 0\|^ *exe 'normal!\)/d[19;42H:w! test.out[20;42H:qa![21;42HENDTEST[23;42Hstart:[24;42H[7mtest93.in [+]                          [22;8H[?25h[?0c[23;8H[8C[?25l[?1c

[0m:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1Hstart:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test93.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[5;9Hone leaDing tab[17C[7m|
test93.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[8;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test93.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test93.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test93.in [+]                           |[0m
two     tabs    in one line[13C[7m|[0m
one  multibyteCharacter[16C[7m|
test93.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|[0m
one  multibyteCharacter[16C[7m|[0m
[1m[7mtest93.in [+]                            [0m[1;42Hj8|:split[2;42Hj8|:split[3;42Hj16|:split[4;42Hj16|:split[5;42Hj16|:wincmd l[6;42H/^start:[7;42H:set nowrap[8;42Hj16|3zl:split[9;42Hj016|3zl:split[10;42Hj016|3zl:split[11;42Hj08|3zl:split[12;42Hj08|3zl:split[13;42Hj016|3zl:split[14;42Hj016|3zl:split[15;42Hj016|3zl:split[16;42H:mksession! test.out[17;42H:new test.out[18;42H:v/\(^ *normal! 0\|^ *exe 'normal!\)/d[19;42H:w! test.out[20;42H:qa![21;42HENDTEST[23;42Hstart:[24;42H[7mtest93.in [+]                          [23;16H[?25h[?0c[?25l[?1c[0m[21;1Htwo     tabs    in one line             
one  multibyteCharacter                
                                        a   two multiByte characters[23;16H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1Hstart:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test93.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[5;9Hone leaDing tab[17C[7m|
test93.in [+]                           |[0m[7;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test93.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test93.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test93.in [+]                           |[0m
two     tabs    in one line[13C[7m|[0m
one  multibyteCharacter[16C[7m|
test93.in [+]                           |[0m
one  multibyteCharacter[16C[7m|[0m
a   two multiByte characters[10C[7m|
test93.in [+]                           |[0m
one  multibyteCharacter[16C[7m|[0m
a   two multiByte characters[10C[7m|[0m
[1m[7mtest93.in [+]                            [0m[1;42Hj8|:split[2;42Hj8|:split[3;42Hj16|:split[4;42Hj16|:split[5;42Hj16|:wincmd l[6;42H/^start:[7;42H:set nowrap[8;42Hj16|3zl:split[9;42Hj016|3zl:split[10;42Hj016|3zl:split[11;42Hj08|3zl:split[12;42Hj08|3zl:split[13;42Hj016|3zl:split[14;42Hj016|3zl:split[15;42Hj016|3zl:split[16;42H:mksession! test.out[17;42H:new test.out[18;42H:v/\(^ *normal! 0\|^ *exe 'normal!\)/d[19;42H:w! test.out[20;42H:qa![21;42HENDTEST[23;42Hstart:[24;42H[7mtest93.in [+]                          [23;16H[?25h[?0c[?25l[?1c[0m[22;1Ha   two multiByte characters          
                                        A  three mulTibyte characters[23;16H[?25h[?0c[?25l[?1c

:[?25h[?0cwincmd l[?25l[?1c[24;1H[7mtest93.in [+]                            [0m[1m[7mtest93.in [+]                          [23;42H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H/[?25h[?0c^start:[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[23;42H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset nowrap[?25l[?1c[23;42H[?25h[?0c[?25l[?1c[1;42Hj8|:split                              [2;42Hj16|:split                             [3;42Hj16|:split                             [4;42Hj16|:wincmd l                          [5;42H/^start:                               [6;42H:set nowrap                            [7;42Hj16|3zl:split                          [8;42Hj016|3zl:split                         [9;42Hj016|3zl:split                         [10;42Hj08|3zl:split                          [11;42Hj08|3zl:split                          [12;42Hj016|3zl:split                         [13;42Hj016|3zl:split                         [14;42Hj016|3zl:split                         [15;42H:mksession! test.out                   [16;42H:new test.out                          [17;42H:v/\(^ *normal! 0\|^ *exe 'normal!\)/d [18;42H:w! test.out                           [19;42H:qa!                                   [20;42HENDTEST                                [21;42H                                       [22;42Hstart:                                 [23;42H                                       [23;42Hno multibyte chAracter[25;1H[K[23;42H[?25h[?0c[15C[?25l[?1c[1;42H:split[1;48H[K[2;42H|:split[2;49H[K[3;42H|:split[3;49H[K[4;42H|:wincmd l[4;52H[K[5;42Htart:[5;47H[K[6;42Ht nowrap[6;50H[K[7;42H|3zl:split[7;52H[K[8;42H6|3zl:split[8;53H[K[9;42H6|3zl:split[9;53H[K[10;42H|3zl:split[10;52H[K[11;42H|3zl:split[11;52H[K[12;42H6|3zl:split[12;53H[K[13;42H6|3zl:split[13;53H[K[14;42H6|3zl:split[14;53H[K[15;42Hsession! test.out[15;59H[K[16;42Hw test.out[16;52H[K[17;42H\(^ *normal! 0\|^ *exe 'normal!\)/d[17;77H[K[18;42H test.out[18;51H[K[19;42H![19;43H[K[20;42HTES[20;46H[K[22;42Hrt:[22;45H[K[23;42Hmultibyte chAracter[23;61H[K[23;54H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[1;42H6|3zl:split[2;42H6|3zl:split[3;42Hsession! test.out[4;42Hw test.out[5;42H\(^ *normal! 0\|^ *exe 'normal!\)/d[6;42H test.out[7;42H![7;43H[K[8;42HTEST[8;46H[K[9;42H[K[10;42Hrt:[10;45H[K[11;42Hmultibyte chAracter[12;42H[7mtest93.in [+]                          [23;54H[?25h[?0c[?25l[?1c[0m[13;42H6|3zl:split                            [14;42Hsession! test.out                      [15;42Hw test.out                             [16;42H\(^ *normal! 0\|^ *exe 'normal!\)/d    [17;42H test.out                              [18;42H!                                      [19;42HTEST                                   [20;42H                                       [21;42Hrt:                                    [22;42Hmultibyte chAracter                    [23;42H                                       [23;47Hone leaDing tab[25;1H[K[23;54H[?25h[?0c[?25l[?1c[13;42Hj016|3zl:split[14;42H:mksession! test.out[15;42H:new test.out[16;42H:v/\(^ *normal! 0\|^ *exe 'normal!\)/d[17;42H:w! test.out[18;42H:qa![19;42HENDTEST[21;42Hstart:[22;42Hno multibyte chAracter[23;47H   one leaDing tab[23;49H[?25h[?0c[8C[?25l[?1c[13;42H6|3zl:split[13;53H[K[14;42Hsession! test.out[14;59H[K[15;42Hw test.out[15;52H[K[16;42H\(^ *normal! 0\|^ *exe 'normal!\)/d[16;77H[K[17;42H test.out[17;51H[K[18;42H![18;43H[K[19;42HTES[19;46H[K[21;42Hrt:[21;45H[K[22;42Hmultibyte chAracter[22;61H[K[23;47Hone leaDing tab[23;62H[K[23;54H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1Hstart:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test93.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[5;9Hone leaDing tab[17C[7m|
test93.in [+]                           |[0m[7;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test93.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test93.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test93.in [+]                           |[0m
two     tabs    in one line[13C[7m|[0m
one  multibyteCharacter[16C[7m|
test93.in [+]                           |[0m
one  multibyteCharacter[16C[7m|[0m
a   two multiByte characters[10C[7m|
test93.in [+]                           |[0m
a   two multiByte characters[10C[7m|[0m
A  three mulTibyte characters[8C[7m|
test93.in [+]                            [0m[1;42H\(^ *normal! 0\|^ *exe 'normal!\)/d[2;43Htest.out[3;42H![4;42HTEST[6;42Hrt:[7;42Hmultibyte chAracter[8;42H[7mtest93.in [+]                          [0m[9;43Htest.out[10;42H![11;42HTEST[13;42Hrt:[14;42Hmultibyte chAracter[15;47Hone leaDing tab[16;42H[7mtest93.in [+]                          [0m[17;43Htest.out[18;42H![19;42HTEST[21;42Hrt:[22;42Hmultibyte chAracter[23;47Hone leaDing tab[24;42H[1m[7mtest93.in [+]                          [23;54H[?25h[?0c[?25l[?1c[0m[17;42H!                                      [18;42HTEST                                   [19;42H                                       [20;42Hrt:                                    [21;42Hmultibyte chAracter                    [22;42H     one leaDing tab                   [23;42H                                       [23;43Hfour leadinG spaces[23;54H[?25h[?0c[?25l[?1c[17;42H:qa![18;42HENDTEST[20;42Hstart:[21;42Hno multibyte chAracter[22;47H   one leaDing tab[23;43H   four leadinG spaces[23;42H[?25h[?0c[15C[?25l[?1c[17;42H![17;43H[K[18;42HTES[18;46H[K[20;42Hrt:[20;45H[K[21;42Hmultibyte chAracter[21;61H[K[22;47Hone leaDing tab[22;62H[K[23;43Hfour leadinG spaces[23;62H[K[23;54H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1Hstart:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test93.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[5;9Hone leaDing tab[17C[7m|
test93.in [+]                           |[0m[7;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test93.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test93.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test93.in [+]                           |[0m
two     tabs    in one line[13C[7m|[0m
one  multibyteCharacter[16C[7m|
test93.in [+]                           |[0m
one  multibyteCharacter[16C[7m|[0m
a   two multiByte characters[10C[7m|
test93.in [+]                           |[0m
a   two multiByte characters[10C[7m|[0m
A  three mulTibyte characters[8C[7m|
test93.in [+]                            [0m[1;42H![2;42HTEST[4;42Hrt:[5;42Hmultibyte chAracter[6;42H[7mtest93.in [+]                          [0m[7;42HTEST[9;42Hrt:[10;42Hmultibyte chAracter[11;47Hone leaDing tab[12;42H[7mtest93.in [+]                          [0m[14;42Hrt:[15;42Hmultibyte chAracter[16;47Hone leaDing tab[17;43Hfour leadinG spaces[18;42H[7mtest93.in [+]                          [0m[19;42Hrt:[20;42Hmultibyte chAracter[21;47Hone leaDing tab[22;43Hfour leadinG spaces[23;55Hconsecutive tabs[24;42H[1m[7mtest93.in [+]                          [22;54H[?25h[?0c[23;54H[?25l[?1c[0m[19;42Hstart:[20;42Hno multibyte chAracter[21;47H   one leaDing tab[22;43H   four leadinG spaces[23;42Htwo[10C   consecutive tabs[23;42H[?25h[?0c[7C[?25l[?1c[19;42Hrt:[19;45H[K[20;42Hmultibyte chAracter[20;61H[K[21;47Hone leaDing tab[21;62H[K[22;43Hfour leadinG spaces[22;62H[K[23;42H   [10Cconsecutive tabs[23;71H[K[23;46H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1Hstart:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test93.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[5;9Hone leaDing tab[17C[7m|
test93.in [+]                           |[0m[7;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test93.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test93.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test93.in [+]                           |[0m
two     tabs    in one line[13C[7m|[0m
one  multibyteCharacter[16C[7m|
test93.in [+]                           |[0m
one  multibyteCharacter[16C[7m|[0m
a   two multiByte characters[10C[7m|
test93.in [+]                           |[0m
a   two multiByte characters[10C[7m|[0m
A  three mulTibyte characters[8C[7m|
test93.in [+]                            [0m[1;42HTEST[3;42Hrt:[4;42Hmultibyte chAracter[5;42H[7mtest93.in [+]                          [0m[7;42Hrt:[8;42Hmultibyte chAracter[9;47Hone leaDing tab[10;42H[7mtest93.in [+]                          [0m[11;42Hrt:[12;42Hmultibyte chAracter[13;47Hone leaDing tab[14;43Hfour leadinG spaces[15;42H[7mtest93.in [+]                          [0m[16;47Hone leaDing tab[17;43Hfour leadinG spaces[18;55Hconsecutive tabs[19;42H[7mtest93.in [+]                          [0m[20;47Hone leaDing tab[21;43Hfour leadinG spaces[22;55Hconsecutive tabs[23;47Htabs    in one line[24;42H[1m[7mtest93.in [+]                          [22;46H[?25h[?0c[23;46H[?25l[?1c[0m[20;47H   one leaDing tab[21;43H   four leadinG spaces[22;42Htwo[10C   consecutive tabs[23;42Htwo     tabs    in one line[23;42H[?25h[?0c[7C[?25l[?1c[20;47Hone leaDing tab[20;62H[K[21;43Hfour leadinG spaces[21;62H[K[22;42H   [10Cconsecutive tabs[22;71H[K[23;42H     tabs    in one line[23;66H[K[23;46H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1Hstart:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test93.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[5;9Hone leaDing tab[17C[7m|
test93.in [+]                           |[0m[7;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test93.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test93.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test93.in [+]                           |[0m
two     tabs    in one line[13C[7m|[0m
one  multibyteCharacter[16C[7m|
test93.in [+]                           |[0m
one  multibyteCharacter[16C[7m|[0m
a   two multiByte characters[10C[7m|
test93.in [+]                           |[0m
a   two multiByte characters[10C[7m|[0m
A  three mulTibyte characters[8C[7m|
test93.in [+]                            [0m[2;42Hrt:[3;42Hmultibyte chAracter[4;42H[7mtest93.in [+]                          [0m[5;42Hrt:[6;42Hmultibyte chAracter[7;47Hone leaDing tab[8;42H[7mtest93.in [+]                          [0m[9;42Hmultibyte chAracter[10;47Hone leaDing tab[11;43Hfour leadinG spaces[12;42H[7mtest93.in [+]                          [0m[13;47Hone leaDing tab[14;43Hfour leadinG spaces[15;55Hconsecutive tabs[16;42H[7mtest93.in [+]                          [0m[17;43Hfour leadinG spaces[18;55Hconsecutive tabs[19;47Htabs    in one line[20;42H[7mtest93.in [+]                          [0m[21;55Hconsecutive tabs[22;47Htabs    in one line[23;43H multibyteCharacter[24;42H[1m[7mtest93.in [+]                          [22;46H[?25h[?0c[23;46H[?25l[?1c[0m[21;42Htwo[10C   consecutive tabs[22;42Htwo     tabs    in one line[23;42Hone  multibyteCharacter[23;42H[?25h[?0c[15C[?25l[?1c[21;42H   [10Cconsecutive tabs[21;71H[K[22;42H     tabs    in one line[22;66H[K[23;42H  multibyteCharacter[23;63H[K[23;54H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1Hstart:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test93.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[5;9Hone leaDing tab[17C[7m|
test93.in [+]                           |[0m[7;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test93.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test93.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test93.in [+]                           |[0m
two     tabs    in one line[13C[7m|[0m
one  multibyteCharacter[16C[7m|
test93.in [+]                           |[0m
one  multibyteCharacter[16C[7m|[0m
a   two multiByte characters[10C[7m|
test93.in [+]                           |[0m
a   two multiByte characters[10C[7m|[0m
A  three mulTibyte characters[8C[7m|
test93.in [+]                            [0m[1;42Hrt:[2;42Hmultibyte chAracter[3;42H[7mtest93.in [+]                          [0m[4;42Hmultibyte chAracter[5;47Hone leaDing tab[6;42H[7mtest93.in [+]                          [0m[7;42Hmultibyte chAracter[8;47Hone leaDing tab[9;43Hfour leadinG spaces[10;42H[7mtest93.in [+]                          [0m[11;43Hfour leadinG spaces[12;55Hconsecutive tabs[13;42H[7mtest93.in [+]                          [0m[14;43Hfour leadinG spaces[15;55Hconsecutive tabs[16;47Htabs    in one line[17;42H[7mtest93.in [+]                          [0m[18;47Htabs    in one line[19;43H multibyteCharacter[20;42H[7mtest93.in [+]                          [0m[21;55Hconsecutive tabs[22;47Htabs    in one line[23;43H multibyteCharacter[24;42H[1m[7mtest93.in [+]                          [23;54H[?25h[?0c[?25l[?1c[0m[21;42H     tabs    in one line               [22;42H  multibyteCharacter                  [23;42H                                       [23;42H  two multiByte characters[23;54H[?25h[?0c[?25l[?1c[21;42Htwo     tabs    in one line[22;42Hone  multibyteCharacter[23;42Ha   two multiByte characters[23;42H[?25h[?0c[15C[?25l[?1c[21;42H     tabs    in one line[21;66H[K[22;42H  multibyteCharacter[22;63H[K[23;42H  two multiByte characters[23;69H[K[23;54H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1Hstart:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test93.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[5;9Hone leaDing tab[17C[7m|
test93.in [+]                           |[0m[7;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test93.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test93.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test93.in [+]                           |[0m
two     tabs    in one line[13C[7m|[0m
one  multibyteCharacter[16C[7m|
test93.in [+]                           |[0m
one  multibyteCharacter[16C[7m|[0m
a   two multiByte characters[10C[7m|
test93.in [+]                           |[0m
a   two multiByte characters[10C[7m|[0m
A  three mulTibyte characters[8C[7m|
test93.in [+]                            [0m[1;42Hrt:[2;42Hmultibyte chAracter[3;42H[7mtest93.in [+]                          [0m[4;42Hmultibyte chAracter[5;47Hone leaDing tab[6;42H[7mtest93.in [+]                          [0m[7;47Hone leaDing tab[8;43Hfour leadinG spaces[9;42H[7mtest93.in [+]                          [0m[10;43Hfour leadinG spaces[11;55Hconsecutive tabs[12;42H[7mtest93.in [+]                          [0m[13;55Hconsecutive tabs[14;47Htabs    in one line[15;42H[7mtest93.in [+]                          [0m[16;47Htabs    in one line[17;43H multibyteCharacter[18;42H[7mtest93.in [+]                          [0m[19;43H multibyteCharacter[20;42H  two multiByte characters[21;42H[7mtest93.in [+]                          [0m[22;43H multibyteCharacter[23;42H  two multiByte characters[24;42H[1m[7mtest93.in [+]                          [23;54H[?25h[?0c[?25l[?1c[0m[22;42H  two multiByte characters            [23;42H                                       [23;42H  three mulTibyte characters[23;54H[?25h[?0c[?25l[?1c[22;42Ha   two multiByte characters[23;42HA  three mulTibyte characters[23;42H[?25h[?0c[15C[?25l[?1c[22;42H  two multiByte characters[22;69H[K[23;42H  three mulTibyte characters[23;71H[K[23;54H[?25h[?0c[?25l[?1c

:[?25h[?0csplit[?25l[?1c[27m[24m[0m[H[J[1;1Hstart:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test93.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[5;9Hone leaDing tab[17C[7m|
test93.in [+]                           |[0m[7;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test93.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test93.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test93.in [+]                           |[0m
two     tabs    in one line[13C[7m|[0m
one  multibyteCharacter[16C[7m|
test93.in [+]                           |[0m
one  multibyteCharacter[16C[7m|[0m
a   two multiByte characters[10C[7m|
test93.in [+]                           |[0m
a   two multiByte characters[10C[7m|[0m
A  three mulTibyte characters[8C[7m|
test93.in [+]                            [0m[1;42Hrt:[2;42Hmultibyte chAracter[3;42H[7mtest93.in [+]                          [0m[4;42Hmultibyte chAracter[5;47Hone leaDing tab[6;42H[7mtest93.in [+]                          [0m[7;47Hone leaDing tab[8;43Hfour leadinG spaces[9;42H[7mtest93.in [+]                          [0m[10;43Hfour leadinG spaces[11;55Hconsecutive tabs[12;42H[7mtest93.in [+]                          [0m[13;55Hconsecutive tabs[14;47Htabs    in one line[15;42H[7mtest93.in [+]                          [0m[16;47Htabs    in one line[17;42H[7mtest93.in [+]                          [0m[18;43H multibyteCharacter[19;42H  two multiByte characters[20;42H[7mtest93.in [+]                          [0m[21;42H  three mulTibyte characters[22;42H[7mtest93.in [+]                          [0m[23;42H  three mulTibyte characters[24;42H[1m[7mtest93.in [+]                          [23;54H[?25h[?0c[?25l[?1c

[0m:[?25h[?0cmksession! test.out[?25l[?1c[23;54H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnew test.out[?25l[?1c"test.out" [25;12H[K[25;12H282 lines, 5375 characters[27m[24m[0m[H[J[1;1Hstart:[34C[7m|[0m
no multibyte chAracter[18C[7m|
test93.in [+]                           |[0m
no multibyte chAracter[18C[7m|[0m[5;9Hone leaDing tab[17C[7m|
test93.in [+]                           |[0m[7;9Hone leaDing tab[17C[7m|[0m
    four leadinG spaces[17C[7m|
test93.in [+]                           |[0m
    four leadinG spaces[17C[7m|[0m
two[13Cconsecutive tabs[8C[7m|
test93.in [+]                           |[0m
two[13Cconsecutive tabs[8C[7m|[0m
two     tabs    in one line[13C[7m|
test93.in [+]                           |[0m
two     tabs    in one line[13C[7m|[0m
one  multibyteCharacter[16C[7m|
test93.in [+]                           |[0m
one  multibyteCharacter[16C[7m|[0m
a   two multiByte characters[10C[7m|
test93.in [+]                           |[0m
a   two multiByte characters[10C[7m|[0m
A  three mulTibyte characters[8C[7m|
test93.in [+]                            [0m[1;42Hrt:[2;42H[7mtest93.in [+]                          [0m[3;42Hmultibyte chAracter[4;47Hone leaDing tab[5;42H[7mtest93.in [+]                          [0m[6;47Hone leaDing tab[7;42H[7mtest93.in [+]                          [0m[8;43Hfour leadinG spaces[9;55Hconsecutive tabs[10;42H[7mtest93.in [+]                          [0m[11;55Hconsecutive tabs[12;42H[7mtest93.in [+]                          [0m[13;47Htabs    in one line[14;43H multibyteCharacter[15;42H[7mtest93.in [+]                          [0m[16;43H multibyteCharacter[17;42H[7mtest93.in [+]                          [0m[18;42H  three mulTibyte characters[19;42H[1m[34m~                                      [0m[20;42H[7mtest93.in [+]                          [0m[21;42H  three mulTibyte characters[22;42H[7mtest93.in [+]                          [0m[23;42Hlet SessionLoad = 1[24;42H[1m[7mtest.out                               [23;42H[?25h[?0c[?25l[?1c

[0m:[?25h[?0cv/\(^ *normal! 0\|^ *exe 'normal!\)/d[?25l[?1c256 fewer lines[25;17H[K[23;42H  normal! 016|[23;56H[K[24;51H[1m[7m[+][23;44H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! test.out[?25l[?1c"test.out" [25;12H[K[25;12H26 lines, 611 characters written[24;51H[1m[7m   [23;44H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test94.failed test.ok test.out X* viminfo
cp test94.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test94.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test94.in" 95 lines, 2163 characters[1;1HTest for Visual mode and operators

Tests for the two kinds of operations: Those executed with Visual mode
followed by an operator and those executed via Operator-pending mode. Also
part of the test are mappings, counts, and repetition with the . command.

Test cases:
- Visual modes (v V CTRL-V) followed by an operator; count; repeating
- Visual mode maps; count; repeating
  - Simple
  - With an Ex command (custom text object)
- Operator-pending mode maps
  - Simple
  - With Ex command moving the cursor
  - With Ex command and Visual selection (custom text object)
- Patch 7.3.879: Properly abort Ex command in Operator-pending mode

STARTTEST
:so small.vim
:set nocp viminfo+=nviminfo
:
:" User functions
:function MoveToCap()
:  call search('\u', 'W')[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for Visual mode and operators[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[18;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[19;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 50 lines, 1176 characters written[19;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[19;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H/^Lemon
yiWPlciWNew[1m[34m^[[0mfr.:
:
:" Patch 7.3.879: Properly abort Operator-pending mode for "dv:<Esc>" etc.
/^zzzz
dV:[1m[34m^M[0mdv:[1m[34m^M[0m:set noma | let v:errmsg = ''
d:[1m[34m^M[0m:set ma | put = v:errmsg =~# '^E21' ? 'ok' : 'failed'
dv:[1m[34m^[[0mdV:[1m[34m^[[0m:set noma | let v:errmsg = ''
d:[1m[34m^[[0m:set ma | put = v:errmsg =~# '^E21' ? 'failed' : 'ok'
:/^start:/+2,$w! test.out
:q!
ENDTEST

start:

apple banana cherry

line 1 line 1
line 2 line 2
line 3 line 3
line 4 line 4
line 5 line 5
line 6 line 6[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nocp viminfo+=nviminfo[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" User functions[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunction MoveToCap()[?25l[?1c
:  [?25h[?0c:  call search('\u', 'W')
[?25l[?1c:  [?25h[?0c:endfunction[1;1H[2L[?25l[?1c[1;1H/^Lemon
yiWPlciWNew[1m[34m^[[0mfr.:[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cfunction SelectInCaps()[?25l[?1c
:  [?25h[?0c:  let [line1, col1] = searchpos('\u', 'bcnW')
[?25l[?1c:  [?25h[?0c:  let [line2, col2] = searchpos('.\u', 'nW')
[?25l[?1c:  [?25h[?0c:  call setpos("'<", [0, line1, col1, 0])
[?25l[?1c:  [?25h[?0c:  call setpos("'>", [0, line2, col2, 0])
[?25l[?1c:  [?25h[?0c:  normal! gv
[?25l[?1c:  [?25h[?0c:endfunction[1;1H[6L[?25l[?1c[1;1H/^Lemon
yiWPlciWNew[1m[34m^[[0mfr.:
:
:" Patch 7.3.879: Properly abort Operator-pending mode for "dv:<Esc>" etc.
/^zzzz
dV:[1m[34m^M[0mdv:[1m[34m^M[0m:set noma | let v:errmsg = ''[25;1H[K[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Visual modes followed by operator[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^apple[?25l[?1c[16;1H[?25h[?0ca[?25l[?1c[25;1H[1m-- VISUAL --[16;2H[?25h[?0c[?25l[?1c[0m[7mp[?25h[?0c[?25l[?1c[0mle banana cherry[16;18H[K[25;1H[K[16;2H[?25h[?0c[?25l[?1c banana cherry[16;16H[K[16;2H[?25h[?0c [?25l[?1c[7mbanan[0m[25;1H[1m-- VISUAL --[16;8H[?25h[?0c[?25l[?1c[0ma  cherry[16;10H[K[25;1H[K[16;3H[?25h[?0c[?25l[?1cy[16;4H[K[16;3H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c[?25l[?1c[16;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^line 1[?25l[?1c[18;1H[?25h[?0c[?25l[?1cl[7mine 1 line 1 [0m[25;1H[1m-- VISUAL LINE --[18;1H[?25h[?0c[?25l[?1c[25;4HINSERT --[0m[25;13H[K[25;1H[K[18;1Hnewline[18;8H[K[18;7H[?25h[?0c[19;7H[?25l[?1c[25;1H[1m-- INSERT --[0m[25;1H[K[19;1Hnewline[19;8H[K[19;7H[?25h[?0c[20;7H[?25l[?1c[7mline 3 line 3 
line 4[0m [7mline 4 [0m[25;1H[1m-- VISUAL LINE --[21;7H[?25h[?0c[?25l[?1c[20;24r[0m[20;1H[2M[1;25r[23;1Hxxxxxxxxxxxxx
xxxxxxxxxxxxx[25;1H[K[20;1H[?25h[?0c[?25l[?1c[20;24r[20;1H[2M[1;25r[23;1Hxxxxxxxxxxxxx
xxxxxxxxxxxxx[20;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^xxxx[?25l[?1c[21;1H[?25h[?0c[?25l[?1c[25;1H[1m-- VISUAL BLOCK --[21;1H[?25h[?0c[?25l[?1c[0m[7mx
[?25h[?0c[?25l[?1c[21;2Hx
x[?25h[?0c[?25l[?1c[0m[25;4H[1mINSERT --[0m[25;13H[K[25;1H[K[21;1H  
  [21;2H[?25h[?0c [?25l[?1c[25;1H[1m-- INSERT --[0m[25;1H[K[21;3H  
    [21;4H[?25h[?0c [?25l[?1c[7mxxxx
[0m    [7mxxxx
[0mxxxx[7mxxxx
[0mxxxx[7mxxx[0m
[1m-- VISUAL BLOCK --[24;8H[?25h[?0c[?25l[?1c
-- INSERT --[0m[25;13H[K[25;1H[K[21;5H----
    ----
xxxx----
xxxx----[21;8H[?25h[?0c-[?25l[?1c[25;1H[1m-- INSERT --[0m[25;1H[K[21;9H----[22;9H----[23;9H----[24;9H----[21;12H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c[?25l[?1c[21;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[?25l[?1c[21;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Visual mode maps (movement and text object)[?25l[?1c[21;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cvnoremap W /\u/s-1<CR>[?25l[?1c[21;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cvnoremap iW :<C-U>call SelectInCaps()<CR>[?25l[?1c[21;12H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^Kiwi[?25l[?1c[1;24r[1;1H[2M[1;25r[24;1HKiwiRaspberryDateWatermelonPeach[25;1H[K[24;1H[?25h[?0c[?25l[?1c
[1m-- VISUAL --[24;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H/\u/s-1[24;1H[7mKiw[?25h[?0c[?25l[?1c[0m
[1m-- INSERT --[0m[25;1H[K[24;1HNoRaspberryDateWatermelonPeach[24;31H[K[24;2H[?25h[?0co[?25l[?1c
[1m-- INSERT --[0m[25;1H[K[24;3HNoberryDateWatermelonPeach[24;29H[K[24;4H[?25h[?0coberry[?25l[?1c[7mDateWat[0m
[1m-- VISUAL --[24;17H[?25h[?0c[?25l[?1c[0m[24;10HrmelonPeach[24;21H[K[25;1H[K[24;10H[?25h[?0c[?25l[?1cach[24;13H[K[24;10H[?25h[?0c[?25l[?1c
:[?25h[?0c[?25l[?1c[24;10H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^Jambu[?25l[?1c[1;24r[24;1H
[1;25r[24;1HJambuRambutanBananaTangerineMango[25;1H[K[24;1H[?25h[?0cJa[?25l[?1c
[1m-- VISUAL --[24;3H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:'<,'>[25;2H[K[25;2Hcall SelectInCaps()[24;1H[7mJamb[?25h[?0c[?25l[?1c[0m
[1m-- INSERT --[0m[25;13H[K[25;1H[K[24;1H-RambutanBananaTangerineMango[24;30H[K[24;1H[?25h[?0c-[?25l[?1c
[1m-- INSERT --[0m[25;1H[K[24;2H-tanBananaTangerineMango[24;26H[K[24;2H[?25h[?0c-[?25l[?1c[7mtanBanana[0m
[1m-- VISUAL --[24;12H[?25h[?0c[?25l[?1c[0m--angerineMango[24;16H[K[25;1H[K[24;3H[?25h[?0ca[?25l[?1cgo[24;6H[K[24;4H[?25h[?0c[?25l[?1c
:[?25h[?0c[?25l[?1c[24;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[?25l[?1c[24;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Operator-pending mode maps (movement and text object)[?25l[?1c[24;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0conoremap W /\u/<CR>[?25l[?1c[24;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0conoremap <Leader>W :<C-U>call MoveToCap()<CR>[?25l[?1c[24;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0conoremap iW :<C-U>call SelectInCaps()<CR>[?25l[?1c[24;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^Pineapple[?25l[?1c[1;24r[1;1H[2M[1;25r[24;1HPineappleQuinceLoganberryOrangeGrapefruitKiwiZ[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/\u/[25;4H[K[25;1H[25;1H[K[24;1H-QuinceLoganberryOrangeGrapefruitKiwiZ[24;39H[K[24;1H[?25h[?0c-[?25l[?1c
/\u/[25;4H[K[25;1H[1m-- INSERT --[0m[25;1H[K[24;2H-LoganberryOrangeGrapefruitKiwiZ[24;34H[K[24;2H[?25h[?0c-[?25l[?1c
/\u/[25;4H[K[25;1H[1m-- INSERT --[0m[25;1H[K[24;3H-GrapefruitKiwiZ[24;19H[K[24;3H[?25h[?0c-[?25l[?1c
/\u/[25;4H[K[25;1H[1m-- INSERT --[0m[25;1H[K[24;4H-Z[24;6H[K[24;4H[?25h[?0c[?25l[?1c
:[?25h[?0c[?25l[?1c[24;4H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^Juniper[?25l[?1c[1;24r[24;1H
[1;25r[24;1HJuniperDurianZ[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:call MoveToCap()[24;1HWhavcre[?25h[?0c[7C[?25l[?1c[25;1H[K[25;1H:call MoveToCap()[24;8HQhevna[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[?25l[?1c[24;8H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^Lemon[?25l[?1c[1;24r[24;1H
[1;25r[24;1HLemonNectarineZ[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:call SelectInCaps()[24;1H[?25h[?0c[?25l[?1cLemonLemonNectarineZLemo[?25h[?0cn[?25l[?1c[25;1H[K[25;1H:call SelectInCaps()[25;1H[K[24;6HNewNectarineZ[24;19H[K[24;8H[?25h[?0cwNecta[?25l[?1c
:call SelectInCaps()[25;1H[K[24;11HwZ[24;13H[K[24;11H[?25h[?0c[?25l[?1c
:[?25h[?0c[?25l[?1c[24;11H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[?25l[?1c[24;11H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Patch 7.3.879: Properly abort Operator-pending mode for "dv:<Esc>" etc.[?25l[?1c[24;11H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^zzzz[?25l[?1c[1;24r[1;1H[2M[1;25r[24;1Hzzzz[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[?25l[?1c[24;4H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset noma | let v:errmsg = ''[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[?25l[?1c[1m[37m[41mE21: Cannot make changes, 'modifiable' is off[24;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset ma | put = v:errmsg =~# '^E21' ? 'ok' : 'failed'[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hok[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c[?25l[?1c[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c[?25l[?1c[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset noma | let v:errmsg = ''[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[?25l[?1c[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset ma | put = v:errmsg =~# '^E21' ? 'failed' : 'ok'[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hok[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c/^start:/+2,$w! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New] 20L, 144C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cq![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test95.failed test.ok test.out X* viminfo
cp test95.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test95.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test95.in" 141 lines, 5816 characters[1;1HTest for regexp patterns with multi-byte support, using utf-8.
See test64 for the non-multi-byte tests.

A pattern that gives the expected result produces OK, so that we know it was
actually tried.

STARTTEST
:so small.vim
:so mbyte.vim
:set nocp encoding=utf-8 viminfo+=nviminfo nomore
:" tl is a List of Lists with:
:"    2: test auto/old/new  0: test auto/old  1: test auto/new
:"    regexp pattern
:"    text to test the pattern on
:"    expected match (optional)
:"    expected submatch 1 (optional)
:"    expected submatch 2 (optional)
:"    etc.
:"  When there is no match use only the first two items.
:let tl = []

:"""" Multi-byte character tests. These will fail unless vim is compiled
:"""" with Multibyte (FEAT_MBYTE) or BIG/HUGE features.
:call add(tl, [2, '[[:alpha:][=a=]]\+', '879 aiaãâaiuvna ', 'aiaãâaiuvna'])[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for regexp patterns with multi-byte support, using utf-8.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[7;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[8;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 131 lines, 5579 characters written[8;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[8;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:[10C$put ='ERROR ' . engine . ': pat: \"' . pat . '\", text: \"' . text .[2;2H'\", submatch ' . i . ': \"' . l[i] . '\", expected: \"' . e . '\"'
:[8Cendif
:      endfor
:      unlet i
:    endif
:  endfor
:endfor
:unlet t tl e l

:" check that 'ambiwidth' does not change the meaning of \p
:set regexpengine=1 ambiwidth=single
:$put ='eng 1 ambi single: ' . match(\"\u00EC\", '\p')
:set regexpengine=1 ambiwidth=double
:$put ='eng 1 ambi double: ' . match(\"\u00EC\", '\p')
:set regexpengine=2 ambiwidth=single
:$put ='eng 2 ambi single: ' . match(\"\u00EC\", '\p')
:set regexpengine=2 ambiwidth=double
:$put ='eng 2 ambi double: ' . match(\"\u00EC\", '\p')

:/\%#=1^Results/,$wq! test.out
ENDTEST

Results of test95:[22;1H[?25h[?0c
[?25l[?1c

:so! Xdotest[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso mbyte.vim[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nocp encoding=utf-8 viminfo+=nviminfo nomore[?25l[?1c[27m[24m[0m[H[J[1;1H:[10C$put ='ERROR ' . engine . ': pat: \"' . pat . '\", text: \"' . text .[2;2H'\", submatch ' . i . ': \"' . l[i] . '\", expected: \"' . e . '\"'
:[8Cendif
:      endfor
:      unlet i
:    endif
:  endfor
:endfor
:unlet t tl e l

:" check that 'ambiwidth' does not change the meaning of \p
:set regexpengine=1 ambiwidth=single
:$put ='eng 1 ambi single: ' . match(\"\u00EC\", '\p')
:set regexpengine=1 ambiwidth=double
:$put ='eng 1 ambi double: ' . match(\"\u00EC\", '\p')
:set regexpengine=2 ambiwidth=single
:$put ='eng 2 ambi single: ' . match(\"\u00EC\", '\p')
:set regexpengine=2 ambiwidth=double
:$put ='eng 2 ambi double: ' . match(\"\u00EC\", '\p')

:/\%#=1^Results/,$wq! test.out
ENDTEST

Results of test95:[23;1H[?25h[?0c[?25l[?1c

:[?25h[?0c" tl is a List of Lists with:[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    2: test auto/old/new  0: test auto/old  1: test auto/new[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    regexp pattern[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    text to test the pattern on[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    expected match (optional)[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    expected submatch 1 (optional)[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    expected submatch 2 (optional)[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"    etc.[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"  When there is no match use only the first two items.[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet tl = [][?25l[?1c[23;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" Multi-byte character tests. These will fail unless vim is compiled[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" with Multibyte (FEAT_MBYTE) or BIG/HUGE features.[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[[:alpha:][=a=]]\+', '879 aiaãâaiuvna ', 'aiaãâaiuvna'])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[[=a=]]\+', 'ddaãâbcd', 'aãâ'])[1m[34m^I^I^I^I^I^I^I^I[0m" equivalence
classes[?25l[?1c[1;1H[L[1;1H:[10C$put ='ERROR ' . engine . ': pat: \"' . pat . '\", text: \"' . text .[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0ccall add(tl, [2, '[^ม ]\+', 'มม oijasoifjos ifjoisj f osij j มมมมม abcd', 'oij
[24;80Ha[25;1Hsoifjos'])[?25l[?1c[1;1H[L[1;1H:[10C$put ='ERROR ' . engine . ': pat: \"' . pat . '\", text: \"' . text .[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0ccall add(tl, [2, ' [^ ]\+', 'start มabcdม ', ' มabcdม'])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[ม[:alpha:][=a=]]\+', '879 aiaãมâมaiuvna ', 'aiaãมâมaiuvna']
[24;80H)[25;1H[?25l[?1c[1;1H[L[1;1H:[10C$put ='ERROR ' . engine . ': pat: \"' . pat . '\", text: \"' . text .[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c" this is not a normal "i" but 0xec[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\p\+', 'ìa', 'ìa'])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\p*', 'aあ', 'aあ'])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" Test recognition of some character classes[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\i\+', '&*¨xx ', 'xx'])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '\f\+', '&*[1m[34m<9f>[0mfname ', 'fname'])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" Test composing character matching[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '.ม', 'xมม่x yมy', 'yม'])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '.มม่', 'xมม่x yมy', 'xมม่'])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, "\u05b9", " x\u05b9 ", "x\u05b9"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, ".\u05b9", " x\u05b9 ", "x\u05b9"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, "\u05b9\u05bb", " x\u05b9\u05bb ", "x\u05b9\u05bb"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, ".\u05b9\u05bb", " x\u05b9\u05bb ", "x\u05b9\u05bb"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, "\u05bb\u05b9", " x\u05b9\u05bb ", "x\u05b9\u05bb"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, ".\u05bb\u05b9", " x\u05b9\u05bb ", "x\u05b9\u05bb"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, "\u05b9", " y\u05bb x\u05b9 ", "x\u05b9"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, ".\u05b9", " y\u05bb x\u05b9 ", "x\u05b9"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, "\u05b9", " y\u05bb\u05b9 x\u05b9 ", "y\u05bb\u05b9"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, ".\u05b9", " y\u05bb\u05b9 x\u05b9 ", "y\u05bb\u05b9"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [1, "\u05b9\u05bb", " y\u05b9 x\u05b9\u05bb ", "x\u05b9\u05bb"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, ".\u05b9\u05bb", " y\u05bb x\u05b9\u05bb ", "x\u05b9\u05bb"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, "a", "ca\u0300t"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, "ca", "ca\u0300t"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, "a\u0300", "ca\u0300t", "a\u0300"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'a\%C', "ca\u0300t", "a\u0300"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'ca\%C', "ca\u0300t", "ca\u0300"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'ca\%Ct', "ca\u0300t", "ca\u0300t"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" Test \Z[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'ú\Z', 'x'])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'יהוה\Z', 'יהוה', 'יהוה'])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'ייְהווָה\Z', 'יהוה', 'יהוה'])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'יהוה\Z', 'ייְהווָה', 'ייְהווָה'])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'ייְהווָה\Z', 'ייְהווָה', 'ייְהווָה'])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, 'ייְ\Z', 'ווְייַ', 'ייַ'])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, "ק\u200d\u05b9x\\Z", "xק\u200d\u05b9xy", "ק\u200d\u05b9x"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, "ק\u200d\u05b9x\\Z", "xק\u200dxy", "ק\u200dx"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, "ק\u200dx\\Z", "xק\u200d\u05b9xy", "ק\u200d\u05b9x"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, "ק\u200dx\\Z", "xק\u200dxy", "ק\u200dx"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, "\u05b9\\Z", "xyz"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, "\\Z\u05b9", "xyz"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, "\u05b9\\Z", "xy\u05b9z", "y\u05b9"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, "\\Z\u05b9", "xy\u05b9z", "y\u05b9"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [1, "\u05b9\\+\\Z", "xy\u05b9z\u05b9 ", "y\u05b9z\u05b9"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [1, "\\Z\u05b9\\+", "xy\u05b9z\u05b9 ", "y\u05b9z\u05b9"])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" Combining different tests and features[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall add(tl, [2, '[^[=a=]]\+', 'ddaãâbcd', 'dd'])[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"""" Run the tests[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfor t in tl[?25l[?1c
:  [?25h[?0c:  let re = t[0]
[?25l[?1c:  [?25h[?0c:  let pat = t[1]
[?25l[?1c:  [?25h[?0c:  let text = t[2]
[?25l[?1c:  [?25h[?0c:  let matchidx = 3
[?25l[?1c:  [?25h[?0c:  for engine in [0, 1, 2]
[?25l[?1c:    [?25h[?0c:    if engine == 2 && re == 0 || engine == 1 && re == 1
[?25l[?1c:      [?25h[?0c:      continue
[?25l[?1c:      [?25h[?0c:    endif
[?25l[?1c:    [?25h[?0c:    let &regexpengine = engine
[?25l[?1c:    [?25h[?0c:    try
[?25l[?1c:      [?25h[?0c:      let l = matchlist(text, pat)
[?25l[?1c:      [?25h[?0c:    catch
[?25l[?1c:      [?25h[?0c:      $put ='ERROR ' . engine . ': pat: \"' . pat . '\", text: \"' . te
[24;80Hx[25;1Ht . '\", caused an exception: \"' . v:exception . '\"'
[?25l[?1c:      [?25h[?0c:    endtry
[?25l[?1c:    [?25h[?0c:" check the match itself
[?25l[?1c:    [?25h[?0c:    if len(l) == 0 && len(t) > matchidx
[?25l[?1c:      [?25h[?0c:      $put ='ERROR ' . engine . ': pat: \"' . pat . '\", text: \"' . te
[24;80Hx[25;1Ht . '\", did not match, expected: \"' . t[matchidx] . '\"'
[?25l[?1c:      [?25h[?0c:    elseif len(l) > 0 && len(t) == matchidx
[?25l[?1c:      [?25h[?0c:      $put ='ERROR ' . engine . ': pat: \"' . pat . '\", text: \"' . te
[24;80Hx[25;1Ht . '\", match: \"' . l[0] . '\", expected no match'
[?25l[?1c:      [?25h[?0c:    elseif len(t) > matchidx && l[0] != t[matchidx]
[?25l[?1c:      [?25h[?0c:      $put ='ERROR ' . engine . ': pat: \"' . pat . '\", text: \"' . tet . '\", match: \"' . l[0] . '\", expected: \"' . t[matchidx] . '\"'
[?25l[?1c:      [?25h[?0c:    else
[?25l[?1c:      [?25h[?0c:      $put ='OK ' . engine . ' - ' . pat
[?25l[?1c:      [?25h[?0c:    endif
[?25l[?1c:    [?25h[?0c:    if len(l) > 0
[?25l[?1c:      [?25h[?0c:"   check all the nine submatches
[?25l[?1c:      [?25h[?0c:      for i in range(1, 9)
[?25l[?1c:[8C[?25h[?0c:        if len(t) <= matchidx + i
[?25l[?1c:[10C[?25h[?0c:          let e = ''
[?25l[?1c:[10C[?25h[?0c:        else
[?25l[?1c:[10C[?25h[?0c:          let e = t[matchidx + i]
[?25l[?1c:[10C[?25h[?0c:        endif
[?25l[?1c:[8C[?25h[?0c:        if l[i] != e
[?25l[?1c:[10C[?25h[?0c:          $put ='ERROR ' . engine . ': pat: \"' . pat . '\", text: "' . text . '\", submatch ' . i . ': \"' . l[i] . '\", expected: \"' . e . '\"'
[?25l[?1c:[10C[?25h[?0c:        endif
[?25l[?1c:[8C[?25h[?0c:      endfor
[?25l[?1c:      [?25h[?0c:      unlet i
[?25l[?1c:      [?25h[?0c:    endif
[?25l[?1c:    [?25h[?0c:  endfor
[?25l[?1c:  [?25h[?0c:endfor[27m[24m[0m[H[J[?25l[?1c[1;1HOK 1 - ק[1m[34m<200d>[0mx\Z
OK 2 - ק[1m[34m<200d>[0mx\Z
OK 0 - ק[1m[34m<200d>[0mx\Z
OK 1 - ק[1m[34m<200d>[0mx\Z
OK 2 - ק[1m[34m<200d>[0mx\Z
OK 0 - ֹ\Z
OK 1 - ֹ\Z
OK 2 - ֹ\Z
OK 0 - \Zֹ
OK 1 - \Zֹ
OK 2 - \Zֹ
OK 0 - ֹ\Z
OK 1 - ֹ\Z
OK 2 - ֹ\Z
OK 0 - \Zֹ
OK 1 - \Zֹ
OK 2 - \Zֹ
OK 0 - ֹ\+\Z
OK 2 - ֹ\+\Z
OK 0 - \Zֹ\+
OK 2 - \Zֹ\+
OK 0 - [^[=a=]]\+
OK 1 - [^[=a=]]\+
OK 2 - [^[=a=]]\+[?25h[?0c[?25l[?1c
:[?25h[?0cunlet t tl e l[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" check that 'ambiwidth' does not change the meaning of \p[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset regexpengine=1 ambiwidth=single[?25l[?1c[27m[24m[0m[H[J[1;1HOK 1 - ק[1m[34m<200d>[0mx\Z
OK 2 - ק[1m[34m<200d>[0mx\Z
OK 0 - ק[1m[34m<200d>[0mx\Z
OK 1 - ק[1m[34m<200d>[0mx\Z
OK 2 - ק[1m[34m<200d>[0mx\Z
OK 0 - ֹ\Z
OK 1 - ֹ\Z
OK 2 - ֹ\Z
OK 0 - \Zֹ
OK 1 - \Zֹ
OK 2 - \Zֹ
OK 0 - ֹ\Z
OK 1 - ֹ\Z
OK 2 - ֹ\Z
OK 0 - \Zֹ
OK 1 - \Zֹ
OK 2 - \Zֹ
OK 0 - ֹ\+\Z
OK 2 - ֹ\+\Z
OK 0 - \Zֹ\+
OK 2 - \Zֹ\+
OK 0 - [^[=a=]]\+
OK 1 - [^[=a=]]\+
OK 2 - [^[=a=]]\+[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='eng 1 ambi single: ' . match(\"\u00EC\", '\p')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Heng 1 ambi single: 0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset regexpengine=1 ambiwidth=double[?25l[?1c[27m[24m[0m[H[J[1;1HOK 2 - ק[1m[34m<200d>[0mx\Z
OK 0 - ק[1m[34m<200d>[0mx\Z
OK 1 - ק[1m[34m<200d>[0mx\Z
OK 2 - ק[1m[34m<200d>[0mx\Z
OK 0 - ֹ\Z
OK 1 - ֹ\Z
OK 2 - ֹ\Z
OK 0 - \Zֹ
OK 1 - \Zֹ
OK 2 - \Zֹ
OK 0 - ֹ\Z
OK 1 - ֹ\Z
OK 2 - ֹ\Z
OK 0 - \Zֹ
OK 1 - \Zֹ
OK 2 - \Zֹ
OK 0 - ֹ\+\Z
OK 2 - ֹ\+\Z
OK 0 - \Zֹ\+
OK 2 - \Zֹ\+
OK 0 - [^[=a=]]\+
OK 1 - [^[=a=]]\+
OK 2 - [^[=a=]]\+
eng 1 ambi single: 0[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='eng 1 ambi double: ' . match(\"\u00EC\", '\p')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Heng 1 ambi double: 0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset regexpengine=2 ambiwidth=single[?25l[?1c[27m[24m[0m[H[J[1;1HOK 0 - ק[1m[34m<200d>[0mx\Z
OK 1 - ק[1m[34m<200d>[0mx\Z
OK 2 - ק[1m[34m<200d>[0mx\Z
OK 0 - ֹ\Z
OK 1 - ֹ\Z
OK 2 - ֹ\Z
OK 0 - \Zֹ
OK 1 - \Zֹ
OK 2 - \Zֹ
OK 0 - ֹ\Z
OK 1 - ֹ\Z
OK 2 - ֹ\Z
OK 0 - \Zֹ
OK 1 - \Zֹ
OK 2 - \Zֹ
OK 0 - ֹ\+\Z
OK 2 - ֹ\+\Z
OK 0 - \Zֹ\+
OK 2 - \Zֹ\+
OK 0 - [^[=a=]]\+
OK 1 - [^[=a=]]\+
OK 2 - [^[=a=]]\+
eng 1 ambi single: 0
eng 1 ambi double: 0[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='eng 2 ambi single: ' . match(\"\u00EC\", '\p')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Heng 2 ambi single: 0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset regexpengine=2 ambiwidth=double[?25l[?1c[27m[24m[0m[H[J[1;1HOK 1 - ק[1m[34m<200d>[0mx\Z
OK 2 - ק[1m[34m<200d>[0mx\Z
OK 0 - ֹ\Z
OK 1 - ֹ\Z
OK 2 - ֹ\Z
OK 0 - \Zֹ
OK 1 - \Zֹ
OK 2 - \Zֹ
OK 0 - ֹ\Z
OK 1 - ֹ\Z
OK 2 - ֹ\Z
OK 0 - \Zֹ
OK 1 - \Zֹ
OK 2 - \Zֹ
OK 0 - ֹ\+\Z
OK 2 - ֹ\+\Z
OK 0 - \Zֹ\+
OK 2 - \Zֹ\+
OK 0 - [^[=a=]]\+
OK 1 - [^[=a=]]\+
OK 2 - [^[=a=]]\+
eng 1 ambi single: 0
eng 1 ambi double: 0
eng 2 ambi single: 0[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='eng 2 ambi double: ' . match(\"\u00EC\", '\p')[?25l[?1c[1;24r[24;1H
[1;25r[24;1Heng 2 ambi double: 0[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c/\%#=1^Results/,$wq! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New] 140L, 2022C written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test96.failed test.ok test.out X* viminfo
cp test96.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test96.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test96.in" 142 lines, 3330 characters[1;1HThis will test for problems in quickfix:
A. incorrectly copying location lists which caused the location list to show a
   different name than the file that was actually being displayed.
B. not reusing the window for which the location list window is opened but
   instead creating new windows.
C. make sure that the location list window is not reused instead of the window
   it belongs to.

Note: to debug a problem comment out the last ":b 1" in a test and testing will
stop at this point.

STARTTEST
:so small.vim
: enew
: w! test.out
: b 1
: " Set up the test environment:
: function! ReadTestProtocol(name)
:   let base = substitute(a:name, '\v^test://(.*)%(\.[^.]+)?', '\1', '')
:   let word = substitute(base, '\v(.*)\..*', '\1', '')
:
:   setl modifiable
:   setl noreadonly
:   setl noswapfile[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HThis will test for problems in quickfix:[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[12;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 39 lines, 1123 characters written[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[13;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H: let words = [ "foo", "bar", "baz", "quux", "shmoo", "spam", "eggs" ]
:
: let qflist = []
: for word in words
:   call add(qflist, {'filename': 'test://' . word . '.txt', 'text': 'file ' . w[6;1Hord . '.txt', })
:   " NOTE: problem 1:
:   " intentionally not setting 'lnum' so that the quickfix entries are not
:   " valid
:   call setloclist(0, qflist, ' ')
: endfor
ENDTEST

Test A:
STARTTEST
:lrewind
:enew
:lopen
:lnext
:lnext
:lnext
:lnext
:vert split
:wincmd L[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c enew[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 0 lines, 0 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c b 1[?25l[?1c"test96.in" 142 lines, 3330 characters[1;1H:
: let qflist = [][2;18H[K[3;1H: for word in words[3;20H[K[4;1H:   call add(qflist, {'filename': 'test://' . word . '.txt', 'text': 'file ' . w[5;1Hord . '.txt', })[5;17H[K[6;1H:   " NOTE: problem 1:[6;23H[K[7;1H:   " intentionally not setting 'lnum' so that the quickfix entries are not[7;76H[K[8;1H:   " valid[8;12H[K[9;1H:   call setloclist(0, qflist, ' ')[9;36H[K[10;1H: endfor[10;9H[K[11;1HENDTEST[11;8H[K[12;1H[K[13;1HTest A:[13;8H[K[14;1HSTARTTEST[14;10H[K[15;1H:lrewind[15;9H[K[16;1H:enew[16;6H[K[17;1H:lopen[17;7H[K[18;1H:lnext[18;7H[K[19;1H:lnext[19;7H[K[20;1H:lnext[20;7H[K[21;1H:lnext[21;7H[K[22;1H:vert split[22;12H[K[23;1H:wincmd L[23;10H[K[24;1H:lopen[24;7H[K[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c " Set up the test environment:[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c function! ReadTestProtocol(name)[?25l[?1c
:  [?25h[?0c:   let base = substitute(a:name, '\v^test://(.*)%(\.[^.]+)?', '\1', '')
[?25l[?1c:  [?25h[?0c:   let word = substitute(base, '\v(.*)\..*', '\1', '')
[?25l[?1c:  [?25h[?0c:
[?25l[?1c:  [?25h[?0c:   setl modifiable
[?25l[?1c:  [?25h[?0c:   setl noreadonly
[?25l[?1c:  [?25h[?0c:   setl noswapfile
[?25l[?1c:  [?25h[?0c:   setl bufhidden=delete
[?25l[?1c:  [?25h[?0c:   %del _
[?25l[?1c:  [?25h[?0c:   " For problem 2:
[?25l[?1c:  [?25h[?0c:   " 'buftype' has to be set to reproduce the constant opening of new windo
[24;80Hw[25;1Hs
[?25l[?1c:  [?25h[?0c:   setl buftype=nofile
[?25l[?1c:  [?25h[?0c:
[?25l[?1c:  [?25h[?0c:   call setline(1, word)
[?25l[?1c:  [?25h[?0c:
[?25l[?1c:  [?25h[?0c:   setl nomodified
[?25l[?1c:  [?25h[?0c:   setl nomodifiable
[?25l[?1c:  [?25h[?0c:   setl readonly
[?25l[?1c:  [?25h[?0c:   exe 'doautocmd BufRead ' . substitute(a:name, '\v^test://(.*)', '\1', ''
[24;80H)[25;1H
[?25l[?1c:  [?25h[?0c: endfunction[27m[24m[0m[H[J[?25l[?1c[1;1H:
: let qflist = []
: for word in words
:   call add(qflist, {'filename': 'test://' . word . '.txt', 'text': 'file ' . w[5;1Hord . '.txt', })
:   " NOTE: problem 1:
:   " intentionally not setting 'lnum' so that the quickfix entries are not
:   " valid
:   call setloclist(0, qflist, ' ')
: endfor
ENDTEST

Test A:
STARTTEST
:lrewind
:enew
:lopen
:lnext
:lnext
:lnext
:lnext
:vert split
:wincmd L
:lopen[12;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c augroup testgroup[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c   au![?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c   autocmd BufReadCmd test://* call ReadTestProtocol(expand("<amatch>"))[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c augroup END[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c let words = [ "foo", "bar", "baz", "quux", "shmoo", "spam", "eggs" ][?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c let qflist = [][?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c for word in words[?25l[?1c
:  [?25h[?0c:   call add(qflist, {'filename': 'test://' . word . '.txt', 'text': 'file '
. word . '.txt', })
[?25l[?1c:  [?25h[?0c:   " NOTE: problem 1:
[?25l[?1c:  [?25h[?0c:   " intentionally not setting 'lnum' so that the quickfix entries are not
[?25l[?1c:  [?25h[?0c:   " valid
[?25l[?1c:  [?25h[?0c:   call setloclist(0, qflist, ' ')
[?25l[?1c:  [?25h[?0c: endfor[1;1H[7L[?25l[?1c[1;1H:
: let qflist = []
: for word in words
:   call add(qflist, {'filename': 'test://' . word . '.txt', 'text': 'file ' . w[5;1Hord . '.txt', })
:   " NOTE: problem 1:
:   " intentionally not setting 'lnum' so that the quickfix entries are not[25;1H[K[12;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H27 lines, 608 characters written[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[15;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:wincmd K
:b test.out
:let fileName = substitute(fileName, '\\', '/', 'g')
:let locationListFileName = substitute(locationListFileName, '\\', '/', 'g')
:call append(line('$'), "Test A:")
:call append(line('$'), "  - file name displayed: " . fileName)
:call append(line('$'), "  - quickfix claims that the file name displayed is: "
. locationListFileName)
:w
:wincmd o
:b 1
ENDTEST

Test B:
STARTTEST
:lrewind
:lopen
:2
:exe "normal \<CR>"
:wincmd p
:3
:exe "normal \<CR>"
:wincmd p
:4[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clrewind[?25l[?1cNo matching autocommands
(1 of 7): file foo.txt
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cenew[?25l[?1c[1;1H[2L[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0clopen[?25l[?1c[13;1H[7m[No Name]                                                                       [0m[14;1H[30m[43mtest://foo.txt|| file foo.txt                                                   [0m[15;1Htest://bar.txt|| file bar.txt[15;30H[K[16;1Htest://baz.txt|| file baz.txt[16;30H[K[17;1Htest://quux.txt|| file quux.txt[17;32H[K[18;1Htest://shmoo.txt|| file shmoo.txt[18;34H[K[19;1Htest://spam.txt|| file spam.txt[19;32H[K[20;1Htest://eggs.txt|| file eggs.txt[20;32H[K[24;1H[1m[7m[Location List]                                                                 [14;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clnext[?25l[?1cNo matching autocommands[1;1Hbar[13;1H[1m[7mtest://bar.txt [RO]                                                             [0m[14;1Htest://foo.txt|| file foo.txt[14;30H[K[15;1H[30m[43mtest://bar.txt|| file bar.txt                                                   [0m[24;1H[7m[Location List]                                                                 [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clnext[?25l[?1cNo matching autocommands[1;3Hz[13;10H[1m[7mz[0m

test://bar.txt|| file bar.txt[15;30H[K[16;1H[30m[43mtest://baz.txt|| file baz.txt                                                   [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clnext[?25l[?1cNo matching autocommands[1;1Hquux[13;8H[1m[7mquux.txt [RO][0m


test://baz.txt|| file baz.txt[16;30H[K[17;1H[30m[43mtest://quux.txt|| file quux.txt                                                 [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clnext[?25l[?1cNo matching autocommands[1;1Hshmoo[13;8H[1m[7mshmoo.txt [RO][0m[17;1Htest://quux.txt|| file quux.txt[17;32H[K[18;1H[30m[43mtest://shmoo.txt|| file shmoo.txt                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cvert split[?25l[?1c[1;41H[7m|[2;41H|[3;41H|[4;41H|[5;41H|[6;41H|[7;41H|[8;41H|[9;41H|[10;41H|[11;41H|[12;41H|[0m[1;42Hshmoo[2;42H[1m[34m~[3;42H~[4;42H~[5;42H~[6;42H~[7;42H~[8;42H~[9;42H~[10;42H~[11;42H~[12;42H~[0m[13;42H[7mtest://shmoo.txt [RO]                  [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cwincmd L[?25l[?1c[1;40H[7m|[2;40H|[3;40H|[4;40H|[5;40H|[6;40H|[7;40H|[8;40H|[9;40H|[10;40H|[11;40H|[12;40H|
test://shmoo.txt [RO]                  |[14;40H|[15;40H|[16;40H|[17;40H|[18;40H|[19;40H|[20;40H|[21;40H|[22;40H|[23;40H|[0m[1;41Hshmo[1;46H[K[2;41H[1m[34m~ [3;41H~ [4;41H~ [5;41H~ [6;41H~ [7;41H~ [8;41H~ [9;41H~ [10;41H~ [11;41H~ [12;41H~ [13;41H~                                       [14;41H~                                       [15;41H~                                       [16;41H~                                       [17;41H~                                       [18;41H~                                       [19;41H~                                       [20;41H~                                       [21;41H~[22;41H~[23;41H~[0m[24;41H[1m[7mtest://shmoo.txt [RO]                   [1;41H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clopen[?25l[?1c[13;41H[7mtest://shmoo.txt [RO]                   [0m[14;41H[30m[43mtest://foo.txt|| file foo.txt           [0m[15;41Htest://bar.txt|| file bar.txt[15;70H[K[16;41Htest://baz.txt|| file baz.txt[16;70H[K[17;41Htest://quux.txt|| file quux.txt[17;72H[K[18;41Htest://shmoo.txt|| file shmoo.txt[18;74H[K[19;41Htest://spam.txt|| file spam.txt[19;72H[K[20;41Htest://eggs.txt|| file eggs.txt[20;72H[K[24;41H[1m[7m[Location List]      [14;41H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cwincmd p[?25l[?1c[13;41H[1m[7mtest://shmoo.txt [RO]                   [0m[24;41H[7m[Location List]                         [1;41H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clnext[?25l[?1cNo matching autocommands[1;41Hbar[1;44H[K[13;48H[1m[7mbar.txt [RO]  [0m[14;41Htest://foo.txt|| file foo.txt[14;70H[K[15;41H[30m[43mtest://bar.txt|| file bar.txt           [1;41H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c"b 1[?25l[?1c[1;41H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet fileName = expand("%")[?25l[?1c[1;41H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwincmd p[?25l[?1c[13;41H[7mtest://bar.txt [RO]                     [0m[24;41H[1m[7m[Location List]                         [15;41H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet locationListFileName = substitute(getline(line('.')), '\([^|]*\)|.*', '\1'
[24;80H,[25;1H '')[?25l[?1c[1;1H[L[1;1Hshmoo[34C[7m|[0mbar[25;1H[K[15;41H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cwincmd n[?25l[?1c[27m[24m[0m[H[J[1;1Hshmoo[34C[7m|[2;40H|[3;40H|[4;40H|[5;40H|[6;40H|[7;40H|[8;40H|[9;40H|[10;40H|[11;40H|[12;40H|[0m[2;1H[1m[34m~                                      
~                                      
~                                      
~                                      
~                                      
~                                      
~                                      
~                                      
~                                      
~                                      
~                                      [0m
[7mtest://shmoo.txt [RO]                  |[0m
test://foo.txt|| file foo.txt[10C[7m|[0m
test://bar.txt|| file bar.txt[10C[7m|[0m
test://baz.txt|| file baz.txt[10C[7m|[0m
test://quux.txt|| file quux.txt[8C[7m|[0m
[30m[43mtest://shmoo.txt|| file shmoo.txt      [0m[7m|[0m
test://spam.txt|| file spam.txt[8C[7m|[0m
test://eggs.txt|| file eggs.txt[8C[7m|[21;40H|[22;40H|[23;40H|[0m[21;1H[1m[34m~                                      
~                                      
~                                      [0m
[7m[Location List]                         [0m[1;41Hbar[2;41H[1m[34m~                                       [3;41H~                                       [4;41H~                                       [5;41H~                                       [0m[6;41H[7mtest://bar.txt [RO]                     [0m[8;41H[1m[34m~                                       [9;41H~                                       [10;41H~                                       [11;41H~                                       [12;41H~                                       [0m[13;41H[1m[7m[No Name]                               [0m[14;41Htest://foo.txt|| file foo.txt[15;41H[30m[43mtest://bar.txt|| file bar.txt           [0m[16;41Htest://baz.txt|| file baz.txt[17;41Htest://quux.txt|| file quux.txt[18;41Htest://shmoo.txt|| file shmoo.txt[19;41Htest://spam.txt|| file spam.txt[20;41Htest://eggs.txt|| file eggs.txt[21;41H[1m[34m~                                       [22;41H~                                       [23;41H~                                       [0m[24;41H[7m[Location List]                         [7;41H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0cwincmd K[?25l[?1c[27m[24m[0m[H[J[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [0m[8;1H[1m[7m[No Name]                                                                       [0m[9;1Hshmoo[34C[7m|[10;40H|[11;40H|[0m[10;1H[1m[34m~                                      
~                                      [0m
[7mtest://shmoo.txt [RO]                  |[0m
test://foo.txt|| file foo.txt[10C[7m|[0m
test://bar.txt|| file bar.txt[10C[7m|[0m
test://baz.txt|| file baz.txt[10C[7m|[0m
test://quux.txt|| file quux.txt[8C[7m|[0m
[30m[43mtest://shmoo.txt|| file shmoo.txt      [0m[7m|[0m
test://spam.txt|| file spam.txt[8C[7m|[0m
test://eggs.txt|| file eggs.txt[8C[7m|[20;40H|[21;40H|[22;40H|[23;40H|[0m[20;1H[1m[34m~                                      
~                                      
~                                      
~                                      [0m
[7m[Location List]                         [0m[9;41Hbar[10;41H[1m[34m~                                       [11;41H~                                       [0m[12;41H[7mtest://bar.txt [RO]                     [0m[13;41Htest://foo.txt|| file foo.txt[14;41H[30m[43mtest://bar.txt|| file bar.txt           [0m[15;41Htest://baz.txt|| file baz.txt[16;41Htest://quux.txt|| file quux.txt[17;41Htest://shmoo.txt|| file shmoo.txt[18;41Htest://spam.txt|| file spam.txt[19;41Htest://eggs.txt|| file eggs.txt[20;41H[1m[34m~                                       [21;41H~                                       [22;41H~                                       [23;41H~                                       [0m[24;41H[7m[Location List]                         [1;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0cb test.out[?25l[?1c"test.out" 0 lines, 0 characters[8;1H[1m[7mtest.out [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet fileName = substitute(fileName, '\\', '/', 'g')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet locationListFileName = substitute(locationListFileName, '\\', '/', 'g')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append(line('$'), "Test A:")[?25l[?1c[2;1HTest A:[2;8H[K[8;10H[1m[7m[+][1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall append(line('$'), "  - file name displayed: " . fileName)[?25l[?1c[3;1H  - file name displayed: test://bar.txt[3;40H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append(line('$'), "  - quickfix claims that the file name displayed is: "
. locationListFileName)[?25l[?1c[1;1H[L[4;1H  - quickfix claims that the file name displayed is: test://bar.txt[4;68H[K[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cw[?25l[?1c"test.out" 4 lines, 117 characters written[8;10H[1m[7m   [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cwincmd o[?25l[?1c[8;1H[1m[34m~                                                                               [9;1H~                                                                               [10;40H  [11;40H  
~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;40H  [21;40H  [22;40H  [23;40H  
~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cb 1[?25l[?1c"test96.in" 142 lines, 3330 characters[1;1H:b test.out
:let fileName = substitute(fileName, '\\', '/', 'g')
:let locationListFileName = substitute(locationListFileName, '\\', '/', 'g')
:call append(line('$'), "Test A:")[4;35H[K[5;1H:call append(line('$'), "  - file name displayed: " . fileName)[5;64H[K[6;1H:call append(line('$'), "  - quickfix claims that the file name displayed is: " [7;1H. locationListFileName)[7;24H[K[8;1H:w[8;3H[K[9;1H:wincmd o[9;10H[K[10;1H:b 1[10;5H[K[11;1HENDTEST[11;8H[K[12;1H[K[13;1HTest B:[13;8H[K[14;1HSTARTTEST[14;10H[K[15;1H:lrewind[15;9H[K[16;1H:lopen[16;7H[K[17;1H:2[17;3H[K[18;1H:exe "normal \<CR>"[18;20H[K[19;1H:wincmd p[19;10H[K[20;1H:3[20;3H[K[21;1H:exe "normal \<CR>"[21;20H[K[22;1H:wincmd p[22;10H[K[23;1H:4[23;3H[K[24;1H:exe "normal \<CR>"[24;20H[K[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H19 lines, 305 characters written[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[15;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[10M[1;25r[15;1H:let numberOfWindowsOpen = winnr('$')
:wincmd n
:wincmd K
:b test.out
:call append(line('$'), "Test B:")
:call append(line('$'), "  - number of window open: " . numberOfWindowsOpen)
:w
:wincmd o
:b 1
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clrewind[?25l[?1cNo matching autocommands
(1 of 7): file foo.txt
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clopen[?25l[?1c[1;1H[2L[1;1Hfoo
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [0m[13;1H[7mtest://foo.txt [RO]                                                             [0m[14;1H[30m[43mtest://foo.txt|| file foo.txt                                                   [0m[15;1Htest://bar.txt|| file bar.txt
test://baz.txt|| file baz.txt
test://quux.txt|| file quux.txt
test://shmoo.txt|| file shmoo.txt[18;34H[K[19;1Htest://spam.txt|| file spam.txt[19;32H[K[20;1Htest://eggs.txt|| file eggs.txt
[1m[34m~                                                                               [22;1H~                                                                               [23;1H~                                                                               [0m[24;1H[1m[7m[Location List]                                                                 [0m[25;1H[K[14;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c2[?25l[?1c[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexe "normal \<CR>"[?25l[?1cNo matching autocommands[1;1Hbar[13;1H[1m[7mtest://bar.txt [RO]                                                             [0m[14;1Htest://foo.txt|| file foo.txt[14;30H[K[15;1H[30m[43mtest://bar.txt|| file bar.txt                                                   [0m[24;1H[7m[Location List]                                                                 [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cwincmd p[?25l[?1c[13;1H[7mtest://bar.txt [RO]                                                             [0m[24;1H[1m[7m[Location List]                                                                 [15;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c3[?25l[?1c[16;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexe "normal \<CR>"[?25l[?1cNo matching autocommands[1;3Hz[13;1H[1m[7mtest://baz.txt [RO]                                                             [0m[15;1Htest://bar.txt|| file bar.txt[15;30H[K[16;1H[30m[43mtest://baz.txt|| file baz.txt                                                   [0m[24;1H[7m[Location List]                                                                 [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cwincmd p[?25l[?1c[13;1H[7mtest://baz.txt [RO]                                                             [0m[24;1H[1m[7m[Location List]                                                                 [16;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c4[?25l[?1c[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexe "normal \<CR>"[?25l[?1cNo matching autocommands[1;1Hquux[13;1H[1m[7mtest://quux.txt [RO]                                                            [0m[16;1Htest://baz.txt|| file baz.txt[16;30H[K[17;1H[30m[43mtest://quux.txt|| file quux.txt                                                 [0m[24;1H[7m[Location List]                                                                 [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet numberOfWindowsOpen = winnr('$')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwincmd n[?25l[?1c[1;1H[K[7;1H[1m[7m[No Name]                                                                       [0m[8;1Hquux[8;5H[K[13;1H[7mtest://quux.txt [RO]                                                            [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cwincmd K[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cb test.out[?25l[?1c"test.out" 4 lines, 117 characters[2;1HTest A:[2;8H[K[3;1H  - file name displayed: test://bar.txt[3;40H[K[4;1H  - quickfix claims that the file name displayed is: test://bar.txt[4;68H[K[7;1H[1m[7mtest.out [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall append(line('$'), "Test B:")[?25l[?1c[5;1HTest B:[5;8H[K[7;10H[1m[7m[+][1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall append(line('$'), "  - number of window open: " . numberOfWindowsOpen)[?25l[?1c[6;1H  - number of window open: 2[6;29H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"test.out" 6 lines, 154 characters written[7;10H[1m[7m   [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cwincmd o[?25l[?1c[7;1H[1m[34m~                                                                               [8;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cb 1[?25l[?1c"test96.in" 142 lines, 3330 characters[1;1H:exe "normal \<CR>"
:let numberOfWindowsOpen = winnr('$')
:wincmd n[3;10H[K[4;1H:wincmd K[4;10H[K[5;1H:b test.out
:call append(line('$'), "Test B:")
:call append(line('$'), "  - number of window open: " . numberOfWindowsOpen)[7;77H[K[8;1H:w[8;3H[K[9;1H:wincmd o[9;10H[K[10;1H:b 1[10;5H[K[11;1HENDTEST[11;8H[K[12;1H[K[13;1HTest C:[13;8H[K[14;1HSTARTTEST[14;10H[K[15;1H:lrewind[15;9H[K[16;1H:lopen[16;7H[K[17;1H:" Let's move the location list window to the top to check whether it (the first[18;1H:" window found) will be reused when we try to open new windows:[18;65H[K[19;1H:wincmd K[19;10H[K[20;1H:2[20;3H[K[21;1H:exe "normal \<CR>"[21;20H[K[22;1H:wincmd p[22;10H[K[23;1H:3[23;3H[K[24;1H:exe "normal \<CR>"[24;20H[K[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H27 lines, 677 characters written[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[15;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[19M[1;25r[6;1H:wincmd p
:4
:exe "normal \<CR>"
:1wincmd w
:let locationListWindowBufType = &buftype
:2wincmd w
:let bufferName = expand("%")
:wincmd n
:wincmd K
:b test.out
:let bufferName = substitute(bufferName, '\\', '/', 'g')
:call append(line('$'), "Test C:")
:call append(line('$'), "  - 'buftype' of the location list window: " . location[19;1HListWindowBufType)
:call append(line('$'), "  - buffer displayed in the 2nd window: " . bufferName)[21;1H:w
:wincmd o
:b 1
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clrewind[?25l[?1cNo matching autocommands
(1 of 7): file foo.txt
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clopen[?25l[?1c[1;1H[2L[1;1Hfoo
[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [0m[13;1H[7mtest://foo.txt [RO]                                                             [0m[14;1H[30m[43mtest://foo.txt|| file foo.txt                                                   [0m[15;1Htest://bar.txt|| file bar.txt[15;30H[K[16;1Htest://baz.txt|| file baz.tx[16;31H[K[17;1Htest://quux.txt|| file quux.txt[17;32H[K[18;1Htest://shmoo.txt|| file shmoo.txt
test://spam.txt|| file spam.txt[19;32H[K[20;1Htest://eggs.txt|| file eggs.txt
[1m[34m~                                                                               [22;1H~                                                                               [23;1H~                                                                               [0m[24;1H[1m[7m[Location List]                                                                 [0m[25;1H[K[14;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c" Let's move the location list window to the top to check whether it (the firs
[24;80Ht[25;1H[?25l[?1c[1;1H[L[1;1Hfoo[25;1H[K[14;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c" window found) will be reused when we try to open new windows:[?25l[?1c[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwincmd K[?25l[?1c[1;1H[30m[43mtest://foo.txt|| file foo.txt                                                   [0m[2;1Htest://bar.txt|| file bar.txt[2;30H[K[3;1Htest://baz.txt|| file baz.txt[3;30H[K[4;1Htest://quux.txt|| file quux.txt[4;32H[K[5;1Htest://shmoo.txt|| file shmoo.txt[5;34H[K[6;1Htest://spam.txt|| file spam.txt[6;32H[K[7;1Htest://eggs.txt|| file eggs.txt[7;32H[K[11;1H[1m[7m[Location List]                                                                 [0m[12;1Hfoo[12;4H[K[13;1H[1m[34m~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [0m[24;1H[7mtest://foo.txt [RO]                                                             [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c2[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexe "normal \<CR>"[?25l[?1cNo matching autocommands[1;1Htest://foo.txt|| file foo.txt[1;30H[K[2;1H[30m[43mtest://bar.txt|| file bar.txt                                                   [0m[11;1H[7m[Location List]                                                                 [0m[12;1Hbar[24;1H[1m[7mtest://bar.txt [RO]                                                             [12;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cwincmd p[?25l[?1c[11;1H[1m[7m[Location List]                                                                 [0m[24;1H[7mtest://bar.txt [RO]                                                             [2;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c3[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexe "normal \<CR>"[?25l[?1cNo matching autocommands[2;1Htest://bar.txt|| file bar.txt[2;30H[K[3;1H[30m[43mtest://baz.txt|| file baz.txt                                                   [0m[11;1H[7m[Location List]                                                                 [0m[12;3Hz[24;1H[1m[7mtest://baz.txt [RO]                                                             [12;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cwincmd p[?25l[?1c[11;1H[1m[7m[Location List]                                                                 [0m[24;1H[7mtest://baz.txt [RO]                                                             [3;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c4[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexe "normal \<CR>"[?25l[?1cNo matching autocommands[3;1Htest://baz.txt|| file baz.txt[3;30H[K[4;1H[30m[43mtest://quux.txt|| file quux.txt                                                 [0m[11;1H[7m[Location List]                                                                 [0m[12;1Hquux[24;1H[1m[7mtest://quux.txt [RO]                                                            [12;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c1wincmd w[?25l[?1c[11;1H[1m[7m[Location List]                                                                 [0m[24;1H[7mtest://quux.txt [RO]                                                            [4;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet locationListWindowBufType = &buftype[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c2wincmd w[?25l[?1c[11;1H[7m[Location List]                                                                 [0m[24;1H[1m[7mtest://quux.txt [RO]                                                            [12;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet bufferName = expand("%")[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwincmd n[?25l[?1c[12;1H[K[18;1H[1m[7m[No Name]                                                                       [0m[19;1Hquux[19;5H[K[24;1H[7mtest://quux.txt [RO]                                                            [12;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cwincmd K[?25l[?1c[27m[24m[0m[H[J[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [0m[7;1H[1m[7m[No Name]                                                                       [0m[8;1Htest://bar.txt|| file bar.txt
test://baz.txt|| file baz.txt
[30m[43mtest://quux.txt|| file quux.txt                                                 [0m[11;1Htest://shmoo.txt|| file shmoo.txt
test://spam.txt|| file spam.txt
test://eggs.txt|| file eggs.txt
[1m[34m~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [0m[18;1H[7m[Location List]                                                                 [0m[19;1Hquux
[1m[34m~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [0m[24;1H[7mtest://quux.txt [RO]                                                            [1;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0cb test.out[?25l[?1c"test.out" 6 lines, 154 characters[2;1HTest A:[2;8H[K[3;1H  - file name displayed: test://bar.txt[3;40H[K[4;1H  - quickfix claims that the file name displayed is: test://bar.txt[4;68H[K[5;1HTest B:[5;8H[K[6;1H  - number of window open: 2[6;29H[K[7;1H[1m[7mtest.out [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet bufferName = substitute(bufferName, '\\', '/', 'g')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append(line('$'), "Test C:")[?25l[?1c[7;10H[1m[7m[+][1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall append(line('$'), "  - 'buftype' of the location list window: " . locatio
[24;80Hn[25;1HListWindowBufType)[?25l[?1c[1;1H[L[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall append(line('$'), "  - buffer displayed in the 2nd window: " . bufferName
[24;80H)[25;1H[?25l[?1c[1;1H[L[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cw[?25l[?1c"test.out" 9 lines, 270 characters written[7;10H[1m[7m   [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cwincmd o[?25l[?1c[27m[24m[0m[H[J[2;1HTest A:
  - file name displayed: test://bar.txt
  - quickfix claims that the file name displayed is: test://bar.txt
Test B:
  - number of window open: 2
Test C:
  - 'buftype' of the location list window: quickfix
  - buffer displayed in the 2nd window: test://quux.txt
[1m[34m~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0cb 1[?25l[?1c"test96.in" 142 lines, 3330 characters[1;1H:wincmd p
:4[2;3H[K[3;1H:exe "normal \<CR>"[3;20H[K[4;1H:1wincmd w[4;11H[K[5;1H:let locationListWindowBufType = &buftype
:2wincmd w[6;12H[K[7;1H:let bufferName = expand("%")
:wincmd n[8;10H[K[9;1H:wincmd K[9;10H[K[10;1H:b test.out[10;12H[K[11;1H:let bufferName = substitute(bufferName, '\\', '/', 'g')[11;57H[K[12;1H:call append(line('$'), "Test C:")[12;35H[K[13;1H:call append(line('$'), "  - 'buftype' of the location list window: " . location[14;1HListWindowBufType)[14;19H[K[15;1H:call append(line('$'), "  - buffer displayed in the 2nd window: " . bufferName)[16;1H:w[16;3H[K[17;1H:wincmd o[17;10H[K[18;1H:b 1[18;5H[K[19;1HENDTEST[19;8H[K[20;1H[K[21;1HSTARTTEST[21;10H[K[22;1H:qa[22;4H[K[23;1HENDTEST[23;8H[K[24;1H[K[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[21;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H1 line, 4 characters written[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[22;1H[?25h[?0c[?25l[?1c


/ENDTEST[25;10H[K[25;1H[23;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa[?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test97.failed test.ok test.out X* viminfo
cp test97.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test97.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test97.in" 23 lines, 483 characters[1;1HTest whether glob()/globpath() return correct results with certain escaped
characters.

STARTTEST
:so small.vim
:" make sure glob() doesn't use the shell
:set shell=doesnotexist
:" consistent sorting of file names
:set nofileignorecase
:e test.out
:$put =glob('Xxx\{')
:$put =glob('Xxx\$')
:w! Xxx{
:w! Xxx\$
:$put =glob('Xxx\{')
:$put =glob('Xxx\$')
:"
:$put =string(globpath('sautest/autoload', '*.vim'))
:$put =string(globpath('sautest/autoload', '*.vim', 0, 1))
:w
:qa!
ENDTEST

[1m[34m~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest whether glob()/globpath() return correct results with certain escaped[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[4;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 17 lines, 376 characters written[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[5;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[22;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" make sure glob() doesn't use the shell[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset shell=doesnotexist[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" consistent sorting of file names[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nofileignorecase[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce test.out[?25l[?1c"test.out" [New File][1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c$put =glob('Xxx\{')[?25l[?1c[2;1H[K[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =glob('Xxx\$')[?25l[?1c[3;1H[K[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! Xxx{[?25l[?1c
Cannot execute shell doesnotexist
[24m[0m
E79: Cannot expand wildcards
"Xxx{" [New File] 3 lines, 3 characters written
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cw! Xxx\$[?25l[?1c"Xxx$" [25;8H[K[25;8H[New File] 3 lines, 3 characters written
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c$put =glob('Xxx\{')[?25l[?1c[27m[24m[0m[H[J[4;1HXxx{
[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [4;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0c$put =glob('Xxx\$')[?25l[?1c[5;1HXxx$[5;5H[K[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =string(globpath('sautest/autoload', '*.vim'))[?25l[?1c[6;1H'sautest/autoload/Test104.vim[6;30H[K[7;1Hsautest/autoload/footest.vim'[7;30H[K[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =string(globpath('sautest/autoload', '*.vim', 0, 1))[?25l[?1c[8;1H['sautest/autoload/Test104.vim', 'sautest/autoload/footest.vim'][8;65H[K[8;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw[?25l[?1c"test.out" [New File] 8 lines, 138 characters written[8;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test98.failed test.ok test.out X* viminfo
cp test98.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test98.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test98.in" 43 lines, 908 characters[1;1HTest for 'scrollbind' causing an unexpected scroll of one of the windows.
STARTTEST
:so small.vim
:" We don't want the status line to cause problems:
:set laststatus=0
:let g:totalLines = &lines * 20
:let middle = g:totalLines / 2
:wincmd n
:wincmd o
:for i in range(1, g:totalLines)
:    call setline(i, 'LINE ' . i)
:endfor
:exe string(middle)
:normal zt
:normal M
:aboveleft vert new
:for i in range(1, g:totalLines)
:    call setline(i, 'line ' . i)
:endfor
:exe string(middle)
:normal zt
:normal M
:" Execute the following two command at once to reproduce the problem.
:setl scb | wincmd p[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for 'scrollbind' causing an unexpected scroll of one of the windows.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[2;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 35 lines, 791 characters written[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[3;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[15M[1;25r[10;1H:setl scb
:wincmd w
:let topLineLeft = line('w0')
:wincmd p
:let topLineRight = line('w0')
:setl noscrollbind
:wincmd p
:setl noscrollbind
:q!
:%del _
:call setline(1, 'Difference between the top lines (left - right): ' . string(to[21;1HpLineLeft - topLineRight))
:w! test.out
:brewind
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" We don't want the status line to cause problems:[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset laststatus=0[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet g:totalLines = &lines * 20[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet middle = g:totalLines / 2[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwincmd n[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [0m[13;1H[1m[7m[No Name]                                                                       [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cwincmd o[?25l[?1c[13;1H[1m[34m~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cfor i in range(1, g:totalLines)[?25l[?1c
:  [?25h[?0c:    call setline(i, 'LINE ' . i)
[?25l[?1c:  [?25h[?0c:endfor[1;1H[2L[?25l[?1c[1;1HLINE 1
LINE 2
LINE 3[3;7H[K[4;1HLINE 4[4;7H[K[5;1HLINE 5[5;7H[K[6;1HLINE 6[6;7H[K[7;1HLINE 7[7;7H[K[8;1HLINE 8[8;7H[K[9;1HLINE 9[9;7H[K[10;1HLINE 10[10;8H[K[11;1HLINE 11[11;8H[K[12;1HLINE 12[12;8H[K[13;1HLINE 13[13;8H[K[14;1HLINE 14[14;8H[K[15;1HLINE 15[15;8H[K[16;1HLINE 16[16;8H[K[17;1HLINE 17[17;8H[K[18;1HLINE 18[18;8H[K[19;1HLINE 19[19;8H[K[20;1HLINE 20[20;8H[K[21;1HLINE 21[21;8H[K[22;1HLINE 22[22;8H[K[23;1HLINE 23[23;8H[K[24;1HLINE 24[24;8H[K[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cexe string(middle)[?25l[?1c[27m[24m[0m[H[J[1;1HLINE 239
LINE 240
LINE 241
LINE 242
LINE 243
LINE 244
LINE 245
LINE 246
LINE 247
LINE 248
LINE 249
LINE 250
LINE 251
LINE 252
LINE 253
LINE 254
LINE 255
LINE 256
LINE 257
LINE 258
LINE 259
LINE 260
LINE 261
LINE 262[12;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cnormal zt[?25l[?1c[1;24r[1;1H[11M[1;25r[14;1HLINE 263
LINE 264
LINE 265
LINE 266
LINE 267
LINE 268
LINE 269
LINE 270
LINE 271
LINE 272
LINE 273[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cnormal M[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0caboveleft vert new[?25l[?1c[1;1H        [32C[7m|[2;41H|[3;41H|[4;41H|[5;41H|[6;41H|[7;41H|[8;41H|[9;41H|[10;41H|[11;41H|[12;41H|[13;41H|[14;41H|[15;41H|[16;41H|[17;41H|[18;41H|[19;41H|[20;41H|[21;41H|[22;41H|[23;41H|[24;41H|[0m[2;1H[1m[34m~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       
~                                       [0m[1;42HLINE 250[2;42HLINE 251[3;42HLINE 252[4;42HLINE 253[5;42HLINE 254[6;42HLINE 255[7;42HLINE 256[8;42HLINE 257[9;42HLINE 258[10;42HLINE 259[11;42HLINE 260[12;42HLINE 261[13;42HLINE 262[14;42HLINE 263[15;42HLINE 264[16;42HLINE 265[17;42HLINE 266[18;42HLINE 267[19;42HLINE 268[20;42HLINE 269[21;42HLINE 270[22;42HLINE 271[23;42HLINE 272[24;42HLINE 273[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfor i in range(1, g:totalLines)[?25l[?1c
:  [?25h[?0c:    call setline(i, 'line ' . i)
[?25l[?1c:  [?25h[?0c:endfor[1;1H[2L[?25l[?1c[1;1Hline 1[34C[7m|[0m
line 2[34C[7m|[0m
line 3                                  
line 4                                  
line 5                                  
line 6                                  
line 7                                  
line 8                                  
line 9                                  
line 10                                 
line 11                                 
line 12                                 
line 13                                 
line 14                                 
line 15                                 
line 16                                 
line 17                                 
line 18                                 
line 19                                 
line 20                                 
line 21                                 
line 22                                 
line 23                                 
line 24                                 [1;42HLINE 250[2;42HLINE 251[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cexe string(middle)[?25l[?1c[1;6H239[2;7H40[3;6H241[4;6H242[5;6H243[6;6H244[7;6H245[8;6H246[9;6H247[10;6H248[11;6H249[12;6H250[13;6H251[14;6H252[15;6H253[16;6H254[17;6H255[18;6H256[19;6H257[20;7H58[21;7H59[22;7H60[23;7H61[24;7H62[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnormal zt[?25l[?1c[1;1Hline 250                                
line 251                                
line 252                                
line 253                                
line 254                                
line 255                                
line 256                                
line 257                                
line 258                                
line 259                                
line 260                                
line 261                                
line 262                                
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        [14;1Hline 263
line 264
line 265
line 266
line 267
line 268
line 269
line 270
line 271
line 272
line 273[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cnormal M[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Execute the following two command at once to reproduce the problem.[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csetl scb | wincmd p[?25l[?1c[12;42H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csetl scb[?25l[?1c[12;42H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwincmd w[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet topLineLeft = line('w0')[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwincmd p[?25l[?1c[12;42H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet topLineRight = line('w0')[?25l[?1c[12;42H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csetl noscrollbind[?25l[?1c[12;42H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwincmd p[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csetl noscrollbind[?25l[?1c[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cq![?25l[?1c[1;1HLINE[1;41H[K[2;1HLINE[2;41H[K[3;1HLINE[3;41H[K[4;1HLINE[4;41H[K[5;1HLINE[5;41H[K[6;1HLINE[6;41H[K[7;1HLINE[7;41H[K[8;1HLINE[8;41H[K[9;1HLINE[9;41H[K[10;1HLINE[10;41H[K[11;1HLINE[11;41H[K[12;1HLINE[12;41H[K[13;1HLINE[13;41H[K[14;1HLINE[14;41H[K[15;1HLINE[15;41H[K[16;1HLINE[16;41H[K[17;1HLINE[17;41H[K[18;1HLINE[18;41H[K[19;1HLINE[19;41H[K[20;1HLINE[20;41H[K[21;1HLINE[21;41H[K[22;1HLINE[22;41H[K[23;1HLINE[23;41H[K[24;1HLINE[24;41H[K[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c%del _[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [0m[25;1H--No lines in buffer--[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall setline(1, 'Difference between the top lines (left - right): ' . string(t
[24;80Ho[25;1HpLineLeft - topLineRight))[?25l[?1c[1;1H[L[1;1HDifference between the top lines (left - right): 0[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cw! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 1 line, 51 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbrewind[?25l[?1c"test98.in" 43 lines, 908 characters[1;1H:normal zt[1;12H[K[2;1H:normal M[2;10H[K[3;1H:" Execute the following two command at once to reproduce the problem.[3;71H[K[4;1H:setl scb | wincmd p[4;21H[K[5;1H:setl scb[5;10H[K[6;1H:wincmd w[6;10H[K[7;1H:let topLineLeft = line('w0')[7;30H[K[8;1H:wincmd p[8;10H[K[9;1H:let topLineRight = line('w0')[9;31H[K[10;1H:setl noscrollbind[10;19H[K[11;1H:wincmd p[11;10H[K[12;1H:setl noscrollbind[12;19H[K[13;1H:q![13;4H[K[14;1H:%del _[14;8H[K[15;1H:call setline(1, 'Difference between the top lines (left - right): ' . string(to[16;1HpLineLeft - topLineRight))[16;27H[K[17;1H:w! test.out[17;13H[K[18;1H:brewind[18;9H[K[19;1HENDTEST[19;8H[K[20;1H[K[21;1HSTARTTEST[21;10H[K[22;1H:qa![22;5H[K[23;1HENDTEST[23;8H[K[24;1H[K[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[21;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H1 line, 5 characters written[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[22;1H[?25h[?0c[?25l[?1c


/ENDTEST[25;10H[K[25;1H[23;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test99.failed test.ok test.out X* viminfo
cp test99.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test99.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test99.in" 68 lines, 2601 characters[1;1HTests for regexp with multi-byte encoding and various magic settings.
Test matchstr() with a count and multi-byte chars.
See test44 for exactly the same test with re=1.

STARTTEST
:so mbyte.vim
:set nocompatible encoding=utf-8 termencoding=latin1 viminfo+=nviminfo
:set re=2
/^1
/a*b\{2}c\+/e
x/\Md\*e\{2}f\+/e
x:set nomagic
/g\*h\{2}i\+/e
x/\mj*k\{2}l\+/e
x/\vm*n{2}o+/e
x/\V^aa$
x:set magic
/\v(a)(b)\2\1\1/e
x/\V[ab]\(\[xy]\)\1
x:" Now search for multi-byte without composing char
/ม
x:" Now search for multi-byte with composing char
/ม[1m[34m~H[0m
x:" find word by change of word class[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for regexp with multi-byte encoding and various magic settings.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[5;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 41 lines, 1362 characters written[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[6;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1Hx?.
x:let @w=':%s#comb[i]nations#[1m[34m~S[0m[1m[34m~D[0mṣ[1m[34m~A[0mm̥[1m[34m~D[0mα[1m[34m~D[0m[1m[34m~F[0m[1m[34m~A[0m#g'
:@w
:?^1?,$w! test.out
:e! test.out
G:put =matchstr(\"[1m[34m~P[0m[1m[34m~Q[0m[1m[34m~R[0m[1m[34m~S[0m\", \".\", 0, 2) " [1m[34m~Q[0m
:put =matchstr(\"[1m[34m~P[0m[1m[34m~Q[0m[1m[34m~R[0m[1m[34m~S[0m\", \"..\", 0, 2) " [1m[34m~Q[0m[1m[34m~R[0m
:put =matchstr(\"[1m[34m~P[0m[1m[34m~Q[0m[1m[34m~R[0m[1m[34m~S[0m\", \".\", 0, 0) " [1m[34m~P[0m
:put =matchstr(\"[1m[34m~P[0m[1m[34m~Q[0m[1m[34m~R[0m[1m[34m~S[0m\", \".\", 4, -1) " [1m[34m~R[0m
:w!
:qa!
ENDTEST

1 a aa abb abbccc
2 d dd dee deefff
3 g gg ghh ghhiii
4 j jj jkk jkklll
5 m mm mnn mnnooo
6 x ^aa$ x
7 (a)(b) abbaa
8 axx [ab]xx
9 หม[1m[34m~H[0mx อมx
a อมx หม[1m[34m~H[0mx
b [1m[34m~A[0m[1m[34m~B[0m[1m[34m~C[0m[1m[34m~A[0m[12;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso mbyte.vim[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nocompatible encoding=utf-8 termencoding=latin1 viminfo+=nviminfo[?25l[?1c[27m[24m[0m[H[J[1;1Hx?.
x:let @w=':%s#comb[i]nations#m#g'
:@w
:?^1?,$w! test.out
:e! test.out
G:put =matchstr(\"\", \".\", 0, 2) " 
:put =matchstr(\"\", \"..\", 0, 2) " 
:put =matchstr(\"\", \".\", 0, 0) " 
:put =matchstr(\"\", \".\", 4, -1) " 
:w!
:qa!
ENDTEST

1 a aa abb abbccc
2 d dd dee deefff
3 g gg ghh ghhiii
4 j jj jkk jkklll
5 m mm mnn mnnooo
6 x ^aa$ x
7 (a)(b) abbaa
8 axx [ab]xx
9 x x
a x x
b ????[13;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset re=2[?25l[?1c[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c^1[?25l[?1c[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0ca*b\{2}c\+/e[?25l[?1c[14;17H[?25h[?0c[?25l[?1c[14;17H[K[14;16H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c\Md\*e\{2}f\+/e[?25l[?1c[15;17H[?25h[?0c[?25l[?1c[15;17H[K[15;16H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nomagic[?25l[?1c[15;16H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cg\*h\{2}i\+/e[?25l[?1c[16;17H[?25h[?0c[?25l[?1c[16;17H[K[16;16H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c\mj*k\{2}l\+/e[?25l[?1c[17;17H[?25h[?0c[?25l[?1c[17;17H[K[17;16H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c\vm*n{2}o+/e[?25l[?1c[18;17H[?25h[?0c[?25l[?1c[18;17H[K[18;16H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c\V^aa$[?25l[?1c[19;5H[?25h[?0c[?25l[?1caa$ x[19;10H[K[19;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset magic[?25l[?1c[19;5H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c\v(a)(b)\2\1\1/e[?25l[?1c[20;14H[?25h[?0c[?25l[?1c[20;14H[K[20;13H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c\V[ab]\(\[xy]\)\1[?25l[?1c[21;7H[?25h[?0c[?25l[?1cab]x[21;12H[K[21;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Now search for multi-byte without composing char[?25l[?1c[21;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c[?25l[?1c[22;8H[?25h[?0c[?25l[?1cx[22;9H[K[22;8H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Now search for multi-byte with composing char[?25l[?1c[22;8H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c[?25l[?1c[23;8H[?25h[?0c[?25l[?1cx[23;9H[K[23;8H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" find word by change of word class[?25l[?1c[23;8H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c?\<??\>?[?25l[?1c[24;3H[?25h[?0c[?25l[?1c???[24;9H[K[24;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test \%u, [\u] and friends[?25l[?1c[24;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c\%u20ac[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hc x x[25;1H[K[24;6H[?25h[?0c[?25l[?1cx[24;7H[K[24;6H[?25h[?0c[?25l[?1c
/[?25h[?0c[\u4f7f\u5929]\+[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hd ??x[25;1H[K[24;3H[?25h[?0c[?25l[?1c?x [24;7H[K[24;3H[?25h[?0c[?25l[?1c
/[?25h[?0c\%U12345678[?25l[?1c[1;24r[24;1H
[1;25r[24;1He y[25;1H[K[24;3H[?25h[?0c[?25l[?1cy[24;4H[K[24;3H[?25h[?0c[?25l[?1c
/[?25h[?0c[\U1234abcd\u1234\uabcd][?25l[?1c[1;24r[24;1H
[1;25r[24;1Hf z[25;1H[K[24;3H[?25h[?0c[?25l[?1cz[24;4H[K[24;3H[?25h[?0c[?25l[?1c
/[?25h[?0c\%d21879b[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hg a?bb[25;1H[K[24;4H[?25h[?0c[?25l[?1cbb[24;6H[K[24;4H[?25h[?0c[?25l[?1c
/[?25h[?0c [[=A=]]* [[=B=]]* [[=C=]]* [[=D=]]* [[=E=]]* [[=F=]]* [[=G=]]* [[=H=]]* [[=I=
[24;80H][25;1H]* [[=J=]]* [[=K=]]* [[=L=]]* [[=M=]]* [[=N=]]* [[=O=]]* [[=P=]]* [[=Q=]]* [[=R
[24;80H=[25;1H]]* [[=S=]]* [[=T=]]* [[=U=]]* [[=V=]]* [[=W=]]* [[=X=]]* [[=Y=]]* [[=Z=]]*/e[?25l[?1c[23;1H[1m[32mPress ENTER or type command to continue[0m[23;40H[K[24;1H[K[25;1H[K[?25h[?0c[1;1H[2L[?25l[?1c[1;1H:put =matchstr(\"\", \".\", 4, -1) " 
:w!
:qa![3;6H[K[4;1HENDTEST[4;8H[K[5;1H[K[6;1H1 a aa abb abbcc
2 d dd dee deeff
3 g gg ghh ghhii
4 j jj jkk jkkll
5 m mm mnn mnnoo
6 x aa$ x[11;10H[K[12;1H7 (a)(b) abba[12;14H[K[13;1H8 axx ab]xx[13;12H[K[14;1H9 x x[14;9H[K[15;1Ha x x[15;10H[K[16;1Hb ???[16;9H[K[17;1Hc x x[17;7H[K[18;1Hd ?[18;7H[K[19;1He y [19;5H[K[20;1Hf z[20;5H[K[21;1Hg abb
h Aſ B Cǿ D E˿ F G H IϿ[23;1H J K L M Nѿ Oؿ P Q R S T Uܿ[24;1H V W X Yݿ Z[25;1H[K[24;38H[?25h[?0c[?25l[?1c[24;38H[K[24;37H[?25h[?0c[?25l[?1c
/[?25h[?0c [[=a=]]* [[=b=]]* [[=c=]]* [[=d=]]* [[=e=]]* [[=f=]]* [[=g=]]* [[=h=]]* [[=i=
[24;80H][25;1H]* [[=j=]]* [[=k=]]* [[=l=]]* [[=m=]]* [[=n=]]* [[=o=]]* [[=p=]]* [[=q=]]* [[=r
[24;80H=[25;1H]]* [[=s=]]* [[=t=]]* [[=u=]]* [[=v=]]* [[=w=]]* [[=x=]]* [[=y=]]* [[=z=]]*/e[?25l[?1c[23;1H[1m[32mPress ENTER or type command to continue[0m[23;40H[K[24;1H[K[25;1H[K[?25h[?0c[1;1H[2L[?25l[?1c[1;1HENDTEST

1 a aa abb abbcc
2 d dd dee deeff
3 g gg ghh ghhii
4 j jj jkk jkkll
5 m mm mnn mnnoo
6 x aa$ x[8;10H[K[9;1H7 (a)(b) abba[9;14H[K[10;1H8 axx ab]xx[10;12H[K[11;1H9 x x[11;9H[K[12;1Ha x x[12;10H[K[13;1Hb ???[13;9H[K[14;1Hc x x[14;7H[K[15;1Hd ?[15;7H[K[16;1He y [16;5H[K[17;1Hf z[17;5H[K[18;1Hg abb
h Aſ B Cǿ D E˿ F G H IϿ[20;1H J K L M Nѿ Oؿ P Q R S T Uܿ[21;1H V W X Yݿ Z
i a忿 b c翿 d e뿿 f g h i￿[23;2Hj k l m n񿿿 o p q r s t u[24;1H v w x y z[25;1H[K[24;43H[?25h[?0c[?25l[?1c[24;43H[K[24;42H[?25h[?0c[?25l[?1c
:[?25h[?0c" Test backwards search from a multi-byte char[?25l[?1c[24;42H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0cx[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hj 0123x[25;1H[K[24;8H[?25h[?0c[?25l[?1c[24;8H[K[24;7H[?25h[?0c[?25l[?1c
?[?25h[?0c.[?25l[?1c[24;6H[?25h[?0c[?25l[?1c[24;7H[K[24;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet @w=':%s#comb[i]nations#mmm[1C#g'[?25l[?1c[24;6H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c@w[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hk m[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c?^1?,$w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New] 20L, 1011C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ce! test.out[?25l[?1c"test.out" [25;12H[K[25;12H20L, 1011C[1;1H[?25h[?0c[24;1H[?25l[?1c[25;1H[K[25;1H:[?25h[?0cput =matchstr(\"\", \".\", 0, 2) " [?25l[?1c[1;24r[24;1H
[1;25r[24;1H[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =matchstr(\"\", \"..\", 0, 2) " [?25l[?1c[1;24r[24;1H
[1;25r[24;1H[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =matchstr(\"\", \".\", 0, 0) " [?25l[?1c[1;24r[24;1H
[1;25r[24;1H[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cput =matchstr(\"\", \".\", 4, -1) " [?25l[?1c[1;24r[24;1H
[1;25r[24;1H[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cw![?25l[?1c"test.out" 24L, 1025C written[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test100.failed test.ok test.out X* viminfo
cp test100.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test100.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test100.in" 50 lines, 1704 characters[1;1HTests for 'undolevel' and 'lispwords' settings being global-local

STARTTEST
:so small.vim
:set nocompatible viminfo+=nviminfo ul=5
:fu! FillBuffer()
  :for i in range(1,13)
    :put=i
    :exe "setg ul=" . &g:ul
  :endfor
:endfu
:fu! UndoLevel()
  :redir @a | setglobal undolevels? | echon ' global' | setlocal undolevels? | e[14;1Hchon ' local' |redir end
  :$put a
:endfu
:new one
:0put ='ONE: expecting global undolevels: 5, local undolevels: -123456 (default)[19;1H'
:call FillBuffer()
:call feedkeys(":earlier 10\n", 't')
:call UndoLevel()
:%w! test.out
:new two[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for 'undolevel' and 'lispwords' settings being global-local[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 45 lines, 1618 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:new three
:setglobal ul=50
:1put ='global value should be changed to 50'
:2put ='THREE: expecting global undolevels: 50, local undolevels: -123456 (defau[5;1Hlt)'
:call UndoLevel()
:%w >> test.out
:"sleep 10
:"
:" Testing 'lispwords'
:"
:setglobal lispwords=foo,bar,baz
:setlocal lispwords-=foo | setlocal lispwords+=quux
:redir >> test.out | echon "\nTesting 'lispwords' local value" | setglobal lispw[15;1Hords? | setlocal lispwords? | echo &lispwords . "\n" | redir end
:setlocal lispwords<
:redir >> test.out | echon "\nTesting 'lispwords' value reset" | setglobal lispw[18;1Hords? | setlocal lispwords? | echo &lispwords . "\n" | redir end
:qa!
ENDTEST

[1m[34m~                                                                               [23;1H~                                                                               [24;1H~                                                                               [20;1H[?25h[?0c
[?25l[?1c[25;1H[0m:so! Xdotest[21;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[21;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset nocompatible viminfo+=nviminfo ul=5[?25l[?1c[21;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfu! FillBuffer()[?25l[?1c
:  [?25h[?0c  :for i in range(1,13)
[?25l[?1c:    [?25h[?0c    :put=i
[?25l[?1c:    [?25h[?0c    :exe "setg ul=" . &g:ul
[?25l[?1c:    [?25h[?0c  :endfor
[?25l[?1c:  [?25h[?0c:endfu[1;1H[5L[?25l[?1c[1;1H:new three
:setglobal ul=50
:1put ='global value should be changed to 50'
:2put ='THREE: expecting global undolevels: 50, local undolevels: -123456 (defau[5;1Hlt)'[25;1H[K[21;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cfu! UndoLevel()[?25l[?1c
:  [?25h[?0c  :redir @a | setglobal undolevels? | echon ' global' | setlocal undolevels?
| echon ' local' |redir end
[?25l[?1c:  [?25h[?0c  :$put a
[?25l[?1c:  [?25h[?0c:endfu[1;1H[4L[?25l[?1c[1;1H:new three
:setglobal ul=50
:1put ='global value should be changed to 50'
:2put ='THREE: expecting global undolevels: 50, local undolevels: -123456 (defau[25;1H[K[21;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cnew one[?25l[?1c"one" [New File][1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7mone                                                                             [0m[13;5Hglobal lispwords=foo,bar,baz[13;33H[K[14;2Hsetlocal lispwords-=foo | setlocal lispwords+=quux[14;52H[K[15;1H:redir >> test.out | echon "\nTesting 'lispwords' local value" | setglobal lispw[16;1Hords? | setlocal lispwords? | echo &lispwords . "\n" | redir end
:setlocal lispwords<[17;22H[K[18;1H:redir >> test.out | echon "\nTesting 'lispwords' value reset" | setglobal lispw[19;1Hords? | setlocal lispwords? | echo &lispwords . "\n" | redir end
:qa![20;5H[K[21;1HENDTEST[22;1H[K[24;1H[7mtest100.in                                                                      [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c0put ='ONE: expecting global undolevels: 5, local undolevels: -123456 (default
[24;80H)[25;1H'[?25l[?1c[1;1H[L[1;1HONE: expecting global undolevels: 5, local undolevels: -123456 (default)[2;1H[K[12;5H[1m[7m[+][0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall FillBuffer()[?25l[?1c[1;1H3[1;2H[K[2;1H4
5[3;2H[K[4;1H6[4;2H[K[5;1H7[5;2H[K[6;1H8[6;2H[K[7;1H9[7;2H[K[8;1H10[8;3H[K[9;1H11[9;3H[K[10;1H12[10;3H[K[11;1H13[11;3H[K[11;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall feedkeys(":earlier 10\n", 't')[?25l[?1c[11;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:earlier 106 fewer lines; before #8  0 seconds ago[6;1H[K[7;1H[1m[34m~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [5;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall UndoLevel()[?25l[?1c[25;1H[K[25;1H  undolevels=5 global
  undolevels=-123456 local
3 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c%w! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New] 12L, 138C written
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cnew two[?25l[?1c"two" [New File][27m[24m[0m[H[J[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [0m[8;1H[1m[7mtwo                                                                             [0m[9;1H6
7[13;3Hundolevels=5 global
  undolevels=-123456 local
[1m[34m~                                                                               [0m[16;1H[7mone [+]                                                                         [0m[17;1H:setlocal lispwords<
:redir >> test.out | echon "\nTesting 'lispwords' value reset" | setglobal lispw[19;1Hords? | setlocal lispwords? | echo &lispwords . "\n" | redir end
:qa!
ENDTEST

[1m[34m~                                                                               [0m[24;1H[7mtest100.in                                                                      [1;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0c0put ='TWO: expecting global undolevels: 5, local undolevels: 2 (first) then 1
[24;80H0[25;1H (afterwards)'[?25l[?1c[1;1H[L[1;1HTWO: expecting global undolevels: 5, local undolevels: 2 (first) then 10 (afterw[2;1Hards)[2;6H[K[3;1H[K[8;5H[1m[7m[+][0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0csetlocal ul=2[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall FillBuffer()[?25l[?1c[1;1H8[1;2H[K[2;1H9[2;2H[K[3;1H10
11[4;3H[K[5;1H12[5;3H[K[6;1H13[6;3H[K[7;1H[K[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall feedkeys(":earlier 10\n", 't')[?25l[?1c[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:earlier 103 fewer lines; before #12  0 seconds ago[4;1H[K[5;1H[1m[34m~                                                                               [6;1H~                                                                               [7;1H~                                                                               [3;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall UndoLevel()[?25l[?1c[25;1H[K[25;1H  undolevels=5 global
  undolevels=2 local
3 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0csetlocal ul=10[?25l[?1c[1;1H[3L[1;1H8
9
10[5;1H[K[6;1H  undolevels=5 global[6;22H[K[7;1H  undolevels=2 local[7;21H[K[25;3H[K[7;3H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall UndoLevel()[?25l[?1c[25;1H[K[25;1H  undolevels=5 global
  undolevels=10 local
3 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c%w >> test.out[?25l[?1c"test.out" [25;12H[K[25;12H18L, 197C appended
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cwincmd p[?25l[?1c[1;1H[4L[1;1H8
9
10[8;1H[7mtwo [+]                                                                         [0m[16;1H[1m[7mone [+]                                                                         [0m[25;3H[K[14;3H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0credir >>test.out | echo "global value shouldn't be changed and still be 5!" | 
[24;80He[25;1Hcho 'ONE: expecting global undolevels: 5, local undolevels: -123456 (default)'|
[24;80H:[25;1Hsetglobal undolevels? | echon ' global' | setlocal undolevels? | echon ' local'
|echo "" |redir end[?25l[?1c[22;1Hglobal value shouldn't be changed and still be 5![22;50H[K[23;1H[K[24;1H[K[25;1H[K[23;1HONE: expecting global undolevels: 5, local undolevels: -123456 (default)
  undolevels=5 global
  undolevels=-123456 local

[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cnew three[?25l[?1c"three" [New File][27m[24m[0m[H[J[1;3Hundolevels=5 global
  undolevels=2 local

  undolevels=5 global
  undolevels=10 local
[7mtwo [+]                                                                         [0m[8;1H[1m[34m~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7mthree                                                                           [0m[13;1H7[16;3Hundolevels=5 global
  undolevels=-123456 local
[7mone [+]                                                                         [0m[19;1H:redir >> test.out | echon "\nTesting 'lispwords' value reset" | setglobal lispw[20;1Hords? | setlocal lispwords? | echo &lispwords . "\n" | redir end
:qa!
ENDTEST

[7mtest100.in                                                                      [7;1H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0csetglobal ul=50[?25l[?1c[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c1put ='global value should be changed to 50'[?25l[?1c[8;1Hglobal value should be changed to 50[8;37H[K[12;7H[1m[7m[+][8;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c2put ='THREE: expecting global undolevels: 50, local undolevels: -123456 (defa
[24;80Hu[25;1Hlt)'[?25l[?1c[1;1H[L[1;3Hundolevels=5 global[9;1HTHREE: expecting global undolevels: 50, local undolevels: -123456 (default)[9;76H[K[25;1H[K[9;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall UndoLevel()[?25l[?1c[25;1H[K[25;1H  undolevels=50 global
  undolevels=-123456 local
3 more lines
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c%w >> test.out[?25l[?1c"test.out" [25;12H[K[25;12H6L, 165C appended
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c"sleep 10[?25l[?1c[1;1H[4L[1;3Hundolevels=5 global
  undolevels=2 local

  undolevels=5 global[7;11r[11;1H
[1;25r[9;1H[K[10;1H  undolevels=50 global[10;23H[K[11;3Hundolevels=-123456 local[25;3H[K[11;3H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c"[?25l[?1c[11;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Testing 'lispwords'[?25l[?1c[11;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[11;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csetglobal lispwords=foo,bar,baz[?25l[?1c[11;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csetlocal lispwords-=foo | setlocal lispwords+=quux[?25l[?1c[11;3H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0credir >> test.out | echon "\nTesting 'lispwords' local value" | setglobal lisp
[24;80Hw[25;1Hords? | setlocal lispwords? | echo &lispwords . "\n" | redir end[?25l[?1c[24;1H[K[25;1H[K[25;1HTesting 'lispwords' local value
  lispwords=foo,bar,baz
  lispwords=bar,baz,quux
bar,baz,quux

[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0csetlocal lispwords<[?25l[?1c[1;1H[6L[1;3Hundolevels=5 global
  undolevels=2 local

  undolevels=5 global
  undolevels=10 local
[7mtwo [+]                                                                         [11;3H[?25h[?0c[?25l[?1c[25;1H[0m:[?25h[?0credir >> test.out | echon "\nTesting 'lispwords' value reset" | setglobal lisp
[24;80Hw[25;1Hords? | setlocal lispwords? | echo &lispwords . "\n" | redir end[?25l[?1c[24;1H[K[25;1H[K[25;1HTesting 'lispwords' value reset
  lispwords=foo,bar,baz
  lispwords=foo,bar,baz
foo,bar,baz

[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test101.failed test.ok test.out X* viminfo
cp test101.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test101.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test101.in" 45 lines, 796 characters[1;1HTest for v:hlsearch     vim: set ft=vim :

STARTTEST
:" Last abc: Q
:so small.vim
:new
:call setline(1, repeat(['aaa'], 10))
:set hlsearch nolazyredraw
:let r=[]
:command -nargs=0 -bar AddR :call add(r, [screenattr(1, 1), v:hlsearch])
/aaa
:AddR
:nohlsearch
:AddR
:let v:hlsearch=1
:AddR
:let v:hlsearch=0
:AddR
:set hlsearch
:AddR
:let v:hlsearch=0
:AddR
n:AddR
:let v:hlsearch=0[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for v:hlsearch     vim: set ft=vim :[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 39 lines, 727 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[20M[1;25r[5;1H:AddR
/
:AddR
:let r1=r[0][0]
:" I guess it is not guaranteed that screenattr outputs always the same characte[10;1Hr
:call map(r, 'v:val[1].":".(v:val[0]==r1?"highlighted":"not highlighted")')
:try
:   let v:hlsearch=[]
:catch
:   call add(r, matchstr(v:exception,'^Vim(let):E\d\+:'))
:endtry
:bwipeout!
:$put=r
:call garbagecollect(1)
:"
:/^start:/,$wq! test.out
:" vim: et ts=4 isk-=\:
:call getchar()
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Last abc: Q[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnew[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7m[No Name]                                                                       [0m[13;2H   call add(r, matchstr(v:exception,'^Vim(let):E\d\+:'))
:endtry[14;8H[K[15;2Hbwipeout!
:$put=r[16;8H[K[17;2Hcall garbagecollect(1)
:"[18;3H[K[19;2H/^start:/,$wq! test.out
:" vim: et ts=4 isk-=\:[20;24H[K[21;2Hcall getchar()[21;17H[K[22;1HENDTEST[22;8H[K[23;1H[K[24;1H[7mtest101.in                                                                      [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall setline(1, repeat(['aaa'], 10))[?25l[?1c[1;1Haaa
aaa[2;4H[K[3;1Haaa[3;4H[K[4;1Haaa[4;4H[K[5;1Haaa[5;4H[K[6;1Haaa[6;4H[K[7;1Haaa[7;4H[K[8;1Haaa[8;4H[K[9;1Haaa[9;4H[K[10;1Haaa[10;4H[K[12;11H[1m[7m[+][1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset hlsearch nolazyredraw[?25l[?1c[22;1H[30m[43mENDTEST[1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet r=[][?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccommand -nargs=0 -bar AddR :call add(r, [screenattr(1, 1), v:hlsearch])[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0caaa[?25l[?1c[1;1H[30m[43maaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa[0m[22;1HENDTEST[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cAddR[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnohlsearch[?25l[?1c[1;1Haaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cAddR[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet v:hlsearch=1[?25l[?1c[1;1H[30m[43maaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa[2;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cAddR[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet v:hlsearch=0[?25l[?1c[1;1Haaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cAddR[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset hlsearch[?25l[?1c[1;1H[30m[43maaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa[2;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cAddR[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet v:hlsearch=0[?25l[?1c[1;1Haaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cAddR[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H/aaa[25;5H[K[25;1H[1;1H[30m[43maaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa[3;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cAddR[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet v:hlsearch=0[?25l[?1c[1;1Haaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cAddR[?25l[?1c[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/[?25h[?0c[?25l[?1c/aaa[1;1H[30m[43maaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa
aaa[4;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cAddR[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet r1=r[0][0][?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" I guess it is not guaranteed that screenattr outputs always the same charact
[24;80He[25;1Hr[?25l[?1c[1;1H[L[1;1H[30m[43maaa[0m[25;1H[K[4;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccall map(r, 'v:val[1].":".(v:val[0]==r1?"highlighted":"not highlighted")')[?25l[?1c[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctry[?25l[?1c
:  [?25h[?0c:   let v:hlsearch=[]
[?25l[?1c:  [?25h[?0c:catch
[?25l[?1c:  [?25h[?0c:   call add(r, matchstr(v:exception,'^Vim(let):E\d\+:'))
[?25l[?1c:  [?25h[?0c:endtry[1;1H[4L[?25l[?1c[1;1H[30m[43maaa
aaa
aaa
aaa[0m[25;1H[K[4;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cbwipeout![?25l[?1c[1;1H:AddR
n:AddR
:let v:hlsearch=0
:AddR
/[5;2H[K[6;1H:AddR
:let r1=r[0][0]
:" I guess it is not guaranteed that screenattr outputs always the same characte[9;1Hr[9;2H[K[10;1H:call map(r, 'v:val[1].":".(v:val[0]==r1?"highlighted":"not highlighted")')
:try[11;5H[K[12;1H:   let v:hlsearch=[][12;22H[K[13;2Hcatch[13;7H[K[14;2H   call add(r, matchstr(v:exception,'^Vim(let):E\d\+:'))
:endtry[15;8H[K[16;2Hbwipeout!
:$put=r[17;8H[K[18;2Hcall garbagecollect(1)
:"[19;3H[K[20;2H/^start:/,$wq! test.out
:" vim: et ts=4 isk-=\:
:call getchar()
ENDTEST[24;1H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put=r[?25l[?1c10 more lines[1;24r[1;1H[11M[1;25r[14;1Hstart:
1:highlighted
0:not highlighted
1:highlighted
0:not highlighted
1:highlighted
0:not highlighted
1:highlighted
0:not highlighted
1:highlighted
Vim(let):E706:[25;1H[K[25;1H10 more lines[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall garbagecollect(1)[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^start:/,$wq! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 11 lines, 164 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test102.failed test.ok test.out X* viminfo
cp test102.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test102.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test102.in" 12 lines, 277 characters[1;1HTest if fnameescape is correct for special chars like !

STARTTEST
:%d
:let fname = 'Xspa ce'
:try | exe "w! " . fnameescape(fname) | put='Space' | endtry
:let fname = 'Xemark!'
:try | exe "w! " . fnameescape(fname) | put='ExclamationMark' | endtry
:w! test.out
:qa!
ENDTEST

[1m[34m~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest if fnameescape is correct for special chars like ![25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 7 lines, 201 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[11;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c%d[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [0m[25;1H--No lines in buffer--[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet fname = 'Xspa ce'[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctry | exe "w! " . fnameescape(fname) | put='Space' | endtry [?25l[?1c"Xspa ce" [25;12H[K[25;11H[New File] 0 lines, 0 characters written[2;1HSpace[2;6H[K[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet fname = 'Xemark!'[?25l[?1c[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctry | exe "w! " . fnameescape(fname) | put='ExclamationMark' | endtry[?25l[?1c"Xemark!" [25;12H[K[25;11H[New File] 2 lines, 7 characters written[3;1HExclamationMark[3;16H[K[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 3 lines, 23 characters written[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test103.failed test.ok test.out X* viminfo
cp test103.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test103.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test103.in" 37 lines, 823 characters[1;1HTest for visual mode not being reset causing E315 error.
STARTTEST
:so small.vim
:enew
:let g:msg="Everything's fine."
:function! TriggerTheProblem()
:[7C" At this point there is no visual selection because :call reset it.
:[7C" Let's restore the selection:
:[7Cnormal gv
:[7C'<,'>del _
:[7Ctry
:[15Cexe "normal \<Esc>"
:[7Ccatch /^Vim\%((\a\+)\)\=:E315/
:[15Cechom 'Snap! E315 error!'
:[15Clet g:msg='Snap! E315 error!'
:[7Cendtry
:endfunction
:enew
:setl buftype=nofile
:call append(line('$'), 'Delete this line.')
:"
:"
:" NOTE: this has to be done by a call to a function because executing :del the
:"[7Cex-way will require the colon operator which resets the visual mode thu[24;1H[1m[34m@                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[24;1H:"       ex-way will require the colon operator which resets the visual mode thu[24;1H[1m[34m@                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for visual mode not being reset causing E315 error.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[2;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[24;1H:"       ex-way will require the colon operator which resets the visual mode thu[24;1H[1m[34m@                                                                               [3;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 29 lines, 723 characters written[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[24;1H:"       ex-way will require the colon operator which resets the visual mode thu[24;1H[1m[34m@                                                                               [3;1H[?25h[?0c[?25l[?1c[0m[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[9M[1;25r[15;1H:"       ex-way will require the colon operator which resets the visual mode thu[16;1Hs
:"[7Cpreventing the problem:
:"
GV:call TriggerTheProblem()
:%del _
:call append(line('$'), g:msg)
:w! test.out
:brewind
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cenew[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet g:msg="Everything's fine."[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunction! TriggerTheProblem()[?25l[?1c
:  [?25h[?0c:[1m[34m^I[0m" At this point there is no visual selection because :call reset it.
[?25l[?1c:  [?25h[?0c:[1m[34m^I[0m" Let's restore the selection:
[?25l[?1c:  [?25h[?0c:[1m[34m^I[0mnormal gv
[?25l[?1c:  [?25h[?0c:[1m[34m^I[0m'<,'>del _
[?25l[?1c:  [?25h[?0c:[1m[34m^I[0mtry
[?25l[?1c:    [?25h[?0c:[1m[34m^I^I[0mexe "normal \<Esc>"
[?25l[?1c:    [?25h[?0c:[1m[34m^I[0mcatch /^Vim\%((\a\+)\)\=:E315/
[?25l[?1c:    [?25h[?0c:[1m[34m^I^I[0mechom 'Snap! E315 error!'
[?25l[?1c:    [?25h[?0c:[1m[34m^I^I[0mlet g:msg='Snap! E315 error!'
[?25l[?1c:    [?25h[?0c:[1m[34m^I[0mendtry
[?25l[?1c:  [?25h[?0c:endfunction[1;1H[11L[?25l[?1c[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cenew[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csetl buftype=nofile[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append(line('$'), 'Delete this line.')[?25l[?1c[2;1HDelete this line.[2;18H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" NOTE: this has to be done by a call to a function because executing :del the[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"       ex-way will require the colon operator which resets the visual mode th
[24;80Hu[25;1Hs[?25l[?1c[1;1H[L[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c"       preventing the problem:[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[1;1H[?25h[?0c
[?25l[?1cD[7melete this line. [?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:'<,'>[?25h[?0ccall TriggerTheProblem()[?25l[?1c[2;1H[1m[34m~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c%del _[?25l[?1c--No lines in buffer--[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall append(line('$'), g:msg)[?25l[?1c[2;1HEverything's fine.[2;19H[K[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 2 lines, 20 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbrewind[?25l[?1c"test103.in" 37 lines, 823 characters[1;1H:[15Clet g:msg='Snap! E315 error!'
:       endtry[2;15H[K[3;1H:endfunction[3;13H[K[4;1H:enew[4;6H[K[5;1H:setl buftype=nofile[5;21H[K[6;1H:call append(line('$'), 'Delete this line.')[6;45H[K[7;1H:"[7;3H[K[8;1H:"[8;3H[K[9;1H:" NOTE: this has to be done by a call to a function because executing :del the[9;80H[K[10;1H:"       ex-way will require the colon operator which resets the visual mode thu[11;1Hs[11;2H[K[12;1H:"       preventing the problem:[12;33H[K[13;1H:"[13;3H[K[14;1HGV:call TriggerTheProblem()[14;28H[K[15;1H:%del _[15;8H[K[16;1H:call append(line('$'), g:msg)[16;31H[K[17;1H:w! test.out[17;13H[K[18;1H:brewind[18;9H[K[19;1HENDTEST[19;8H[K[20;1H[K[21;1HSTARTTEST[21;10H[K[22;1H:qa![22;5H[K[23;1HENDTEST[23;8H[K[24;1H[K[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H/^STARTTEST[21;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H1 line, 5 characters written[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[22;1H[?25h[?0c[?25l[?1c


/ENDTEST[25;10H[K[25;1H[23;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test104.failed test.ok test.out X* viminfo
cp test104.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test104.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test104.in" 30 lines, 698 characters[1;1HTests for :let.  vim: set ft=vim ts=8 :

STARTTEST
:so small.vim
:set runtimepath+=./sautest
:" Test to not autoload when assigning.  It causes internal error.
:try
:  let Test104#numvar = function('tr')
:  $put ='OK: ' . string(Test104#numvar)
:catch
:  $put ='FAIL: ' . v:exception
:endtry
:let a = 1
:let b = 2
:for letargs in ['a b', '{0 == 1 ? "a" : "b"}', '{0 == 1 ? "a" : "b"} a', 'a {0
== 1 ? "a" : "b"}']
:  try
:    redir => messages
:    execute 'let' letargs
:    redir END
:    $put ='OK:'
:    $put =split(substitute(messages, '\n', '\0  ', 'g'), '\n')
:  catch
:    $put ='FAIL: ' . v:exception[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for :let.  vim: set ft=vim ts=8 :[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 24 lines, 618 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[5M[1;25r[20;1H:    redir END
:  endtry
:endfor
:/^Results/,$wq! test.out
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset runtimepath+=./sautest[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Test to not autoload when assigning.  It causes internal error.[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctry[?25l[?1c
:  [?25h[?0c:  let Test104#numvar = function('tr')
[?25l[?1c:  [?25h[?0c:  $put ='OK: ' . string(Test104#numvar)
[?25l[?1c:  [?25h[?0c:catch
[?25l[?1c:  [?25h[?0c:  $put ='FAIL: ' . v:exception
[?25l[?1c:  [?25h[?0c:endtry[1;1H[5L[?25l[?1c[1;1H:  $put ='OK: ' . string(Test104#numvar)
:catch
:  $put ='FAIL: ' . v:exception
:endtry
:let a = 1
:let b = 2
:for letargs in ['a b', '{0 == 1 ? "a" : "b"}', '{0 == 1 ? "a" : "b"} a', 'a {0
== 1 ? "a" : "b"}']
:  try[9;7H[K[10;1H:    redir => messages
:    execute 'let' letargs[12;12HEND[12;15H[K[13;6H$put ='OK:'[13;17H[K[14;6H$put =split(substitute(messages, '\n', '\0  ', 'g'), '\n')
:  catch[15;9H[K[16;12H'FAIL: ' . v:exception[16;34H[K[17;4H  redir END
:  endtry[18;11H[K[19;2Hendfor[19;8H[K[20;2H/^Results/,$wq! test.out
ENDTEST[22;1H[K[23;1HResults of test104:
OK: function('tr')[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet a = 1[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet b = 2[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfor letargs in ['a b', '{0 == 1 ? "a" : "b"}', '{0 == 1 ? "a" : "b"} a', 'a {0
== 1 ? "a" : "b"}'][?25l[?1c[25;1H[K[25;1H:  [?25h[?0c:  try
[?25l[?1c:    [?25h[?0c:    redir => messages
[?25l[?1c:    [?25h[?0c:    execute 'let' letargs
[?25l[?1ca[21C#1
b[21C#2
:    [?25h[?0c:    redir END
[?25l[?1c:    [?25h[?0c:    $put ='OK:'
[?25l[?1c:    [?25h[?0c:    $put =split(substitute(messages, '\n', '\0  ', 'g'), '\n')
[?25l[?1c:    [?25h[?0c:  catch
[?25l[?1c:    [?25h[?0c:    $put ='FAIL: ' . v:exception
[?25l[?1c:    [?25h[?0c:    redir END
[?25l[?1c:    [?25h[?0c:  endtry
[?25l[?1c:  [?25h[?0c:endfor
[?25l[?1cb[21C#2
b[21C#2
a[21C#1
a[21C#1
b[21C#2
[1m[32mPress ENTER or type command to continue[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0c/^Results/,$wq! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 13 lines, 244 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test105.failed test.ok test.out X* viminfo
cp test105.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test105.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test105.in" 45 lines, 1700 characters[1;1HTest filename modifiers     vim: set ft=vim :

STARTTEST
:source small.vim
:%delete _
:set shell=sh
:set shellslash
:let tab="\t"
:command -nargs=1 Put :let expr=<q-args> | $put =expr.tab.strtrans(string(eval(e[10;1Hxpr)))
:let $HOME=fnamemodify('.', ':p:h:h')
:Put fnamemodify('.',[14C':p'      )[-1:]
:Put fnamemodify('.',[14C':p:h'    )[-1:]
:Put fnamemodify('test.out',[7C':p'      )[-1:]
:Put fnamemodify('test.out',[7C':.'      )
:Put fnamemodify('../testdir/a',   ':.'      )
:Put fnamemodify('test.out',[7C':~'      )
:Put fnamemodify('../testdir/a',   ':~'      )
:Put fnamemodify('../testdir/a',   ':t'      )
:Put fnamemodify('.',[14C':p:t'    )
:Put fnamemodify('test.out',[7C':p:t'    )
:Put fnamemodify('test.out',[7C':p:e'    )
:Put fnamemodify('test.out',[7C':p:t:e'  )
:Put fnamemodify('abc.fb2.tar.gz', ':r'      )[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest filename modifiers     vim: set ft=vim :[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 40 lines, 1634 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:Put fnamemodify('test.out',[7C':p:t:e'  )
:Put fnamemodify('abc.fb2.tar.gz', ':r'      )
:Put fnamemodify('abc.fb2.tar.gz', ':r:r'    )
:Put fnamemodify('abc.fb2.tar.gz', ':r:r:r'  )
:Put substitute(fnamemodify('abc.fb2.tar.gz', ':p:r:r'), '.*\(testdir/.*\)', '\1[6;1H', '')
:Put fnamemodify('abc.fb2.tar.gz', ':e'      )
:Put fnamemodify('abc.fb2.tar.gz', ':e:e'    )
:Put fnamemodify('abc.fb2.tar.gz', ':e:e:e'  )
:Put fnamemodify('abc.fb2.tar.gz', ':e:e:e:e')
:Put fnamemodify('abc.fb2.tar.gz', ':e:e:r'  )
:Put fnamemodify('abc def',[8C':S'      )
:Put fnamemodify('abc" "def',      ':S'      )
:Put fnamemodify('abc"%"def',      ':S'      )
:Put fnamemodify('abc'' ''def',    ':S'      )
:Put fnamemodify('abc''%''def',    ':S'      )
:Put fnamemodify("abc\ndef",[7C':S'      )
:set shell=tcsh
:Put fnamemodify("abc\ndef",[7C':S'      )
:$put ='vim: ts=8'
:1 delete _
:w! test.out
:qa!
ENDTEST[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0csource small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c%delete _[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [12;1H~                                                                               [13;1H~                                                                               [14;1H~                                                                               [15;1H~                                                                               [16;1H~                                                                               [17;1H~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [0m[25;1H--No lines in buffer--[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset shell=sh[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset shellslash[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet tab="\t"[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccommand -nargs=1 Put :let expr=<q-args> | $put =expr.tab.strtrans(string(eval(
[24;80He[25;1Hxpr)))[?25l[?1c[1;1H[L[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0clet $HOME=fnamemodify('.', ':p:h:h')[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify('.',              ':p'      )[-1:][?25l[?1c[2;1Hfnamemodify('.',              ':p'      )[-1:]  '/'[2;52H[K[2;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify('.',              ':p:h'    )[-1:][?25l[?1c[3;1Hfnamemodify('.',              ':p:h'    )[-1:]  'r'[3;52H[K[3;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify('test.out',       ':p'      )[-1:][?25l[?1c[4;1Hfnamemodify('test.out',       ':p'      )[-1:]  't'[4;52H[K[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify('test.out',       ':.'      )[?25l[?1c[5;1Hfnamemodify('test.out',       ':.'      )       'test.out'[5;59H[K[5;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify('../testdir/a',   ':.'      )[?25l[?1c[6;1Hfnamemodify('../testdir/a',   ':.'      )       'a'[6;52H[K[6;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify('test.out',       ':~'      )[?25l[?1c[7;1Hfnamemodify('test.out',       ':~'      )       '~/testdir/test.out'[7;69H[K[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify('../testdir/a',   ':~'      )[?25l[?1c[8;1Hfnamemodify('../testdir/a',   ':~'      )       '~/testdir/a'[8;62H[K[8;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify('../testdir/a',   ':t'      )[?25l[?1c[9;1Hfnamemodify('../testdir/a',   ':t'      )       'a'[9;52H[K[9;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify('.',              ':p:t'    )[?25l[?1c[10;1Hfnamemodify('.',              ':p:t'    )       ''[10;51H[K[10;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify('test.out',       ':p:t'    )[?25l[?1c[11;1Hfnamemodify('test.out',       ':p:t'    )       'test.out'[11;59H[K[11;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify('test.out',       ':p:e'    )[?25l[?1c[12;1Hfnamemodify('test.out',       ':p:e'    )       'out'[12;54H[K[12;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify('test.out',       ':p:t:e'  )[?25l[?1c[13;1Hfnamemodify('test.out',       ':p:t:e'  )       'out'[13;54H[K[13;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify('abc.fb2.tar.gz', ':r'      )[?25l[?1c[14;1Hfnamemodify('abc.fb2.tar.gz', ':r'      )       'abc.fb2.tar'[14;62H[K[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify('abc.fb2.tar.gz', ':r:r'    )[?25l[?1c[15;1Hfnamemodify('abc.fb2.tar.gz', ':r:r'    )       'abc.fb2'[15;58H[K[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify('abc.fb2.tar.gz', ':r:r:r'  )[?25l[?1c[16;1Hfnamemodify('abc.fb2.tar.gz', ':r:r:r'  )       'abc'[16;54H[K[16;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut substitute(fnamemodify('abc.fb2.tar.gz', ':p:r:r'), '.*\(testdir/.*\)', '\
[24;80H1[25;1H', '')[?25l[?1c[1;1H[L[17;1Hsubstitute(fnamemodify('abc.fb2.tar.gz', ':p:r:r'), '.*\(testdir/.*\)', '\1', ''[18;1H)       'testdir/abc.fb2'[18;26H[K[25;1H[K[17;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cPut fnamemodify('abc.fb2.tar.gz', ':e'      )[?25l[?1c[19;1Hfnamemodify('abc.fb2.tar.gz', ':e'      )       'gz'[19;53H[K[19;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify('abc.fb2.tar.gz', ':e:e'    )[?25l[?1c[20;1Hfnamemodify('abc.fb2.tar.gz', ':e:e'    )       'tar.gz'[20;57H[K[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify('abc.fb2.tar.gz', ':e:e:e'  )[?25l[?1c[21;1Hfnamemodify('abc.fb2.tar.gz', ':e:e:e'  )       'fb2.tar.gz'[21;61H[K[21;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify('abc.fb2.tar.gz', ':e:e:e:e')[?25l[?1c[22;1Hfnamemodify('abc.fb2.tar.gz', ':e:e:e:e')       'fb2.tar.gz'[22;61H[K[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify('abc.fb2.tar.gz', ':e:e:r'  )[?25l[?1c[23;1Hfnamemodify('abc.fb2.tar.gz', ':e:e:r'  )       'tar'[23;54H[K[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify('abc def',        ':S'      )[?25l[?1c[24;1Hfnamemodify('abc def',        ':S'      )       '''abc def'''[24;62H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify('abc" "def',      ':S'      )[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hfnamemodify('abc" "def',      ':S'      )[7C'''abc" "def'''[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cPut fnamemodify('abc"%"def',      ':S'      )[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hfnamemodify('abc"%"def',      ':S'      )[7C'''abc"%"def'''[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cPut fnamemodify('abc'' ''def',    ':S'      )[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hfnamemodify('abc'' ''def',    ':S'      )[7C'''abc''\'''' ''\''''def'''[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cPut fnamemodify('abc''%''def',    ':S'      )[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hfnamemodify('abc''%''def',    ':S'      )[7C'''abc''\''''%''\''''def'''[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cPut fnamemodify("abc\ndef",       ':S'      )[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hfnamemodify("abc\ndef",[7C':S'      )[7C'''abc^@def'''[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cset shell=tcsh[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cPut fnamemodify("abc\ndef",       ':S'      )[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hfnamemodify("abc\ndef",[7C':S'      )[7C'''abc\^@def'''[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c$put ='vim: ts=8'[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hvim: ts=8[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c1 delete _[?25l[?1c[1;15H',              ':p[8C[-1:]  '/'[1;52H[K[2;15H',              ':p:h'    )[-1:]  'r[3;14Htest.out',[10C'      )[-1:]  't'[4;33H.'  [5;14H../testdir/a',   ':.'  [13Ca'[5;52H[K[6;33H~'    [11C~/testdir/test.out'[7;14H../testdir/a',   ':~[16C~/testdir/a[8;14H../testdir/a',   ':t'  [14C'[8;52H[K[9;14H.',              ':p:t'  [11C'[9;51H[K[10;1Hfnamemodify('test.out',       ':p:t'    )       'test.out'[10;59H[K[11;1Hfnamemodify('test.out',       ':p:e'    )[7C'out'[12;14Htest.out',       ':p:t:e'[11Cout'[13;33Hr'  [13Cabc.fb2.tar'[14;33Hr:r'  [11Cabc.fb2'[14;58H[K[15;33Hr:r:r'  [9Cabc'[15;54H[K[16;1Hsubstitute(fnamemodify('abc.fb2.tar.gz', ':p:r:r'), '.*\(testdir/.*\)', '\1', ''[17;1H)       'testdir/abc.fb2'[17;31H[K[18;17H.fb2.tar.gz', ':e[16Cgz'[18;53H[K[19;17H.fb2.tar.gz', ':e:e'[13Ctar.gz'[19;57H[K[20;17H.fb2.tar.gz', ':e:e:e'[11Cfb2.tar.gz[20;61H[K[21;17H.fb2.tar.gz', ':e:e:e:e'[9Cfb2.tar.gz[21;61H[K[22;13H'abc.fb2.tar.gz', ':e:e:r'[11Ctar'[22;54H[K[23;13H'abc def', [31C def''[23;62H[K[24;1Hfnamemodify('abc" "def',      ':S'      )[7C'''abc" "def'''[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cw! test.out[?25l[?1c"test.out" [25;12H[K[25;12H[New File] 29 lines, 1560 characters written[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test106.failed test.ok test.out X* viminfo
cp test106.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test106.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test106.in" 16 lines, 581 characters[1;1HTests for errorformat.  vim: set ft=vim ts=8 :

STARTTEST
:so small.vim
:if !has('quickfix') | e! test.ok | wq! test.out | endif
:set efm=%EEEE%m,%WWWW%m,%+CCCC%.%#,%-GGGG%.%#
:cgetexpr ['WWWW', 'EEEE', 'CCCC']
:$put =strtrans(string(map(getqflist(), '[v:val.text, v:val.valid]')))
:cgetexpr ['WWWW', 'GGGG', 'EEEE', 'CCCC']
:$put =strtrans(string(map(getqflist(), '[v:val.text, v:val.valid]')))
:cgetexpr ['WWWW', 'GGGG', 'ZZZZ', 'EEEE', 'CCCC', 'YYYY']
:$put =strtrans(string(map(getqflist(), '[v:val.text, v:val.valid]')))
:/^Results/,$wq! test.out
ENDTEST

Results of test106:
[1m[34m~                                                                               [18;1H~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for errorformat.  vim: set ft=vim ts=8 :[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 10 lines, 494 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[14;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cif !has('quickfix') | e! test.ok | wq! test.out | endif[?25l[?1c[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset efm=%EEEE%m,%WWWW%m,%+CCCC%.%#,%-GGGG%.%#[?25l[?1c[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccgetexpr ['WWWW', 'EEEE', 'CCCC'][?25l[?1c[15;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =strtrans(string(map(getqflist(), '[v:val.text, v:val.valid]')))[?25l[?1c[17;1H[['W', 1], ['E^@CCCC', 1]][17;27H[K[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccgetexpr ['WWWW', 'GGGG', 'EEEE', 'CCCC'][?25l[?1c[17;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =strtrans(string(map(getqflist(), '[v:val.text, v:val.valid]')))[?25l[?1c[18;1H[['W', 1], ['E^@CCCC', 1]][18;27H[K[18;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccgetexpr ['WWWW', 'GGGG', 'ZZZZ', 'EEEE', 'CCCC', 'YYYY'][?25l[?1c[18;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =strtrans(string(map(getqflist(), '[v:val.text, v:val.valid]')))[?25l[?1c[19;1H[['W', 1], ['ZZZZ', 0], ['E^@CCCC', 1], ['YYYY', 0]][19;53H[K[19;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^Results/,$wq! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 4 lines, 127 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test107.failed test.ok test.out X* viminfo
cp test107.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test107.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test107.in" 38 lines, 717 characters[1;1HTests for adjusting window and contents     vim: set ft=vim :

STARTTEST
:so small.vim
:new
:call setline(1, range(1,256))
:let r=[]
:func! GetScreenStr(row)
:   let str = ""
:   for c in range(1,3)
:[7Clet str .= nr2char(screenchar(a:row, c))
:   endfor
:   return str
:endfunc
:
:exe ":norm! \<C-W>t\<C-W>=1Gzt\<C-W>w\<C-W>+"
:let s3=GetScreenStr(1)
:wincmd p
:call add(r, [line("w0"), s3])
:
:exe ":norm! \<C-W>t\<C-W>=50Gzt\<C-W>w\<C-W>+"
:let s3=GetScreenStr(1)
:wincmd p
:call add(r, [line("w0"), s3])[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for adjusting window and contents     vim: set ft=vim :[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 32 lines, 628 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[1;24r[1;1H[12M[1;25r[13;1H:
:exe ":norm! \<C-W>t\<C-W>=59Gzt\<C-W>w\<C-W>+"
:let s3=GetScreenStr(1)
::wincmd p
:call add(r, [line("w0"), s3])
:
:bwipeout!
:$put=r
:call garbagecollect(1)
:"
:/^start:/,$wq! test.out
ENDTEST[25;1H[K[24;1H[?25h[?0c[?25l[?1c[1;24r[24;1H
[1;25r[24;1H[?25h[?0c[?25l[?1c
:so! Xdotest[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cnew[?25l[?1c[1;1H[K[2;1H[1m[34m~                                                                               [3;1H~                                                                               [4;1H~                                                                               [5;1H~                                                                               [6;1H~                                                                               [7;1H~                                                                               [8;1H~                                                                               [9;1H~                                                                               [10;1H~                                                                               [11;1H~                                                                               [0m[12;1H[1m[7m[No Name]                                                                       [0m[13;2Hlet s3=GetScreenStr(1)[13;24H[K[14;2H:wincmd p[14;11H[K[15;2Hcall add(r, [line("w0"), s3])[16;2H[K[17;2Hbwipeout!
:$put=r[18;8H[K[19;2Hcall garbagecollect(1)
:"[20;3H[K[21;2H/^start:/,$wq! test.out
ENDTEST[22;8H[K[23;1H[K[24;1H[7mtest107.in                                                                      [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall setline(1, range(1,256))[?25l[?1c[1;1H1
2[2;2H[K[3;1H3[3;2H[K[4;1H4[4;2H[K[5;1H5[5;2H[K[6;1H6[6;2H[K[7;1H7[7;2H[K[8;1H8[8;2H[K[9;1H9[9;2H[K[10;1H10[10;3H[K[11;1H11[11;3H[K[12;11H[1m[7m[+][1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet r=[][?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunc! GetScreenStr(row)[?25l[?1c
:  [?25h[?0c:   let str = ""
[?25l[?1c:  [?25h[?0c:   for c in range(1,3)
[?25l[?1c:    [?25h[?0c:       let str .= nr2char(screenchar(a:row, c))
[?25l[?1c:    [?25h[?0c:   endfor
[?25l[?1c:  [?25h[?0c:   return str
[?25l[?1c:  [?25h[?0c:endfunc[1;1H[6L[?25l[?1c[1;1H1
2
3
4
5
6[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexe ":norm! \<C-W>t\<C-W>=1Gzt\<C-W>w\<C-W>+"[?25l[?1c[11;1H[7m[No Name] [+]                                                                   [0m[12;1H:exe ":norm! \<C-W>t\<C-W>=59Gzt\<C-W>w\<C-W>+"[12;48H[K[24;1H[1m[7mtest107.in                                                                      [23;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0clet s3=GetScreenStr(1)[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwincmd p[?25l[?1c[11;1H[1m[7m[No Name] [+]                                                                   [0m[24;1H[7mtest107.in                                                                      [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall add(r, [line("w0"), s3])[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexe ":norm! \<C-W>t\<C-W>=50Gzt\<C-W>w\<C-W>+"[?25l[?1c[27m[24m[0m[H[J[1;1H50
51
52
53
54
55
56
57
58
59
[7m[No Name] [+]                                                                   [0m[12;1H:exe ":norm! \<C-W>t\<C-W>=59Gzt\<C-W>w\<C-W>+"
:let s3=GetScreenStr(1)
::wincmd p
:call add(r, [line("w0"), s3])
:
:bwipeout!
:$put=r
:call garbagecollect(1)
:"
:/^start:/,$wq! test.out
ENDTEST

[1m[7mtest107.in                                                                      [23;1H[?25h[?0c[?25l[?1c

[0m:[?25h[?0clet s3=GetScreenStr(1)[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cwincmd p[?25l[?1c[11;1H[1m[7m[No Name] [+]                                                                   [0m[24;1H[7mtest107.in                                                                      [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall add(r, [line("w0"), s3])[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cexe ":norm! \<C-W>t\<C-W>=59Gzt\<C-W>w\<C-W>+"[?25l[?1c[27m[24m[0m[H[J[1;1H59
60
61
62
63
64
65
66
67
68
[7m[No Name] [+]                                                                   [0m[12;1H:exe ":norm! \<C-W>t\<C-W>=59Gzt\<C-W>w\<C-W>+"
:let s3=GetScreenStr(1)
::wincmd p
:call add(r, [line("w0"), s3])
:
:bwipeout!
:$put=r
:call garbagecollect(1)
:"
:/^start:/,$wq! test.out
ENDTEST

[1m[7mtest107.in                                                                      [23;1H[?25h[?0c[?25l[?1c

[0m:[?25h[?0clet s3=GetScreenStr(1)[?25l[?1c[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c:wincmd p[?25l[?1c[11;1H[1m[7m[No Name] [+]                                                                   [0m[24;1H[7mtest107.in                                                                      [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0ccall add(r, [line("w0"), s3])[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cbwipeout![?25l[?1c[1;1H:endfunc
:[2;2H[K[3;1H:exe ":norm! \<C-W>t\<C-W>=1Gzt\<C-W>w\<C-W>+"
:let s3=GetScreenStr(1)
:wincmd p
:call add(r, [line("w0"), s3])
:[7;2H[K[8;1H:exe ":norm! \<C-W>t\<C-W>=50Gzt\<C-W>w\<C-W>+"
:let s3=GetScreenStr(1)
:wincmd p
:call add(r, [line("w0"), s3])[11;31H[K[12;2H[K[13;2Hexe ":norm! \<C-W>t\<C-W>=59Gzt\<C-W>w\<C-W>+"
:let s3=GetScreenStr(1)
::wincmd p[15;11H[K[16;2Hcall add(r, [line("w0"), s3])[17;2H[K[18;2Hbwipeout!
:$put=r[19;8H[K[20;2Hcall garbagecollect(1)
:"[21;3H[K[22;1H:/^start:/,$wq! test.out
ENDTEST[24;1H[K[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put=r[?25l[?1c3 more lines[1;24r[1;1H[4M[1;25r[21;1Hstart:
[1, '1  ']
[50, '50 ']
[59, '59 '][25;1H[K[25;1H3 more lines[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall garbagecollect(1)[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^start:/,$wq! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 4 lines, 42 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test_autoformat_join.failed test.ok test.out X* viminfo
cp test_autoformat_join.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test_autoformat_join.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test_autoformat_join.in" 23 lines, 524 characters[1;1HTests for setting the '[,'] marks when joining lines.

STARTTEST
:so small.vim
:/^\t\t/
0gqj[1m[34m^[[0m
:let a=string(getpos("'[")).'/'.string(getpos("']"))
:/^This line/;'}-join
:let b=string(getpos("'[")).'/'.string(getpos("']"))
:$put ='First test: Start/End '.string(a)
:$put ='Second test: Start/End '.string(b)
:/^\t\t/,$wq! test.out
ENDTEST[16;17HO sodales, ludite, vos qui
attamen consulite per voster honur. Tua pulchra facies me fay planszer milies

This line.
Should be joined with the next line
and with this line

Results:
[1m[34m~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTests for setting the '[,'] marks when joining lines.[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 9 lines, 265 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[13;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[14;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^\t\t/[?25l[?1c[16;17H[?25h[?0c[16;8H[?25l[?1c[36Cattamen consulite per voster honur.
Tua pulchra facies me fay planszer milies[17;42H[K[17;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet a=string(getpos("'[")).'/'.string(getpos("']"))[?25l[?1c[18;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^This line/;'}-join[?25l[?1c[19;24r[19;1H[2M[1;25r[19;1HThis line.  Should be joined with the next line and with this line[23;1H[1m[34m~                                                                               [24;1H~                                                                               [0m[25;1H[K[19;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0clet b=string(getpos("'[")).'/'.string(getpos("']"))[?25l[?1c[19;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put ='First test: Start/End '.string(a)[?25l[?1c[22;1HFirst test: Start/End '[0, 16, 1, 0]/[0, 17, 1, 0]'[22;52H[K[22;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put ='Second test: Start/End '.string(b)[?25l[?1c[23;1HSecond test: Start/End '[0, 19, 11, 0]/[0, 19, 67, 0]'[23;55H[K[23;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^\t\t/,$wq! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 8 lines, 292 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test_eval.failed test.ok test.out X* viminfo
cp test_eval.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test_eval.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test_eval.in" 207 lines, 5216 characters[1;1HTest for various eval features.   vim: set ft=vim :

Note: system clipboard support is not tested. I do not think anybody will thank
me for messing with clipboard.

STARTTEST
:so small.vim
:set encoding=latin1
:set noswapfile
:lang C
:fun AppendRegContents(reg)
    call append('$', printf('%s: type %s; value: %s (%s), expr: %s (%s)', a:reg,[13;2Hgetregtype(a:reg), getreg(a:reg), string(getreg(a:reg, 0, 1)), getreg(a:reg, 1)[14;1H, string(getreg(a:reg, 1, 1))))
endfun
:command -nargs=? AR :call AppendRegContents(<q-args>)
:fun SetReg(...)
    call call('setreg', a:000)
    call append('$', printf('{{{2 setreg(%s)', string(a:000)[1:-2]))
    call AppendRegContents(a:1)
    if a:1 isnot# '='[22;9Hexecute "silent normal! Go==\n==\e\"".a:1."P"
    endif
endfun[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for various eval features.   vim: set ft=vim :[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[6;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 195 lines, 5003 characters written[7;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[7;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[27m[24m[0m[H[J[1;1H:so test_eval_func.vim
:"
:" Using $ instead of '$' must give an error
:try
: call append($, 'foobar')
:catch
:$put =v:exception
:endtry
:"
:$put ='{{{1 getcurpos/setpos'
/^012345678
6l:let sp = getcurpos()
0:call setpos('.', sp)
jyl:$put
:"
:/^start:/+1,$wq! test.out
:" vim: et ts=4 isk-=\: fmr=???,???
:call getchar()
ENDTEST

012345678
012345678

start:[19;1H[?25h[?0c
[?25l[?1c[25;1H:so! Xdotest[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cset encoding=latin1[?25l[?1c[27m[24m[0m[H[J[1;1H:so test_eval_func.vim
:"
:" Using $ instead of '$' must give an error
:try
: call append($, 'foobar')
:catch
:$put =v:exception
:endtry
:"
:$put ='{{{1 getcurpos/setpos'
/^012345678
6l:let sp = getcurpos()
0:call setpos('.', sp)
jyl:$put
:"
:/^start:/+1,$wq! test.out
:" vim: et ts=4 isk-=\: fmr=???,???
:call getchar()
ENDTEST

012345678
012345678

start:[20;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cset noswapfile[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clang C[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfun AppendRegContents(reg)[?25l[?1c
:  [?25h[?0c    call append('$', printf('%s: type %s; value: %s (%s), expr: %s (%s)', a:
[24;80Hr[25;1Heg, getregtype(a:reg), getreg(a:reg), string(getreg(a:reg, 0, 1)), getreg(a:reg
[24;80H,[25;1H 1), string(getreg(a:reg, 1, 1))))
[?25l[?1c:  [?25h[?0cendfun[1;1H[4L[?25l[?1c[1;1H:so test_eval_func.vim
:"
:" Using $ instead of '$' must give an error
:try[25;1H[K[20;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0ccommand -nargs=? AR :call AppendRegContents(<q-args>)[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfun SetReg(...)[?25l[?1c
:  [?25h[?0c    call call('setreg', a:000)
[?25l[?1c:  [?25h[?0c    call append('$', printf('{{{2 setreg(%s)', string(a:000)[1:-2]))
[?25l[?1c:  [?25h[?0c    call AppendRegContents(a:1)
[?25l[?1c:  [?25h[?0c    if a:1 isnot# '='
[?25l[?1c:    [?25h[?0c        execute "silent normal! Go==\n==\e\"".a:1."P"
[?25l[?1c:    [?25h[?0c    endif
[?25l[?1c:  [?25h[?0cendfun[1;1H[7L[?25l[?1c[1;1H:so test_eval_func.vim
:"
:" Using $ instead of '$' must give an error
:try
: call append($, 'foobar')
:catch
:$put =v:exception[25;1H[K[20;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cfun ErrExe(str)[?25l[?1c
:  [?25h[?0c    call append('$', 'Executing '.a:str)
[?25l[?1c:  [?25h[?0c    try
[?25l[?1c:    [?25h[?0c        execute a:str
[?25l[?1c:    [?25h[?0c    catch
[?25l[?1c:    [?25h[?0c        $put =v:exception
[?25l[?1c:    [?25h[?0c    endtry
[?25l[?1c:  [?25h[?0cendfun[1;1H[7L[?25l[?1c[1;1H:so test_eval_func.vim
:"
:" Using $ instead of '$' must give an error
:try
: call append($, 'foobar')
:catch
:$put =v:exception[25;1H[K[20;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cfun Test()[?25l[?1c
:  [?25h[?0c$put ='{{{1 let tests'
[?25l[?1c:  [?25h[?0clet @" = 'abc'
[?25l[?1c:  [?25h[?0cAR "
[?25l[?1c:  [?25h[?0clet @" = "abc\n"
[?25l[?1c:  [?25h[?0cAR "
[?25l[?1c:  [?25h[?0clet @" = "abc\<C-m>"
[?25l[?1c:  [?25h[?0cAR "
[?25l[?1c:  [?25h[?0clet @= = '"abc"'
[?25l[?1c:  [?25h[?0cAR =
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c$put ='{{{1 Basic setreg tests'
[?25l[?1c:  [?25h[?0ccall SetReg('a', 'abcA', 'c')
[?25l[?1c:  [?25h[?0ccall SetReg('b', 'abcB', 'v')
[?25l[?1c:  [?25h[?0ccall SetReg('c', 'abcC', 'l')
[?25l[?1c:  [?25h[?0ccall SetReg('d', 'abcD', 'V')
[?25l[?1c:  [?25h[?0ccall SetReg('e', 'abcE', 'b')
[?25l[?1c:  [?25h[?0ccall SetReg('f', 'abcF', "\<C-v>")
[?25l[?1c:  [?25h[?0ccall SetReg('g', 'abcG', 'b10')
[?25l[?1c:  [?25h[?0ccall SetReg('h', 'abcH', "\<C-v>10")
[?25l[?1c:  [?25h[?0ccall SetReg('I', 'abcI')
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c$put ='{{{1 Appending single lines with setreg()'
[?25l[?1c:  [?25h[?0ccall SetReg('A', 'abcAc', 'c')
[?25l[?1c:  [?25h[?0ccall SetReg('A', 'abcAl', 'l')
[?25l[?1c:  [?25h[?0ccall SetReg('A', 'abcAc2','c')
[?25l[?1c:  [?25h[?0ccall SetReg('b', 'abcBc', 'ca')
[?25l[?1c:  [?25h[?0ccall SetReg('b', 'abcBb', 'ba')
[?25l[?1c:  [?25h[?0ccall SetReg('b', 'abcBc2','ca')
[?25l[?1c:  [?25h[?0ccall SetReg('b', 'abcBb2','b50a')
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0ccall SetReg('C', 'abcCl', 'l')
[?25l[?1c:  [?25h[?0ccall SetReg('C', 'abcCc', 'c')
[?25l[?1c:  [?25h[?0ccall SetReg('D', 'abcDb', 'b')
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0ccall SetReg('E', 'abcEb', 'b')
[?25l[?1c:  [?25h[?0ccall SetReg('E', 'abcEl', 'l')
[?25l[?1c:  [?25h[?0ccall SetReg('F', 'abcFc', 'c')
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c$put ='{{{1 Appending NL with setreg()'
[?25l[?1c:  [?25h[?0ccall setreg('a', 'abcA2', 'c')
[?25l[?1c:  [?25h[?0ccall setreg('b', 'abcB2', 'v')
[?25l[?1c:  [?25h[?0ccall setreg('c', 'abcC2', 'l')
[?25l[?1c:  [?25h[?0ccall setreg('d', 'abcD2', 'V')
[?25l[?1c:  [?25h[?0ccall setreg('e', 'abcE2', 'b')
[?25l[?1c:  [?25h[?0ccall setreg('f', 'abcF2', "\<C-v>")
[?25l[?1c:  [?25h[?0ccall setreg('g', 'abcG2', 'b10')
[?25l[?1c:  [?25h[?0ccall setreg('h', 'abcH2', "\<C-v>10")
[?25l[?1c:  [?25h[?0ccall setreg('I', 'abcI2')
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0ccall SetReg('A', "\n")
[?25l[?1c:  [?25h[?0ccall SetReg('B', "\n", 'c')
[?25l[?1c:  [?25h[?0ccall SetReg('C', "\n")
[?25l[?1c:  [?25h[?0ccall SetReg('D', "\n", 'l')
[?25l[?1c:  [?25h[?0ccall SetReg('E', "\n")
[?25l[?1c:  [?25h[?0ccall SetReg('F', "\n", 'b')
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c$put ='{{{1 Setting lists with setreg()'
[?25l[?1c:  [?25h[?0ccall SetReg('a', ['abcA3'], 'c')
[?25l[?1c:  [?25h[?0ccall SetReg('b', ['abcB3'], 'l')
[?25l[?1c:  [?25h[?0ccall SetReg('c', ['abcC3'], 'b')
[?25l[?1c:  [?25h[?0ccall SetReg('d', ['abcD3'])
[?25l[?1c:  [?25h[?0ccall SetReg('e', [1, 2, 'abc', 3])
[?25l[?1c:  [?25h[?0ccall SetReg('f', [1, 2, 3])
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c$put ='{{{1 Appending lists with setreg()'
[?25l[?1c:  [?25h[?0ccall SetReg('A', ['abcA3c'], 'c')
[?25l[?1c:  [?25h[?0ccall SetReg('b', ['abcB3l'], 'la')
[?25l[?1c:  [?25h[?0ccall SetReg('C', ['abcC3b'], 'lb')
[?25l[?1c:  [?25h[?0ccall SetReg('D', ['abcD32'])
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0ccall SetReg('A', ['abcA32'])
[?25l[?1c:  [?25h[?0ccall SetReg('B', ['abcB3c'], 'c')
[?25l[?1c:  [?25h[?0ccall SetReg('C', ['abcC3l'], 'l')
[?25l[?1c:  [?25h[?0ccall SetReg('D', ['abcD3b'], 'b')
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c$put ='{{{1 Appending lists with NL with setreg()'
[?25l[?1c:  [?25h[?0ccall SetReg('A', ["\n", 'abcA3l2'], 'l')
[?25l[?1c:  [?25h[?0ccall SetReg('B', ["\n", 'abcB3c2'], 'c')
[?25l[?1c:  [?25h[?0ccall SetReg('C', ["\n", 'abcC3b2'], 'b')
[?25l[?1c:  [?25h[?0ccall SetReg('D', ["\n", 'abcD3b50'],'b50')
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c$put ='{{{1 Setting lists with NLs with setreg()'
[?25l[?1c:  [?25h[?0ccall SetReg('a', ['abcA4-0', "\n", "abcA4-2\n", "\nabcA4-3", "abcA4-4\nabcA4
[24;80H-[25;1H4-2"])
[?25l[?1c:  [?25h[?0ccall SetReg('b', ['abcB4c-0', "\n", "abcB4c-2\n", "\nabcB4c-3", "abcB4c-4\na
[24;80Hb[25;1HcB4c-4-2"], 'c')
[?25l[?1c:  [?25h[?0ccall SetReg('c', ['abcC4l-0', "\n", "abcC4l-2\n", "\nabcC4l-3", "abcC4l-4\na
[24;80Hb[25;1HcC4l-4-2"], 'l')
[?25l[?1c:  [?25h[?0ccall SetReg('d', ['abcD4b-0', "\n", "abcD4b-2\n", "\nabcD4b-3", "abcD4b-4\na
[24;80Hb[25;1HcD4b-4-2"], 'b')
[?25l[?1c:  [?25h[?0ccall SetReg('e', ['abcE4b10-0', "\n", "abcE4b10-2\n", "\nabcE4b10-3", "abcE4
[24;80Hb[25;1H10-4\nabcE4b10-4-2"], 'b10')
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c$put ='{{{1 Search and expressions'
[?25l[?1c:  [?25h[?0ccall SetReg('/', ['abc/'])
[?25l[?1c:  [?25h[?0ccall SetReg('/', ["abc/\n"])
[?25l[?1c:  [?25h[?0ccall SetReg('=', ['"abc/"'])
[?25l[?1c:  [?25h[?0ccall SetReg('=', ["\"abc/\n\""])
[?25l[?1c:  [?25h[?0c
[?25l[?1c:  [?25h[?0c$put ='{{{1 Errors'
[?25l[?1c:  [?25h[?0ccall ErrExe('call setreg()')
[?25l[?1c:  [?25h[?0ccall ErrExe('call setreg(1)')
[?25l[?1c:  [?25h[?0ccall ErrExe('call setreg(1, 2, 3, 4)')
[?25l[?1c:  [?25h[?0ccall ErrExe('call setreg([], 2)')
[?25l[?1c:  [?25h[?0ccall ErrExe('call setreg(1, {})')
[?25l[?1c:  [?25h[?0ccall ErrExe('call setreg(1, 2, [])')
[?25l[?1c:  [?25h[?0ccall ErrExe('call setreg("/", ["1", "2"])')
[?25l[?1c:  [?25h[?0ccall ErrExe('call setreg("=", ["1", "2"])')
[?25l[?1c:  [?25h[?0ccall ErrExe('call setreg(1, ["", "", [], ""])')
[?25l[?1c:  [?25h[?0cendfun[27m[24m[0m[H[J[?25l[?1c[1;1H:so test_eval_func.vim
:"
:" Using $ instead of '$' must give an error
:try
: call append($, 'foobar')
:catch
:$put =v:exception
:endtry
:"
:$put ='{{{1 getcurpos/setpos'
/^012345678
6l:let sp = getcurpos()
0:call setpos('.', sp)
jyl:$put
:"
:/^start:/+1,$wq! test.out
:" vim: et ts=4 isk-=\: fmr=???,???
:call getchar()
ENDTEST

012345678
012345678

start:[20;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c"[?25l[?1c[20;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall Test()[?25l[?1c[1;1H=: type v; value: abc/ (['abc/']), expr: "abc/" (['"abc/"'])
{{{2 setreg('=', ['"abc/[1m[34m^@[0m"'])
=: type v; value: abc/[1m[34m^@[0m (['abc/[1m[34m^@[0m']), expr: "abc/[1m[34m^@[0m" (['"abc/[1m[34m^@[0m"'])
{{{1 Errors
Executing call setreg()[5;24H[K[6;1HVim(call):E119: Not enough arguments for function: setreg
Executing call setreg(1)
Vim(call):E119: Not enough arguments for function: setreg
Executing call setreg(1, 2, 3, 4)
Vim(call):E118: Too many arguments for function: setreg
Executing call setreg([], 2)
Vim(call):E730: using List as a String
Executing call setreg(1, {})
Vim(call):E731: using Dictionary as a String
Executing call setreg(1, 2, [])
Vim(call):E730: using List as a String
Executing call setreg("/", ["1", "2"])
Vim(call):E883: search pattern and expression register may not contain two or mo[19;1Hre lines
Executing call setreg("=", ["1", "2"])
Vim(call):E883: search pattern and expression register may not contain two or mo[22;1Hre lines[22;9H[K[23;1HExecuting call setreg(1, ["", "", [], ""])
Vim(call):E730: using List as a String[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cdelfunction SetReg[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cdelfunction AppendRegContents[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cdelfunction ErrExe[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cdelfunction Test[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cdelcommand AR[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall garbagecollect(1)[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" function name not starting with capital[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctry[?25l[?1c
:  [?25h[?0c:func! g:test()
[?25l[?1c:  [?25h[?0c:echo "test"
[?25l[?1c:  [?25h[?0c:endfunc
[?25l[?1c:  [?25h[?0c:catch
[?25l[?1c:  [?25h[?0c:$put =v:exception
[?25l[?1c:  [?25h[?0c:endtry[1;1H[6L[?25l[?1c[1;1H{{{2 setreg('=', ['"abc/[1m[34m^@[0m"'])
=: type v; value: abc/[1m[34m^@[0m (['abc/[1m[34m^@[0m']), expr: "abc/[1m[34m^@[0m" (['"abc/[1m[34m^@[0m"'])
{{{1 Errors
Executing call setreg()
Vim(call):E119: Not enough arguments for function: setreg
Executing call setreg(1)
Vim(call):E119: Not enough arguments for function: setreg
Executing call setreg(1, 2, 3, 4)[8;34H[K[9;1HVim(call):E118: Too many arguments for function: setreg
Executing call setreg([], 2)[10;29H[K[11;1HVim(call):E730: using List as a String
Executing call setreg(1, {})[12;29H[K[13;1HVim(call):E731: using Dictionary as a String
Executing call setreg(1, 2, [])[14;32H[K[15;1HVim(call):E730: using List as a String
Executing call setreg("/", ["1", "2"])
Vim(call):E883: search pattern and expression register may not contain two or mo[18;1Hre lines[18;9H[K[19;1HExecuting call setreg("=", ["1", "2"])
Vim(call):E883: search pattern and expression register may not contain two or mo[21;1Hre lines[21;9H[K[22;1HExecuting call setreg(1, ["", "", [], ""])
Vim(call):E730: using List as a String[23;39H[K[24;5Hfunction):E128: Function name must start with a capital or "s:": g:test()[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" function name includes a colon[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctry[?25l[?1c
:  [?25h[?0c:func! b:test()
[?25l[?1c:  [?25h[?0c:echo "test"
[?25l[?1c:  [?25h[?0c:endfunc
[?25l[?1c:  [?25h[?0c:catch
[?25l[?1c:  [?25h[?0c:$put =v:exception
[?25l[?1c:  [?25h[?0c:endtry[1;1H[6L[?25l[?1c[1;1H=: type v; value: abc/[1m[34m^@[0m (['abc/[1m[34m^@[0m']), expr: "abc/[1m[34m^@[0m" (['"abc/[1m[34m^@[0m"'])
{{{1 Errors
Executing call setreg()
Vim(call):E119: Not enough arguments for function: setreg
Executing call setreg(1)
Vim(call):E119: Not enough arguments for function: setreg
Executing call setreg(1, 2, 3, 4)[7;34H[K[8;1HVim(call):E118: Too many arguments for function: setreg
Executing call setreg([], 2)[9;29H[K[10;1HVim(call):E730: using List as a String
Executing call setreg(1, {})[11;29H[K[12;1HVim(call):E731: using Dictionary as a String
Executing call setreg(1, 2, [])[13;32H[K[14;1HVim(call):E730: using List as a String
Executing call setreg("/", ["1", "2"])
Vim(call):E883: search pattern and expression register may not contain two or mo[17;1Hre lines[17;9H[K[18;1HExecuting call setreg("=", ["1", "2"])
Vim(call):E883: search pattern and expression register may not contain two or mo[20;1Hre lines[20;9H[K[21;1HExecuting call setreg(1, ["", "", [], ""])
Vim(call):E730: using List as a String[22;39H[K[23;5Hfunction):E128: Function name must start with a capital or "s:": g:test()[24;70Hb[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" function name folowed by #[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctry[?25l[?1c
:  [?25h[?0c:func! test2() "#
[?25l[?1c:  [?25h[?0c:echo "test2"
[?25l[?1c:  [?25h[?0c:endfunc
[?25l[?1c:  [?25h[?0c:catch
[?25l[?1c:  [?25h[?0c:$put =v:exception
[?25l[?1c:  [?25h[?0c:endtry[1;1H[6L[?25l[?1c[1;1H{{{1 Errors
Executing call setreg()
Vim(call):E119: Not enough arguments for function: setreg
Executing call setreg(1)
Vim(call):E119: Not enough arguments for function: setreg
Executing call setreg(1, 2, 3, 4)
Vim(call):E118: Too many arguments for function: setreg
Executing call setreg([], 2)[8;29H[K[9;1HVim(call):E730: using List as a String
Executing call setreg(1, {})[10;29H[K[11;1HVim(call):E731: using Dictionary as a String
Executing call setreg(1, 2, [])[12;32H[K[13;1HVim(call):E730: using List as a String
Executing call setreg("/", ["1", "2"])
Vim(call):E883: search pattern and expression register may not contain two or mo[16;1Hre lines[16;9H[K[17;1HExecuting call setreg("=", ["1", "2"])
Vim(call):E883: search pattern and expression register may not contain two or mo[19;1Hre lines[19;9H[K[20;1HExecuting call setreg(1, ["", "", [], ""])
Vim(call):E730: using List as a String[21;39H[K[22;5Hfunction):E128: Function name must start with a capital or "s:": g:test()[23;70Hb[24;70Htest2() "#[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" function name starting with/without "g:", buffer-local funcref.[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cfunction! g:Foo(n)[?25l[?1c
:  [?25h[?0c:  $put ='called Foo(' . a:n . ')'
[?25l[?1c:  [?25h[?0c:endfunction[1;1H[2L[?25l[?1c[1;1H{{{1 Errors
Executing call setreg()[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0clet b:my_func = function('Foo')[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall b:my_func(1)[?25l[?1c[1;24r[24;1H
[1;25r[24;1Hcalled Foo(1)[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cecho g:Foo(2)[?25l[?1c0[25;2H[K[1;24r[24;1H
[1;25r[24;1Hcalled Foo(2)[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0cecho Foo(3)[?25l[?1c0[25;2H[K[1;24r[24;1H
[1;25r[24;1Hcalled Foo(3)[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" script-local function used in Funcref must exist.[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso test_eval_func.vim[?25l[?1c[1;24r[1;1H[4M[1;25r[21;1Hs:Testje exists: 0
func s:Testje exists: 1
Bar exists: 1
func Bar exists: 1[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c" Using $ instead of '$' must give an error[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctry[?25l[?1c
:  [?25h[?0c: call append($, 'foobar')
[?25l[?1c:  [?25h[?0c:catch
[?25l[?1c:  [?25h[?0c:$put =v:exception
[?25l[?1c:  [?25h[?0c:endtry[1;1H[4L[?25l[?1c[1;1HVim(call):E730: using List as a String
Executing call setreg(1, {})
Vim(call):E731: using Dictionary as a String
Executing call setreg(1, 2, [])
Vim(call):E730: using List as a String
Executing call setreg("/", ["1", "2"])
Vim(call):E883: search pattern and expression register may not contain two or mo[8;1Hre lines[8;9H[K[9;1HExecuting call setreg("=", ["1", "2"])
Vim(call):E883: search pattern and expression register may not contain two or mo[11;1Hre lines[11;9H[K[12;1HExecuting call setreg(1, ["", "", [], ""])
Vim(call):E730: using List as a String[13;39H[K[14;5Hfunction):E128: Function name must start with a capital or "s:": g:test()[15;70Hb[16;70Htest2() "#
called Foo(1[17;14H[K[18;12H2[19;12H3
s:Testje exists: 0
func s:Testje exists: 1
Bar exists: 1[22;15H[K[23;1Hfunc Bar exists: 1
Vim(call):E116: Invalid arguments for function append[25;1H[K[24;1H[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put ='{{{1 getcurpos/setpos'[?25l[?1c[1;24r[24;1H
[1;25r[24;1H{{{1 getcurpos/setpos[25;1H[K[24;1H[?25h[?0c[?25l[?1c
/[?25h[?0c^012345678[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[27m[24m[0m[H[J[1;1H:$put ='{{{1 getcurpos/setpos'
/^012345678
6l:let sp = getcurpos()
0:call setpos('.', sp)
jyl:$put
:"
:/^start:/+1,$wq! test.out
:" vim: et ts=4 isk-=\: fmr=???,???
:call getchar()
ENDTEST

012345678
012345678

start:
{{{1 let tests
": type v; value: abc (['abc']), expr: abc (['abc'])
": type V; value: abc[1m[34m^@[0m (['abc']), expr: abc[1m[34m^@[0m (['abc'])
": type V; value: abc[1m[34m^M^@[0m (['abc[1m[34m^M[0m']), expr: abc[1m[34m^M^@[0m (['abc[1m[34m^M[0m'])
=: type v; value: abc (['abc']), expr: "abc" (['"abc"'])
{{{1 Basic setreg tests
{{{2 setreg('a', 'abcA', 'c')
a: type v; value: abcA (['abcA']), expr: abcA (['abcA'])
==
[1m[31msearch hit BOTTOM, continuing at TOP[12;1H[?25h[?0c[0m012345[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet sp = getcurpos()[?25l[?1c[12;7H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ccall setpos('.', sp)[?25l[?1c[12;7H[?25h[?0c[13;7H[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put[?25l[?1c[27m[24m[0m[H[J[1;1HVim(call):E731: using Dictionary as a String
Executing call setreg(1, 2, [])
Vim(call):E730: using List as a String
Executing call setreg("/", ["1", "2"])
Vim(call):E883: search pattern and expression register may not contain two or mo[6;1Hre lines
Executing call setreg("=", ["1", "2"])
Vim(call):E883: search pattern and expression register may not contain two or mo[9;1Hre lines
Executing call setreg(1, ["", "", [], ""])
Vim(call):E730: using List as a String
Vim(function):E128: Function name must start with a capital or "s:": g:test()
Vim(function):E128: Function name must start with a capital or "s:": b:test()
Vim(function):E128: Function name must start with a capital or "s:": test2() "#
called Foo(1)
called Foo(2)
called Foo(3)
s:Testje exists: 0
func s:Testje exists: 1
Bar exists: 1
func Bar exists: 1
Vim(call):E116: Invalid arguments for function append
{{{1 getcurpos/setpos
6[?25h[?0c[?25l[?1c
:[?25h[?0c"[?25l[?1c[24;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c/^start:/+1,$wq! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 350 lines, 11010 characters written[?25h[?0c
# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo
rm -rf test_options.failed test.ok test.out X* viminfo
cp test_options.ok test.ok
# Sleep a moment to avoid that the xterm title is messed up.
# 200 msec is sufficient, but only modern sleep supports a fraction of
# a second, fall back to a second if it fails.
VIMRUNTIME=../../runtime; export VIMRUNTIME;  ../vim -u unix.vim -U NONE --noplugin -s dotest.in test_options.in
Vim: Warning: Output is not to a terminal
[1;25r[?25h[?8c[?25h[?0c[27m[24m[0m[H[J[?25l[?1c[25;1H"test_options.in" 17 lines, 213 characters[1;1HTest for ":options".

STARTTEST
:so small.vim
:let caught = 'ok'
:try
  :options
:catch
  :let caught = v:throwpoint . "\n" . v:exception
:endtry
:buf 1
:$put =caught
:/^result/,$w! test.out
:qa!
ENDTEST

result
[1m[34m~                                                                               [19;1H~                                                                               [20;1H~                                                                               [21;1H~                                                                               [22;1H~                                                                               [23;1H~                                                                               [24;1H~                                                                               [1;1H[?25h[?0c[?25l[?1c[0m[25;1H[K[25;1H:[?25h[?0cset cp[?25l[?1c[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cmap dotest /^STARTTEST^[1m[34m^M[0mj:set ff=unix cpo-=A^[1m[34m^M[0m:.,/ENDTEST/-1w! Xdotest^[1m[34m^M[0m:set f
[24;80Hf[25;1H& cpo+=A^[1m[34m^M[0mnj0:so! Xdotest^[1m[34m^M[0mdotest[?25l[?1c[1;1H[L[1;1HTest for ":options".[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H/^STARTTEST[3;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:set ff=unix cpo-=A[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:.,/ENDTEST/-1w! Xdotest"Xdotest" [25;11H[K[25;11H[New File] 11 lines, 165 characters written[4;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:set ff& cpo+=A[4;1H[?25h[?0c[?25l[?1c[25;1H/ENDTEST[25;10H[K[25;1H[15;1H[?25h[?0c
[?25l[?1c[25;1H[K[25;1H:so! Xdotest[16;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cso small.vim[?25l[?1c[16;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0clet caught = 'ok'[?25l[?1c[16;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0ctry[?25l[?1c
:  [?25h[?0c  :options
[?25l[?1c"option-window" [New File]
:  [?25h[?0c:catch 
[?25l[?1c:  [?25h[?0c  :let caught = v:throwpoint . "\n" . v:exception
[?25l[?1c:  [?25h[?0c:endtry[1;1H[5L[?25l[?1c[1;1H" Each "set" line shows the current value of an option (on the left).
" Hit <CR> on a "set" line to execute it.
"[12CA boolean option will be toggled.
"[12CFor other options you can edit the value.
" Hit <CR> on a help line to open a help window on this option.
" Hit <CR> on an index line to jump there.
" Hit <Space> on a "set" line to refresh it.[8;1H[K[9;1H[1m[35m 1 important[0m[9;13H[K[10;1H[1m[35m 2 moving around, searching and patterns
 3 tags[0m
[1m[7moption-window                                                                   [0m[13;1H  :let caught = v:throwpoint . "\n" . v:exception
:endtry
:buf 1[15;7H[K[16;1H:$put =caught
:/^result/,$w! test.out
:qa![18;5H[K[19;1HENDTEST[19;8H[K[20;1H[K[21;1Hresult[21;7H[K[24;1H[7mtest_options.in                                                                 [0m[25;1H[K[1;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0cbuf 1[?25l[?1c[1;1HTest for ":options".[1;21H[K[2;1H[K[3;1HSTARTTEST[3;14H[K[4;1H:so small.vim[4;14H[K[5;1H:let caught = 'ok'[5;19H[K[6;1H:try[6;5H[K[7;1H  :options[7;11H[K[8;1H:catch
  :let caught = v:throwpoint . "\n" . v:exception
:endtry[10;8H[K[11;1H:buf 1[11;7H[K[12;1H[1m[7mtest_options.in[0m[25;1H"test_options.in" line 1 of 17 --5%-- col 1[1;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0c$put =caught[?25l[?1c[1;11r[1;1H[7M[1;25r[5;1H:$put =caught
:/^result/,$w! test.out
:qa!
ENDTEST

result
ok[12;17H[1m[7m[+][0m[22;1Hok[22;3H[K[24;17H[7m[+][0m[25;1H[K[11;1H[?25h[?0c[?25l[?1c[25;1H:[?25h[?0c/^result/,$w! test.out[?25l[?1c[1m[31msearch hit BOTTOM, continuing at TOP[0m"test.out" [25;12H[K[25;12H[New File] 2 lines, 10 characters written[11;1H[?25h[?0c[?25l[?1c[25;1H[K[25;1H:[?25h[?0cqa![?25l[?1c[?25h[?0c[25;1H[K[25;1H# For flaky tests retry one time.
# Check if the test.out file matches test.ok.
rm -rf X* test.ok viminfo

Test results:
ALL DONE
make[3]: Leaving directory '/sources/vim74/src/testdir'
make -f Makefile unittest
make[3]: Entering directory '/sources/vim74/src'
gcc -m64 -c -I. -Iproto -DHAVE_CONFIG_H     -g -O2 -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=1       -o objects/memfile_test.o memfile_test.c
gcc -m64 -c -I. -Iproto -DHAVE_CONFIG_H     -g -O2 -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=1       version.c -o objects/version.o
link.sh: $LINK_AS_NEEDED set to 'yes': invoking linker directly.
  gcc -m64   -L/usr/local/lib -Wl,--as-needed 	-o memfile_test objects/buffer.o objects/blowfish.o objects/charset.o objects/diff.o objects/digraph.o objects/edit.o objects/eval.o objects/ex_cmds.o objects/ex_cmds2.o objects/ex_docmd.o objects/ex_eval.o objects/ex_getln.o objects/fileio.o objects/fold.o objects/getchar.o objects/hardcopy.o objects/hashtab.o  objects/if_cscope.o objects/if_xcmdsrv.o objects/mark.o objects/memline.o objects/menu.o objects/message.o objects/misc1.o objects/misc2.o objects/move.o objects/mbyte.o objects/normal.o objects/ops.o objects/option.o objects/os_unix.o objects/pathdef.o objects/popupmnu.o objects/quickfix.o objects/regexp.o objects/screen.o objects/search.o objects/sha256.o objects/spell.o objects/syntax.o  objects/tag.o objects/term.o objects/ui.o objects/undo.o objects/version.o objects/window.o           objects/netbeans.o  objects/memfile_test.o        -lm -lncurses -lnsl  -lacl -lattr -ldl          
link.sh: Linked fine
memfile_test passed
make[3]: Leaving directory '/sources/vim74/src'
make[2]: Leaving directory '/sources/vim74/src'
make[1]: Leaving directory '/sources/vim74'
